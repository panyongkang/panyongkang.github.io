title: è¶£å‘³æ€§è„šæœ¬
author: PanYuKang
cover: https://pic.imgdb.cn/item/6640bf550ea9cb14036cafdc.png
tags: [è‡ªåŠ¨åŒ–,æ¶æ,è„šæœ¬è¯­è¨€]
categories: [é»‘æŠ€èƒ½]

date: 2024-05-12 21:10:02

---

## batè„šæœ¬åŒºåŸŸ

æ–°å»ºtxtæ–‡ä»¶ï¼Œå°†ä»£ç å¤åˆ¶åå¦å­˜ä¸ºANSLç¼–ç æ ¼å¼çš„æ–‡ä»¶ï¼Œå› ä¸ºç”µè„‘é»˜è®¤æ˜¯utf-8,æœ‰æ—¶å€™è¿è¡Œä¸å‡ºæ¥å°±æ˜¯è¿™ä¸ªåŸå› ã€‚ç„¶åå°†.txtåç¼€åæ”¹ä¸º.batå³å¯ç‚¹å‡»è¿è¡Œã€‚

### è®¡ç®—å½“å‰ç›®å½•å¤§å°

```bash
@echo off
:: æ™ºèƒ½è·¯å¾„å¤„ç†
set "TARGET_PATH=%~1"
if "%~1"=="" set "TARGET_PATH=%~dp0"
if "%TARGET_PATH:~-1%"=="\" set "TARGET_PATH=%TARGET_PATH:~0,-1%"

:: è°ƒç”¨ PowerShell è®¡ç®—å¤§å°ï¼ˆå®Œå…¨ä¿®å¤ç‰ˆï¼‰
powershell -NoProfile -ExecutionPolicy Bypass -Command ^
    "$target = '%TARGET_PATH%'; " ^
    "if (-not (Test-Path -LiteralPath $target)) { " ^
    "    Write-Host ('[é”™è¯¯] è·¯å¾„ä¸å­˜åœ¨: ' + $target) -ForegroundColor Red; " ^
    "    exit 1; " ^
    "}; " ^
    "$isFile = (Get-Item -LiteralPath $target) -is [System.IO.FileInfo]; " ^
    "if ($isFile) { " ^
    "    $size = (Get-Item -LiteralPath $target).Length; " ^
    "    $sizeGB = $size / 1GB; " ^
    "    if ($sizeGB -ge 1) { " ^
    "        $displaySize = \"{0:N2} GB\" -f $sizeGB; " ^
    "    } else { " ^
    "        $displaySize = \"{0:N2} MB\" -f ($size / 1MB); " ^
    "    }; " ^
    "    [PSCustomObject]@{ " ^
    "        Name = [System.IO.Path]::GetFileName($target); " ^
    "        Size = $displaySize " ^
    "    } | Format-Table -AutoSize; " ^
    "    exit 0; " ^
    "}; " ^
    "$items = Get-ChildItem -LiteralPath $target -Force; " ^
    "$results = @(); $totalBytes = 0; " ^
    "foreach ($item in $items) { " ^
    "    try { " ^
    "        if ($item.PSIsContainer) { " ^
    "            $size = (Get-ChildItem -LiteralPath $item.FullName -Recurse -File -Force -ErrorAction Stop | " ^
    "                   Measure-Object -Property Length -Sum -ErrorAction Stop).Sum; " ^
    "        } else { " ^
    "            $size = $item.Length; " ^
    "        }; " ^
    "        $totalBytes += $size; " ^
    "        if ($size -ge 1GB) { " ^
    "            $displaySize = \"{0:N2} GB\" -f ($size / 1GB); " ^
    "        } elseif ($size -ge 1MB) { " ^
    "            $displaySize = \"{0:N2} MB\" -f ($size / 1MB); " ^
    "        } else { " ^
    "            $displaySize = \"{0:N2} KB\" -f ($size / 1KB); " ^
    "        }; " ^
    "        $results += [PSCustomObject]@{ " ^
    "            Name = $item.Name; " ^
    "            Size = $displaySize; " ^
    "            RawSize = $size " ^
    "        }; " ^
    "    } catch { " ^
    "        $results += [PSCustomObject]@{ " ^
    "            Name = $item.Name + ' [æ‹’ç»è®¿é—®]'; " ^
    "            Size = 'N/A'; " ^
    "            RawSize = -1 " ^
    "        }; " ^
    "    }; " ^
    "}; " ^
    "$results | Sort-Object -Property RawSize -Descending | Format-Table Name, Size -AutoSize; " ^
    "$totalGB = $totalBytes / 1GB; " ^
    "$totalMB = $totalBytes / 1MB; " ^
    "$totalKB = $totalBytes / 1KB; " ^
    "if ($totalGB -ge 1) { " ^
    "    $summary = \"æ€»å¤§å°: {0:N2} GB ({1:N2} MB)\" -f $totalGB, $totalMB; " ^
    "} elseif ($totalMB -ge 1) { " ^
    "    $summary = \"æ€»å¤§å°: {0:N2} MB ({1:N0} KB)\" -f $totalMB, $totalKB; " ^
    "} else { " ^
    "    $summary = \"æ€»å¤§å°: {0:N0} KB\" -f $totalKB; " ^
    "}; " ^
    "Write-Host \"`n$summary`nè¯¦ç»†ç»Ÿè®¡: $totalBytes å­—èŠ‚\""

pause
```

**è¿è¡Œç»“æœï¼š**

```
Name                                 Size
----                                 ----
Program Files                        4.57 GB
Program Files (x86)                  2.21 GB
database                             1.90 GB
software                             113.14 MB
softwarenodejs                       102.12 MB
å‹ç¼©åŒ…                               87.72 MB
WinRAR                               5.75 MB
DumpStack.log.tmp                    8.00 KB
$RECYCLE.BIN                         0.13 KB
System Volume Information [æ‹’ç»è®¿é—®] N/A



æ€»å¤§å°: 8.99 GB (9,207.64 MB)
è¯¦ç»†ç»Ÿè®¡: 9654907173 å­—èŠ‚
è¯·æŒ‰ä»»æ„é”®ç»§ç»­. . .
```

#### å³é”®èœå•æ”¯æŒç‚¹å‡»

##### æ³¨å†Œè¡¨è„šæœ¬

regæ–‡ä»¶æ˜¯ä¸€ç§â€œæ³¨å†Œè¡¨è„šæœ¬â€ï¼Œä¸“ç”¨äºä¿®æ”¹ Windows æ³¨å†Œè¡¨ã€‚

* åç¼€åæ˜¯ `.reg`
* æœ¬è´¨ä¸Šæ˜¯ **æ³¨å†Œè¡¨é¡¹ + å‘½ä»¤** çš„æ–‡æœ¬æ–‡ä»¶
* è¿è¡Œæ–¹å¼ï¼š**åŒå‡»å¯¼å…¥** æˆ–ç”¨ `regedit /s xxx.reg` å‘½ä»¤æ‰§è¡Œ
* åŠŸèƒ½ç±»ä¼¼äºï¼š
  * bat è„šæœ¬ä½œç”¨äºå‘½ä»¤è¡Œ
  * reg è„šæœ¬ä½œç”¨äºæ³¨å†Œè¡¨

æ‰§è¡Œæ­¥éª¤å¦‚ä¸‹ï¼š

1. åˆ›å»ºä¸€ä¸ªæ”¯æŒå‚æ•°çš„ `.bat` è„šæœ¬
2. å†™ä¸€ä¸ª `.reg` æ–‡ä»¶å°†å®ƒæ³¨å†Œè¿›å³é”®èœå•
3. è¿è¡Œ `.reg` æ–‡ä»¶å¯¼å…¥æ³¨å†Œè¡¨å³å¯

##### æ·»åŠ å³é”®èœå•

åˆ›å»ºä¸€ä¸ª"æ·»åŠ å³é”®èœå•.reg"æ–‡ä»¶ï¼Œä¿å­˜ä½ç½®ä¸é™åˆ¶,æœ€å¥½è·Ÿbatè„šæœ¬ä¿å­˜åœ¨ä¸€èµ·ï¼Œæ–¹ä¾¿æ‰§è¡Œã€‚æ–‡ä»¶ä»£ç å¦‚ä¸‹ï¼š

```bash
Windows Registry Editor Version 5.00

; 1.æ–‡ä»¶å¤¹å³é”®èœå•
[HKEY_CLASSES_ROOT\Directory\shell\è®¡ç®—ç›®å½•å¤§å°]
@="è®¡ç®—ç›®å½•å¤§å°"
[HKEY_CLASSES_ROOT\Directory\shell\è®¡ç®—ç›®å½•å¤§å°\command]
@="cmd.exe /c \"\"F:\\å¥½ç©è„šæœ¬ç¨‹åº\\è®¡ç®—å½“å‰ç›®å½•å¤§å°.bat\" \"%1\"\""

; 2.ç£ç›˜å³é”®èœå•ï¼ˆå¦‚ C:\ D:\ï¼‰
[HKEY_CLASSES_ROOT\Drive\shell\è®¡ç®—ç›®å½•å¤§å°]
@="è®¡ç®—ç›®å½•å¤§å°"
[HKEY_CLASSES_ROOT\Drive\shell\è®¡ç®—ç›®å½•å¤§å°\command]
@="cmd.exe /c \"\"F:\\å¥½ç©è„šæœ¬ç¨‹åº\\è®¡ç®—å½“å‰ç›®å½•å¤§å°.bat\" \"%1\"\""

; 3.ç©ºç™½åŒºåŸŸå³é”®èœå•ï¼ˆå½“å‰æ‰€åœ¨è·¯å¾„ï¼‰
[HKEY_CLASSES_ROOT\Directory\Background\shell\è®¡ç®—ç›®å½•å¤§å°]
@="è®¡ç®—ç›®å½•å¤§å°"
[HKEY_CLASSES_ROOT\Directory\Background\shell\è®¡ç®—ç›®å½•å¤§å°\command]
@="cmd.exe /c \"\"F:\\å¥½ç©è„šæœ¬ç¨‹åº\\è®¡ç®—å½“å‰ç›®å½•å¤§å°.bat\" \"%V\"\""

```

##### åˆ é™¤å³é”®èœå•

åŒæ ·çš„ï¼Œåˆ›å»ºä¸€ä¸ª"åˆ é™¤å³é”®èœå•.reg"æ–‡ä»¶,ä»£ç å¦‚ä¸‹ï¼š

```bash
Windows Registry Editor Version 5.00

; åˆ é™¤æ–‡ä»¶å¤¹å³é”®èœå•
[-HKEY_CLASSES_ROOT\Directory\shell\è®¡ç®—ç›®å½•å¤§å°]

; åˆ é™¤ç£ç›˜å³é”®èœå•
[-HKEY_CLASSES_ROOT\Drive\shell\è®¡ç®—ç›®å½•å¤§å°]

; åˆ é™¤ç©ºç™½åŒºåŸŸå³é”®èœå•
[-HKEY_CLASSES_ROOT\Directory\Background\shell\è®¡ç®—ç›®å½•å¤§å°]
```

### win10ä¸€é”®åƒåœ¾æ¸…ç†

æ–°å»ºtxtæ–‡ä»¶ï¼Œå°†ä»£ç å¤åˆ¶åå¦å­˜ä¸ºANSLç¼–ç æ ¼å¼çš„æ–‡ä»¶ï¼Œå› ä¸ºç”µè„‘é»˜è®¤æ˜¯utf-8,æœ‰æ—¶å€™è¿è¡Œä¸å‡ºæ¥å°±æ˜¯è¿™ä¸ªåŸå› ã€‚ç„¶åå°†.txtåç¼€åæ”¹ä¸º.batå³å¯ç‚¹å‡»è¿è¡Œã€‚

```
@echo offã€€ã€€

echo æ­£åœ¨æ¸…é™¤ç³»ç»Ÿåƒåœ¾æ–‡ä»¶ï¼Œè¯·ç¨ç­‰......ã€€

del /f /s /q %systemdrive%\*.tmpã€€ã€€

del /f /s /q %systemdrive%\*._mpã€€ã€€

del /f /s /q %systemdrive%\*.logã€€ã€€

del /f /s /q %systemdrive%\*.gidã€€ã€€

del /f /s /q %systemdrive%\*.chkã€€ã€€

del /f /s /q %systemdrive%\*.oldã€€ã€€

del /f /s /q %systemdrive%\recycled\*.*ã€€ã€€

del /f /s /q %windir%\*.bakã€€ã€€

del /f /s /q %windir%\prefetch\*.*ã€€ã€€

rd /s /q %windir%\temp & md %windir%\tempã€€ã€€

del /f /q %userprofile%\cookies\*.*ã€€ã€€

del /f /q %userprofile%\recent\*.*ã€€ã€€

del /f /s /q â€œ%userprofile%\Local Settings\Temporary Internet Files\*.*â€ã€€ã€€

del /f /s /q â€œ%userprofile%\Local Settings\Temp\*.*â€ã€€ã€€

del /f /s /q â€œ%userprofile%\recent\*.*â€ã€€ã€€

echo æ¸…é™¤ç³»ç»ŸLJå®Œæˆï¼ã€€ã€€

echo. & pause
```

### æ¸…ç©ºå›æ”¶ç«™

å°†ä»£ç å¤åˆ¶åå¦å­˜ä¸ºANSLç¼–ç æ ¼å¼çš„æ–‡ä»¶ï¼Œç„¶åå°†.txtåç¼€åæ”¹ä¸º.batå³å¯ã€‚

```
@echo off
powershell -c "Clear-RecycleBin -Force" 2>nul
```

### è½¯ä»¶å¤šå¼€ç™»å½•

å†™å…¥ä»¥ä¸‹ä»£ç å³å¯åŒæ—¶å¯åŠ¨å¤šä¸ªåº”ç”¨è½¯ä»¶ï¼Œæƒ³ç™»å‡ ä¸ªå°±ç å…¥å‡ ä¸ªï¼Œæœ€åæ”¹æˆ.batæ–‡ä»¶å³å¯ã€‚

```
start "" "D:\Program Files (x86)\Tencent\WeChat\WeChat.exe"
start "" "D:\Program Files (x86)\Tencent\WeChat\WeChat.exe"
start "" "D:\Program Files (x86)\Tencent\QQ\Bin\QQScLauncher.exe"
```

### åº”ç”¨åˆ†èº«

æ¯”å¦‚ç”µè„‘å¾®ä¿¡æƒ³å¤šå¼€ç™»å½•ï¼Œä¹Ÿå¯ä»¥å†™å…¥å¦‚ä¸‹batè„šæœ¬å¼€å¯ç™»å½•ï¼š

```
PATH D:\Program Files (x86)\Tencent\WeChat
start WeChat.exe&WeChat.exe
```

### æ»‘åŠ¨å…³æœº

è¿™ä¸ªæ¯”è¾ƒç§€ï¼ˆæ¨èï¼‰,åç¼€å.batæ–‡ä»¶ã€‚

```
slidetoshutdown
```

### é‡å¯åº”ç”¨

å¯å¿«é€Ÿé‡å¯åº”ç”¨ç¨‹åºçš„batè„šæœ¬ï¼š

```bash
@echo off
tasklist | findstr /I "Code.exe" >nul
if errorlevel 1 (
    echo ABC å®¢æˆ·ç«¯æœªè¿è¡Œï¼Œç›´æ¥å¯åŠ¨...
) else (
    echo æ­£åœ¨å…³é—­ ABC å®¢æˆ·ç«¯...
    taskkill /F /IM Code.exe >nul 2>nul
)

echo æ­£åœ¨å¯åŠ¨ ABC å®¢æˆ·ç«¯...
start "" /B "D:\Program Files\VSCode\Code.exe"
echo æ“ä½œå®Œæˆã€‚
exit
```

### é‡å¯æ¡Œé¢

æœ‰æ—¶å€™win10ç³»ç»Ÿçš„æ‰¬å£°å™¨æˆ–è€…æ¡Œé¢å›¾æ ‡æ— æ³•å¯åŠ¨ï¼Œå¯ä»¥é€šè¿‡batæ–‡ä»¶æ¥ä¸€é”®é‡å¯æ“ä½œã€‚

```
@echo off

taskkill /f /im explorer.exe

CD /d %userprofile%\AppData\Local

DEL IconCache.db /a

start explorer.exe

cho æ‰§è¡Œå®Œæˆ
```

### é‡å¯ç”µè„‘

é€šè¿‡æ‰§è¡Œbatè„šæœ¬æ–‡ä»¶å®ç°ä¸€é”®é‡å¯ç”µè„‘çš„æ“ä½œã€‚

```
shutdown -r -t 0
```

### ç”µè„‘ç¡çœ 

é€šè¿‡æ‰§è¡Œbatè„šæœ¬æ–‡ä»¶å®ç°ä¸€é”®ç¡çœ çš„æ“ä½œã€‚

```
rundll32.exe powrprof.dll,SetSuspendState 0,1,0
```

### å±å¹•äº®åº¦åˆ‡æ¢

```
@echo off
setlocal enabledelayedexpansion

set "brightness=10"

for /f "tokens=2 delims==." %%a in ('wmic path Win32_VideoController get CurrentHorizontalResolution /value') do (
    set "resolution=%%a"
)

if exist "%temp%\brightness.txt" (
    set /p brightness=<"%temp%\brightness.txt"
    if !brightness! equ 10 (
        set "brightness=90"
    ) else (
        set "brightness=10"
    )
)

powershell -command "(Get-WmiObject -Namespace root/WMI -Class WmiMonitorBrightnessMethods).WmiSetBrightness(1, !brightness!)"
echo !brightness!>"%temp%\brightness.txt"

exit /b

```

### æ•°å­—æ—¶é’Ÿ

```
@echo off
setlocal enabledelayedexpansion
color 09
mode con COLS=67 LINES=8
title æ•°å­—æ—¶é’Ÿ code by felicity 
set num0_0=â– â– â– â– 
set num0_1=â– â–¡â–¡â– 
set num0_2=â– â–¡â–¡â– 
set num0_3=â– â–¡â–¡â– 
set num0_4=â– â–¡â–¡â– 
set num0_5=â– â–¡â–¡â– 
set num0_6=â– â– â– â– 

set num1_0=â–¡â–¡â–¡â– 
set num1_1=â–¡â–¡â–¡â– 
set num1_2=â–¡â–¡â–¡â– 
set num1_3=â–¡â–¡â–¡â– 
set num1_4=â–¡â–¡â–¡â– 
set num1_5=â–¡â–¡â–¡â– 
set num1_6=â–¡â–¡â–¡â– 

set num2_0=â– â– â– â– 
set num2_1=â–¡â–¡â–¡â– 
set num2_2=â–¡â–¡â–¡â– 
set num2_3=â– â– â– â– 
set num2_4=â– â–¡â–¡â–¡
set num2_5=â– â–¡â–¡â–¡
set num2_6=â– â– â– â– 

set num3_0=â– â– â– â– 
set num3_1=â–¡â–¡â–¡â– 
set num3_2=â–¡â–¡â–¡â– 
set num3_3=â– â– â– â– 
set num3_4=â–¡â–¡â–¡â– 
set num3_5=â–¡â–¡â–¡â– 
set num3_6=â– â– â– â– 

set num4_0=â– â–¡â–¡â– 
set num4_1=â– â–¡â–¡â– 
set num4_2=â– â–¡â–¡â– 
set num4_3=â– â– â– â– 
set num4_4=â–¡â–¡â–¡â– 
set num4_5=â–¡â–¡â–¡â– 
set num4_6=â–¡â–¡â–¡â– 

set num5_0=â– â– â– â– 
set num5_1=â– â–¡â–¡â–¡
set num5_2=â– â–¡â–¡â–¡
set num5_3=â– â– â– â– 
set num5_4=â–¡â–¡â–¡â– 
set num5_5=â–¡â–¡â–¡â– 
set num5_6=â– â– â– â– 

set num6_0=â– â– â– â– 
set num6_1=â– â–¡â–¡â–¡
set num6_2=â– â–¡â–¡â–¡
set num6_3=â– â– â– â– 
set num6_4=â– â–¡â–¡â– 
set num6_5=â– â–¡â–¡â– 
set num6_6=â– â– â– â– 

set num7_0=â– â– â– â– 
set num7_1=â–¡â–¡â–¡â– 
set num7_2=â–¡â–¡â–¡â– 
set num7_3=â–¡â–¡â–¡â– 
set num7_4=â–¡â–¡â–¡â– 
set num7_5=â–¡â–¡â–¡â– 
set num7_6=â–¡â–¡â–¡â– 

set num8_0=â– â– â– â– 
set num8_1=â– â–¡â–¡â– 
set num8_2=â– â–¡â–¡â– 
set num8_3=â– â– â– â– 
set num8_4=â– â–¡â–¡â– 
set num8_5=â– â–¡â–¡â– 
set num8_6=â– â– â– â– 

set num9_0=â– â– â– â– 
set num9_1=â– â–¡â–¡â– 
set num9_2=â– â–¡â–¡â– 
set num9_3=â– â– â– â– 
set num9_4=â–¡â–¡â–¡â– 
set num9_5=â–¡â–¡â–¡â– 
set num9_6=â– â– â– â– 

:lable
::è·å–ç³»ç»Ÿæ—¶é—´ï¼Œå¹¶å»é™¤å†’å·å¾—åˆ°ä¸€ä¸ªæ•°
set str=%time:~0,-3% 
set str1=%str::=%

:: åˆ¤æ–­æ—¶é—´çš„å¤§å°ä»¥åŒºåˆ†10ç‚¹ä¹‹å‰æˆ–ä¹‹åï¼Œåˆ†åˆ«å¤„ç†ï¼Œå› ä¸º10ç‚¹ä¹‹å‰çš„æ—¶é—´å°‘ä¸€ä½æ•°ã€‚ä¹‹åæŠŠæ—¶é—´æ•°å­—çš„æ¯ä½æ•°åˆ†åˆ«æå‡ºæ¥èµ‹ç»™n1-n6ã€‚
if %str1% lss 100000 (
	set n1=0
	set n2=%str1:~1,1%
	set n3=%str1:~2,1%
	set n4=%str1:~3,1%
	set n5=%str1:~4,1%
	set n6=%str1:~5,1%
	) else (
	set n1=%str1:~0,1%
	set n2=%str1:~1,1%
	set n3=%str1:~2,1%
	set n4=%str1:~3,1%
	set n5=%str1:~4,1%
	set n6=%str1:~5,1%
	)
ping /n 2 127.0.0.1>nul &cls

:: !num%n1%_0!  ï¼Œæ•°å­—n1çš„ç¬¬ä¸€è¡Œ
:: !num%n1%_1!  ï¼Œæ•°å­—n1çš„ç¬¬äºŒè¡Œ
:: !num%n1%_2!
:: !num%n1%_3!
:: !num%n1%_4!
:: !num%n1%_5!
:: !num%n1%_6!
::ä»¥ä¸Šå¯¹åº”ä¹‹å‰æ‰€èµ‹çš„å€¼ï¼Œn1-n6ç”±æˆªå–çš„ç³»ç»Ÿæ—¶é—´è·å¾—


set /p =!num%n1%_0!â–¡!num%n2%_0!â–¡â–¡â–¡!num%n3%_0!â–¡!num%n4%_0!â–¡â–¡â–¡!num%n5%_0!â–¡!num%n6%_0!<nul & echo.
set /p =!num%n1%_1!â–¡!num%n2%_1!â–¡â–¡â–¡!num%n3%_1!â–¡!num%n4%_1!â–¡â–¡â–¡!num%n5%_1!â–¡!num%n6%_1!<nul & echo.
set /p =!num%n1%_2!â–¡!num%n2%_2!â–¡â– â–¡!num%n3%_2!â–¡!num%n4%_2!â–¡â– â–¡!num%n5%_2!â–¡!num%n6%_2!<nul & echo.
set /p =!num%n1%_3!â–¡!num%n2%_3!â–¡â–¡â–¡!num%n3%_3!â–¡!num%n4%_3!â–¡â–¡â–¡!num%n5%_3!â–¡!num%n6%_3!<nul & echo.
set /p =!num%n1%_4!â–¡!num%n2%_4!â–¡â– â–¡!num%n3%_4!â–¡!num%n4%_4!â–¡â– â–¡!num%n5%_4!â–¡!num%n6%_4!<nul & echo.
set /p =!num%n1%_5!â–¡!num%n2%_5!â–¡â–¡â–¡!num%n3%_5!â–¡!num%n4%_5!â–¡â–¡â–¡!num%n5%_5!â–¡!num%n6%_5!<nul & echo.
set /p =!num%n1%_6!â–¡!num%n2%_6!â–¡â–¡â–¡!num%n3%_6!â–¡!num%n4%_6!â–¡â–¡â–¡!num%n5%_6!â–¡!num%n6%_6!<nul & echo.

goto :lable
```

## vbsè„šæœ¬åŒºåŸŸ

### ç”µè„‘å¿µè¯—ï¼ˆé¦™æ°´ç¯‡ï¼‰

æ³¨æ„åŒå¼•å·æ˜¯è‹±æ–‡çš„ï¼Œç„¶åå°†.txtåç¼€åæ”¹ä¸º.vbså³å¯ã€‚

```
set objTTS = createobject("sapi.spvoice")
objTTS.speak "èŠ¦ä¸¹æ°-æŸæ—å°‘å¥³:ç«ç‘°æ˜¯æˆ‘å·çš„ï¼Œä½ çˆ±çš„äººæ˜¯æˆ‘æ€çš„ã€‚ä¸çˆ±ä½ æ˜¯å‡çš„ï¼Œæƒ³å¿˜äº†ä½ æ˜¯çœŸçš„ã€‚å†·æ°´ï¼šæ‰€è°“å†·æ°´ï¼Œå¦‚äººé¥®æ°´å†·æš–è‡ªçŸ¥ã€‚èŠ¦ä¸¹æ°-å­¤å„¿æ€¨ï¼šä½ ç»éå–„ç±»ï¼Œæˆ‘ä¹Ÿä¸åšå¥½äººã€‚YSL-åè½¬å·´é»ï¼šæˆ‘æƒ³å’Œä½ è§é¢ï¼Œåœ°ç‚¹ä½ é€‰ï¼Œæ£®æ—æ²™æ¼ ï¼Œå¤œæ™šä¾ç¨€çš„æ¹–ç•”ï¼Œè‰åŸå¤§æµ·ï¼Œæƒ…åˆ†è–„é›¾çš„è¡—å£ï¼Œåªæ˜¯ä¸è¦åœ¨æ¢¦é‡Œã€‚çºªæ¢µå¸Œ-å¿ƒæ— ç¦å¿Œï¼šä»æ­¤ï¼Œæˆ‘çˆ±çš„äººéƒ½åƒä½ ã€‚è’‚æ™®è¿ªå…‹-å½±ä¸­ä¹‹æ°´ï¼šæˆ‘çˆ±ä½ åªæ˜¯æˆ‘çš„äº‹ï¼Œä¸ä½ æ— å…³ã€‚"
```

### æ¶æç”µè„‘è‡ªçˆ†

åŒæ ·åç¼€åæ”¹ä¸º.vbså³å¯ã€‚

```
msgbox"ç”µè„‘å³å°†è‡ªçˆ†"+chr(13)+"è¯·åœ¨15ç§’å†…ç¦»å¼€åº§ä½"+chr(13)+"å¦åˆ™ä½ æ­»å®šäº†",2,"ç³»ç»Ÿè‡ªçˆ†æé†’"
CreateObject("SAPI.SpVoice").Speak"ç”µè„‘å³å°†è‡ªçˆ†ï¼Œè¯·åœ¨15ç§’å†…ç¦»å¼€åº§ä½ï¼Œå¦åˆ™ä½ æ­»å®šäº†ï¼"
```

### ç”µè„‘è‡ªçˆ†æ¶æ

```
Set objVoice = CreateObject("SAPI.SpVoice")

' æ˜¾ç¤ºæ¶ˆæ¯æ¡†
MsgBox "ç”µè„‘å³å°†è‡ªçˆ†" & vbCrLf & "è¯·åœ¨15ç§’å†…ç¦»å¼€åº§ä½" & vbCrLf & "å¦åˆ™ä½ æ­»å®šäº†", 2, "ç³»ç»Ÿè‡ªçˆ†æé†’"

' å¢åŠ ä¸€äº›ææ€ªçš„è¯­éŸ³è¾“å‡º
objVoice.Speak "å˜¿ï¼Œä½ å¬åˆ°äº†å—ï¼Ÿç”µè„‘å³å°†è‡ªçˆ†å•¦ï¼ä½ è¿˜ä¸å¿«è·‘çš„è¯ï¼Œå¯åˆ«æ€ªæˆ‘æ²¡æé†’ä½ ï¼"

' æ¯3ç§’å‘å‡ºä¸€æ¬¡ "è¹¦è¹¦è¹¦" çš„å£°éŸ³
For i = 1 To 3
    WScript.Sleep 3000 ' åœé¡¿3ç§’
    objVoice.Speak "è¹¦è¹¦è¹¦"
Next

' æœ€åè­¦å‘Š
objVoice.Speak "æ—¶é—´æ‰€å‰©æ— å‡ ï¼Œä½ è¿˜ä¸å¿«ç‚¹ç¦»å¼€ï¼Ÿè®°ä½ï¼Œç¦»å¼€åº§ä½ï¼Œæ‰èƒ½ä¿ä½å°å‘½ï¼"

```

### ä¸­å¥–åƒä¸‡å¯Œç¿

ä»£ç å†™å¥½åå¦å­˜ä¸ºANSLç¼–ç æ ¼å¼çš„txtæ–‡ä»¶ï¼Œå†æŠŠåç¼€åæ”¹ä¸º.vbsã€‚

```
set objTTS = createobject("sapi.spvoice")
msgbox"æ­å–œæ‚¨ä¸Šä¸€æœŸè´­ä¹°çš„å…­åˆå½©ä¸­å¥–å•¦ï¼"+chr(13)+"å¥–é‡‘ä¸ºä¸€åƒä¸‡å…ƒ"
objTTS.speak "æ­å–œä½ ä¸­äº†ä¸€åƒä¸‡çš„ç™½æ—¥æ¢¦å¤§å¥–!"
objTTS.Speak"æ”¯ä»˜å®åˆ°è´¦ï¼Œä¸€åƒä¸‡å…ƒ"
```

### è¡¨ç™½æ¶æ

```
msgbox "åšæˆ‘å¥³æœ‹å‹å¥½å—",vbQuestion,"åœ¨å—"

msgbox ("æˆ¿äº§å†™ä½ åå­—")

msgbox ("ä¿å¤§")

msgbox ("æˆ‘å¦ˆä¼šæ¸¸æ³³")

dim j

do while j<1

Select Case msgbox("åšæˆ‘å¥³æœ‹å‹å¥½å—",68,"è¯·éƒ‘é‡çš„å›ç­”æˆ‘")

Case 6 j=1

Case 7 msgbox("å†ç»™ä½ ä¸€æ¬¡æœºä¼š")

end Select

loop

msgbox("æˆ‘å°±çŸ¥é“ä½ ä¼šåŒæ„çš„ï¼Œå“ˆå“ˆå“ˆå“ˆ")
```

### è¡¨ç™½æ¶æè¯­éŸ³ç‰ˆ

```
' åˆ›å»ºè¯­éŸ³å¯¹è±¡
Set speech = CreateObject("SAPI.SpVoice")

' è¡¨ç™½
speech.Speak "åšæˆ‘å¥³æœ‹å‹å¥½å—"
msgbox "åšæˆ‘å¥³æœ‹å‹å¥½å—", vbQuestion, "åœ¨å—"

' æˆ¿äº§å†™ä½ åå­—
speech.Speak "æˆ¿äº§å†™ä½ åå­—"
msgbox "æˆ¿äº§å†™ä½ åå­—"

' ä¿å¤§
speech.Speak "ä¿å¤§"
msgbox "ä¿å¤§"

' æˆ‘å¦ˆä¼šæ¸¸æ³³
speech.Speak "æˆ‘å¦ˆä¼šæ¸¸æ³³"
msgbox "æˆ‘å¦ˆä¼šæ¸¸æ³³"

' å¾ªç¯è¯¢é—®
Dim j
Do While j < 1
    Select Case msgbox("åšæˆ‘å¥³æœ‹å‹å¥½å—", 68, "è¯·éƒ‘é‡çš„å›ç­”æˆ‘")
        Case 6 ' Yes æŒ‰é’®
            j = 1
        Case 7 ' No æŒ‰é’®
            speech.Speak "å†ç»™ä½ ä¸€æ¬¡æœºä¼š"
            msgbox "å†ç»™ä½ ä¸€æ¬¡æœºä¼š"
    End Select
Loop

' ç»“æŸè¯­
speech.Speak "æˆ‘å°±çŸ¥é“ä½ ä¼šåŒæ„çš„ï¼Œå“ˆå“ˆå“ˆå“ˆ"
msgbox "æˆ‘å°±çŸ¥é“ä½ ä¼šåŒæ„çš„ï¼Œå“ˆå“ˆå“ˆå“ˆ"

```

### é‡å¯åº”ç”¨

#### ç¤ºä¾‹1

åˆ›å»ºä¸€ä¸ªvsbæ–‡ä»¶ï¼Œå¦å­˜ç¼–ç ä¸ºANSIæ ¼å¼å³å¯ã€‚

```
Set WshShell = CreateObject("WScript.Shell")
Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")

' æ£€æŸ¥ VSCode æ˜¯å¦å·²å¯åŠ¨
Set colProcesses = objWMIService.ExecQuery("Select * from Win32_Process where Name = 'Code.exe'")

' å¦‚æœ VSCode å·²ç»åœ¨è¿è¡Œï¼Œå…³é—­å®ƒ
If colProcesses.Count > 0 Then
    WshShell.Run "taskkill /F /IM Code.exe", 0, True
    WScript.Sleep 1000 ' ç­‰å¾… 1 ç§’é’Ÿï¼Œä»¥ç¡®ä¿è¿›ç¨‹å…³é—­
End If

' å¯åŠ¨ VSCode
Set objExec = WshShell.Exec("""D:\Program Files\VSCode\Code.exe""") ' ä½¿ç”¨ Exec æ–¹æ³•

' ç­‰å¾… 3 ç§’é’Ÿä»¥ç¡®ä¿ VSCode å¯åŠ¨
WScript.Sleep 3000

```

#### ç¤ºä¾‹2

å¦‚æœé‡åˆ°æœ‰äº›åº”ç”¨éœ€è¦ç®¡ç†å‘˜æƒé™è¿è¡Œï¼Œä¸”åº”ç”¨æ‰“å¼€æ—¶é—´æ¯”è¾ƒé•¿çš„ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹vsbè„šæœ¬ä»£ç ã€‚

```
Set WshShell = CreateObject("WScript.Shell")
Set objFSO = CreateObject("Scripting.FileSystemObject")

' ä¸´æ—¶æ–‡ä»¶è·¯å¾„ï¼Œç”¨äºæ ‡è®°è„šæœ¬æ˜¯å¦æ­£åœ¨æ‰§è¡Œ
tempFile = "C:\temp\vsCodeRunning.txt"

' ç¡®ä¿è·¯å¾„å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»º
If Not objFSO.FolderExists("C:\temp") Then
    objFSO.CreateFolder("C:\temp")
End If

' æ£€æŸ¥æ˜¯å¦å·²ç»ä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œ
If Not IsAdmin() Then
    ' å¦‚æœæ²¡æœ‰ç®¡ç†å‘˜æƒé™ï¼Œé‡æ–°å¯åŠ¨è„šæœ¬å¹¶ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ
    RunAsAdmin()
    WScript.Quit
End If

' æ£€æŸ¥æ ‡è®°æ–‡ä»¶ï¼Œé˜²æ­¢é‡å¤æ‰§è¡Œ
If FileExists(tempFile) Then
    WScript.Echo "è„šæœ¬å·²ç»åœ¨è¿è¡Œï¼Œè¯·ç¨å..."
    WScript.Quit
End If

' åˆ›å»ºæ ‡è®°æ–‡ä»¶ï¼Œè¡¨ç¤ºè„šæœ¬æ­£åœ¨è¿è¡Œ
CreateFile tempFile

' æ£€æŸ¥ VSCode æ˜¯å¦å·²å¯åŠ¨
Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")
Set colProcesses = objWMIService.ExecQuery("Select * from Win32_Process where Name = 'Code.exe'")

' å¦‚æœ VSCode å·²ç»åœ¨è¿è¡Œï¼Œå…³é—­å®ƒ
If colProcesses.Count > 0 Then
    WshShell.Run "taskkill /F /IM Code.exe", 0, True
    WScript.Sleep 2000 ' ç­‰å¾… 2 ç§’é’Ÿï¼Œä»¥ç¡®ä¿è¿›ç¨‹å®Œå…¨å…³é—­
    ' WScript.Echo "VSCode å·²å…³é—­ã€‚" ' è¾“å‡ºåˆ°æ§åˆ¶å°
End If

' å¯åŠ¨ VSCode
WshShell.Run """D:\Program Files\Microsoft VS Code\Code.exe""", 1, False ' ä½¿ç”¨ Run æ–¹æ³•ï¼Œä¸ç­‰å¾…

' ç­‰å¾…ç›´åˆ° VSCode å¯åŠ¨å®Œæˆæˆ–è¾¾åˆ°æœ€å¤§ç­‰å¾…æ¬¡æ•°
max_wait_time = 120
wait_interval = 5
max_attempts = max_wait_time / wait_interval
attempt = 0
Do While attempt < max_attempts
    Set colProcesses = objWMIService.ExecQuery("Select * from Win32_Process where Name = 'Code.exe'")
    If colProcesses.Count > 0 Then
        Exit Do
    Else
        WScript.Echo "VSCode å°šæœªå¯åŠ¨ï¼Œç»§ç»­ç­‰å¾…... å·²ç­‰å¾… " & attempt * wait_interval & " ç§’"
        WScript.Sleep wait_interval * 1000
        attempt = attempt + 1
    End If
Loop

If attempt >= max_attempts Then
    WScript.Echo "è¾¾åˆ°æœ€å¤§ç­‰å¾…æ—¶é—´ï¼ŒVSCode å¯èƒ½æ— æ³•å¯åŠ¨ã€‚"
End If

' åˆ é™¤æ ‡è®°æ–‡ä»¶ï¼Œè¡¨ç¤ºè„šæœ¬æ‰§è¡Œå®Œæˆ
DeleteFile tempFile

' å‡½æ•°ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
Function FileExists(filePath)
    On Error Resume Next
    FileExists = (Len(Dir(filePath)) > 0)
    On Error GoTo 0
End Function

' å‡½æ•°ï¼šåˆ›å»ºæ–‡ä»¶
Sub CreateFile(filePath)
    Set objFSO = CreateObject("Scripting.FileSystemObject")
    Set objFile = objFSO.CreateTextFile(filePath, True)
    objFile.WriteLine("VSCodeè„šæœ¬æ­£åœ¨æ‰§è¡Œ")
    objFile.Close
End Sub

' å‡½æ•°ï¼šåˆ é™¤æ–‡ä»¶
Sub DeleteFile(filePath)
    Set objFSO = CreateObject("Scripting.FileSystemObject")
    objFSO.DeleteFile filePath, True
End Sub

' å‡½æ•°ï¼šæ£€æŸ¥æ˜¯å¦ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ
Function IsAdmin()
    On Error Resume Next
    Set objShell = CreateObject("Shell.Application")
    If objShell.IsUserAnAdmin() Then
        IsAdmin = True
    Else
        IsAdmin = False
    End If
    On Error GoTo 0
End Function

' å‡½æ•°ï¼šä»¥ç®¡ç†å‘˜èº«ä»½é‡æ–°è¿è¡Œè„šæœ¬
Sub RunAsAdmin()
    Set objShell = CreateObject("Shell.Application")
    objShell.ShellExecute "wscript.exe", """" & WScript.ScriptFullName & """", "", "runas", 1
End Sub
```

### å…³é—­ç”µè„‘

è¿™ä¸ªæ˜¯vbsæ–‡ä»¶çš„å…³æœºå‘½ä»¤ï¼Œè¿˜å¯ä»¥ç›´æ¥cmdå‘½ä»¤çª—å£ï¼šshutdown -s -t 00æ¥å…³æœºã€‚

```
dim WSHshell

set WSHshell = wscript.createobject("wscript.shell")

WSHshell.run "shutdown -f -s -t 00",0 ,true
```

### æ¶ˆæ¯è½°ç‚¸æ¶æ

```bash
On Error Resume Next

Dim wsh,ye

set wsh=createobject("wscript.shell")

for i=1 to 30

wscript.sleep 300

wsh.AppActivate("")

wsh.sendKeys "^v"

wsh.sendKeys 

wsh.sendKeys "%s"

next 

wscript.quit
```

**ä½¿ç”¨æ–¹æ³•**

1. å¤åˆ¶è¿™æ®µä»£ç ï¼Œä¿å­˜ä¸º `*.vbs`åç¼€çš„VBSè„šæœ¬ï¼›
2. æ‰“å¼€ç‰¹å®šèŠå¤©çª—å£
3. æŠŠæƒ³è¦è¾“å…¥çš„å†…å®¹å¤åˆ¶åœ¨å‰ªåˆ‡æ¿ä¸­ï¼›
4. åŒå‡»è¯¥è„šæœ¬å³å¯æ‰¹é‡å‘é€ï¼Œæ¯”å¦‚è®¾ç½®çš„æ˜¯å¾ªç¯30æ¬¡å‘é€ï¼Œå¯ä»»æ„ä¿®æ”¹ã€‚

### æ‰¹é‡å¯åŠ¨é¢æ¿

è¯¥vbså¯åŠ¨è„šæœ¬ç”¨äºåŒå‡»æ‰§è¡Œæ‰¹é‡å¯åŠ¨é¢æ¿.ps1æ–‡ä»¶ï¼Œè§£å†³æ— æ³•ç›´æ¥åŒå‡»å¯åŠ¨ã€å…³é—­é¢æ¿ä¸å½±å“å·²å¯åŠ¨ç¨‹åºç­‰é—®é¢˜ã€‚**ï¼ˆæ¨èï¼‰**

ä¿å­˜ä¸º ANSI ç¼–ç ï¼š

1. ç”¨è®°äº‹æœ¬æ‰“å¼€ VBS æ–‡ä»¶
2. ç‚¹å‡»"æ–‡ä»¶" â†’ "å¦å­˜ä¸º"
3. åœ¨ä¿å­˜å¯¹è¯æ¡†åº•éƒ¨ï¼Œå°†"ç¼–ç "æ”¹ä¸º **ANSI**
4. ä¿å­˜æ–‡ä»¶

```bash
' åº”ç”¨å¯åŠ¨é¢æ¿å¯åŠ¨å™¨ - æ— é»‘æ¡†ç‰ˆæœ¬
CreateObject("WScript.Shell").Run "powershell.exe -ExecutionPolicy Bypass -WindowStyle Hidden -File ""F:\å¥½ç©è„šæœ¬ç¨‹åº\æ‰¹é‡å¯åŠ¨é¢æ¿.ps1""", 0, False
```

## ps1è„šæœ¬åŒºåŸŸ

### **å®ç°åŒå‡»è¿è¡Œ .ps1 è„šæœ¬**

é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒå‡» .ps1 æ–‡ä»¶ä¸ä¼šç›´æ¥è¿è¡Œï¼Œå› ä¸º PowerShell çš„æ‰§è¡Œç­–ç•¥é™åˆ¶äº†è„šæœ¬çš„ç›´æ¥æ‰§è¡Œï¼Œè€Œä¸” Windows é€šå¸¸å°† .ps1 æ–‡ä»¶ä¸æ–‡æœ¬ç¼–è¾‘å™¨å…³è”ï¼Œè€Œä¸æ˜¯ PowerShell æ‰§è¡Œç¯å¢ƒã€‚ä»¥ä¸‹æ˜¯å®ç°åŒå‡»è¿è¡Œçš„æ­¥éª¤ï¼š

#### **å¿«æ·æ–¹å¼é…ç½®**

1. **åˆ›å»ºä¸€ä¸ªå¿«æ·æ–¹å¼** ï¼š

* å³é”®ç‚¹å‡»ä½ çš„è„šæœ¬æ–‡ä»¶ï¼ˆä¾‹å¦‚ AppLauncher.ps1ï¼‰ï¼Œé€‰æ‹©â€œåˆ›å»ºå¿«æ·æ–¹å¼â€ã€‚
* å°†å¿«æ·æ–¹å¼é‡å‘½åï¼ˆä¾‹å¦‚ å¯åŠ¨é¢æ¿.lnkï¼‰å¹¶ç§»åŠ¨åˆ°æ¡Œé¢æˆ–å…¶ä»–æ–¹ä¾¿çš„ä½ç½®ã€‚

1. **ä¿®æ”¹å¿«æ·æ–¹å¼å±æ€§** ï¼š

* å³é”®ç‚¹å‡»å¿«æ·æ–¹å¼ï¼Œé€‰æ‹©â€œå±æ€§â€ã€‚
* åœ¨â€œç›®æ ‡â€å­—æ®µä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼ˆæ›¿æ¢è·¯å¾„ä¸ºä½ çš„è„šæœ¬è·¯å¾„ï¼‰ï¼š
  text

  ```
  powershell.exe -ExecutionPolicy Bypass -File "C:\Path\To\Your\AppLauncher.ps1"
  ```
* -ExecutionPolicy Bypass ç»•è¿‡æ‰§è¡Œç­–ç•¥é™åˆ¶ï¼Œå…è®¸è„šæœ¬è¿è¡Œã€‚
* å¯é€‰ï¼šç‚¹å‡»â€œæ›´æ”¹å›¾æ ‡â€æŒ‰é’®ï¼Œé€‰æ‹©ä¸€ä¸ªæ›´ç¾è§‚çš„å›¾æ ‡ï¼ˆä¾‹å¦‚ä» shell32.dll é€‰æ‹©ï¼‰ã€‚

1. **åŒå‡»è¿è¡Œ** ï¼š

* åŒå‡»å¿«æ·æ–¹å¼å³å¯è¿è¡Œè„šæœ¬ï¼Œå¯åŠ¨ GUI é¢æ¿ã€‚
* è¿™ç§æ–¹æ³•ä¸éœ€è¦ä¿®æ”¹ç³»ç»Ÿæ‰§è¡Œç­–ç•¥ï¼Œé€‚åˆå•æœºä½¿ç”¨ã€‚

### æ‰¹é‡å¯åŠ¨é¢æ¿.ps1

å¦å­˜æ—¶ç”¨å¸¦æœ‰BOMçš„UTF-8çš„ç¼–ç æ ¼å¼è¿›è¡Œä¿å­˜ã€‚

```bash
# ============================================
# ğŸŒ å‘é˜³çš„åº”ç”¨å¯åŠ¨é¢æ¿ v4.1
# åŠŸèƒ½ï¼šè‡ªå®šä¹‰å¸ƒå±€ç•Œé¢,å¿«é€Ÿæ‰¹é‡å¯åŠ¨åº”ç”¨ç¨‹åºã€‚
# ============================================

Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing

# è½¯ä»¶æ¸…å• - ä½¿ç”¨å­—ä½“å›¾æ ‡
$apps = @(
    @{Name="è°·æ­Œæµè§ˆå™¨"; Path="C:\Program Files\Google\Chrome\Application\chrome.exe"; Icon="â²"},
    @{Name="Edge æµè§ˆå™¨"; Path="C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe"; Icon="â²"},
    @{Name="å¾®ä¿¡"; Path="D:\Program Files\Tencent\Weixin\Weixin.exe"; Icon="â˜"},
    @{Name="QQ"; Path="D:\Program Files (x86)\Tencent\QQ\Bin\QQ.exe"; Icon="â™«"},
    @{Name="VSCode"; Path="D:\Program Files\VSCode\Code.exe"; Icon="ğŸ“„"},
    @{Name="æœ‰é“äº‘ç¬”è®°"; Path="D:\Program Files\ynote-desktop\æœ‰é“äº‘ç¬”è®°.exe"; Icon="âš™"},
    @{Name="Notepad++"; Path="E:\å¸¸ç”¨è½¯ä»¶åŒ…\npp.8.6.7.portable.x64\notepad++.exe"; Icon="âœ"},
    @{Name="Photoshop"; Path="C:\Program Files\Adobe\Photoshop\photoshop.exe"; Icon="ğŸ¨"},
    @{Name="Excel"; Path="C:\Program Files\Microsoft Office\Office16\EXCEL.EXE"; Icon="â˜…"},
    @{Name="Word"; Path="C:\Program Files\Microsoft Office\Office16\WINWORD.EXE"; Icon="â™¦"},
    @{Name="PowerPoint"; Path="C:\Program Files\Microsoft Office\Office16\POWERPNT.EXE"; Icon="â™£"},
    @{Name="Teams"; Path="C:\Program Files\Microsoft Teams\teams.exe"; Icon="å˜»å˜»"},
    @{Name="Slack"; Path="C:\Program Files\Slack\slack.exe"; Icon="ğŸ’¼"},
    @{Name="Discord"; Path="C:\Program Files\Discord\Discord.exe"; Icon="âš”"},
    @{Name="Spotify"; Path="C:\Program Files\Spotify\Spotify.exe"; Icon="â™«"},
    @{Name="è®¡ç®—å™¨"; Path="C:\Windows\System32\calc.exe"; Icon="â„—"},
    @{Name="ç”»å›¾"; Path="C:\Windows\System32\mspaint.exe"; Icon="â‚"},
    @{Name="è®°äº‹æœ¬"; Path="C:\Windows\System32\notepad.exe"; Icon="ğŸ“„"}
)

# åˆ›å»ºä¸»çª—ä½“
$form = New-Object System.Windows.Forms.Form
$form.Text = "ğŸŒ å‘é˜³çš„åº”ç”¨å¯åŠ¨é¢æ¿ v4.1"
$form.StartPosition = "CenterScreen"
$form.Size = New-Object System.Drawing.Size(850, 600)
$form.BackColor = [System.Drawing.Color]::FromArgb(245, 249, 255)
$form.TopMost = $false
$form.FormBorderStyle = "FixedDialog"
$form.MaximizeBox = $false
$form.MinimizeBox = $true

# æ ‡é¢˜é¢æ¿
$headerPanel = New-Object System.Windows.Forms.Panel
$headerPanel.Size = New-Object System.Drawing.Size(810, 90)
$headerPanel.Location = New-Object System.Drawing.Point(20, 15)
$headerPanel.BackColor = [System.Drawing.Color]::FromArgb(74, 107, 255)
$headerPanel.ForeColor = [System.Drawing.Color]::White
$form.Controls.Add($headerPanel)

# æ¸å˜èƒŒæ™¯ç»˜åˆ¶
$headerPanel.Add_Paint({
    param($sender, $e)
    $brush = New-Object System.Drawing.Drawing2D.LinearGradientBrush(
        $sender.ClientRectangle,
        [System.Drawing.Color]::FromArgb(74, 107, 255),
        [System.Drawing.Color]::FromArgb(119, 146, 255),
        [System.Drawing.Drawing2D.LinearGradientMode]::Horizontal
    )
    $e.Graphics.FillRectangle($brush, $sender.ClientRectangle)
    $brush.Dispose()
})

# æ ‡é¢˜
$titleLabel = New-Object System.Windows.Forms.Label
$titleLabel.Text = "åº”ç”¨å¯åŠ¨é¢æ¿"
$titleLabel.Font = New-Object System.Drawing.Font("Microsoft YaHei", 16, [System.Drawing.FontStyle]::Bold)
$titleLabel.ForeColor = [System.Drawing.Color]::White
$titleLabel.Size = New-Object System.Drawing.Size(810, 40)
$titleLabel.Location = New-Object System.Drawing.Point(0, 15)
$titleLabel.TextAlign = "MiddleCenter"
$headerPanel.Controls.Add($titleLabel)

# å‰¯æ ‡é¢˜
$subtitleLabel = New-Object System.Windows.Forms.Label
$subtitleLabel.Text = "é€‰æ‹©æ‚¨è¦å¯åŠ¨çš„åº”ç”¨ç¨‹åº"
$subtitleLabel.Font = New-Object System.Drawing.Font("Microsoft YaHei", 10, [System.Drawing.FontStyle]::Regular)
$subtitleLabel.ForeColor = [System.Drawing.Color]::FromArgb(230, 230, 255)
$subtitleLabel.Size = New-Object System.Drawing.Size(810, 25)
$subtitleLabel.Location = New-Object System.Drawing.Point(0, 55)
$subtitleLabel.TextAlign = "MiddleCenter"
$headerPanel.Controls.Add($subtitleLabel)

# åˆ›å»ºæ»šåŠ¨é¢æ¿
$scrollPanel = New-Object System.Windows.Forms.Panel
$scrollPanel.Size = New-Object System.Drawing.Size(810, 350)
$scrollPanel.Location = New-Object System.Drawing.Point(20, 120)
$scrollPanel.BackColor = [System.Drawing.Color]::White
$scrollPanel.BorderStyle = "FixedSingle"
$scrollPanel.AutoScroll = $true
$form.Controls.Add($scrollPanel)

# åˆ›å»ºå¤é€‰æ¡†ï¼ˆä¸¤åˆ—å¸ƒå±€ï¼‰
$checkboxes = @()
$columnCount = 3  # åˆ—æ•°
$itemWidth = 200  # å¢åŠ å®½åº¦ä»¥å®¹çº³å›¾æ ‡
$itemHeight = 50  # æ¯é¡¹é«˜åº¦
$margin = 15      # è¾¹è·

for ($i = 0; $i -lt $apps.Count; $i++) {
    $app = $apps[$i]
    $row = [Math]::Floor($i / $columnCount)
    $column = $i % $columnCount
  
    $x = $margin + ($column * $itemWidth)
    $y = $margin + ($row * $itemHeight)
  
    # åˆ›å»ºåº”ç”¨é¡¹é¢æ¿
    $itemPanel = New-Object System.Windows.Forms.Panel
    $itemPanel.Size = New-Object System.Drawing.Size(($itemWidth - 25), 40)
    $itemPanel.Location = New-Object System.Drawing.Point($x, $y)
    $itemPanel.BackColor = [System.Drawing.Color]::FromArgb(250, 252, 255)
    $itemPanel.BorderStyle = "FixedSingle"
    $itemPanel.Cursor = [System.Windows.Forms.Cursors]::Hand
  
    # æ·»åŠ æ‚¬åœæ•ˆæœ
    $itemPanel.Add_MouseEnter({
        $this.BackColor = [System.Drawing.Color]::FromArgb(240, 245, 255)
        $this.BorderStyle = "FixedSingle"
    })
  
    $itemPanel.Add_MouseLeave({
        if (-not $this.Controls[0].Checked) {
            $this.BackColor = [System.Drawing.Color]::FromArgb(250, 252, 255)
        }
    })
  
    # å¤é€‰æ¡†
    $cb = New-Object System.Windows.Forms.CheckBox
    $cb.Text = "  $($app.Icon)  $($app.Name)"  # å¢åŠ å›¾æ ‡ä¸æ–‡å­—é—´è·
    $cb.Tag = $app.Path
    $cb.Font = New-Object System.Drawing.Font("Microsoft YaHei", 9.5, [System.Drawing.FontStyle]::Regular)
    $cb.Location = New-Object System.Drawing.Point(8, 10)
    $cb.AutoSize = $true
    $cb.BackColor = [System.Drawing.Color]::Transparent
    $cb.Cursor = [System.Windows.Forms.Cursors]::Hand
  
    # å¤é€‰æ¡†çŠ¶æ€æ”¹å˜æ—¶æ›´æ–°é¢æ¿æ ·å¼
    $cb.Add_CheckedChanged({
        if ($this.Checked) {
            $this.Parent.BackColor = [System.Drawing.Color]::FromArgb(230, 240, 255)
        } else {
            $this.Parent.BackColor = [System.Drawing.Color]::FromArgb(250, 252, 255)
        }
    })
  
    $itemPanel.Controls.Add($cb)
    $scrollPanel.Controls.Add($itemPanel)
    $checkboxes += $cb
}

# è°ƒæ•´æ»šåŠ¨é¢æ¿é«˜åº¦
$totalRows = [Math]::Ceiling($apps.Count / $columnCount)
$scrollPanel.Height = [Math]::Min(350, ($totalRows * $itemHeight + 2 * $margin))

# æŒ‰é’®é¢æ¿
$buttonPanel = New-Object System.Windows.Forms.Panel
$buttonPanel.Size = New-Object System.Drawing.Size(810, 80)
$buttonPanel.Location = New-Object System.Drawing.Point(20, ($scrollPanel.Location.Y + $scrollPanel.Height + 20))
$buttonPanel.BackColor = [System.Drawing.Color]::Transparent
$form.Controls.Add($buttonPanel)

# å¯åŠ¨æŒ‰é’®
$launchButton = New-Object System.Windows.Forms.Button
$launchButton.Text = "ğŸš€ å¯åŠ¨é€‰ä¸­ç¨‹åº"
$launchButton.Font = New-Object System.Drawing.Font("Microsoft YaHei", 11, [System.Drawing.FontStyle]::Bold)
$launchButton.Size = New-Object System.Drawing.Size(200, 45)
$launchButton.Location = New-Object System.Drawing.Point(150, 15)
$launchButton.BackColor = [System.Drawing.Color]::FromArgb(74, 107, 255)
$launchButton.ForeColor = [System.Drawing.Color]::White
$launchButton.FlatStyle = "Flat"
$launchButton.FlatAppearance.BorderSize = 0
$launchButton.Cursor = [System.Windows.Forms.Cursors]::Hand

# æŒ‰é’®æ‚¬åœæ•ˆæœ
$launchButton.Add_MouseEnter({
    $this.BackColor = [System.Drawing.Color]::FromArgb(30, 144, 255)
})

$launchButton.Add_MouseLeave({
    $this.BackColor = [System.Drawing.Color]::FromArgb(74, 107, 255)
})

$launchButton.Add_Click({
    $selected = $checkboxes | Where-Object { $_.Checked }
    if ($selected.Count -eq 0) {
        [System.Windows.Forms.MessageBox]::Show("è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼", "æç¤º", 
            [System.Windows.Forms.MessageBoxButtons]::OK, 
            [System.Windows.Forms.MessageBoxIcon]::Information)
        return
    }

    $notFound = @()
    $successCount = 0
  
    foreach ($item in $selected) {
        $path = $item.Tag
        if (Test-Path $path) {
            try {
                Start-Process -FilePath $path -ErrorAction Stop
                $successCount++
            } catch {
                $notFound += "$($item.Text.Trim()) (å¯åŠ¨å¤±è´¥)"
            }
        } else {
            $notFound += "$($item.Text.Trim()) (æ–‡ä»¶ä¸å­˜åœ¨)"
        }
        Start-Sleep -Milliseconds 100  # ç¨å¾®å»¶è¿Ÿï¼Œé¿å…åŒæ—¶å¯åŠ¨å¤ªå¤šç¨‹åº
    }

    if ($notFound.Count -gt 0) {
        [System.Windows.Forms.MessageBox]::Show("ä»¥ä¸‹ç¨‹åºå¯åŠ¨å¤±è´¥ï¼š`n`n" + ($notFound -join "`n"), 
            "âš ï¸ å¯åŠ¨å¤±è´¥", 
            [System.Windows.Forms.MessageBoxButtons]::OK, 
            [System.Windows.Forms.MessageBoxIcon]::Warning)
    } else {
        [System.Windows.Forms.MessageBox]::Show("âœ… å·²æˆåŠŸå¯åŠ¨ $successCount ä¸ªåº”ç”¨ï¼", 
            "å®Œæˆ", 
            [System.Windows.Forms.MessageBoxButtons]::OK, 
            [System.Windows.Forms.MessageBoxIcon]::Information)
        $form.WindowState = [System.Windows.Forms.FormWindowState]::Minimized
    }
})
$buttonPanel.Controls.Add($launchButton)

# è°ƒæ•´çª—ä½“é«˜åº¦
$form.Height = $buttonPanel.Location.Y + $buttonPanel.Height + 50

# å¯åŠ¨çª—å£
[void]$form.ShowDialog()
```
